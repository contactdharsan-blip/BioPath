(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const R of document.querySelectorAll('link[rel="modulepreload"]'))d(R);new MutationObserver(R=>{for(const S of R)if(S.type==="childList")for(const j of S.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&d(j)}).observe(document,{childList:!0,subtree:!0});function n(R){const S={};return R.integrity&&(S.integrity=R.integrity),R.referrerPolicy&&(S.referrerPolicy=R.referrerPolicy),R.crossOrigin==="use-credentials"?S.credentials="include":R.crossOrigin==="anonymous"?S.credentials="omit":S.credentials="same-origin",S}function d(R){if(R.ep)return;R.ep=!0;const S=n(R);fetch(R.href,S)}})();function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var o=Symbol.for("react.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),j=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),D=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),A=Symbol.iterator;function L(k){return k===null||typeof k!="object"?null:(k=A&&k[A]||k["@@iterator"],typeof k=="function"?k:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,u={};function i(k,Y,ie){this.props=k,this.context=Y,this.refs=u,this.updater=ie||w}i.prototype.isReactComponent={},i.prototype.setState=function(k,Y){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,Y,"setState")},i.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function s(){}s.prototype=i.prototype;function h(k,Y,ie){this.props=k,this.context=Y,this.refs=u,this.updater=ie||w}var g=h.prototype=new s;g.constructor=h,b(g,i.prototype),g.isPureReactComponent=!0;var y=Array.isArray,E=Object.prototype.hasOwnProperty,l={current:null},f={key:!0,ref:!0,__self:!0,__source:!0};function m(k,Y,ie){var ne,he={},le=null,xe=null;if(Y!=null)for(ne in Y.ref!==void 0&&(xe=Y.ref),Y.key!==void 0&&(le=""+Y.key),Y)E.call(Y,ne)&&!f.hasOwnProperty(ne)&&(he[ne]=Y[ne]);var fe=arguments.length-2;if(fe===1)he.children=ie;else if(1<fe){for(var pe=Array(fe),Te=0;Te<fe;Te++)pe[Te]=arguments[Te+2];he.children=pe}if(k&&k.defaultProps)for(ne in fe=k.defaultProps,fe)he[ne]===void 0&&(he[ne]=fe[ne]);return{$$typeof:o,type:k,key:le,ref:xe,props:he,_owner:l.current}}function C(k,Y){return{$$typeof:o,type:k.type,key:Y,ref:k.ref,props:k.props,_owner:k._owner}}function T(k){return typeof k=="object"&&k!==null&&k.$$typeof===o}function P(k){var Y={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(ie){return Y[ie]})}var F=/\/+/g;function N(k,Y){return typeof k=="object"&&k!==null&&k.key!=null?P(""+k.key):Y.toString(36)}function B(k,Y,ie,ne,he){var le=typeof k;(le==="undefined"||le==="boolean")&&(k=null);var xe=!1;if(k===null)xe=!0;else switch(le){case"string":case"number":xe=!0;break;case"object":switch(k.$$typeof){case o:case a:xe=!0}}if(xe)return xe=k,he=he(xe),k=ne===""?"."+N(xe,0):ne,y(he)?(ie="",k!=null&&(ie=k.replace(F,"$&/")+"/"),B(he,Y,ie,"",function(Te){return Te})):he!=null&&(T(he)&&(he=C(he,ie+(!he.key||xe&&xe.key===he.key?"":(""+he.key).replace(F,"$&/")+"/")+k)),Y.push(he)),1;if(xe=0,ne=ne===""?".":ne+":",y(k))for(var fe=0;fe<k.length;fe++){le=k[fe];var pe=ne+N(le,fe);xe+=B(le,Y,ie,pe,he)}else if(pe=L(k),typeof pe=="function")for(k=pe.call(k),fe=0;!(le=k.next()).done;)le=le.value,pe=ne+N(le,fe++),xe+=B(le,Y,ie,pe,he);else if(le==="object")throw Y=String(k),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return xe}function U(k,Y,ie){if(k==null)return k;var ne=[],he=0;return B(k,ne,"","",function(le){return Y.call(ie,le,he++)}),ne}function K(k){if(k._status===-1){var Y=k._result;Y=Y(),Y.then(function(ie){(k._status===0||k._status===-1)&&(k._status=1,k._result=ie)},function(ie){(k._status===0||k._status===-1)&&(k._status=2,k._result=ie)}),k._status===-1&&(k._status=0,k._result=Y)}if(k._status===1)return k._result.default;throw k._result}var H={current:null},G={transition:null},$={ReactCurrentDispatcher:H,ReactCurrentBatchConfig:G,ReactCurrentOwner:l};function V(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:U,forEach:function(k,Y,ie){U(k,function(){Y.apply(this,arguments)},ie)},count:function(k){var Y=0;return U(k,function(){Y++}),Y},toArray:function(k){return U(k,function(Y){return Y})||[]},only:function(k){if(!T(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},react_production_min.Component=i,react_production_min.Fragment=n,react_production_min.Profiler=R,react_production_min.PureComponent=h,react_production_min.StrictMode=d,react_production_min.Suspense=v,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,react_production_min.act=V,react_production_min.cloneElement=function(k,Y,ie){if(k==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+k+".");var ne=b({},k.props),he=k.key,le=k.ref,xe=k._owner;if(Y!=null){if(Y.ref!==void 0&&(le=Y.ref,xe=l.current),Y.key!==void 0&&(he=""+Y.key),k.type&&k.type.defaultProps)var fe=k.type.defaultProps;for(pe in Y)E.call(Y,pe)&&!f.hasOwnProperty(pe)&&(ne[pe]=Y[pe]===void 0&&fe!==void 0?fe[pe]:Y[pe])}var pe=arguments.length-2;if(pe===1)ne.children=ie;else if(1<pe){fe=Array(pe);for(var Te=0;Te<pe;Te++)fe[Te]=arguments[Te+2];ne.children=fe}return{$$typeof:o,type:k.type,key:he,ref:le,props:ne,_owner:xe}},react_production_min.createContext=function(k){return k={$$typeof:j,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},k.Provider={$$typeof:S,_context:k},k.Consumer=k},react_production_min.createElement=m,react_production_min.createFactory=function(k){var Y=m.bind(null,k);return Y.type=k,Y},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(k){return{$$typeof:p,render:k}},react_production_min.isValidElement=T,react_production_min.lazy=function(k){return{$$typeof:x,_payload:{_status:-1,_result:k},_init:K}},react_production_min.memo=function(k,Y){return{$$typeof:D,type:k,compare:Y===void 0?null:Y}},react_production_min.startTransition=function(k){var Y=G.transition;G.transition={};try{k()}finally{G.transition=Y}},react_production_min.unstable_act=V,react_production_min.useCallback=function(k,Y){return H.current.useCallback(k,Y)},react_production_min.useContext=function(k){return H.current.useContext(k)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(k){return H.current.useDeferredValue(k)},react_production_min.useEffect=function(k,Y){return H.current.useEffect(k,Y)},react_production_min.useId=function(){return H.current.useId()},react_production_min.useImperativeHandle=function(k,Y,ie){return H.current.useImperativeHandle(k,Y,ie)},react_production_min.useInsertionEffect=function(k,Y){return H.current.useInsertionEffect(k,Y)},react_production_min.useLayoutEffect=function(k,Y){return H.current.useLayoutEffect(k,Y)},react_production_min.useMemo=function(k,Y){return H.current.useMemo(k,Y)},react_production_min.useReducer=function(k,Y,ie){return H.current.useReducer(k,Y,ie)},react_production_min.useRef=function(k){return H.current.useRef(k)},react_production_min.useState=function(k){return H.current.useState(k)},react_production_min.useSyncExternalStore=function(k,Y,ie){return H.current.useSyncExternalStore(k,Y,ie)},react_production_min.useTransition=function(){return H.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var o=requireReact(),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,R=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S={key:!0,ref:!0,__self:!0,__source:!0};function j(p,v,D){var x,A={},L=null,w=null;D!==void 0&&(L=""+D),v.key!==void 0&&(L=""+v.key),v.ref!==void 0&&(w=v.ref);for(x in v)d.call(v,x)&&!S.hasOwnProperty(x)&&(A[x]=v[x]);if(p&&p.defaultProps)for(x in v=p.defaultProps,v)A[x]===void 0&&(A[x]=v[x]);return{$$typeof:a,type:p,key:L,ref:w,props:A,_owner:R.current}}return reactJsxRuntime_production_min.Fragment=n,reactJsxRuntime_production_min.jsx=j,reactJsxRuntime_production_min.jsxs=j,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(o){function a(G,$){var V=G.length;G.push($);e:for(;0<V;){var k=V-1>>>1,Y=G[k];if(0<R(Y,$))G[k]=$,G[V]=Y,V=k;else break e}}function n(G){return G.length===0?null:G[0]}function d(G){if(G.length===0)return null;var $=G[0],V=G.pop();if(V!==$){G[0]=V;e:for(var k=0,Y=G.length,ie=Y>>>1;k<ie;){var ne=2*(k+1)-1,he=G[ne],le=ne+1,xe=G[le];if(0>R(he,V))le<Y&&0>R(xe,he)?(G[k]=xe,G[le]=V,k=le):(G[k]=he,G[ne]=V,k=ne);else if(le<Y&&0>R(xe,V))G[k]=xe,G[le]=V,k=le;else break e}}return $}function R(G,$){var V=G.sortIndex-$.sortIndex;return V!==0?V:G.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var S=performance;o.unstable_now=function(){return S.now()}}else{var j=Date,p=j.now();o.unstable_now=function(){return j.now()-p}}var v=[],D=[],x=1,A=null,L=3,w=!1,b=!1,u=!1,i=typeof setTimeout=="function"?setTimeout:null,s=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(G){for(var $=n(D);$!==null;){if($.callback===null)d(D);else if($.startTime<=G)d(D),$.sortIndex=$.expirationTime,a(v,$);else break;$=n(D)}}function y(G){if(u=!1,g(G),!b)if(n(v)!==null)b=!0,K(E);else{var $=n(D);$!==null&&H(y,$.startTime-G)}}function E(G,$){b=!1,u&&(u=!1,s(m),m=-1),w=!0;var V=L;try{for(g($),A=n(v);A!==null&&(!(A.expirationTime>$)||G&&!P());){var k=A.callback;if(typeof k=="function"){A.callback=null,L=A.priorityLevel;var Y=k(A.expirationTime<=$);$=o.unstable_now(),typeof Y=="function"?A.callback=Y:A===n(v)&&d(v),g($)}else d(v);A=n(v)}if(A!==null)var ie=!0;else{var ne=n(D);ne!==null&&H(y,ne.startTime-$),ie=!1}return ie}finally{A=null,L=V,w=!1}}var l=!1,f=null,m=-1,C=5,T=-1;function P(){return!(o.unstable_now()-T<C)}function F(){if(f!==null){var G=o.unstable_now();T=G;var $=!0;try{$=f(!0,G)}finally{$?N():(l=!1,f=null)}}else l=!1}var N;if(typeof h=="function")N=function(){h(F)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,U=B.port2;B.port1.onmessage=F,N=function(){U.postMessage(null)}}else N=function(){i(F,0)};function K(G){f=G,l||(l=!0,N())}function H(G,$){m=i(function(){G(o.unstable_now())},$)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(G){G.callback=null},o.unstable_continueExecution=function(){b||w||(b=!0,K(E))},o.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<G?Math.floor(1e3/G):5},o.unstable_getCurrentPriorityLevel=function(){return L},o.unstable_getFirstCallbackNode=function(){return n(v)},o.unstable_next=function(G){switch(L){case 1:case 2:case 3:var $=3;break;default:$=L}var V=L;L=$;try{return G()}finally{L=V}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(G,$){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var V=L;L=G;try{return $()}finally{L=V}},o.unstable_scheduleCallback=function(G,$,V){var k=o.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?k+V:k):V=k,G){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=V+Y,G={id:x++,callback:$,priorityLevel:G,startTime:V,expirationTime:Y,sortIndex:-1},V>k?(G.sortIndex=V,a(D,G),n(v)===null&&G===n(D)&&(u?(s(m),m=-1):u=!0,H(y,V-k))):(G.sortIndex=Y,a(v,G),b||w||(b=!0,K(E))),G},o.unstable_shouldYield=P,o.unstable_wrapCallback=function(G){var $=L;return function(){var V=L;L=$;try{return G.apply(this,arguments)}finally{L=V}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var o=requireReact(),a=requireScheduler();function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,c=1;c<arguments.length;c++)t+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=new Set,R={};function S(e,t){j(e,t),j(e+"Capture",t)}function j(e,t){for(R[e]=t,e=0;e<t.length;e++)d.add(t[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v=Object.prototype.hasOwnProperty,D=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},A={};function L(e){return v.call(A,e)?!0:v.call(x,e)?!1:D.test(e)?A[e]=!0:(x[e]=!0,!1)}function w(e,t,c,M){if(c!==null&&c.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return M?!1:c!==null?!c.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b(e,t,c,M){if(t===null||typeof t>"u"||w(e,t,c,M))return!0;if(M)return!1;if(c!==null)switch(c.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function u(e,t,c,M,I,W,J){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=M,this.attributeNamespace=I,this.mustUseProperty=c,this.propertyName=e,this.type=t,this.sanitizeURL=W,this.removeEmptyString=J}var i={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){i[e]=new u(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];i[t]=new u(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){i[e]=new u(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){i[e]=new u(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){i[e]=new u(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){i[e]=new u(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){i[e]=new u(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){i[e]=new u(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){i[e]=new u(e,5,!1,e.toLowerCase(),null,!1,!1)});var s=/[\-:]([a-z])/g;function h(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(s,h);i[t]=new u(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(s,h);i[t]=new u(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(s,h);i[t]=new u(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){i[e]=new u(e,1,!1,e.toLowerCase(),null,!1,!1)}),i.xlinkHref=new u("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){i[e]=new u(e,1,!1,e.toLowerCase(),null,!0,!0)});function g(e,t,c,M){var I=i.hasOwnProperty(t)?i[t]:null;(I!==null?I.type!==0:M||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b(t,c,I,M)&&(c=null),M||I===null?L(t)&&(c===null?e.removeAttribute(t):e.setAttribute(t,""+c)):I.mustUseProperty?e[I.propertyName]=c===null?I.type===3?!1:"":c:(t=I.attributeName,M=I.attributeNamespace,c===null?e.removeAttribute(t):(I=I.type,c=I===3||I===4&&c===!0?"":""+c,M?e.setAttributeNS(M,t,c):e.setAttribute(t,c))))}var y=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),l=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),P=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),G=Symbol.iterator;function $(e){return e===null||typeof e!="object"?null:(e=G&&e[G]||e["@@iterator"],typeof e=="function"?e:null)}var V=Object.assign,k;function Y(e){if(k===void 0)try{throw Error()}catch(c){var t=c.stack.trim().match(/\n( *(at )?)/);k=t&&t[1]||""}return`
`+k+e}var ie=!1;function ne(e,t){if(!e||ie)return"";ie=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(Fe){var M=Fe}Reflect.construct(e,[],t)}else{try{t.call()}catch(Fe){M=Fe}e.call(t.prototype)}else{try{throw Error()}catch(Fe){M=Fe}e()}}catch(Fe){if(Fe&&M&&typeof Fe.stack=="string"){for(var I=Fe.stack.split(`
`),W=M.stack.split(`
`),J=I.length-1,de=W.length-1;1<=J&&0<=de&&I[J]!==W[de];)de--;for(;1<=J&&0<=de;J--,de--)if(I[J]!==W[de]){if(J!==1||de!==1)do if(J--,de--,0>de||I[J]!==W[de]){var ve=`
`+I[J].replace(" at new "," at ");return e.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",e.displayName)),ve}while(1<=J&&0<=de);break}}}finally{ie=!1,Error.prepareStackTrace=c}return(e=e?e.displayName||e.name:"")?Y(e):""}function he(e){switch(e.tag){case 5:return Y(e.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return e=ne(e.type,!1),e;case 11:return e=ne(e.type.render,!1),e;case 1:return e=ne(e.type,!0),e;default:return""}}function le(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case f:return"Fragment";case l:return"Portal";case C:return"Profiler";case m:return"StrictMode";case N:return"Suspense";case B:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case F:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U:return t=e.displayName||null,t!==null?t:le(e.type)||"Memo";case K:t=e._payload,e=e._init;try{return le(e(t))}catch{}}return null}function xe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(t);case 8:return t===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function fe(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pe(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Te(e){var t=pe(e)?"checked":"value",c=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),M=""+e[t];if(!e.hasOwnProperty(t)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var I=c.get,W=c.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return I.call(this)},set:function(J){M=""+J,W.call(this,J)}}),Object.defineProperty(e,t,{enumerable:c.enumerable}),{getValue:function(){return M},setValue:function(J){M=""+J},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ke(e){e._valueTracker||(e._valueTracker=Te(e))}function $e(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var c=t.getValue(),M="";return e&&(M=pe(e)?e.checked?"true":"false":e.value),e=M,e!==c?(t.setValue(e),!0):!1}function Le(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ue(e,t){var c=t.checked;return V({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??e._wrapperState.initialChecked})}function Me(e,t){var c=t.defaultValue==null?"":t.defaultValue,M=t.checked!=null?t.checked:t.defaultChecked;c=fe(t.value!=null?t.value:c),e._wrapperState={initialChecked:M,initialValue:c,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ge(e,t){t=t.checked,t!=null&&g(e,"checked",t,!1)}function Je(e,t){Ge(e,t);var c=fe(t.value),M=t.type;if(c!=null)M==="number"?(c===0&&e.value===""||e.value!=c)&&(e.value=""+c):e.value!==""+c&&(e.value=""+c);else if(M==="submit"||M==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?tt(e,t.type,c):t.hasOwnProperty("defaultValue")&&tt(e,t.type,fe(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qe(e,t,c){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var M=t.type;if(!(M!=="submit"&&M!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,c||t===e.value||(e.value=t),e.defaultValue=t}c=e.name,c!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,c!==""&&(e.name=c)}function tt(e,t,c){(t!=="number"||Le(e.ownerDocument)!==e)&&(c==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+c&&(e.defaultValue=""+c))}var Ze=Array.isArray;function Ve(e,t,c,M){if(e=e.options,t){t={};for(var I=0;I<c.length;I++)t["$"+c[I]]=!0;for(c=0;c<e.length;c++)I=t.hasOwnProperty("$"+e[c].value),e[c].selected!==I&&(e[c].selected=I),I&&M&&(e[c].defaultSelected=!0)}else{for(c=""+fe(c),t=null,I=0;I<e.length;I++){if(e[I].value===c){e[I].selected=!0,M&&(e[I].defaultSelected=!0);return}t!==null||e[I].disabled||(t=e[I])}t!==null&&(t.selected=!0)}}function Ye(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(n(91));return V({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ke(e,t){var c=t.value;if(c==null){if(c=t.children,t=t.defaultValue,c!=null){if(t!=null)throw Error(n(92));if(Ze(c)){if(1<c.length)throw Error(n(93));c=c[0]}t=c}t==null&&(t=""),c=t}e._wrapperState={initialValue:fe(c)}}function We(e,t){var c=fe(t.value),M=fe(t.defaultValue);c!=null&&(c=""+c,c!==e.value&&(e.value=c),t.defaultValue==null&&e.defaultValue!==c&&(e.defaultValue=c)),M!=null&&(e.defaultValue=""+M)}function nt(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function at(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?at(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var re,se=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,c,M,I){MSApp.execUnsafeLocalFunction(function(){return e(t,c,M,I)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(re=re||document.createElement("div"),re.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=re.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Se(e,t){if(t){var c=e.firstChild;if(c&&c===e.lastChild&&c.nodeType===3){c.nodeValue=t;return}}e.textContent=t}var we={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ze=["Webkit","ms","Moz","O"];Object.keys(we).forEach(function(e){ze.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),we[t]=we[e]})});function Be(e,t,c){return t==null||typeof t=="boolean"||t===""?"":c||typeof t!="number"||t===0||we.hasOwnProperty(e)&&we[e]?(""+t).trim():t+"px"}function Z(e,t){e=e.style;for(var c in t)if(t.hasOwnProperty(c)){var M=c.indexOf("--")===0,I=Be(c,t[c],M);c==="float"&&(c="cssFloat"),M?e.setProperty(c,I):e[c]=I}}var ge=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ce(e,t){if(t){if(ge[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(n(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(n(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(t.style!=null&&typeof t.style!="object")throw Error(n(62))}}function Ue(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ce=null;function Pe(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Q=null,Ne=null,He=null;function z(e){if(e=hn(e)){if(typeof Q!="function")throw Error(n(280));var t=e.stateNode;t&&(t=yi(t),Q(e.stateNode,e.type,t))}}function be(e){Ne?He?He.push(e):He=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=He;if(He=Ne=null,z(e),t)for(e=0;e<t.length;e++)z(t[e])}}function ee(e,t){return e(t)}function me(){}var Ae=!1;function ut(e,t,c){if(Ae)return e(t,c);Ae=!0;try{return ee(e,t,c)}finally{Ae=!1,(Ne!==null||He!==null)&&(me(),_e())}}function ot(e,t){var c=e.stateNode;if(c===null)return null;var M=yi(c);if(M===null)return null;c=M[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(M=!M.disabled)||(e=e.type,M=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!M;break e;default:e=!1}if(e)return null;if(c&&typeof c!="function")throw Error(n(231,t,typeof c));return c}var rt=!1;if(p)try{var yt={};Object.defineProperty(yt,"passive",{get:function(){rt=!0}}),window.addEventListener("test",yt,yt),window.removeEventListener("test",yt,yt)}catch{rt=!1}function Xt(e,t,c,M,I,W,J,de,ve){var Fe=Array.prototype.slice.call(arguments,3);try{t.apply(c,Fe)}catch(et){this.onError(et)}}var bt=!1,xt=null,vt=!1,Pt=null,Dt={onError:function(e){bt=!0,xt=e}};function ir(e,t,c,M,I,W,J,de,ve){bt=!1,xt=null,Xt.apply(Dt,arguments)}function Vt(e,t,c,M,I,W,J,de,ve){if(ir.apply(this,arguments),bt){if(bt){var Fe=xt;bt=!1,xt=null}else throw Error(n(198));vt||(vt=!0,Pt=Fe)}}function Rt(e){var t=e,c=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(c=t.return),e=t.return;while(e)}return t.tag===3?c:null}function At(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function St(e){if(Rt(e)!==e)throw Error(n(188))}function Ht(e){var t=e.alternate;if(!t){if(t=Rt(e),t===null)throw Error(n(188));return t!==e?null:e}for(var c=e,M=t;;){var I=c.return;if(I===null)break;var W=I.alternate;if(W===null){if(M=I.return,M!==null){c=M;continue}break}if(I.child===W.child){for(W=I.child;W;){if(W===c)return St(I),e;if(W===M)return St(I),t;W=W.sibling}throw Error(n(188))}if(c.return!==M.return)c=I,M=W;else{for(var J=!1,de=I.child;de;){if(de===c){J=!0,c=I,M=W;break}if(de===M){J=!0,M=I,c=W;break}de=de.sibling}if(!J){for(de=W.child;de;){if(de===c){J=!0,c=W,M=I;break}if(de===M){J=!0,M=W,c=I;break}de=de.sibling}if(!J)throw Error(n(189))}}if(c.alternate!==M)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?e:t}function Yt(e){return e=Ht(e),e!==null?rr(e):null}function rr(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=rr(e);if(t!==null)return t;e=e.sibling}return null}var cr=a.unstable_scheduleCallback,dr=a.unstable_cancelCallback,Hr=a.unstable_shouldYield,Vi=a.unstable_requestPaint,er=a.unstable_now,Xn=a.unstable_getCurrentPriorityLevel,Hi=a.unstable_ImmediatePriority,Zn=a.unstable_UserBlockingPriority,Qn=a.unstable_NormalPriority,Io=a.unstable_LowPriority,Aa=a.unstable_IdlePriority,Jn=null,Lt=null;function fi(e){if(Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(Jn,e,void 0,(e.current.flags&128)===128)}catch{}}var ar=Math.clz32?Math.clz32:ks,No=Math.log,Ki=Math.LN2;function ks(e){return e>>>=0,e===0?32:31-(No(e)/Ki|0)|0}var $i=64,Yi=4194304;function Ri(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xi(e,t){var c=e.pendingLanes;if(c===0)return 0;var M=0,I=e.suspendedLanes,W=e.pingedLanes,J=c&268435455;if(J!==0){var de=J&~I;de!==0?M=Ri(de):(W&=J,W!==0&&(M=Ri(W)))}else J=c&~I,J!==0?M=Ri(J):W!==0&&(M=Ri(W));if(M===0)return 0;if(t!==0&&t!==M&&(t&I)===0&&(I=M&-M,W=t&-t,I>=W||I===16&&(W&4194240)!==0))return t;if((M&4)!==0&&(M|=c&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=M;0<t;)c=31-ar(t),I=1<<c,M|=e[c],t&=~I;return M}function Si(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rn(e,t){for(var c=e.suspendedLanes,M=e.pingedLanes,I=e.expirationTimes,W=e.pendingLanes;0<W;){var J=31-ar(W),de=1<<J,ve=I[J];ve===-1?((de&c)===0||(de&M)!==0)&&(I[J]=Si(de,t)):ve<=t&&(e.expiredLanes|=de),W&=~de}}function fr(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ai(){var e=$i;return $i<<=1,($i&4194240)===0&&($i=64),e}function ei(e){for(var t=[],c=0;31>c;c++)t.push(e);return t}function Kr(e,t,c){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ar(t),e[t]=c}function zo(e,t){var c=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var M=e.eventTimes;for(e=e.expirationTimes;0<c;){var I=31-ar(c),W=1<<I;t[I]=0,M[I]=-1,e[I]=-1,c&=~W}}function ti(e,t){var c=e.entangledLanes|=t;for(e=e.entanglements;c;){var M=31-ar(c),I=1<<M;I&t|e[M]&t&&(e[M]|=t),c&=~I}}var Kt=0;function ri(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Ma,La,ii,wr,Cr,Bt=!1,mi=[],$r=null,ni=null,Dr=null,Zi=new Map,Mi=new Map,Or=[],Fo="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ta(e,t){switch(e){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":Dr=null;break;case"pointerover":case"pointerout":Zi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mi.delete(t.pointerId)}}function Rr(e,t,c,M,I,W){return e===null||e.nativeEvent!==W?(e={blockedOn:t,domEventName:c,eventSystemFlags:M,nativeEvent:W,targetContainers:[I]},t!==null&&(t=hn(t),t!==null&&La(t)),e):(e.eventSystemFlags|=M,t=e.targetContainers,I!==null&&t.indexOf(I)===-1&&t.push(I),e)}function Sn(e,t,c,M,I){switch(t){case"focusin":return $r=Rr($r,e,t,c,M,I),!0;case"dragenter":return ni=Rr(ni,e,t,c,M,I),!0;case"mouseover":return Dr=Rr(Dr,e,t,c,M,I),!0;case"pointerover":var W=I.pointerId;return Zi.set(W,Rr(Zi.get(W)||null,e,t,c,M,I)),!0;case"gotpointercapture":return W=I.pointerId,Mi.set(W,Rr(Mi.get(W)||null,e,t,c,M,I)),!0}return!1}function ja(e){var t=Pi(e.target);if(t!==null){var c=Rt(t);if(c!==null){if(t=c.tag,t===13){if(t=At(c),t!==null){e.blockedOn=t,Cr(e.priority,function(){ii(c)});return}}else if(t===3&&c.stateNode.current.memoizedState.isDehydrated){e.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}e.blockedOn=null}function qn(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var c=Ns(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(c===null){c=e.nativeEvent;var M=new c.constructor(c.type,c);ce=M,c.target.dispatchEvent(M),ce=null}else return t=hn(c),t!==null&&La(t),e.blockedOn=c,!1;t.shift()}return!0}function Qi(e,t,c){qn(e)&&c.delete(t)}function Da(){Bt=!1,$r!==null&&qn($r)&&($r=null),ni!==null&&qn(ni)&&(ni=null),Dr!==null&&qn(Dr)&&(Dr=null),Zi.forEach(Qi),Mi.forEach(Qi)}function Ji(e,t){e.blockedOn===t&&(e.blockedOn=null,Bt||(Bt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Da)))}function An(e){function t(I){return Ji(I,e)}if(0<mi.length){Ji(mi[0],e);for(var c=1;c<mi.length;c++){var M=mi[c];M.blockedOn===e&&(M.blockedOn=null)}}for($r!==null&&Ji($r,e),ni!==null&&Ji(ni,e),Dr!==null&&Ji(Dr,e),Zi.forEach(t),Mi.forEach(t),c=0;c<Or.length;c++)M=Or[c],M.blockedOn===e&&(M.blockedOn=null);for(;0<Or.length&&(c=Or[0],c.blockedOn===null);)ja(c),c.blockedOn===null&&Or.shift()}var Li=y.ReactCurrentBatchConfig,es=!0;function Bo(e,t,c,M){var I=Kt,W=Li.transition;Li.transition=null;try{Kt=1,Is(e,t,c,M)}finally{Kt=I,Li.transition=W}}function Uo(e,t,c,M){var I=Kt,W=Li.transition;Li.transition=null;try{Kt=4,Is(e,t,c,M)}finally{Kt=I,Li.transition=W}}function Is(e,t,c,M){if(es){var I=Ns(e,t,c,M);if(I===null)_s(e,t,M,ts,c),Ta(e,M);else if(Sn(I,e,t,c,M))M.stopPropagation();else if(Ta(e,M),t&4&&-1<Fo.indexOf(e)){for(;I!==null;){var W=hn(I);if(W!==null&&Ma(W),W=Ns(e,t,c,M),W===null&&_s(e,t,M,ts,c),W===I)break;I=W}I!==null&&M.stopPropagation()}else _s(e,t,M,null,c)}}var ts=null;function Ns(e,t,c,M){if(ts=null,e=Pe(M),e=Pi(e),e!==null)if(t=Rt(e),t===null)e=null;else if(c=t.tag,c===13){if(e=At(t),e!==null)return e;e=null}else if(c===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ts=e,null}function Oa(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xn()){case Hi:return 1;case Zn:return 4;case Qn:case Io:return 16;case Aa:return 536870912;default:return 16}default:return 16}}var pi=null,zs=null,rs=null;function Pa(){if(rs)return rs;var e,t=zs,c=t.length,M,I="value"in pi?pi.value:pi.textContent,W=I.length;for(e=0;e<c&&t[e]===I[e];e++);var J=c-e;for(M=1;M<=J&&t[c-M]===I[W-M];M++);return rs=I.slice(e,1<M?1-M:void 0)}function is(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ns(){return!0}function qi(){return!1}function Pr(e){function t(c,M,I,W,J){this._reactName=c,this._targetInst=I,this.type=M,this.nativeEvent=W,this.target=J,this.currentTarget=null;for(var de in e)e.hasOwnProperty(de)&&(c=e[de],this[de]=c?c(W):W[de]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?ns:qi,this.isPropagationStopped=qi,this}return V(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ns)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ns)},persist:function(){},isPersistent:ns}),t}var en={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fs=Pr(en),gi=V({},en,{view:0,detail:0}),ka=Pr(gi),Ti,Bs,Mn,ss=V({},gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mn&&(Mn&&e.type==="mousemove"?(Ti=e.screenX-Mn.screenX,Bs=e.screenY-Mn.screenY):Bs=Ti=0,Mn=e),Ti)},movementY:function(e){return"movementY"in e?e.movementY:Bs}}),Ia=Pr(ss),Ln=V({},ss,{dataTransfer:0}),Wo=Pr(Ln),Na=V({},gi,{relatedTarget:0}),as=Pr(Na),Go=V({},en,{animationName:0,elapsedTime:0,pseudoElement:0}),Vo=Pr(Go),Ho=V({},en,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ko=Pr(Ho),os=V({},en,{data:0}),za=Pr(os),$o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xo[e])?!!t[e]:!1}function jn(){return Tn}var Zo=V({},gi,{key:function(e){if(e.key){var t=$o[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=is(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Yo[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return e.type==="keypress"?is(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?is(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Qo=Pr(Zo),Jo=V({},ss,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fa=Pr(Jo),qo=V({},gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn}),el=Pr(qo),tl=V({},en,{propertyName:0,elapsedTime:0,pseudoElement:0}),ls=Pr(tl),rl=V({},ss,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),il=Pr(rl),tn=[9,13,27,32],us=p&&"CompositionEvent"in window,rn=null;p&&"documentMode"in document&&(rn=document.documentMode);var Ba=p&&"TextEvent"in window&&!rn,cs=p&&(!us||rn&&8<rn&&11>=rn),Us=" ",Ua=!1;function Wa(e,t){switch(e){case"keyup":return tn.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ga(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var nn=!1;function lu(e,t){switch(e){case"compositionend":return Ga(t);case"keypress":return t.which!==32?null:(Ua=!0,Us);case"textInput":return e=t.data,e===Us&&Ua?null:e;default:return null}}function Dn(e,t){if(nn)return e==="compositionend"||!us&&Wa(e,t)?(e=Pa(),rs=zs=pi=null,nn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return cs&&t.locale!=="ko"?null:t.data;default:return null}}var nl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ws(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nl[e.type]:t==="textarea"}function Gs(e,t,c,M){be(M),t=un(t,"onChange"),0<t.length&&(c=new Fs("onChange","change",null,c,M),e.push({event:c,listeners:t}))}var sn=null,On=null;function ds(e){vi(e,0)}function Yr(e){var t=fn(e);if($e(t))return e}function sl(e,t){if(e==="change")return t}var Va=!1;if(p){var Sr;if(p){var hs="oninput"in document;if(!hs){var Vs=document.createElement("div");Vs.setAttribute("oninput","return;"),hs=typeof Vs.oninput=="function"}Sr=hs}else Sr=!1;Va=Sr&&(!document.documentMode||9<document.documentMode)}function Ha(){sn&&(sn.detachEvent("onpropertychange",Hs),On=sn=null)}function Hs(e){if(e.propertyName==="value"&&Yr(On)){var t=[];Gs(t,On,e,Pe(e)),ut(ds,t)}}function fs(e,t,c){e==="focusin"?(Ha(),sn=t,On=c,sn.attachEvent("onpropertychange",Hs)):e==="focusout"&&Ha()}function Ka(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Yr(On)}function $a(e,t){if(e==="click")return Yr(t)}function Ya(e,t){if(e==="input"||e==="change")return Yr(t)}function Xa(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nr=typeof Object.is=="function"?Object.is:Xa;function an(e,t){if(Nr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var c=Object.keys(e),M=Object.keys(t);if(c.length!==M.length)return!1;for(M=0;M<c.length;M++){var I=c[M];if(!v.call(t,I)||!Nr(e[I],t[I]))return!1}return!0}function Ks(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $s(e,t){var c=Ks(e);e=0;for(var M;c;){if(c.nodeType===3){if(M=e+c.textContent.length,e<=t&&M>=t)return{node:c,offset:t-e};e=M}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Ks(c)}}function Ys(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ys(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Pn(){for(var e=window,t=Le();t instanceof e.HTMLIFrameElement;){try{var c=typeof t.contentWindow.location.href=="string"}catch{c=!1}if(c)e=t.contentWindow;else break;t=Le(e.document)}return t}function Wr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Xs(e){var t=Pn(),c=e.focusedElem,M=e.selectionRange;if(t!==c&&c&&c.ownerDocument&&Ys(c.ownerDocument.documentElement,c)){if(M!==null&&Wr(c)){if(t=M.start,e=M.end,e===void 0&&(e=t),"selectionStart"in c)c.selectionStart=t,c.selectionEnd=Math.min(e,c.value.length);else if(e=(t=c.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var I=c.textContent.length,W=Math.min(M.start,I);M=M.end===void 0?W:Math.min(M.end,I),!e.extend&&W>M&&(I=M,M=W,W=I),I=$s(c,W);var J=$s(c,M);I&&J&&(e.rangeCount!==1||e.anchorNode!==I.node||e.anchorOffset!==I.offset||e.focusNode!==J.node||e.focusOffset!==J.offset)&&(t=t.createRange(),t.setStart(I.node,I.offset),e.removeAllRanges(),W>M?(e.addRange(t),e.extend(J.node,J.offset)):(t.setEnd(J.node,J.offset),e.addRange(t)))}}for(t=[],e=c;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<t.length;c++)e=t[c],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Za=p&&"documentMode"in document&&11>=document.documentMode,xi=null,ms=null,on=null,ps=!1;function Zs(e,t,c){var M=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ps||xi==null||xi!==Le(M)||(M=xi,"selectionStart"in M&&Wr(M)?M={start:M.selectionStart,end:M.selectionEnd}:(M=(M.ownerDocument&&M.ownerDocument.defaultView||window).getSelection(),M={anchorNode:M.anchorNode,anchorOffset:M.anchorOffset,focusNode:M.focusNode,focusOffset:M.focusOffset}),on&&an(on,M)||(on=M,M=un(ms,"onSelect"),0<M.length&&(t=new Fs("onSelect","select",null,t,c),e.push({event:t,listeners:M}),t.target=xi)))}function ji(e,t){var c={};return c[e.toLowerCase()]=t.toLowerCase(),c["Webkit"+e]="webkit"+t,c["Moz"+e]="moz"+t,c}var si={animationend:ji("Animation","AnimationEnd"),animationiteration:ji("Animation","AnimationIteration"),animationstart:ji("Animation","AnimationStart"),transitionend:ji("Transition","TransitionEnd")},gs={},Qs={};p&&(Qs=document.createElement("div").style,"AnimationEvent"in window||(delete si.animationend.animation,delete si.animationiteration.animation,delete si.animationstart.animation),"TransitionEvent"in window||delete si.transitionend.transition);function kn(e){if(gs[e])return gs[e];if(!si[e])return e;var t=si[e],c;for(c in t)if(t.hasOwnProperty(c)&&c in Qs)return gs[e]=t[c];return e}var Js=kn("animationend"),qs=kn("animationiteration"),xs=kn("animationstart"),ea=kn("transitionend"),ta=new Map,Jt="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ai(e,t){ta.set(e,t),S(t,[e])}for(var vs=0;vs<Jt.length;vs++){var ra=Jt[vs],al=ra.toLowerCase(),uu=ra[0].toUpperCase()+ra.slice(1);ai(al,"on"+uu)}ai(Js,"onAnimationEnd"),ai(qs,"onAnimationIteration"),ai(xs,"onAnimationStart"),ai("dblclick","onDoubleClick"),ai("focusin","onFocus"),ai("focusout","onBlur"),ai(ea,"onTransitionEnd"),j("onMouseEnter",["mouseout","mouseover"]),j("onMouseLeave",["mouseout","mouseover"]),j("onPointerEnter",["pointerout","pointerover"]),j("onPointerLeave",["pointerout","pointerover"]),S("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),S("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),S("onBeforeInput",["compositionend","keypress","textInput","paste"]),S("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),S("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),S("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var In="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qa=new Set("cancel close invalid load scroll toggle".split(" ").concat(In));function Ja(e,t,c){var M=e.type||"unknown-event";e.currentTarget=c,Vt(M,t,void 0,e),e.currentTarget=null}function vi(e,t){t=(t&4)!==0;for(var c=0;c<e.length;c++){var M=e[c],I=M.event;M=M.listeners;e:{var W=void 0;if(t)for(var J=M.length-1;0<=J;J--){var de=M[J],ve=de.instance,Fe=de.currentTarget;if(de=de.listener,ve!==W&&I.isPropagationStopped())break e;Ja(I,de,Fe),W=ve}else for(J=0;J<M.length;J++){if(de=M[J],ve=de.instance,Fe=de.currentTarget,de=de.listener,ve!==W&&I.isPropagationStopped())break e;Ja(I,de,Fe),W=ve}}}if(vt)throw e=Pt,vt=!1,Pt=null,e}function Zt(e,t){var c=t[Oi];c===void 0&&(c=t[Oi]=new Set);var M=e+"__bubble";c.has(M)||(qa(t,e,2,!1),c.add(M))}function ys(e,t,c){var M=0;t&&(M|=4),qa(c,e,M,t)}var Nn="_reactListening"+Math.random().toString(36).slice(2);function ln(e){if(!e[Nn]){e[Nn]=!0,d.forEach(function(c){c!=="selectionchange"&&(Qa.has(c)||ys(c,!1,e),ys(c,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nn]||(t[Nn]=!0,ys("selectionchange",!1,t))}}function qa(e,t,c,M){switch(Oa(t)){case 1:var I=Bo;break;case 4:I=Uo;break;default:I=Is}c=I.bind(null,t,c,e),I=void 0,!rt||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(I=!0),M?I!==void 0?e.addEventListener(t,c,{capture:!0,passive:I}):e.addEventListener(t,c,!0):I!==void 0?e.addEventListener(t,c,{passive:I}):e.addEventListener(t,c,!1)}function _s(e,t,c,M,I){var W=M;if((t&1)===0&&(t&2)===0&&M!==null)e:for(;;){if(M===null)return;var J=M.tag;if(J===3||J===4){var de=M.stateNode.containerInfo;if(de===I||de.nodeType===8&&de.parentNode===I)break;if(J===4)for(J=M.return;J!==null;){var ve=J.tag;if((ve===3||ve===4)&&(ve=J.stateNode.containerInfo,ve===I||ve.nodeType===8&&ve.parentNode===I))return;J=J.return}for(;de!==null;){if(J=Pi(de),J===null)return;if(ve=J.tag,ve===5||ve===6){M=W=J;continue e}de=de.parentNode}}M=M.return}ut(function(){var Fe=W,et=Pe(c),it=[];e:{var Qe=ta.get(e);if(Qe!==void 0){var dt=Fs,mt=e;switch(e){case"keypress":if(is(c)===0)break e;case"keydown":case"keyup":dt=Qo;break;case"focusin":mt="focus",dt=as;break;case"focusout":mt="blur",dt=as;break;case"beforeblur":case"afterblur":dt=as;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=Ia;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=Wo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=el;break;case Js:case qs:case xs:dt=Vo;break;case ea:dt=ls;break;case"scroll":dt=ka;break;case"wheel":dt=il;break;case"copy":case"cut":case"paste":dt=Ko;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=Fa}var pt=(t&4)!==0,ur=!pt&&e==="scroll",De=pt?Qe!==null?Qe+"Capture":null:Qe;pt=[];for(var Ee=Fe,Ie;Ee!==null;){Ie=Ee;var lt=Ie.stateNode;if(Ie.tag===5&&lt!==null&&(Ie=lt,De!==null&&(lt=ot(Ee,De),lt!=null&&pt.push(Di(Ee,lt,Ie)))),ur)break;Ee=Ee.return}0<pt.length&&(Qe=new dt(Qe,mt,null,c,et),it.push({event:Qe,listeners:pt}))}}if((t&7)===0){e:{if(Qe=e==="mouseover"||e==="pointerover",dt=e==="mouseout"||e==="pointerout",Qe&&c!==ce&&(mt=c.relatedTarget||c.fromElement)&&(Pi(mt)||mt[oi]))break e;if((dt||Qe)&&(Qe=et.window===et?et:(Qe=et.ownerDocument)?Qe.defaultView||Qe.parentWindow:window,dt?(mt=c.relatedTarget||c.toElement,dt=Fe,mt=mt?Pi(mt):null,mt!==null&&(ur=Rt(mt),mt!==ur||mt.tag!==5&&mt.tag!==6)&&(mt=null)):(dt=null,mt=Fe),dt!==mt)){if(pt=Ia,lt="onMouseLeave",De="onMouseEnter",Ee="mouse",(e==="pointerout"||e==="pointerover")&&(pt=Fa,lt="onPointerLeave",De="onPointerEnter",Ee="pointer"),ur=dt==null?Qe:fn(dt),Ie=mt==null?Qe:fn(mt),Qe=new pt(lt,Ee+"leave",dt,c,et),Qe.target=ur,Qe.relatedTarget=Ie,lt=null,Pi(et)===Fe&&(pt=new pt(De,Ee+"enter",mt,c,et),pt.target=Ie,pt.relatedTarget=ur,lt=pt),ur=lt,dt&&mt)t:{for(pt=dt,De=mt,Ee=0,Ie=pt;Ie;Ie=cn(Ie))Ee++;for(Ie=0,lt=De;lt;lt=cn(lt))Ie++;for(;0<Ee-Ie;)pt=cn(pt),Ee--;for(;0<Ie-Ee;)De=cn(De),Ie--;for(;Ee--;){if(pt===De||De!==null&&pt===De.alternate)break t;pt=cn(pt),De=cn(De)}pt=null}else pt=null;dt!==null&&ia(it,Qe,dt,pt,!1),mt!==null&&ur!==null&&ia(it,ur,mt,pt,!0)}}e:{if(Qe=Fe?fn(Fe):window,dt=Qe.nodeName&&Qe.nodeName.toLowerCase(),dt==="select"||dt==="input"&&Qe.type==="file")var gt=sl;else if(Ws(Qe))if(Va)gt=Ya;else{gt=Ka;var wt=fs}else(dt=Qe.nodeName)&&dt.toLowerCase()==="input"&&(Qe.type==="checkbox"||Qe.type==="radio")&&(gt=$a);if(gt&&(gt=gt(e,Fe))){Gs(it,gt,c,et);break e}wt&&wt(e,Qe,Fe),e==="focusout"&&(wt=Qe._wrapperState)&&wt.controlled&&Qe.type==="number"&&tt(Qe,"number",Qe.value)}switch(wt=Fe?fn(Fe):window,e){case"focusin":(Ws(wt)||wt.contentEditable==="true")&&(xi=wt,ms=Fe,on=null);break;case"focusout":on=ms=xi=null;break;case"mousedown":ps=!0;break;case"contextmenu":case"mouseup":case"dragend":ps=!1,Zs(it,c,et);break;case"selectionchange":if(Za)break;case"keydown":case"keyup":Zs(it,c,et)}var Ct;if(us)e:{switch(e){case"compositionstart":var Mt="onCompositionStart";break e;case"compositionend":Mt="onCompositionEnd";break e;case"compositionupdate":Mt="onCompositionUpdate";break e}Mt=void 0}else nn?Wa(e,c)&&(Mt="onCompositionEnd"):e==="keydown"&&c.keyCode===229&&(Mt="onCompositionStart");Mt&&(cs&&c.locale!=="ko"&&(nn||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&nn&&(Ct=Pa()):(pi=et,zs="value"in pi?pi.value:pi.textContent,nn=!0)),wt=un(Fe,Mt),0<wt.length&&(Mt=new za(Mt,e,null,c,et),it.push({event:Mt,listeners:wt}),Ct?Mt.data=Ct:(Ct=Ga(c),Ct!==null&&(Mt.data=Ct)))),(Ct=Ba?lu(e,c):Dn(e,c))&&(Fe=un(Fe,"onBeforeInput"),0<Fe.length&&(et=new za("onBeforeInput","beforeinput",null,c,et),it.push({event:et,listeners:Fe}),et.data=Ct))}vi(it,t)})}function Di(e,t,c){return{instance:e,listener:t,currentTarget:c}}function un(e,t){for(var c=t+"Capture",M=[];e!==null;){var I=e,W=I.stateNode;I.tag===5&&W!==null&&(I=W,W=ot(e,c),W!=null&&M.unshift(Di(e,W,I)),W=ot(e,t),W!=null&&M.push(Di(e,W,I))),e=e.return}return M}function cn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ia(e,t,c,M,I){for(var W=t._reactName,J=[];c!==null&&c!==M;){var de=c,ve=de.alternate,Fe=de.stateNode;if(ve!==null&&ve===M)break;de.tag===5&&Fe!==null&&(de=Fe,I?(ve=ot(c,W),ve!=null&&J.unshift(Di(c,ve,de))):I||(ve=ot(c,W),ve!=null&&J.push(Di(c,ve,de)))),c=c.return}J.length!==0&&e.push({event:t,listeners:J})}var ol=/\r\n?/g,ll=/\u0000|\uFFFD/g;function eo(e){return(typeof e=="string"?e:""+e).replace(ol,`
`).replace(ll,"")}function bs(e,t,c){if(t=eo(t),eo(e)!==t&&c)throw Error(n(425))}function Es(){}var na=null,sa=null;function aa(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var oa=typeof setTimeout=="function"?setTimeout:void 0,ul=typeof clearTimeout=="function"?clearTimeout:void 0,to=typeof Promise=="function"?Promise:void 0,cl=typeof queueMicrotask=="function"?queueMicrotask:typeof to<"u"?function(e){return to.resolve(null).then(e).catch(dl)}:oa;function dl(e){setTimeout(function(){throw e})}function la(e,t){var c=t,M=0;do{var I=c.nextSibling;if(e.removeChild(c),I&&I.nodeType===8)if(c=I.data,c==="/$"){if(M===0){e.removeChild(I),An(t);return}M--}else c!=="$"&&c!=="$?"&&c!=="$!"||M++;c=I}while(c);An(t)}function gr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ro(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var c=e.data;if(c==="$"||c==="$!"||c==="$?"){if(t===0)return e;t--}else c==="/$"&&t++}e=e.previousSibling}return null}var dn=Math.random().toString(36).slice(2),Gr="__reactFiber$"+dn,zn="__reactProps$"+dn,oi="__reactContainer$"+dn,Oi="__reactEvents$"+dn,ua="__reactListeners$"+dn,ca="__reactHandles$"+dn;function Pi(e){var t=e[Gr];if(t)return t;for(var c=e.parentNode;c;){if(t=c[oi]||c[Gr]){if(c=t.alternate,t.child!==null||c!==null&&c.child!==null)for(e=ro(e);e!==null;){if(c=e[Gr])return c;e=ro(e)}return t}e=c,c=e.parentNode}return null}function hn(e){return e=e[Gr]||e[oi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function fn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(n(33))}function yi(e){return e[zn]||null}var Fn=[],mn=-1;function _i(e){return{current:e}}function qt(e){0>mn||(e.current=Fn[mn],Fn[mn]=null,mn--)}function Qt(e,t){mn++,Fn[mn]=e.current,e.current=t}var bi={},xr=_i(bi),Ar=_i(!1),ki=bi;function pn(e,t){var c=e.type.contextTypes;if(!c)return bi;var M=e.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===t)return M.__reactInternalMemoizedMaskedChildContext;var I={},W;for(W in c)I[W]=t[W];return M&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=I),I}function Mr(e){return e=e.childContextTypes,e!=null}function ws(){qt(Ar),qt(xr)}function io(e,t,c){if(xr.current!==bi)throw Error(n(168));Qt(xr,t),Qt(Ar,c)}function no(e,t,c){var M=e.stateNode;if(t=t.childContextTypes,typeof M.getChildContext!="function")return c;M=M.getChildContext();for(var I in M)if(!(I in t))throw Error(n(108,xe(e)||"Unknown",I));return V({},c,M)}function Cs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bi,ki=xr.current,Qt(xr,e),Qt(Ar,Ar.current),!0}function da(e,t,c){var M=e.stateNode;if(!M)throw Error(n(169));c?(e=no(e,t,ki),M.__reactInternalMemoizedMergedChildContext=e,qt(Ar),qt(xr),Qt(xr,e)):qt(Ar),Qt(Ar,c)}var Xr=null,Bn=!1,Rs=!1;function ha(e){Xr===null?Xr=[e]:Xr.push(e)}function so(e){Bn=!0,ha(e)}function li(){if(!Rs&&Xr!==null){Rs=!0;var e=0,t=Kt;try{var c=Xr;for(Kt=1;e<c.length;e++){var M=c[e];do M=M(!0);while(M!==null)}Xr=null,Bn=!1}catch(I){throw Xr!==null&&(Xr=Xr.slice(e+1)),cr(Hi,li),I}finally{Kt=t,Rs=!1}}return null}var Ii=[],Ni=0,Ss=null,_=0,X=[],O=0,te=null,oe=1,ae="";function Oe(e,t){Ii[Ni++]=_,Ii[Ni++]=Ss,Ss=e,_=t}function Re(e,t,c){X[O++]=oe,X[O++]=ae,X[O++]=te,te=e;var M=oe;e=ae;var I=32-ar(M)-1;M&=~(1<<I),c+=1;var W=32-ar(t)+I;if(30<W){var J=I-I%5;W=(M&(1<<J)-1).toString(32),M>>=J,I-=J,oe=1<<32-ar(t)+I|c<<I|M,ae=W+e}else oe=1<<W|c<<I|M,ae=e}function ht(e){e.return!==null&&(Oe(e,1),Re(e,1,0))}function ye(e){for(;e===Ss;)Ss=Ii[--Ni],Ii[Ni]=null,_=Ii[--Ni],Ii[Ni]=null;for(;e===te;)te=X[--O],X[O]=null,ae=X[--O],X[O]=null,oe=X[--O],X[O]=null}var je=null,Tt=null,st=!1,Xe=null;function _t(e,t){var c=qr(5,null,null,0);c.elementType="DELETED",c.stateNode=t,c.return=e,t=e.deletions,t===null?(e.deletions=[c],e.flags|=16):t.push(c)}function tr(e,t){switch(e.tag){case 5:var c=e.type;return t=t.nodeType!==1||c.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,je=e,Tt=gr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,je=e,Tt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(c=te!==null?{id:oe,overflow:ae}:null,e.memoizedState={dehydrated:t,treeContext:c,retryLane:1073741824},c=qr(18,null,null,0),c.stateNode=t,c.return=e,e.child=c,je=e,Tt=null,!0):!1;default:return!1}}function Nt(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ot(e){if(st){var t=Tt;if(t){var c=t;if(!tr(e,t)){if(Nt(e))throw Error(n(418));t=gr(c.nextSibling);var M=je;t&&tr(e,t)?_t(M,c):(e.flags=e.flags&-4097|2,st=!1,je=e)}}else{if(Nt(e))throw Error(n(418));e.flags=e.flags&-4097|2,st=!1,je=e}}}function Ut(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;je=e}function kt(e){if(e!==je)return!1;if(!st)return Ut(e),st=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!aa(e.type,e.memoizedProps)),t&&(t=Tt)){if(Nt(e))throw ct(),Error(n(418));for(;t;)_t(e,t),t=gr(t.nextSibling)}if(Ut(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var c=e.data;if(c==="/$"){if(t===0){Tt=gr(e.nextSibling);break e}t--}else c!=="$"&&c!=="$!"&&c!=="$?"||t++}e=e.nextSibling}Tt=null}}else Tt=je?gr(e.stateNode.nextSibling):null;return!0}function ct(){for(var e=Tt;e;)e=gr(e.nextSibling)}function zt(){Tt=je=null,st=!1}function or(e){Xe===null?Xe=[e]:Xe.push(e)}var Et=y.ReactCurrentBatchConfig;function Wt(e,t,c){if(e=c.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(n(309));var M=c.stateNode}if(!M)throw Error(n(147,e));var I=M,W=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===W?t.ref:(t=function(J){var de=I.refs;J===null?delete de[W]:de[W]=J},t._stringRef=W,t)}if(typeof e!="string")throw Error(n(284));if(!c._owner)throw Error(n(290,e))}return e}function It(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jt(e){var t=e._init;return t(e._payload)}function Ft(e){function t(De,Ee){if(e){var Ie=De.deletions;Ie===null?(De.deletions=[Ee],De.flags|=16):Ie.push(Ee)}}function c(De,Ee){if(!e)return null;for(;Ee!==null;)t(De,Ee),Ee=Ee.sibling;return null}function M(De,Ee){for(De=new Map;Ee!==null;)Ee.key!==null?De.set(Ee.key,Ee):De.set(Ee.index,Ee),Ee=Ee.sibling;return De}function I(De,Ee){return De=wn(De,Ee),De.index=0,De.sibling=null,De}function W(De,Ee,Ie){return De.index=Ie,e?(Ie=De.alternate,Ie!==null?(Ie=Ie.index,Ie<Ee?(De.flags|=2,Ee):Ie):(De.flags|=2,Ee)):(De.flags|=1048576,Ee)}function J(De){return e&&De.alternate===null&&(De.flags|=2),De}function de(De,Ee,Ie,lt){return Ee===null||Ee.tag!==6?(Ee=ru(Ie,De.mode,lt),Ee.return=De,Ee):(Ee=I(Ee,Ie),Ee.return=De,Ee)}function ve(De,Ee,Ie,lt){var gt=Ie.type;return gt===f?et(De,Ee,Ie.props.children,lt,Ie.key):Ee!==null&&(Ee.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===K&&jt(gt)===Ee.type)?(lt=I(Ee,Ie.props),lt.ref=Wt(De,Ee,Ie),lt.return=De,lt):(lt=Mo(Ie.type,Ie.key,Ie.props,null,De.mode,lt),lt.ref=Wt(De,Ee,Ie),lt.return=De,lt)}function Fe(De,Ee,Ie,lt){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==Ie.containerInfo||Ee.stateNode.implementation!==Ie.implementation?(Ee=iu(Ie,De.mode,lt),Ee.return=De,Ee):(Ee=I(Ee,Ie.children||[]),Ee.return=De,Ee)}function et(De,Ee,Ie,lt,gt){return Ee===null||Ee.tag!==7?(Ee=Yn(Ie,De.mode,lt,gt),Ee.return=De,Ee):(Ee=I(Ee,Ie),Ee.return=De,Ee)}function it(De,Ee,Ie){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Ee=ru(""+Ee,De.mode,Ie),Ee.return=De,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case E:return Ie=Mo(Ee.type,Ee.key,Ee.props,null,De.mode,Ie),Ie.ref=Wt(De,null,Ee),Ie.return=De,Ie;case l:return Ee=iu(Ee,De.mode,Ie),Ee.return=De,Ee;case K:var lt=Ee._init;return it(De,lt(Ee._payload),Ie)}if(Ze(Ee)||$(Ee))return Ee=Yn(Ee,De.mode,Ie,null),Ee.return=De,Ee;It(De,Ee)}return null}function Qe(De,Ee,Ie,lt){var gt=Ee!==null?Ee.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number")return gt!==null?null:de(De,Ee,""+Ie,lt);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case E:return Ie.key===gt?ve(De,Ee,Ie,lt):null;case l:return Ie.key===gt?Fe(De,Ee,Ie,lt):null;case K:return gt=Ie._init,Qe(De,Ee,gt(Ie._payload),lt)}if(Ze(Ie)||$(Ie))return gt!==null?null:et(De,Ee,Ie,lt,null);It(De,Ie)}return null}function dt(De,Ee,Ie,lt,gt){if(typeof lt=="string"&&lt!==""||typeof lt=="number")return De=De.get(Ie)||null,de(Ee,De,""+lt,gt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case E:return De=De.get(lt.key===null?Ie:lt.key)||null,ve(Ee,De,lt,gt);case l:return De=De.get(lt.key===null?Ie:lt.key)||null,Fe(Ee,De,lt,gt);case K:var wt=lt._init;return dt(De,Ee,Ie,wt(lt._payload),gt)}if(Ze(lt)||$(lt))return De=De.get(Ie)||null,et(Ee,De,lt,gt,null);It(Ee,lt)}return null}function mt(De,Ee,Ie,lt){for(var gt=null,wt=null,Ct=Ee,Mt=Ee=0,_r=null;Ct!==null&&Mt<Ie.length;Mt++){Ct.index>Mt?(_r=Ct,Ct=null):_r=Ct.sibling;var $t=Qe(De,Ct,Ie[Mt],lt);if($t===null){Ct===null&&(Ct=_r);break}e&&Ct&&$t.alternate===null&&t(De,Ct),Ee=W($t,Ee,Mt),wt===null?gt=$t:wt.sibling=$t,wt=$t,Ct=_r}if(Mt===Ie.length)return c(De,Ct),st&&Oe(De,Mt),gt;if(Ct===null){for(;Mt<Ie.length;Mt++)Ct=it(De,Ie[Mt],lt),Ct!==null&&(Ee=W(Ct,Ee,Mt),wt===null?gt=Ct:wt.sibling=Ct,wt=Ct);return st&&Oe(De,Mt),gt}for(Ct=M(De,Ct);Mt<Ie.length;Mt++)_r=dt(Ct,De,Mt,Ie[Mt],lt),_r!==null&&(e&&_r.alternate!==null&&Ct.delete(_r.key===null?Mt:_r.key),Ee=W(_r,Ee,Mt),wt===null?gt=_r:wt.sibling=_r,wt=_r);return e&&Ct.forEach(function(Cn){return t(De,Cn)}),st&&Oe(De,Mt),gt}function pt(De,Ee,Ie,lt){var gt=$(Ie);if(typeof gt!="function")throw Error(n(150));if(Ie=gt.call(Ie),Ie==null)throw Error(n(151));for(var wt=gt=null,Ct=Ee,Mt=Ee=0,_r=null,$t=Ie.next();Ct!==null&&!$t.done;Mt++,$t=Ie.next()){Ct.index>Mt?(_r=Ct,Ct=null):_r=Ct.sibling;var Cn=Qe(De,Ct,$t.value,lt);if(Cn===null){Ct===null&&(Ct=_r);break}e&&Ct&&Cn.alternate===null&&t(De,Ct),Ee=W(Cn,Ee,Mt),wt===null?gt=Cn:wt.sibling=Cn,wt=Cn,Ct=_r}if($t.done)return c(De,Ct),st&&Oe(De,Mt),gt;if(Ct===null){for(;!$t.done;Mt++,$t=Ie.next())$t=it(De,$t.value,lt),$t!==null&&(Ee=W($t,Ee,Mt),wt===null?gt=$t:wt.sibling=$t,wt=$t);return st&&Oe(De,Mt),gt}for(Ct=M(De,Ct);!$t.done;Mt++,$t=Ie.next())$t=dt(Ct,De,Mt,$t.value,lt),$t!==null&&(e&&$t.alternate!==null&&Ct.delete($t.key===null?Mt:$t.key),Ee=W($t,Ee,Mt),wt===null?gt=$t:wt.sibling=$t,wt=$t);return e&&Ct.forEach(function(cd){return t(De,cd)}),st&&Oe(De,Mt),gt}function ur(De,Ee,Ie,lt){if(typeof Ie=="object"&&Ie!==null&&Ie.type===f&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case E:e:{for(var gt=Ie.key,wt=Ee;wt!==null;){if(wt.key===gt){if(gt=Ie.type,gt===f){if(wt.tag===7){c(De,wt.sibling),Ee=I(wt,Ie.props.children),Ee.return=De,De=Ee;break e}}else if(wt.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===K&&jt(gt)===wt.type){c(De,wt.sibling),Ee=I(wt,Ie.props),Ee.ref=Wt(De,wt,Ie),Ee.return=De,De=Ee;break e}c(De,wt);break}else t(De,wt);wt=wt.sibling}Ie.type===f?(Ee=Yn(Ie.props.children,De.mode,lt,Ie.key),Ee.return=De,De=Ee):(lt=Mo(Ie.type,Ie.key,Ie.props,null,De.mode,lt),lt.ref=Wt(De,Ee,Ie),lt.return=De,De=lt)}return J(De);case l:e:{for(wt=Ie.key;Ee!==null;){if(Ee.key===wt)if(Ee.tag===4&&Ee.stateNode.containerInfo===Ie.containerInfo&&Ee.stateNode.implementation===Ie.implementation){c(De,Ee.sibling),Ee=I(Ee,Ie.children||[]),Ee.return=De,De=Ee;break e}else{c(De,Ee);break}else t(De,Ee);Ee=Ee.sibling}Ee=iu(Ie,De.mode,lt),Ee.return=De,De=Ee}return J(De);case K:return wt=Ie._init,ur(De,Ee,wt(Ie._payload),lt)}if(Ze(Ie))return mt(De,Ee,Ie,lt);if($(Ie))return pt(De,Ee,Ie,lt);It(De,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"?(Ie=""+Ie,Ee!==null&&Ee.tag===6?(c(De,Ee.sibling),Ee=I(Ee,Ie),Ee.return=De,De=Ee):(c(De,Ee),Ee=ru(Ie,De.mode,lt),Ee.return=De,De=Ee),J(De)):c(De,Ee)}return ur}var zr=Ft(!0),fa=Ft(!1),zi=_i(null),Fi=null,As=null,hl=null;function fl(){hl=As=Fi=null}function ml(e){var t=zi.current;qt(zi),e._currentValue=t}function pl(e,t,c){for(;e!==null;){var M=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,M!==null&&(M.childLanes|=t)):M!==null&&(M.childLanes&t)!==t&&(M.childLanes|=t),e===c)break;e=e.return}}function Ms(e,t){Fi=e,hl=As=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Fr=!0),e.firstContext=null)}function Zr(e){var t=e._currentValue;if(hl!==e)if(e={context:e,memoizedValue:t,next:null},As===null){if(Fi===null)throw Error(n(308));As=e,Fi.dependencies={lanes:0,firstContext:e}}else As=As.next=e;return t}var Un=null;function gl(e){Un===null?Un=[e]:Un.push(e)}function cu(e,t,c,M){var I=t.interleaved;return I===null?(c.next=c,gl(t)):(c.next=I.next,I.next=c),t.interleaved=c,Bi(e,M)}function Bi(e,t){e.lanes|=t;var c=e.alternate;for(c!==null&&(c.lanes|=t),c=e,e=e.return;e!==null;)e.childLanes|=t,c=e.alternate,c!==null&&(c.childLanes|=t),c=e,e=e.return;return c.tag===3?c.stateNode:null}var gn=!1;function xl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function du(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ui(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xn(e,t,c){var M=e.updateQueue;if(M===null)return null;if(M=M.shared,(Gt&2)!==0){var I=M.pending;return I===null?t.next=t:(t.next=I.next,I.next=t),M.pending=t,Bi(e,c)}return I=M.interleaved,I===null?(t.next=t,gl(M)):(t.next=I.next,I.next=t),M.interleaved=t,Bi(e,c)}function ao(e,t,c){if(t=t.updateQueue,t!==null&&(t=t.shared,(c&4194240)!==0)){var M=t.lanes;M&=e.pendingLanes,c|=M,t.lanes=c,ti(e,c)}}function hu(e,t){var c=e.updateQueue,M=e.alternate;if(M!==null&&(M=M.updateQueue,c===M)){var I=null,W=null;if(c=c.firstBaseUpdate,c!==null){do{var J={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};W===null?I=W=J:W=W.next=J,c=c.next}while(c!==null);W===null?I=W=t:W=W.next=t}else I=W=t;c={baseState:M.baseState,firstBaseUpdate:I,lastBaseUpdate:W,shared:M.shared,effects:M.effects},e.updateQueue=c;return}e=c.lastBaseUpdate,e===null?c.firstBaseUpdate=t:e.next=t,c.lastBaseUpdate=t}function oo(e,t,c,M){var I=e.updateQueue;gn=!1;var W=I.firstBaseUpdate,J=I.lastBaseUpdate,de=I.shared.pending;if(de!==null){I.shared.pending=null;var ve=de,Fe=ve.next;ve.next=null,J===null?W=Fe:J.next=Fe,J=ve;var et=e.alternate;et!==null&&(et=et.updateQueue,de=et.lastBaseUpdate,de!==J&&(de===null?et.firstBaseUpdate=Fe:de.next=Fe,et.lastBaseUpdate=ve))}if(W!==null){var it=I.baseState;J=0,et=Fe=ve=null,de=W;do{var Qe=de.lane,dt=de.eventTime;if((M&Qe)===Qe){et!==null&&(et=et.next={eventTime:dt,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var mt=e,pt=de;switch(Qe=t,dt=c,pt.tag){case 1:if(mt=pt.payload,typeof mt=="function"){it=mt.call(dt,it,Qe);break e}it=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=pt.payload,Qe=typeof mt=="function"?mt.call(dt,it,Qe):mt,Qe==null)break e;it=V({},it,Qe);break e;case 2:gn=!0}}de.callback!==null&&de.lane!==0&&(e.flags|=64,Qe=I.effects,Qe===null?I.effects=[de]:Qe.push(de))}else dt={eventTime:dt,lane:Qe,tag:de.tag,payload:de.payload,callback:de.callback,next:null},et===null?(Fe=et=dt,ve=it):et=et.next=dt,J|=Qe;if(de=de.next,de===null){if(de=I.shared.pending,de===null)break;Qe=de,de=Qe.next,Qe.next=null,I.lastBaseUpdate=Qe,I.shared.pending=null}}while(!0);if(et===null&&(ve=it),I.baseState=ve,I.firstBaseUpdate=Fe,I.lastBaseUpdate=et,t=I.shared.interleaved,t!==null){I=t;do J|=I.lane,I=I.next;while(I!==t)}else W===null&&(I.shared.lanes=0);Vn|=J,e.lanes=J,e.memoizedState=it}}function fu(e,t,c){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var M=e[t],I=M.callback;if(I!==null){if(M.callback=null,M=c,typeof I!="function")throw Error(n(191,I));I.call(M)}}}var ma={},Ei=_i(ma),pa=_i(ma),ga=_i(ma);function Wn(e){if(e===ma)throw Error(n(174));return e}function vl(e,t){switch(Qt(ga,t),Qt(pa,e),Qt(Ei,ma),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:q(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=q(t,e)}qt(Ei),Qt(Ei,t)}function Ls(){qt(Ei),qt(pa),qt(ga)}function mu(e){Wn(ga.current);var t=Wn(Ei.current),c=q(t,e.type);t!==c&&(Qt(pa,e),Qt(Ei,c))}function yl(e){pa.current===e&&(qt(Ei),qt(pa))}var nr=_i(0);function lo(e){for(var t=e;t!==null;){if(t.tag===13){var c=t.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _l=[];function bl(){for(var e=0;e<_l.length;e++)_l[e]._workInProgressVersionPrimary=null;_l.length=0}var uo=y.ReactCurrentDispatcher,El=y.ReactCurrentBatchConfig,Gn=0,sr=null,mr=null,vr=null,co=!1,xa=!1,va=0,Dc=0;function Lr(){throw Error(n(321))}function wl(e,t){if(t===null)return!1;for(var c=0;c<t.length&&c<e.length;c++)if(!Nr(e[c],t[c]))return!1;return!0}function Cl(e,t,c,M,I,W){if(Gn=W,sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,uo.current=e===null||e.memoizedState===null?Ic:Nc,e=c(M,I),xa){W=0;do{if(xa=!1,va=0,25<=W)throw Error(n(301));W+=1,vr=mr=null,t.updateQueue=null,uo.current=zc,e=c(M,I)}while(xa)}if(uo.current=mo,t=mr!==null&&mr.next!==null,Gn=0,vr=mr=sr=null,co=!1,t)throw Error(n(300));return e}function Rl(){var e=va!==0;return va=0,e}function wi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?sr.memoizedState=vr=e:vr=vr.next=e,vr}function Qr(){if(mr===null){var e=sr.alternate;e=e!==null?e.memoizedState:null}else e=mr.next;var t=vr===null?sr.memoizedState:vr.next;if(t!==null)vr=t,mr=e;else{if(e===null)throw Error(n(310));mr=e,e={memoizedState:mr.memoizedState,baseState:mr.baseState,baseQueue:mr.baseQueue,queue:mr.queue,next:null},vr===null?sr.memoizedState=vr=e:vr=vr.next=e}return vr}function ya(e,t){return typeof t=="function"?t(e):t}function Sl(e){var t=Qr(),c=t.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=e;var M=mr,I=M.baseQueue,W=c.pending;if(W!==null){if(I!==null){var J=I.next;I.next=W.next,W.next=J}M.baseQueue=I=W,c.pending=null}if(I!==null){W=I.next,M=M.baseState;var de=J=null,ve=null,Fe=W;do{var et=Fe.lane;if((Gn&et)===et)ve!==null&&(ve=ve.next={lane:0,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null}),M=Fe.hasEagerState?Fe.eagerState:e(M,Fe.action);else{var it={lane:et,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null};ve===null?(de=ve=it,J=M):ve=ve.next=it,sr.lanes|=et,Vn|=et}Fe=Fe.next}while(Fe!==null&&Fe!==W);ve===null?J=M:ve.next=de,Nr(M,t.memoizedState)||(Fr=!0),t.memoizedState=M,t.baseState=J,t.baseQueue=ve,c.lastRenderedState=M}if(e=c.interleaved,e!==null){I=e;do W=I.lane,sr.lanes|=W,Vn|=W,I=I.next;while(I!==e)}else I===null&&(c.lanes=0);return[t.memoizedState,c.dispatch]}function Al(e){var t=Qr(),c=t.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=e;var M=c.dispatch,I=c.pending,W=t.memoizedState;if(I!==null){c.pending=null;var J=I=I.next;do W=e(W,J.action),J=J.next;while(J!==I);Nr(W,t.memoizedState)||(Fr=!0),t.memoizedState=W,t.baseQueue===null&&(t.baseState=W),c.lastRenderedState=W}return[W,M]}function pu(){}function gu(e,t){var c=sr,M=Qr(),I=t(),W=!Nr(M.memoizedState,I);if(W&&(M.memoizedState=I,Fr=!0),M=M.queue,Ml(yu.bind(null,c,M,e),[e]),M.getSnapshot!==t||W||vr!==null&&vr.memoizedState.tag&1){if(c.flags|=2048,_a(9,vu.bind(null,c,M,I,t),void 0,null),yr===null)throw Error(n(349));(Gn&30)!==0||xu(c,t,I)}return I}function xu(e,t,c){e.flags|=16384,e={getSnapshot:t,value:c},t=sr.updateQueue,t===null?(t={lastEffect:null,stores:null},sr.updateQueue=t,t.stores=[e]):(c=t.stores,c===null?t.stores=[e]:c.push(e))}function vu(e,t,c,M){t.value=c,t.getSnapshot=M,_u(t)&&bu(e)}function yu(e,t,c){return c(function(){_u(t)&&bu(e)})}function _u(e){var t=e.getSnapshot;e=e.value;try{var c=t();return!Nr(e,c)}catch{return!0}}function bu(e){var t=Bi(e,1);t!==null&&hi(t,e,1,-1)}function Eu(e){var t=wi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:e},t.queue=e,e=e.dispatch=kc.bind(null,sr,e),[t.memoizedState,e]}function _a(e,t,c,M){return e={tag:e,create:t,destroy:c,deps:M,next:null},t=sr.updateQueue,t===null?(t={lastEffect:null,stores:null},sr.updateQueue=t,t.lastEffect=e.next=e):(c=t.lastEffect,c===null?t.lastEffect=e.next=e:(M=c.next,c.next=e,e.next=M,t.lastEffect=e)),e}function wu(){return Qr().memoizedState}function ho(e,t,c,M){var I=wi();sr.flags|=e,I.memoizedState=_a(1|t,c,void 0,M===void 0?null:M)}function fo(e,t,c,M){var I=Qr();M=M===void 0?null:M;var W=void 0;if(mr!==null){var J=mr.memoizedState;if(W=J.destroy,M!==null&&wl(M,J.deps)){I.memoizedState=_a(t,c,W,M);return}}sr.flags|=e,I.memoizedState=_a(1|t,c,W,M)}function Cu(e,t){return ho(8390656,8,e,t)}function Ml(e,t){return fo(2048,8,e,t)}function Ru(e,t){return fo(4,2,e,t)}function Su(e,t){return fo(4,4,e,t)}function Au(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Mu(e,t,c){return c=c!=null?c.concat([e]):null,fo(4,4,Au.bind(null,t,e),c)}function Ll(){}function Lu(e,t){var c=Qr();t=t===void 0?null:t;var M=c.memoizedState;return M!==null&&t!==null&&wl(t,M[1])?M[0]:(c.memoizedState=[e,t],e)}function Tu(e,t){var c=Qr();t=t===void 0?null:t;var M=c.memoizedState;return M!==null&&t!==null&&wl(t,M[1])?M[0]:(e=e(),c.memoizedState=[e,t],e)}function ju(e,t,c){return(Gn&21)===0?(e.baseState&&(e.baseState=!1,Fr=!0),e.memoizedState=c):(Nr(c,t)||(c=Ai(),sr.lanes|=c,Vn|=c,e.baseState=!0),t)}function Oc(e,t){var c=Kt;Kt=c!==0&&4>c?c:4,e(!0);var M=El.transition;El.transition={};try{e(!1),t()}finally{Kt=c,El.transition=M}}function Du(){return Qr().memoizedState}function Pc(e,t,c){var M=bn(e);if(c={lane:M,action:c,hasEagerState:!1,eagerState:null,next:null},Ou(e))Pu(t,c);else if(c=cu(e,t,c,M),c!==null){var I=Ir();hi(c,e,M,I),ku(c,t,M)}}function kc(e,t,c){var M=bn(e),I={lane:M,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ou(e))Pu(t,I);else{var W=e.alternate;if(e.lanes===0&&(W===null||W.lanes===0)&&(W=t.lastRenderedReducer,W!==null))try{var J=t.lastRenderedState,de=W(J,c);if(I.hasEagerState=!0,I.eagerState=de,Nr(de,J)){var ve=t.interleaved;ve===null?(I.next=I,gl(t)):(I.next=ve.next,ve.next=I),t.interleaved=I;return}}catch{}c=cu(e,t,I,M),c!==null&&(I=Ir(),hi(c,e,M,I),ku(c,t,M))}}function Ou(e){var t=e.alternate;return e===sr||t!==null&&t===sr}function Pu(e,t){xa=co=!0;var c=e.pending;c===null?t.next=t:(t.next=c.next,c.next=t),e.pending=t}function ku(e,t,c){if((c&4194240)!==0){var M=t.lanes;M&=e.pendingLanes,c|=M,t.lanes=c,ti(e,c)}}var mo={readContext:Zr,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},Ic={readContext:Zr,useCallback:function(e,t){return wi().memoizedState=[e,t===void 0?null:t],e},useContext:Zr,useEffect:Cu,useImperativeHandle:function(e,t,c){return c=c!=null?c.concat([e]):null,ho(4194308,4,Au.bind(null,t,e),c)},useLayoutEffect:function(e,t){return ho(4194308,4,e,t)},useInsertionEffect:function(e,t){return ho(4,2,e,t)},useMemo:function(e,t){var c=wi();return t=t===void 0?null:t,e=e(),c.memoizedState=[e,t],e},useReducer:function(e,t,c){var M=wi();return t=c!==void 0?c(t):t,M.memoizedState=M.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},M.queue=e,e=e.dispatch=Pc.bind(null,sr,e),[M.memoizedState,e]},useRef:function(e){var t=wi();return e={current:e},t.memoizedState=e},useState:Eu,useDebugValue:Ll,useDeferredValue:function(e){return wi().memoizedState=e},useTransition:function(){var e=Eu(!1),t=e[0];return e=Oc.bind(null,e[1]),wi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,c){var M=sr,I=wi();if(st){if(c===void 0)throw Error(n(407));c=c()}else{if(c=t(),yr===null)throw Error(n(349));(Gn&30)!==0||xu(M,t,c)}I.memoizedState=c;var W={value:c,getSnapshot:t};return I.queue=W,Cu(yu.bind(null,M,W,e),[e]),M.flags|=2048,_a(9,vu.bind(null,M,W,c,t),void 0,null),c},useId:function(){var e=wi(),t=yr.identifierPrefix;if(st){var c=ae,M=oe;c=(M&~(1<<32-ar(M)-1)).toString(32)+c,t=":"+t+"R"+c,c=va++,0<c&&(t+="H"+c.toString(32)),t+=":"}else c=Dc++,t=":"+t+"r"+c.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Nc={readContext:Zr,useCallback:Lu,useContext:Zr,useEffect:Ml,useImperativeHandle:Mu,useInsertionEffect:Ru,useLayoutEffect:Su,useMemo:Tu,useReducer:Sl,useRef:wu,useState:function(){return Sl(ya)},useDebugValue:Ll,useDeferredValue:function(e){var t=Qr();return ju(t,mr.memoizedState,e)},useTransition:function(){var e=Sl(ya)[0],t=Qr().memoizedState;return[e,t]},useMutableSource:pu,useSyncExternalStore:gu,useId:Du,unstable_isNewReconciler:!1},zc={readContext:Zr,useCallback:Lu,useContext:Zr,useEffect:Ml,useImperativeHandle:Mu,useInsertionEffect:Ru,useLayoutEffect:Su,useMemo:Tu,useReducer:Al,useRef:wu,useState:function(){return Al(ya)},useDebugValue:Ll,useDeferredValue:function(e){var t=Qr();return mr===null?t.memoizedState=e:ju(t,mr.memoizedState,e)},useTransition:function(){var e=Al(ya)[0],t=Qr().memoizedState;return[e,t]},useMutableSource:pu,useSyncExternalStore:gu,useId:Du,unstable_isNewReconciler:!1};function ui(e,t){if(e&&e.defaultProps){t=V({},t),e=e.defaultProps;for(var c in e)t[c]===void 0&&(t[c]=e[c]);return t}return t}function Tl(e,t,c,M){t=e.memoizedState,c=c(M,t),c=c==null?t:V({},t,c),e.memoizedState=c,e.lanes===0&&(e.updateQueue.baseState=c)}var po={isMounted:function(e){return(e=e._reactInternals)?Rt(e)===e:!1},enqueueSetState:function(e,t,c){e=e._reactInternals;var M=Ir(),I=bn(e),W=Ui(M,I);W.payload=t,c!=null&&(W.callback=c),t=xn(e,W,I),t!==null&&(hi(t,e,I,M),ao(t,e,I))},enqueueReplaceState:function(e,t,c){e=e._reactInternals;var M=Ir(),I=bn(e),W=Ui(M,I);W.tag=1,W.payload=t,c!=null&&(W.callback=c),t=xn(e,W,I),t!==null&&(hi(t,e,I,M),ao(t,e,I))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var c=Ir(),M=bn(e),I=Ui(c,M);I.tag=2,t!=null&&(I.callback=t),t=xn(e,I,M),t!==null&&(hi(t,e,M,c),ao(t,e,M))}};function Iu(e,t,c,M,I,W,J){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(M,W,J):t.prototype&&t.prototype.isPureReactComponent?!an(c,M)||!an(I,W):!0}function Nu(e,t,c){var M=!1,I=bi,W=t.contextType;return typeof W=="object"&&W!==null?W=Zr(W):(I=Mr(t)?ki:xr.current,M=t.contextTypes,W=(M=M!=null)?pn(e,I):bi),t=new t(c,W),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=po,e.stateNode=t,t._reactInternals=e,M&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=I,e.__reactInternalMemoizedMaskedChildContext=W),t}function zu(e,t,c,M){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(c,M),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(c,M),t.state!==e&&po.enqueueReplaceState(t,t.state,null)}function jl(e,t,c,M){var I=e.stateNode;I.props=c,I.state=e.memoizedState,I.refs={},xl(e);var W=t.contextType;typeof W=="object"&&W!==null?I.context=Zr(W):(W=Mr(t)?ki:xr.current,I.context=pn(e,W)),I.state=e.memoizedState,W=t.getDerivedStateFromProps,typeof W=="function"&&(Tl(e,t,W,c),I.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(t=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),t!==I.state&&po.enqueueReplaceState(I,I.state,null),oo(e,c,I,M),I.state=e.memoizedState),typeof I.componentDidMount=="function"&&(e.flags|=4194308)}function Ts(e,t){try{var c="",M=t;do c+=he(M),M=M.return;while(M);var I=c}catch(W){I=`
Error generating stack: `+W.message+`
`+W.stack}return{value:e,source:t,stack:I,digest:null}}function Dl(e,t,c){return{value:e,source:null,stack:c??null,digest:t??null}}function Ol(e,t){try{console.error(t.value)}catch(c){setTimeout(function(){throw c})}}var Fc=typeof WeakMap=="function"?WeakMap:Map;function Fu(e,t,c){c=Ui(-1,c),c.tag=3,c.payload={element:null};var M=t.value;return c.callback=function(){Eo||(Eo=!0,Yl=M),Ol(e,t)},c}function Bu(e,t,c){c=Ui(-1,c),c.tag=3;var M=e.type.getDerivedStateFromError;if(typeof M=="function"){var I=t.value;c.payload=function(){return M(I)},c.callback=function(){Ol(e,t)}}var W=e.stateNode;return W!==null&&typeof W.componentDidCatch=="function"&&(c.callback=function(){Ol(e,t),typeof M!="function"&&(yn===null?yn=new Set([this]):yn.add(this));var J=t.stack;this.componentDidCatch(t.value,{componentStack:J!==null?J:""})}),c}function Uu(e,t,c){var M=e.pingCache;if(M===null){M=e.pingCache=new Fc;var I=new Set;M.set(t,I)}else I=M.get(t),I===void 0&&(I=new Set,M.set(t,I));I.has(c)||(I.add(c),e=qc.bind(null,e,t,c),t.then(e,e))}function Wu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Gu(e,t,c,M,I){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(t=Ui(-1,1),t.tag=2,xn(c,t,1))),c.lanes|=1),e):(e.flags|=65536,e.lanes=I,e)}var Bc=y.ReactCurrentOwner,Fr=!1;function kr(e,t,c,M){t.child=e===null?fa(t,null,c,M):zr(t,e.child,c,M)}function Vu(e,t,c,M,I){c=c.render;var W=t.ref;return Ms(t,I),M=Cl(e,t,c,M,W,I),c=Rl(),e!==null&&!Fr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~I,Wi(e,t,I)):(st&&c&&ht(t),t.flags|=1,kr(e,t,M,I),t.child)}function Hu(e,t,c,M,I){if(e===null){var W=c.type;return typeof W=="function"&&!tu(W)&&W.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(t.tag=15,t.type=W,Ku(e,t,W,M,I)):(e=Mo(c.type,null,M,t,t.mode,I),e.ref=t.ref,e.return=t,t.child=e)}if(W=e.child,(e.lanes&I)===0){var J=W.memoizedProps;if(c=c.compare,c=c!==null?c:an,c(J,M)&&e.ref===t.ref)return Wi(e,t,I)}return t.flags|=1,e=wn(W,M),e.ref=t.ref,e.return=t,t.child=e}function Ku(e,t,c,M,I){if(e!==null){var W=e.memoizedProps;if(an(W,M)&&e.ref===t.ref)if(Fr=!1,t.pendingProps=M=W,(e.lanes&I)!==0)(e.flags&131072)!==0&&(Fr=!0);else return t.lanes=e.lanes,Wi(e,t,I)}return Pl(e,t,c,M,I)}function $u(e,t,c){var M=t.pendingProps,I=M.children,W=e!==null?e.memoizedState:null;if(M.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Ds,Vr),Vr|=c;else{if((c&1073741824)===0)return e=W!==null?W.baseLanes|c:c,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qt(Ds,Vr),Vr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},M=W!==null?W.baseLanes:c,Qt(Ds,Vr),Vr|=M}else W!==null?(M=W.baseLanes|c,t.memoizedState=null):M=c,Qt(Ds,Vr),Vr|=M;return kr(e,t,I,c),t.child}function Yu(e,t){var c=t.ref;(e===null&&c!==null||e!==null&&e.ref!==c)&&(t.flags|=512,t.flags|=2097152)}function Pl(e,t,c,M,I){var W=Mr(c)?ki:xr.current;return W=pn(t,W),Ms(t,I),c=Cl(e,t,c,M,W,I),M=Rl(),e!==null&&!Fr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~I,Wi(e,t,I)):(st&&M&&ht(t),t.flags|=1,kr(e,t,c,I),t.child)}function Xu(e,t,c,M,I){if(Mr(c)){var W=!0;Cs(t)}else W=!1;if(Ms(t,I),t.stateNode===null)xo(e,t),Nu(t,c,M),jl(t,c,M,I),M=!0;else if(e===null){var J=t.stateNode,de=t.memoizedProps;J.props=de;var ve=J.context,Fe=c.contextType;typeof Fe=="object"&&Fe!==null?Fe=Zr(Fe):(Fe=Mr(c)?ki:xr.current,Fe=pn(t,Fe));var et=c.getDerivedStateFromProps,it=typeof et=="function"||typeof J.getSnapshotBeforeUpdate=="function";it||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(de!==M||ve!==Fe)&&zu(t,J,M,Fe),gn=!1;var Qe=t.memoizedState;J.state=Qe,oo(t,M,J,I),ve=t.memoizedState,de!==M||Qe!==ve||Ar.current||gn?(typeof et=="function"&&(Tl(t,c,et,M),ve=t.memoizedState),(de=gn||Iu(t,c,de,M,Qe,ve,Fe))?(it||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(t.flags|=4194308)):(typeof J.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=M,t.memoizedState=ve),J.props=M,J.state=ve,J.context=Fe,M=de):(typeof J.componentDidMount=="function"&&(t.flags|=4194308),M=!1)}else{J=t.stateNode,du(e,t),de=t.memoizedProps,Fe=t.type===t.elementType?de:ui(t.type,de),J.props=Fe,it=t.pendingProps,Qe=J.context,ve=c.contextType,typeof ve=="object"&&ve!==null?ve=Zr(ve):(ve=Mr(c)?ki:xr.current,ve=pn(t,ve));var dt=c.getDerivedStateFromProps;(et=typeof dt=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(de!==it||Qe!==ve)&&zu(t,J,M,ve),gn=!1,Qe=t.memoizedState,J.state=Qe,oo(t,M,J,I);var mt=t.memoizedState;de!==it||Qe!==mt||Ar.current||gn?(typeof dt=="function"&&(Tl(t,c,dt,M),mt=t.memoizedState),(Fe=gn||Iu(t,c,Fe,M,Qe,mt,ve)||!1)?(et||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(M,mt,ve),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(M,mt,ve)),typeof J.componentDidUpdate=="function"&&(t.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof J.componentDidUpdate!="function"||de===e.memoizedProps&&Qe===e.memoizedState||(t.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||de===e.memoizedProps&&Qe===e.memoizedState||(t.flags|=1024),t.memoizedProps=M,t.memoizedState=mt),J.props=M,J.state=mt,J.context=ve,M=Fe):(typeof J.componentDidUpdate!="function"||de===e.memoizedProps&&Qe===e.memoizedState||(t.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||de===e.memoizedProps&&Qe===e.memoizedState||(t.flags|=1024),M=!1)}return kl(e,t,c,M,W,I)}function kl(e,t,c,M,I,W){Yu(e,t);var J=(t.flags&128)!==0;if(!M&&!J)return I&&da(t,c,!1),Wi(e,t,W);M=t.stateNode,Bc.current=t;var de=J&&typeof c.getDerivedStateFromError!="function"?null:M.render();return t.flags|=1,e!==null&&J?(t.child=zr(t,e.child,null,W),t.child=zr(t,null,de,W)):kr(e,t,de,W),t.memoizedState=M.state,I&&da(t,c,!0),t.child}function Zu(e){var t=e.stateNode;t.pendingContext?io(e,t.pendingContext,t.pendingContext!==t.context):t.context&&io(e,t.context,!1),vl(e,t.containerInfo)}function Qu(e,t,c,M,I){return zt(),or(I),t.flags|=256,kr(e,t,c,M),t.child}var Il={dehydrated:null,treeContext:null,retryLane:0};function Nl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ju(e,t,c){var M=t.pendingProps,I=nr.current,W=!1,J=(t.flags&128)!==0,de;if((de=J)||(de=e!==null&&e.memoizedState===null?!1:(I&2)!==0),de?(W=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(I|=1),Qt(nr,I&1),e===null)return Ot(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(J=M.children,e=M.fallback,W?(M=t.mode,W=t.child,J={mode:"hidden",children:J},(M&1)===0&&W!==null?(W.childLanes=0,W.pendingProps=J):W=Lo(J,M,0,null),e=Yn(e,M,c,null),W.return=t,e.return=t,W.sibling=e,t.child=W,t.child.memoizedState=Nl(c),t.memoizedState=Il,e):zl(t,J));if(I=e.memoizedState,I!==null&&(de=I.dehydrated,de!==null))return Uc(e,t,J,M,de,I,c);if(W){W=M.fallback,J=t.mode,I=e.child,de=I.sibling;var ve={mode:"hidden",children:M.children};return(J&1)===0&&t.child!==I?(M=t.child,M.childLanes=0,M.pendingProps=ve,t.deletions=null):(M=wn(I,ve),M.subtreeFlags=I.subtreeFlags&14680064),de!==null?W=wn(de,W):(W=Yn(W,J,c,null),W.flags|=2),W.return=t,M.return=t,M.sibling=W,t.child=M,M=W,W=t.child,J=e.child.memoizedState,J=J===null?Nl(c):{baseLanes:J.baseLanes|c,cachePool:null,transitions:J.transitions},W.memoizedState=J,W.childLanes=e.childLanes&~c,t.memoizedState=Il,M}return W=e.child,e=W.sibling,M=wn(W,{mode:"visible",children:M.children}),(t.mode&1)===0&&(M.lanes=c),M.return=t,M.sibling=null,e!==null&&(c=t.deletions,c===null?(t.deletions=[e],t.flags|=16):c.push(e)),t.child=M,t.memoizedState=null,M}function zl(e,t){return t=Lo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function go(e,t,c,M){return M!==null&&or(M),zr(t,e.child,null,c),e=zl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Uc(e,t,c,M,I,W,J){if(c)return t.flags&256?(t.flags&=-257,M=Dl(Error(n(422))),go(e,t,J,M)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(W=M.fallback,I=t.mode,M=Lo({mode:"visible",children:M.children},I,0,null),W=Yn(W,I,J,null),W.flags|=2,M.return=t,W.return=t,M.sibling=W,t.child=M,(t.mode&1)!==0&&zr(t,e.child,null,J),t.child.memoizedState=Nl(J),t.memoizedState=Il,W);if((t.mode&1)===0)return go(e,t,J,null);if(I.data==="$!"){if(M=I.nextSibling&&I.nextSibling.dataset,M)var de=M.dgst;return M=de,W=Error(n(419)),M=Dl(W,M,void 0),go(e,t,J,M)}if(de=(J&e.childLanes)!==0,Fr||de){if(M=yr,M!==null){switch(J&-J){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}I=(I&(M.suspendedLanes|J))!==0?0:I,I!==0&&I!==W.retryLane&&(W.retryLane=I,Bi(e,I),hi(M,e,I,-1))}return eu(),M=Dl(Error(n(421))),go(e,t,J,M)}return I.data==="$?"?(t.flags|=128,t.child=e.child,t=ed.bind(null,e),I._reactRetry=t,null):(e=W.treeContext,Tt=gr(I.nextSibling),je=t,st=!0,Xe=null,e!==null&&(X[O++]=oe,X[O++]=ae,X[O++]=te,oe=e.id,ae=e.overflow,te=t),t=zl(t,M.children),t.flags|=4096,t)}function qu(e,t,c){e.lanes|=t;var M=e.alternate;M!==null&&(M.lanes|=t),pl(e.return,t,c)}function Fl(e,t,c,M,I){var W=e.memoizedState;W===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:M,tail:c,tailMode:I}:(W.isBackwards=t,W.rendering=null,W.renderingStartTime=0,W.last=M,W.tail=c,W.tailMode=I)}function ec(e,t,c){var M=t.pendingProps,I=M.revealOrder,W=M.tail;if(kr(e,t,M.children,c),M=nr.current,(M&2)!==0)M=M&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qu(e,c,t);else if(e.tag===19)qu(e,c,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}M&=1}if(Qt(nr,M),(t.mode&1)===0)t.memoizedState=null;else switch(I){case"forwards":for(c=t.child,I=null;c!==null;)e=c.alternate,e!==null&&lo(e)===null&&(I=c),c=c.sibling;c=I,c===null?(I=t.child,t.child=null):(I=c.sibling,c.sibling=null),Fl(t,!1,I,c,W);break;case"backwards":for(c=null,I=t.child,t.child=null;I!==null;){if(e=I.alternate,e!==null&&lo(e)===null){t.child=I;break}e=I.sibling,I.sibling=c,c=I,I=e}Fl(t,!0,c,null,W);break;case"together":Fl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xo(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wi(e,t,c){if(e!==null&&(t.dependencies=e.dependencies),Vn|=t.lanes,(c&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(n(153));if(t.child!==null){for(e=t.child,c=wn(e,e.pendingProps),t.child=c,c.return=t;e.sibling!==null;)e=e.sibling,c=c.sibling=wn(e,e.pendingProps),c.return=t;c.sibling=null}return t.child}function Wc(e,t,c){switch(t.tag){case 3:Zu(t),zt();break;case 5:mu(t);break;case 1:Mr(t.type)&&Cs(t);break;case 4:vl(t,t.stateNode.containerInfo);break;case 10:var M=t.type._context,I=t.memoizedProps.value;Qt(zi,M._currentValue),M._currentValue=I;break;case 13:if(M=t.memoizedState,M!==null)return M.dehydrated!==null?(Qt(nr,nr.current&1),t.flags|=128,null):(c&t.child.childLanes)!==0?Ju(e,t,c):(Qt(nr,nr.current&1),e=Wi(e,t,c),e!==null?e.sibling:null);Qt(nr,nr.current&1);break;case 19:if(M=(c&t.childLanes)!==0,(e.flags&128)!==0){if(M)return ec(e,t,c);t.flags|=128}if(I=t.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Qt(nr,nr.current),M)break;return null;case 22:case 23:return t.lanes=0,$u(e,t,c)}return Wi(e,t,c)}var tc,Bl,rc,ic;tc=function(e,t){for(var c=t.child;c!==null;){if(c.tag===5||c.tag===6)e.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break;for(;c.sibling===null;){if(c.return===null||c.return===t)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Bl=function(){},rc=function(e,t,c,M){var I=e.memoizedProps;if(I!==M){e=t.stateNode,Wn(Ei.current);var W=null;switch(c){case"input":I=ue(e,I),M=ue(e,M),W=[];break;case"select":I=V({},I,{value:void 0}),M=V({},M,{value:void 0}),W=[];break;case"textarea":I=Ye(e,I),M=Ye(e,M),W=[];break;default:typeof I.onClick!="function"&&typeof M.onClick=="function"&&(e.onclick=Es)}Ce(c,M);var J;c=null;for(Fe in I)if(!M.hasOwnProperty(Fe)&&I.hasOwnProperty(Fe)&&I[Fe]!=null)if(Fe==="style"){var de=I[Fe];for(J in de)de.hasOwnProperty(J)&&(c||(c={}),c[J]="")}else Fe!=="dangerouslySetInnerHTML"&&Fe!=="children"&&Fe!=="suppressContentEditableWarning"&&Fe!=="suppressHydrationWarning"&&Fe!=="autoFocus"&&(R.hasOwnProperty(Fe)?W||(W=[]):(W=W||[]).push(Fe,null));for(Fe in M){var ve=M[Fe];if(de=I?.[Fe],M.hasOwnProperty(Fe)&&ve!==de&&(ve!=null||de!=null))if(Fe==="style")if(de){for(J in de)!de.hasOwnProperty(J)||ve&&ve.hasOwnProperty(J)||(c||(c={}),c[J]="");for(J in ve)ve.hasOwnProperty(J)&&de[J]!==ve[J]&&(c||(c={}),c[J]=ve[J])}else c||(W||(W=[]),W.push(Fe,c)),c=ve;else Fe==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,de=de?de.__html:void 0,ve!=null&&de!==ve&&(W=W||[]).push(Fe,ve)):Fe==="children"?typeof ve!="string"&&typeof ve!="number"||(W=W||[]).push(Fe,""+ve):Fe!=="suppressContentEditableWarning"&&Fe!=="suppressHydrationWarning"&&(R.hasOwnProperty(Fe)?(ve!=null&&Fe==="onScroll"&&Zt("scroll",e),W||de===ve||(W=[])):(W=W||[]).push(Fe,ve))}c&&(W=W||[]).push("style",c);var Fe=W;(t.updateQueue=Fe)&&(t.flags|=4)}},ic=function(e,t,c,M){c!==M&&(t.flags|=4)};function ba(e,t){if(!st)switch(e.tailMode){case"hidden":t=e.tail;for(var c=null;t!==null;)t.alternate!==null&&(c=t),t=t.sibling;c===null?e.tail=null:c.sibling=null;break;case"collapsed":c=e.tail;for(var M=null;c!==null;)c.alternate!==null&&(M=c),c=c.sibling;M===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:M.sibling=null}}function Tr(e){var t=e.alternate!==null&&e.alternate.child===e.child,c=0,M=0;if(t)for(var I=e.child;I!==null;)c|=I.lanes|I.childLanes,M|=I.subtreeFlags&14680064,M|=I.flags&14680064,I.return=e,I=I.sibling;else for(I=e.child;I!==null;)c|=I.lanes|I.childLanes,M|=I.subtreeFlags,M|=I.flags,I.return=e,I=I.sibling;return e.subtreeFlags|=M,e.childLanes=c,t}function Gc(e,t,c){var M=t.pendingProps;switch(ye(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tr(t),null;case 1:return Mr(t.type)&&ws(),Tr(t),null;case 3:return M=t.stateNode,Ls(),qt(Ar),qt(xr),bl(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(e===null||e.child===null)&&(kt(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Xe!==null&&(Ql(Xe),Xe=null))),Bl(e,t),Tr(t),null;case 5:yl(t);var I=Wn(ga.current);if(c=t.type,e!==null&&t.stateNode!=null)rc(e,t,c,M,I),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!M){if(t.stateNode===null)throw Error(n(166));return Tr(t),null}if(e=Wn(Ei.current),kt(t)){M=t.stateNode,c=t.type;var W=t.memoizedProps;switch(M[Gr]=t,M[zn]=W,e=(t.mode&1)!==0,c){case"dialog":Zt("cancel",M),Zt("close",M);break;case"iframe":case"object":case"embed":Zt("load",M);break;case"video":case"audio":for(I=0;I<In.length;I++)Zt(In[I],M);break;case"source":Zt("error",M);break;case"img":case"image":case"link":Zt("error",M),Zt("load",M);break;case"details":Zt("toggle",M);break;case"input":Me(M,W),Zt("invalid",M);break;case"select":M._wrapperState={wasMultiple:!!W.multiple},Zt("invalid",M);break;case"textarea":Ke(M,W),Zt("invalid",M)}Ce(c,W),I=null;for(var J in W)if(W.hasOwnProperty(J)){var de=W[J];J==="children"?typeof de=="string"?M.textContent!==de&&(W.suppressHydrationWarning!==!0&&bs(M.textContent,de,e),I=["children",de]):typeof de=="number"&&M.textContent!==""+de&&(W.suppressHydrationWarning!==!0&&bs(M.textContent,de,e),I=["children",""+de]):R.hasOwnProperty(J)&&de!=null&&J==="onScroll"&&Zt("scroll",M)}switch(c){case"input":ke(M),qe(M,W,!0);break;case"textarea":ke(M),nt(M);break;case"select":case"option":break;default:typeof W.onClick=="function"&&(M.onclick=Es)}M=I,t.updateQueue=M,M!==null&&(t.flags|=4)}else{J=I.nodeType===9?I:I.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=at(c)),e==="http://www.w3.org/1999/xhtml"?c==="script"?(e=J.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof M.is=="string"?e=J.createElement(c,{is:M.is}):(e=J.createElement(c),c==="select"&&(J=e,M.multiple?J.multiple=!0:M.size&&(J.size=M.size))):e=J.createElementNS(e,c),e[Gr]=t,e[zn]=M,tc(e,t,!1,!1),t.stateNode=e;e:{switch(J=Ue(c,M),c){case"dialog":Zt("cancel",e),Zt("close",e),I=M;break;case"iframe":case"object":case"embed":Zt("load",e),I=M;break;case"video":case"audio":for(I=0;I<In.length;I++)Zt(In[I],e);I=M;break;case"source":Zt("error",e),I=M;break;case"img":case"image":case"link":Zt("error",e),Zt("load",e),I=M;break;case"details":Zt("toggle",e),I=M;break;case"input":Me(e,M),I=ue(e,M),Zt("invalid",e);break;case"option":I=M;break;case"select":e._wrapperState={wasMultiple:!!M.multiple},I=V({},M,{value:void 0}),Zt("invalid",e);break;case"textarea":Ke(e,M),I=Ye(e,M),Zt("invalid",e);break;default:I=M}Ce(c,I),de=I;for(W in de)if(de.hasOwnProperty(W)){var ve=de[W];W==="style"?Z(e,ve):W==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,ve!=null&&se(e,ve)):W==="children"?typeof ve=="string"?(c!=="textarea"||ve!=="")&&Se(e,ve):typeof ve=="number"&&Se(e,""+ve):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(R.hasOwnProperty(W)?ve!=null&&W==="onScroll"&&Zt("scroll",e):ve!=null&&g(e,W,ve,J))}switch(c){case"input":ke(e),qe(e,M,!1);break;case"textarea":ke(e),nt(e);break;case"option":M.value!=null&&e.setAttribute("value",""+fe(M.value));break;case"select":e.multiple=!!M.multiple,W=M.value,W!=null?Ve(e,!!M.multiple,W,!1):M.defaultValue!=null&&Ve(e,!!M.multiple,M.defaultValue,!0);break;default:typeof I.onClick=="function"&&(e.onclick=Es)}switch(c){case"button":case"input":case"select":case"textarea":M=!!M.autoFocus;break e;case"img":M=!0;break e;default:M=!1}}M&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tr(t),null;case 6:if(e&&t.stateNode!=null)ic(e,t,e.memoizedProps,M);else{if(typeof M!="string"&&t.stateNode===null)throw Error(n(166));if(c=Wn(ga.current),Wn(Ei.current),kt(t)){if(M=t.stateNode,c=t.memoizedProps,M[Gr]=t,(W=M.nodeValue!==c)&&(e=je,e!==null))switch(e.tag){case 3:bs(M.nodeValue,c,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&bs(M.nodeValue,c,(e.mode&1)!==0)}W&&(t.flags|=4)}else M=(c.nodeType===9?c:c.ownerDocument).createTextNode(M),M[Gr]=t,t.stateNode=M}return Tr(t),null;case 13:if(qt(nr),M=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(st&&Tt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)ct(),zt(),t.flags|=98560,W=!1;else if(W=kt(t),M!==null&&M.dehydrated!==null){if(e===null){if(!W)throw Error(n(318));if(W=t.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(n(317));W[Gr]=t}else zt(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Tr(t),W=!1}else Xe!==null&&(Ql(Xe),Xe=null),W=!0;if(!W)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=c,t):(M=M!==null,M!==(e!==null&&e.memoizedState!==null)&&M&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(nr.current&1)!==0?pr===0&&(pr=3):eu())),t.updateQueue!==null&&(t.flags|=4),Tr(t),null);case 4:return Ls(),Bl(e,t),e===null&&ln(t.stateNode.containerInfo),Tr(t),null;case 10:return ml(t.type._context),Tr(t),null;case 17:return Mr(t.type)&&ws(),Tr(t),null;case 19:if(qt(nr),W=t.memoizedState,W===null)return Tr(t),null;if(M=(t.flags&128)!==0,J=W.rendering,J===null)if(M)ba(W,!1);else{if(pr!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(J=lo(e),J!==null){for(t.flags|=128,ba(W,!1),M=J.updateQueue,M!==null&&(t.updateQueue=M,t.flags|=4),t.subtreeFlags=0,M=c,c=t.child;c!==null;)W=c,e=M,W.flags&=14680066,J=W.alternate,J===null?(W.childLanes=0,W.lanes=e,W.child=null,W.subtreeFlags=0,W.memoizedProps=null,W.memoizedState=null,W.updateQueue=null,W.dependencies=null,W.stateNode=null):(W.childLanes=J.childLanes,W.lanes=J.lanes,W.child=J.child,W.subtreeFlags=0,W.deletions=null,W.memoizedProps=J.memoizedProps,W.memoizedState=J.memoizedState,W.updateQueue=J.updateQueue,W.type=J.type,e=J.dependencies,W.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),c=c.sibling;return Qt(nr,nr.current&1|2),t.child}e=e.sibling}W.tail!==null&&er()>Os&&(t.flags|=128,M=!0,ba(W,!1),t.lanes=4194304)}else{if(!M)if(e=lo(J),e!==null){if(t.flags|=128,M=!0,c=e.updateQueue,c!==null&&(t.updateQueue=c,t.flags|=4),ba(W,!0),W.tail===null&&W.tailMode==="hidden"&&!J.alternate&&!st)return Tr(t),null}else 2*er()-W.renderingStartTime>Os&&c!==1073741824&&(t.flags|=128,M=!0,ba(W,!1),t.lanes=4194304);W.isBackwards?(J.sibling=t.child,t.child=J):(c=W.last,c!==null?c.sibling=J:t.child=J,W.last=J)}return W.tail!==null?(t=W.tail,W.rendering=t,W.tail=t.sibling,W.renderingStartTime=er(),t.sibling=null,c=nr.current,Qt(nr,M?c&1|2:c&1),t):(Tr(t),null);case 22:case 23:return ql(),M=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==M&&(t.flags|=8192),M&&(t.mode&1)!==0?(Vr&1073741824)!==0&&(Tr(t),t.subtreeFlags&6&&(t.flags|=8192)):Tr(t),null;case 24:return null;case 25:return null}throw Error(n(156,t.tag))}function Vc(e,t){switch(ye(t),t.tag){case 1:return Mr(t.type)&&ws(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ls(),qt(Ar),qt(xr),bl(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return yl(t),null;case 13:if(qt(nr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(n(340));zt()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qt(nr),null;case 4:return Ls(),null;case 10:return ml(t.type._context),null;case 22:case 23:return ql(),null;case 24:return null;default:return null}}var vo=!1,jr=!1,Hc=typeof WeakSet=="function"?WeakSet:Set,ft=null;function js(e,t){var c=e.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(M){lr(e,t,M)}else c.current=null}function Ul(e,t,c){try{c()}catch(M){lr(e,t,M)}}var nc=!1;function Kc(e,t){if(na=es,e=Pn(),Wr(e)){if("selectionStart"in e)var c={start:e.selectionStart,end:e.selectionEnd};else e:{c=(c=e.ownerDocument)&&c.defaultView||window;var M=c.getSelection&&c.getSelection();if(M&&M.rangeCount!==0){c=M.anchorNode;var I=M.anchorOffset,W=M.focusNode;M=M.focusOffset;try{c.nodeType,W.nodeType}catch{c=null;break e}var J=0,de=-1,ve=-1,Fe=0,et=0,it=e,Qe=null;t:for(;;){for(var dt;it!==c||I!==0&&it.nodeType!==3||(de=J+I),it!==W||M!==0&&it.nodeType!==3||(ve=J+M),it.nodeType===3&&(J+=it.nodeValue.length),(dt=it.firstChild)!==null;)Qe=it,it=dt;for(;;){if(it===e)break t;if(Qe===c&&++Fe===I&&(de=J),Qe===W&&++et===M&&(ve=J),(dt=it.nextSibling)!==null)break;it=Qe,Qe=it.parentNode}it=dt}c=de===-1||ve===-1?null:{start:de,end:ve}}else c=null}c=c||{start:0,end:0}}else c=null;for(sa={focusedElem:e,selectionRange:c},es=!1,ft=t;ft!==null;)if(t=ft,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ft=e;else for(;ft!==null;){t=ft;try{var mt=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(mt!==null){var pt=mt.memoizedProps,ur=mt.memoizedState,De=t.stateNode,Ee=De.getSnapshotBeforeUpdate(t.elementType===t.type?pt:ui(t.type,pt),ur);De.__reactInternalSnapshotBeforeUpdate=Ee}break;case 3:var Ie=t.stateNode.containerInfo;Ie.nodeType===1?Ie.textContent="":Ie.nodeType===9&&Ie.documentElement&&Ie.removeChild(Ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(lt){lr(t,t.return,lt)}if(e=t.sibling,e!==null){e.return=t.return,ft=e;break}ft=t.return}return mt=nc,nc=!1,mt}function Ea(e,t,c){var M=t.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var I=M=M.next;do{if((I.tag&e)===e){var W=I.destroy;I.destroy=void 0,W!==void 0&&Ul(t,c,W)}I=I.next}while(I!==M)}}function yo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var c=t=t.next;do{if((c.tag&e)===e){var M=c.create;c.destroy=M()}c=c.next}while(c!==t)}}function Wl(e){var t=e.ref;if(t!==null){var c=e.stateNode;e.tag,e=c,typeof t=="function"?t(e):t.current=e}}function sc(e){var t=e.alternate;t!==null&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gr],delete t[zn],delete t[Oi],delete t[ua],delete t[ca])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return e.tag===5||e.tag===3||e.tag===4}function oc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gl(e,t,c){var M=e.tag;if(M===5||M===6)e=e.stateNode,t?c.nodeType===8?c.parentNode.insertBefore(e,t):c.insertBefore(e,t):(c.nodeType===8?(t=c.parentNode,t.insertBefore(e,c)):(t=c,t.appendChild(e)),c=c._reactRootContainer,c!=null||t.onclick!==null||(t.onclick=Es));else if(M!==4&&(e=e.child,e!==null))for(Gl(e,t,c),e=e.sibling;e!==null;)Gl(e,t,c),e=e.sibling}function Vl(e,t,c){var M=e.tag;if(M===5||M===6)e=e.stateNode,t?c.insertBefore(e,t):c.appendChild(e);else if(M!==4&&(e=e.child,e!==null))for(Vl(e,t,c),e=e.sibling;e!==null;)Vl(e,t,c),e=e.sibling}var br=null,ci=!1;function vn(e,t,c){for(c=c.child;c!==null;)lc(e,t,c),c=c.sibling}function lc(e,t,c){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(Jn,c)}catch{}switch(c.tag){case 5:jr||js(c,t);case 6:var M=br,I=ci;br=null,vn(e,t,c),br=M,ci=I,br!==null&&(ci?(e=br,c=c.stateNode,e.nodeType===8?e.parentNode.removeChild(c):e.removeChild(c)):br.removeChild(c.stateNode));break;case 18:br!==null&&(ci?(e=br,c=c.stateNode,e.nodeType===8?la(e.parentNode,c):e.nodeType===1&&la(e,c),An(e)):la(br,c.stateNode));break;case 4:M=br,I=ci,br=c.stateNode.containerInfo,ci=!0,vn(e,t,c),br=M,ci=I;break;case 0:case 11:case 14:case 15:if(!jr&&(M=c.updateQueue,M!==null&&(M=M.lastEffect,M!==null))){I=M=M.next;do{var W=I,J=W.destroy;W=W.tag,J!==void 0&&((W&2)!==0||(W&4)!==0)&&Ul(c,t,J),I=I.next}while(I!==M)}vn(e,t,c);break;case 1:if(!jr&&(js(c,t),M=c.stateNode,typeof M.componentWillUnmount=="function"))try{M.props=c.memoizedProps,M.state=c.memoizedState,M.componentWillUnmount()}catch(de){lr(c,t,de)}vn(e,t,c);break;case 21:vn(e,t,c);break;case 22:c.mode&1?(jr=(M=jr)||c.memoizedState!==null,vn(e,t,c),jr=M):vn(e,t,c);break;default:vn(e,t,c)}}function uc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var c=e.stateNode;c===null&&(c=e.stateNode=new Hc),t.forEach(function(M){var I=td.bind(null,e,M);c.has(M)||(c.add(M),M.then(I,I))})}}function di(e,t){var c=t.deletions;if(c!==null)for(var M=0;M<c.length;M++){var I=c[M];try{var W=e,J=t,de=J;e:for(;de!==null;){switch(de.tag){case 5:br=de.stateNode,ci=!1;break e;case 3:br=de.stateNode.containerInfo,ci=!0;break e;case 4:br=de.stateNode.containerInfo,ci=!0;break e}de=de.return}if(br===null)throw Error(n(160));lc(W,J,I),br=null,ci=!1;var ve=I.alternate;ve!==null&&(ve.return=null),I.return=null}catch(Fe){lr(I,t,Fe)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cc(t,e),t=t.sibling}function cc(e,t){var c=e.alternate,M=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(di(t,e),Ci(e),M&4){try{Ea(3,e,e.return),yo(3,e)}catch(pt){lr(e,e.return,pt)}try{Ea(5,e,e.return)}catch(pt){lr(e,e.return,pt)}}break;case 1:di(t,e),Ci(e),M&512&&c!==null&&js(c,c.return);break;case 5:if(di(t,e),Ci(e),M&512&&c!==null&&js(c,c.return),e.flags&32){var I=e.stateNode;try{Se(I,"")}catch(pt){lr(e,e.return,pt)}}if(M&4&&(I=e.stateNode,I!=null)){var W=e.memoizedProps,J=c!==null?c.memoizedProps:W,de=e.type,ve=e.updateQueue;if(e.updateQueue=null,ve!==null)try{de==="input"&&W.type==="radio"&&W.name!=null&&Ge(I,W),Ue(de,J);var Fe=Ue(de,W);for(J=0;J<ve.length;J+=2){var et=ve[J],it=ve[J+1];et==="style"?Z(I,it):et==="dangerouslySetInnerHTML"?se(I,it):et==="children"?Se(I,it):g(I,et,it,Fe)}switch(de){case"input":Je(I,W);break;case"textarea":We(I,W);break;case"select":var Qe=I._wrapperState.wasMultiple;I._wrapperState.wasMultiple=!!W.multiple;var dt=W.value;dt!=null?Ve(I,!!W.multiple,dt,!1):Qe!==!!W.multiple&&(W.defaultValue!=null?Ve(I,!!W.multiple,W.defaultValue,!0):Ve(I,!!W.multiple,W.multiple?[]:"",!1))}I[zn]=W}catch(pt){lr(e,e.return,pt)}}break;case 6:if(di(t,e),Ci(e),M&4){if(e.stateNode===null)throw Error(n(162));I=e.stateNode,W=e.memoizedProps;try{I.nodeValue=W}catch(pt){lr(e,e.return,pt)}}break;case 3:if(di(t,e),Ci(e),M&4&&c!==null&&c.memoizedState.isDehydrated)try{An(t.containerInfo)}catch(pt){lr(e,e.return,pt)}break;case 4:di(t,e),Ci(e);break;case 13:di(t,e),Ci(e),I=e.child,I.flags&8192&&(W=I.memoizedState!==null,I.stateNode.isHidden=W,!W||I.alternate!==null&&I.alternate.memoizedState!==null||($l=er())),M&4&&uc(e);break;case 22:if(et=c!==null&&c.memoizedState!==null,e.mode&1?(jr=(Fe=jr)||et,di(t,e),jr=Fe):di(t,e),Ci(e),M&8192){if(Fe=e.memoizedState!==null,(e.stateNode.isHidden=Fe)&&!et&&(e.mode&1)!==0)for(ft=e,et=e.child;et!==null;){for(it=ft=et;ft!==null;){switch(Qe=ft,dt=Qe.child,Qe.tag){case 0:case 11:case 14:case 15:Ea(4,Qe,Qe.return);break;case 1:js(Qe,Qe.return);var mt=Qe.stateNode;if(typeof mt.componentWillUnmount=="function"){M=Qe,c=Qe.return;try{t=M,mt.props=t.memoizedProps,mt.state=t.memoizedState,mt.componentWillUnmount()}catch(pt){lr(M,c,pt)}}break;case 5:js(Qe,Qe.return);break;case 22:if(Qe.memoizedState!==null){fc(it);continue}}dt!==null?(dt.return=Qe,ft=dt):fc(it)}et=et.sibling}e:for(et=null,it=e;;){if(it.tag===5){if(et===null){et=it;try{I=it.stateNode,Fe?(W=I.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none"):(de=it.stateNode,ve=it.memoizedProps.style,J=ve!=null&&ve.hasOwnProperty("display")?ve.display:null,de.style.display=Be("display",J))}catch(pt){lr(e,e.return,pt)}}}else if(it.tag===6){if(et===null)try{it.stateNode.nodeValue=Fe?"":it.memoizedProps}catch(pt){lr(e,e.return,pt)}}else if((it.tag!==22&&it.tag!==23||it.memoizedState===null||it===e)&&it.child!==null){it.child.return=it,it=it.child;continue}if(it===e)break e;for(;it.sibling===null;){if(it.return===null||it.return===e)break e;et===it&&(et=null),it=it.return}et===it&&(et=null),it.sibling.return=it.return,it=it.sibling}}break;case 19:di(t,e),Ci(e),M&4&&uc(e);break;case 21:break;default:di(t,e),Ci(e)}}function Ci(e){var t=e.flags;if(t&2){try{e:{for(var c=e.return;c!==null;){if(ac(c)){var M=c;break e}c=c.return}throw Error(n(160))}switch(M.tag){case 5:var I=M.stateNode;M.flags&32&&(Se(I,""),M.flags&=-33);var W=oc(e);Vl(e,W,I);break;case 3:case 4:var J=M.stateNode.containerInfo,de=oc(e);Gl(e,de,J);break;default:throw Error(n(161))}}catch(ve){lr(e,e.return,ve)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $c(e,t,c){ft=e,dc(e)}function dc(e,t,c){for(var M=(e.mode&1)!==0;ft!==null;){var I=ft,W=I.child;if(I.tag===22&&M){var J=I.memoizedState!==null||vo;if(!J){var de=I.alternate,ve=de!==null&&de.memoizedState!==null||jr;de=vo;var Fe=jr;if(vo=J,(jr=ve)&&!Fe)for(ft=I;ft!==null;)J=ft,ve=J.child,J.tag===22&&J.memoizedState!==null?mc(I):ve!==null?(ve.return=J,ft=ve):mc(I);for(;W!==null;)ft=W,dc(W),W=W.sibling;ft=I,vo=de,jr=Fe}hc(e)}else(I.subtreeFlags&8772)!==0&&W!==null?(W.return=I,ft=W):hc(e)}}function hc(e){for(;ft!==null;){var t=ft;if((t.flags&8772)!==0){var c=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:jr||yo(5,t);break;case 1:var M=t.stateNode;if(t.flags&4&&!jr)if(c===null)M.componentDidMount();else{var I=t.elementType===t.type?c.memoizedProps:ui(t.type,c.memoizedProps);M.componentDidUpdate(I,c.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var W=t.updateQueue;W!==null&&fu(t,W,M);break;case 3:var J=t.updateQueue;if(J!==null){if(c=null,t.child!==null)switch(t.child.tag){case 5:c=t.child.stateNode;break;case 1:c=t.child.stateNode}fu(t,J,c)}break;case 5:var de=t.stateNode;if(c===null&&t.flags&4){c=de;var ve=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":ve.autoFocus&&c.focus();break;case"img":ve.src&&(c.src=ve.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var Fe=t.alternate;if(Fe!==null){var et=Fe.memoizedState;if(et!==null){var it=et.dehydrated;it!==null&&An(it)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}jr||t.flags&512&&Wl(t)}catch(Qe){lr(t,t.return,Qe)}}if(t===e){ft=null;break}if(c=t.sibling,c!==null){c.return=t.return,ft=c;break}ft=t.return}}function fc(e){for(;ft!==null;){var t=ft;if(t===e){ft=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ft=c;break}ft=t.return}}function mc(e){for(;ft!==null;){var t=ft;try{switch(t.tag){case 0:case 11:case 15:var c=t.return;try{yo(4,t)}catch(ve){lr(t,c,ve)}break;case 1:var M=t.stateNode;if(typeof M.componentDidMount=="function"){var I=t.return;try{M.componentDidMount()}catch(ve){lr(t,I,ve)}}var W=t.return;try{Wl(t)}catch(ve){lr(t,W,ve)}break;case 5:var J=t.return;try{Wl(t)}catch(ve){lr(t,J,ve)}}}catch(ve){lr(t,t.return,ve)}if(t===e){ft=null;break}var de=t.sibling;if(de!==null){de.return=t.return,ft=de;break}ft=t.return}}var Yc=Math.ceil,_o=y.ReactCurrentDispatcher,Hl=y.ReactCurrentOwner,Jr=y.ReactCurrentBatchConfig,Gt=0,yr=null,hr=null,Er=0,Vr=0,Ds=_i(0),pr=0,wa=null,Vn=0,bo=0,Kl=0,Ca=null,Br=null,$l=0,Os=1/0,Gi=null,Eo=!1,Yl=null,yn=null,wo=!1,_n=null,Co=0,Ra=0,Xl=null,Ro=-1,So=0;function Ir(){return(Gt&6)!==0?er():Ro!==-1?Ro:Ro=er()}function bn(e){return(e.mode&1)===0?1:(Gt&2)!==0&&Er!==0?Er&-Er:Et.transition!==null?(So===0&&(So=Ai()),So):(e=Kt,e!==0||(e=window.event,e=e===void 0?16:Oa(e.type)),e)}function hi(e,t,c,M){if(50<Ra)throw Ra=0,Xl=null,Error(n(185));Kr(e,c,M),((Gt&2)===0||e!==yr)&&(e===yr&&((Gt&2)===0&&(bo|=c),pr===4&&En(e,Er)),Ur(e,M),c===1&&Gt===0&&(t.mode&1)===0&&(Os=er()+500,Bn&&li()))}function Ur(e,t){var c=e.callbackNode;Rn(e,t);var M=Xi(e,e===yr?Er:0);if(M===0)c!==null&&dr(c),e.callbackNode=null,e.callbackPriority=0;else if(t=M&-M,e.callbackPriority!==t){if(c!=null&&dr(c),t===1)e.tag===0?so(gc.bind(null,e)):ha(gc.bind(null,e)),cl(function(){(Gt&6)===0&&li()}),c=null;else{switch(ri(M)){case 1:c=Hi;break;case 4:c=Zn;break;case 16:c=Qn;break;case 536870912:c=Aa;break;default:c=Qn}c=Cc(c,pc.bind(null,e))}e.callbackPriority=t,e.callbackNode=c}}function pc(e,t){if(Ro=-1,So=0,(Gt&6)!==0)throw Error(n(327));var c=e.callbackNode;if(Ps()&&e.callbackNode!==c)return null;var M=Xi(e,e===yr?Er:0);if(M===0)return null;if((M&30)!==0||(M&e.expiredLanes)!==0||t)t=Ao(e,M);else{t=M;var I=Gt;Gt|=2;var W=vc();(yr!==e||Er!==t)&&(Gi=null,Os=er()+500,Kn(e,t));do try{Qc();break}catch(de){xc(e,de)}while(!0);fl(),_o.current=W,Gt=I,hr!==null?t=0:(yr=null,Er=0,t=pr)}if(t!==0){if(t===2&&(I=fr(e),I!==0&&(M=I,t=Zl(e,I))),t===1)throw c=wa,Kn(e,0),En(e,M),Ur(e,er()),c;if(t===6)En(e,M);else{if(I=e.current.alternate,(M&30)===0&&!Xc(I)&&(t=Ao(e,M),t===2&&(W=fr(e),W!==0&&(M=W,t=Zl(e,W))),t===1))throw c=wa,Kn(e,0),En(e,M),Ur(e,er()),c;switch(e.finishedWork=I,e.finishedLanes=M,t){case 0:case 1:throw Error(n(345));case 2:$n(e,Br,Gi);break;case 3:if(En(e,M),(M&130023424)===M&&(t=$l+500-er(),10<t)){if(Xi(e,0)!==0)break;if(I=e.suspendedLanes,(I&M)!==M){Ir(),e.pingedLanes|=e.suspendedLanes&I;break}e.timeoutHandle=oa($n.bind(null,e,Br,Gi),t);break}$n(e,Br,Gi);break;case 4:if(En(e,M),(M&4194240)===M)break;for(t=e.eventTimes,I=-1;0<M;){var J=31-ar(M);W=1<<J,J=t[J],J>I&&(I=J),M&=~W}if(M=I,M=er()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*Yc(M/1960))-M,10<M){e.timeoutHandle=oa($n.bind(null,e,Br,Gi),M);break}$n(e,Br,Gi);break;case 5:$n(e,Br,Gi);break;default:throw Error(n(329))}}}return Ur(e,er()),e.callbackNode===c?pc.bind(null,e):null}function Zl(e,t){var c=Ca;return e.current.memoizedState.isDehydrated&&(Kn(e,t).flags|=256),e=Ao(e,t),e!==2&&(t=Br,Br=c,t!==null&&Ql(t)),e}function Ql(e){Br===null?Br=e:Br.push.apply(Br,e)}function Xc(e){for(var t=e;;){if(t.flags&16384){var c=t.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var M=0;M<c.length;M++){var I=c[M],W=I.getSnapshot;I=I.value;try{if(!Nr(W(),I))return!1}catch{return!1}}}if(c=t.child,t.subtreeFlags&16384&&c!==null)c.return=t,t=c;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function En(e,t){for(t&=~Kl,t&=~bo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var c=31-ar(t),M=1<<c;e[c]=-1,t&=~M}}function gc(e){if((Gt&6)!==0)throw Error(n(327));Ps();var t=Xi(e,0);if((t&1)===0)return Ur(e,er()),null;var c=Ao(e,t);if(e.tag!==0&&c===2){var M=fr(e);M!==0&&(t=M,c=Zl(e,M))}if(c===1)throw c=wa,Kn(e,0),En(e,t),Ur(e,er()),c;if(c===6)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$n(e,Br,Gi),Ur(e,er()),null}function Jl(e,t){var c=Gt;Gt|=1;try{return e(t)}finally{Gt=c,Gt===0&&(Os=er()+500,Bn&&li())}}function Hn(e){_n!==null&&_n.tag===0&&(Gt&6)===0&&Ps();var t=Gt;Gt|=1;var c=Jr.transition,M=Kt;try{if(Jr.transition=null,Kt=1,e)return e()}finally{Kt=M,Jr.transition=c,Gt=t,(Gt&6)===0&&li()}}function ql(){Vr=Ds.current,qt(Ds)}function Kn(e,t){e.finishedWork=null,e.finishedLanes=0;var c=e.timeoutHandle;if(c!==-1&&(e.timeoutHandle=-1,ul(c)),hr!==null)for(c=hr.return;c!==null;){var M=c;switch(ye(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&ws();break;case 3:Ls(),qt(Ar),qt(xr),bl();break;case 5:yl(M);break;case 4:Ls();break;case 13:qt(nr);break;case 19:qt(nr);break;case 10:ml(M.type._context);break;case 22:case 23:ql()}c=c.return}if(yr=e,hr=e=wn(e.current,null),Er=Vr=t,pr=0,wa=null,Kl=bo=Vn=0,Br=Ca=null,Un!==null){for(t=0;t<Un.length;t++)if(c=Un[t],M=c.interleaved,M!==null){c.interleaved=null;var I=M.next,W=c.pending;if(W!==null){var J=W.next;W.next=I,M.next=J}c.pending=M}Un=null}return e}function xc(e,t){do{var c=hr;try{if(fl(),uo.current=mo,co){for(var M=sr.memoizedState;M!==null;){var I=M.queue;I!==null&&(I.pending=null),M=M.next}co=!1}if(Gn=0,vr=mr=sr=null,xa=!1,va=0,Hl.current=null,c===null||c.return===null){pr=1,wa=t,hr=null;break}e:{var W=e,J=c.return,de=c,ve=t;if(t=Er,de.flags|=32768,ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var Fe=ve,et=de,it=et.tag;if((et.mode&1)===0&&(it===0||it===11||it===15)){var Qe=et.alternate;Qe?(et.updateQueue=Qe.updateQueue,et.memoizedState=Qe.memoizedState,et.lanes=Qe.lanes):(et.updateQueue=null,et.memoizedState=null)}var dt=Wu(J);if(dt!==null){dt.flags&=-257,Gu(dt,J,de,W,t),dt.mode&1&&Uu(W,Fe,t),t=dt,ve=Fe;var mt=t.updateQueue;if(mt===null){var pt=new Set;pt.add(ve),t.updateQueue=pt}else mt.add(ve);break e}else{if((t&1)===0){Uu(W,Fe,t),eu();break e}ve=Error(n(426))}}else if(st&&de.mode&1){var ur=Wu(J);if(ur!==null){(ur.flags&65536)===0&&(ur.flags|=256),Gu(ur,J,de,W,t),or(Ts(ve,de));break e}}W=ve=Ts(ve,de),pr!==4&&(pr=2),Ca===null?Ca=[W]:Ca.push(W),W=J;do{switch(W.tag){case 3:W.flags|=65536,t&=-t,W.lanes|=t;var De=Fu(W,ve,t);hu(W,De);break e;case 1:de=ve;var Ee=W.type,Ie=W.stateNode;if((W.flags&128)===0&&(typeof Ee.getDerivedStateFromError=="function"||Ie!==null&&typeof Ie.componentDidCatch=="function"&&(yn===null||!yn.has(Ie)))){W.flags|=65536,t&=-t,W.lanes|=t;var lt=Bu(W,de,t);hu(W,lt);break e}}W=W.return}while(W!==null)}_c(c)}catch(gt){t=gt,hr===c&&c!==null&&(hr=c=c.return);continue}break}while(!0)}function vc(){var e=_o.current;return _o.current=mo,e===null?mo:e}function eu(){(pr===0||pr===3||pr===2)&&(pr=4),yr===null||(Vn&268435455)===0&&(bo&268435455)===0||En(yr,Er)}function Ao(e,t){var c=Gt;Gt|=2;var M=vc();(yr!==e||Er!==t)&&(Gi=null,Kn(e,t));do try{Zc();break}catch(I){xc(e,I)}while(!0);if(fl(),Gt=c,_o.current=M,hr!==null)throw Error(n(261));return yr=null,Er=0,pr}function Zc(){for(;hr!==null;)yc(hr)}function Qc(){for(;hr!==null&&!Hr();)yc(hr)}function yc(e){var t=wc(e.alternate,e,Vr);e.memoizedProps=e.pendingProps,t===null?_c(e):hr=t,Hl.current=null}function _c(e){var t=e;do{var c=t.alternate;if(e=t.return,(t.flags&32768)===0){if(c=Gc(c,t,Vr),c!==null){hr=c;return}}else{if(c=Vc(c,t),c!==null){c.flags&=32767,hr=c;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pr=6,hr=null;return}}if(t=t.sibling,t!==null){hr=t;return}hr=t=e}while(t!==null);pr===0&&(pr=5)}function $n(e,t,c){var M=Kt,I=Jr.transition;try{Jr.transition=null,Kt=1,Jc(e,t,c,M)}finally{Jr.transition=I,Kt=M}return null}function Jc(e,t,c,M){do Ps();while(_n!==null);if((Gt&6)!==0)throw Error(n(327));c=e.finishedWork;var I=e.finishedLanes;if(c===null)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var W=c.lanes|c.childLanes;if(zo(e,W),e===yr&&(hr=yr=null,Er=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||wo||(wo=!0,Cc(Qn,function(){return Ps(),null})),W=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||W){W=Jr.transition,Jr.transition=null;var J=Kt;Kt=1;var de=Gt;Gt|=4,Hl.current=null,Kc(e,c),cc(c,e),Xs(sa),es=!!na,sa=na=null,e.current=c,$c(c),Vi(),Gt=de,Kt=J,Jr.transition=W}else e.current=c;if(wo&&(wo=!1,_n=e,Co=I),W=e.pendingLanes,W===0&&(yn=null),fi(c.stateNode),Ur(e,er()),t!==null)for(M=e.onRecoverableError,c=0;c<t.length;c++)I=t[c],M(I.value,{componentStack:I.stack,digest:I.digest});if(Eo)throw Eo=!1,e=Yl,Yl=null,e;return(Co&1)!==0&&e.tag!==0&&Ps(),W=e.pendingLanes,(W&1)!==0?e===Xl?Ra++:(Ra=0,Xl=e):Ra=0,li(),null}function Ps(){if(_n!==null){var e=ri(Co),t=Jr.transition,c=Kt;try{if(Jr.transition=null,Kt=16>e?16:e,_n===null)var M=!1;else{if(e=_n,_n=null,Co=0,(Gt&6)!==0)throw Error(n(331));var I=Gt;for(Gt|=4,ft=e.current;ft!==null;){var W=ft,J=W.child;if((ft.flags&16)!==0){var de=W.deletions;if(de!==null){for(var ve=0;ve<de.length;ve++){var Fe=de[ve];for(ft=Fe;ft!==null;){var et=ft;switch(et.tag){case 0:case 11:case 15:Ea(8,et,W)}var it=et.child;if(it!==null)it.return=et,ft=it;else for(;ft!==null;){et=ft;var Qe=et.sibling,dt=et.return;if(sc(et),et===Fe){ft=null;break}if(Qe!==null){Qe.return=dt,ft=Qe;break}ft=dt}}}var mt=W.alternate;if(mt!==null){var pt=mt.child;if(pt!==null){mt.child=null;do{var ur=pt.sibling;pt.sibling=null,pt=ur}while(pt!==null)}}ft=W}}if((W.subtreeFlags&2064)!==0&&J!==null)J.return=W,ft=J;else e:for(;ft!==null;){if(W=ft,(W.flags&2048)!==0)switch(W.tag){case 0:case 11:case 15:Ea(9,W,W.return)}var De=W.sibling;if(De!==null){De.return=W.return,ft=De;break e}ft=W.return}}var Ee=e.current;for(ft=Ee;ft!==null;){J=ft;var Ie=J.child;if((J.subtreeFlags&2064)!==0&&Ie!==null)Ie.return=J,ft=Ie;else e:for(J=Ee;ft!==null;){if(de=ft,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:yo(9,de)}}catch(gt){lr(de,de.return,gt)}if(de===J){ft=null;break e}var lt=de.sibling;if(lt!==null){lt.return=de.return,ft=lt;break e}ft=de.return}}if(Gt=I,li(),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(Jn,e)}catch{}M=!0}return M}finally{Kt=c,Jr.transition=t}}return!1}function bc(e,t,c){t=Ts(c,t),t=Fu(e,t,1),e=xn(e,t,1),t=Ir(),e!==null&&(Kr(e,1,t),Ur(e,t))}function lr(e,t,c){if(e.tag===3)bc(e,e,c);else for(;t!==null;){if(t.tag===3){bc(t,e,c);break}else if(t.tag===1){var M=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(yn===null||!yn.has(M))){e=Ts(c,e),e=Bu(t,e,1),t=xn(t,e,1),e=Ir(),t!==null&&(Kr(t,1,e),Ur(t,e));break}}t=t.return}}function qc(e,t,c){var M=e.pingCache;M!==null&&M.delete(t),t=Ir(),e.pingedLanes|=e.suspendedLanes&c,yr===e&&(Er&c)===c&&(pr===4||pr===3&&(Er&130023424)===Er&&500>er()-$l?Kn(e,0):Kl|=c),Ur(e,t)}function Ec(e,t){t===0&&((e.mode&1)===0?t=1:(t=Yi,Yi<<=1,(Yi&130023424)===0&&(Yi=4194304)));var c=Ir();e=Bi(e,t),e!==null&&(Kr(e,t,c),Ur(e,c))}function ed(e){var t=e.memoizedState,c=0;t!==null&&(c=t.retryLane),Ec(e,c)}function td(e,t){var c=0;switch(e.tag){case 13:var M=e.stateNode,I=e.memoizedState;I!==null&&(c=I.retryLane);break;case 19:M=e.stateNode;break;default:throw Error(n(314))}M!==null&&M.delete(t),Ec(e,c)}var wc;wc=function(e,t,c){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ar.current)Fr=!0;else{if((e.lanes&c)===0&&(t.flags&128)===0)return Fr=!1,Wc(e,t,c);Fr=(e.flags&131072)!==0}else Fr=!1,st&&(t.flags&1048576)!==0&&Re(t,_,t.index);switch(t.lanes=0,t.tag){case 2:var M=t.type;xo(e,t),e=t.pendingProps;var I=pn(t,xr.current);Ms(t,c),I=Cl(null,t,M,e,I,c);var W=Rl();return t.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mr(M)?(W=!0,Cs(t)):W=!1,t.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,xl(t),I.updater=po,t.stateNode=I,I._reactInternals=t,jl(t,M,e,c),t=kl(null,t,M,!0,W,c)):(t.tag=0,st&&W&&ht(t),kr(null,t,I,c),t=t.child),t;case 16:M=t.elementType;e:{switch(xo(e,t),e=t.pendingProps,I=M._init,M=I(M._payload),t.type=M,I=t.tag=id(M),e=ui(M,e),I){case 0:t=Pl(null,t,M,e,c);break e;case 1:t=Xu(null,t,M,e,c);break e;case 11:t=Vu(null,t,M,e,c);break e;case 14:t=Hu(null,t,M,ui(M.type,e),c);break e}throw Error(n(306,M,""))}return t;case 0:return M=t.type,I=t.pendingProps,I=t.elementType===M?I:ui(M,I),Pl(e,t,M,I,c);case 1:return M=t.type,I=t.pendingProps,I=t.elementType===M?I:ui(M,I),Xu(e,t,M,I,c);case 3:e:{if(Zu(t),e===null)throw Error(n(387));M=t.pendingProps,W=t.memoizedState,I=W.element,du(e,t),oo(t,M,null,c);var J=t.memoizedState;if(M=J.element,W.isDehydrated)if(W={element:M,isDehydrated:!1,cache:J.cache,pendingSuspenseBoundaries:J.pendingSuspenseBoundaries,transitions:J.transitions},t.updateQueue.baseState=W,t.memoizedState=W,t.flags&256){I=Ts(Error(n(423)),t),t=Qu(e,t,M,c,I);break e}else if(M!==I){I=Ts(Error(n(424)),t),t=Qu(e,t,M,c,I);break e}else for(Tt=gr(t.stateNode.containerInfo.firstChild),je=t,st=!0,Xe=null,c=fa(t,null,M,c),t.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(zt(),M===I){t=Wi(e,t,c);break e}kr(e,t,M,c)}t=t.child}return t;case 5:return mu(t),e===null&&Ot(t),M=t.type,I=t.pendingProps,W=e!==null?e.memoizedProps:null,J=I.children,aa(M,I)?J=null:W!==null&&aa(M,W)&&(t.flags|=32),Yu(e,t),kr(e,t,J,c),t.child;case 6:return e===null&&Ot(t),null;case 13:return Ju(e,t,c);case 4:return vl(t,t.stateNode.containerInfo),M=t.pendingProps,e===null?t.child=zr(t,null,M,c):kr(e,t,M,c),t.child;case 11:return M=t.type,I=t.pendingProps,I=t.elementType===M?I:ui(M,I),Vu(e,t,M,I,c);case 7:return kr(e,t,t.pendingProps,c),t.child;case 8:return kr(e,t,t.pendingProps.children,c),t.child;case 12:return kr(e,t,t.pendingProps.children,c),t.child;case 10:e:{if(M=t.type._context,I=t.pendingProps,W=t.memoizedProps,J=I.value,Qt(zi,M._currentValue),M._currentValue=J,W!==null)if(Nr(W.value,J)){if(W.children===I.children&&!Ar.current){t=Wi(e,t,c);break e}}else for(W=t.child,W!==null&&(W.return=t);W!==null;){var de=W.dependencies;if(de!==null){J=W.child;for(var ve=de.firstContext;ve!==null;){if(ve.context===M){if(W.tag===1){ve=Ui(-1,c&-c),ve.tag=2;var Fe=W.updateQueue;if(Fe!==null){Fe=Fe.shared;var et=Fe.pending;et===null?ve.next=ve:(ve.next=et.next,et.next=ve),Fe.pending=ve}}W.lanes|=c,ve=W.alternate,ve!==null&&(ve.lanes|=c),pl(W.return,c,t),de.lanes|=c;break}ve=ve.next}}else if(W.tag===10)J=W.type===t.type?null:W.child;else if(W.tag===18){if(J=W.return,J===null)throw Error(n(341));J.lanes|=c,de=J.alternate,de!==null&&(de.lanes|=c),pl(J,c,t),J=W.sibling}else J=W.child;if(J!==null)J.return=W;else for(J=W;J!==null;){if(J===t){J=null;break}if(W=J.sibling,W!==null){W.return=J.return,J=W;break}J=J.return}W=J}kr(e,t,I.children,c),t=t.child}return t;case 9:return I=t.type,M=t.pendingProps.children,Ms(t,c),I=Zr(I),M=M(I),t.flags|=1,kr(e,t,M,c),t.child;case 14:return M=t.type,I=ui(M,t.pendingProps),I=ui(M.type,I),Hu(e,t,M,I,c);case 15:return Ku(e,t,t.type,t.pendingProps,c);case 17:return M=t.type,I=t.pendingProps,I=t.elementType===M?I:ui(M,I),xo(e,t),t.tag=1,Mr(M)?(e=!0,Cs(t)):e=!1,Ms(t,c),Nu(t,M,I),jl(t,M,I,c),kl(null,t,M,!0,e,c);case 19:return ec(e,t,c);case 22:return $u(e,t,c)}throw Error(n(156,t.tag))};function Cc(e,t){return cr(e,t)}function rd(e,t,c,M){this.tag=e,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(e,t,c,M){return new rd(e,t,c,M)}function tu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function id(e){if(typeof e=="function")return tu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===F)return 11;if(e===U)return 14}return 2}function wn(e,t){var c=e.alternate;return c===null?(c=qr(e.tag,t,e.key,e.mode),c.elementType=e.elementType,c.type=e.type,c.stateNode=e.stateNode,c.alternate=e,e.alternate=c):(c.pendingProps=t,c.type=e.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=e.flags&14680064,c.childLanes=e.childLanes,c.lanes=e.lanes,c.child=e.child,c.memoizedProps=e.memoizedProps,c.memoizedState=e.memoizedState,c.updateQueue=e.updateQueue,t=e.dependencies,c.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},c.sibling=e.sibling,c.index=e.index,c.ref=e.ref,c}function Mo(e,t,c,M,I,W){var J=2;if(M=e,typeof e=="function")tu(e)&&(J=1);else if(typeof e=="string")J=5;else e:switch(e){case f:return Yn(c.children,I,W,t);case m:J=8,I|=8;break;case C:return e=qr(12,c,t,I|2),e.elementType=C,e.lanes=W,e;case N:return e=qr(13,c,t,I),e.elementType=N,e.lanes=W,e;case B:return e=qr(19,c,t,I),e.elementType=B,e.lanes=W,e;case H:return Lo(c,I,W,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:J=10;break e;case P:J=9;break e;case F:J=11;break e;case U:J=14;break e;case K:J=16,M=null;break e}throw Error(n(130,e==null?e:typeof e,""))}return t=qr(J,c,t,I),t.elementType=e,t.type=M,t.lanes=W,t}function Yn(e,t,c,M){return e=qr(7,e,M,t),e.lanes=c,e}function Lo(e,t,c,M){return e=qr(22,e,M,t),e.elementType=H,e.lanes=c,e.stateNode={isHidden:!1},e}function ru(e,t,c){return e=qr(6,e,null,t),e.lanes=c,e}function iu(e,t,c){return t=qr(4,e.children!==null?e.children:[],e.key,t),t.lanes=c,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function nd(e,t,c,M,I){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ei(0),this.expirationTimes=ei(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ei(0),this.identifierPrefix=M,this.onRecoverableError=I,this.mutableSourceEagerHydrationData=null}function nu(e,t,c,M,I,W,J,de,ve){return e=new nd(e,t,c,de,ve),t===1?(t=1,W===!0&&(t|=8)):t=0,W=qr(3,null,null,t),e.current=W,W.stateNode=e,W.memoizedState={element:M,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},xl(W),e}function sd(e,t,c){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:M==null?null:""+M,children:e,containerInfo:t,implementation:c}}function Rc(e){if(!e)return bi;e=e._reactInternals;e:{if(Rt(e)!==e||e.tag!==1)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(n(171))}if(e.tag===1){var c=e.type;if(Mr(c))return no(e,c,t)}return t}function Sc(e,t,c,M,I,W,J,de,ve){return e=nu(c,M,!0,e,I,W,J,de,ve),e.context=Rc(null),c=e.current,M=Ir(),I=bn(c),W=Ui(M,I),W.callback=t??null,xn(c,W,I),e.current.lanes=I,Kr(e,I,M),Ur(e,M),e}function To(e,t,c,M){var I=t.current,W=Ir(),J=bn(I);return c=Rc(c),t.context===null?t.context=c:t.pendingContext=c,t=Ui(W,J),t.payload={element:e},M=M===void 0?null:M,M!==null&&(t.callback=M),e=xn(I,t,J),e!==null&&(hi(e,I,J,W),ao(e,I,J)),J}function jo(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function Ac(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var c=e.retryLane;e.retryLane=c!==0&&c<t?c:t}}function su(e,t){Ac(e,t),(e=e.alternate)&&Ac(e,t)}function ad(){return null}var Mc=typeof reportError=="function"?reportError:function(e){console.error(e)};function au(e){this._internalRoot=e}Do.prototype.render=au.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(n(409));To(e,t,null,null)},Do.prototype.unmount=au.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hn(function(){To(null,e,null,null)}),t[oi]=null}};function Do(e){this._internalRoot=e}Do.prototype.unstable_scheduleHydration=function(e){if(e){var t=wr();e={blockedOn:null,target:e,priority:t};for(var c=0;c<Or.length&&t!==0&&t<Or[c].priority;c++);Or.splice(c,0,e),c===0&&ja(e)}};function ou(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Oo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Lc(){}function od(e,t,c,M,I){if(I){if(typeof M=="function"){var W=M;M=function(){var Fe=jo(J);W.call(Fe)}}var J=Sc(t,M,e,0,null,!1,!1,"",Lc);return e._reactRootContainer=J,e[oi]=J.current,ln(e.nodeType===8?e.parentNode:e),Hn(),J}for(;I=e.lastChild;)e.removeChild(I);if(typeof M=="function"){var de=M;M=function(){var Fe=jo(ve);de.call(Fe)}}var ve=nu(e,0,!1,null,null,!1,!1,"",Lc);return e._reactRootContainer=ve,e[oi]=ve.current,ln(e.nodeType===8?e.parentNode:e),Hn(function(){To(t,ve,c,M)}),ve}function Po(e,t,c,M,I){var W=c._reactRootContainer;if(W){var J=W;if(typeof I=="function"){var de=I;I=function(){var ve=jo(J);de.call(ve)}}To(t,J,e,I)}else J=od(c,t,e,I,M);return jo(J)}Ma=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var c=Ri(t.pendingLanes);c!==0&&(ti(t,c|1),Ur(t,er()),(Gt&6)===0&&(Os=er()+500,li()))}break;case 13:Hn(function(){var M=Bi(e,1);if(M!==null){var I=Ir();hi(M,e,1,I)}}),su(e,1)}},La=function(e){if(e.tag===13){var t=Bi(e,134217728);if(t!==null){var c=Ir();hi(t,e,134217728,c)}su(e,134217728)}},ii=function(e){if(e.tag===13){var t=bn(e),c=Bi(e,t);if(c!==null){var M=Ir();hi(c,e,t,M)}su(e,t)}},wr=function(){return Kt},Cr=function(e,t){var c=Kt;try{return Kt=e,t()}finally{Kt=c}},Q=function(e,t,c){switch(t){case"input":if(Je(e,c),t=c.name,c.type==="radio"&&t!=null){for(c=e;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<c.length;t++){var M=c[t];if(M!==e&&M.form===e.form){var I=yi(M);if(!I)throw Error(n(90));$e(M),Je(M,I)}}}break;case"textarea":We(e,c);break;case"select":t=c.value,t!=null&&Ve(e,!!c.multiple,t,!1)}},ee=Jl,me=Hn;var ld={usingClientEntryPoint:!1,Events:[hn,fn,yi,be,_e,Jl]},Sa={findFiberByHostInstance:Pi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ud={bundleType:Sa.bundleType,version:Sa.version,rendererPackageName:Sa.rendererPackageName,rendererConfig:Sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Yt(e),e===null?null:e.stateNode},findFiberByHostInstance:Sa.findFiberByHostInstance||ad,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ko=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ko.isDisabled&&ko.supportsFiber)try{Jn=ko.inject(ud),Lt=ko}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ld,reactDom_production_min.createPortal=function(e,t){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ou(t))throw Error(n(200));return sd(e,t,null,c)},reactDom_production_min.createRoot=function(e,t){if(!ou(e))throw Error(n(299));var c=!1,M="",I=Mc;return t!=null&&(t.unstable_strictMode===!0&&(c=!0),t.identifierPrefix!==void 0&&(M=t.identifierPrefix),t.onRecoverableError!==void 0&&(I=t.onRecoverableError)),t=nu(e,1,!1,null,null,c,!1,M,I),e[oi]=t.current,ln(e.nodeType===8?e.parentNode:e),new au(t)},reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(n(188)):(e=Object.keys(e).join(","),Error(n(268,e)));return e=Yt(t),e=e===null?null:e.stateNode,e},reactDom_production_min.flushSync=function(e){return Hn(e)},reactDom_production_min.hydrate=function(e,t,c){if(!Oo(t))throw Error(n(200));return Po(null,e,t,!0,c)},reactDom_production_min.hydrateRoot=function(e,t,c){if(!ou(e))throw Error(n(405));var M=c!=null&&c.hydratedSources||null,I=!1,W="",J=Mc;if(c!=null&&(c.unstable_strictMode===!0&&(I=!0),c.identifierPrefix!==void 0&&(W=c.identifierPrefix),c.onRecoverableError!==void 0&&(J=c.onRecoverableError)),t=Sc(t,null,e,1,c??null,I,!1,W,J),e[oi]=t.current,ln(e),M)for(e=0;e<M.length;e++)c=M[e],I=c._getVersion,I=I(c._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[c,I]:t.mutableSourceEagerHydrationData.push(c,I);return new Do(t)},reactDom_production_min.render=function(e,t,c){if(!Oo(t))throw Error(n(200));return Po(null,e,t,!1,c)},reactDom_production_min.unmountComponentAtNode=function(e){if(!Oo(e))throw Error(n(40));return e._reactRootContainer?(Hn(function(){Po(null,null,e,!1,function(){e._reactRootContainer=null,e[oi]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Jl,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,t,c,M){if(!Oo(c))throw Error(n(200));if(e==null||e._reactInternals===void 0)throw Error(n(38));return Po(e,t,c,!1,M)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var o=requireReactDom();return client.createRoot=o.createRoot,client.hydrateRoot=o.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(o){return this.listeners.add(o),this.onSubscribe(),()=>{this.listeners.delete(o),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},defaultTimeoutProvider={setTimeout:(o,a)=>setTimeout(o,a),clearTimeout:o=>clearTimeout(o),setInterval:(o,a)=>setInterval(o,a),clearInterval:o=>clearInterval(o)},TimeoutManager=class{#e=defaultTimeoutProvider;#t=!1;setTimeoutProvider(o){this.#e=o}setTimeout(o,a){return this.#e.setTimeout(o,a)}clearTimeout(o){this.#e.clearTimeout(o)}setInterval(o,a){return this.#e.setInterval(o,a)}clearInterval(o){this.#e.clearInterval(o)}},timeoutManager=new TimeoutManager;function systemSetTimeoutZero(o){setTimeout(o,0)}var isServer=typeof window>"u"||"Deno"in globalThis;function noop$1(){}function functionalUpdate(o,a){return typeof o=="function"?o(a):o}function isValidTimeout(o){return typeof o=="number"&&o>=0&&o!==1/0}function timeUntilStale(o,a){return Math.max(o+(a||0)-Date.now(),0)}function resolveStaleTime(o,a){return typeof o=="function"?o(a):o}function resolveEnabled(o,a){return typeof o=="function"?o(a):o}function matchQuery(o,a){const{type:n="all",exact:d,fetchStatus:R,predicate:S,queryKey:j,stale:p}=o;if(j){if(d){if(a.queryHash!==hashQueryKeyByOptions(j,a.options))return!1}else if(!partialMatchKey(a.queryKey,j))return!1}if(n!=="all"){const v=a.isActive();if(n==="active"&&!v||n==="inactive"&&v)return!1}return!(typeof p=="boolean"&&a.isStale()!==p||R&&R!==a.state.fetchStatus||S&&!S(a))}function matchMutation(o,a){const{exact:n,status:d,predicate:R,mutationKey:S}=o;if(S){if(!a.options.mutationKey)return!1;if(n){if(hashKey(a.options.mutationKey)!==hashKey(S))return!1}else if(!partialMatchKey(a.options.mutationKey,S))return!1}return!(d&&a.state.status!==d||R&&!R(a))}function hashQueryKeyByOptions(o,a){return(a?.queryKeyHashFn||hashKey)(o)}function hashKey(o){return JSON.stringify(o,(a,n)=>isPlainObject$1(n)?Object.keys(n).sort().reduce((d,R)=>(d[R]=n[R],d),{}):n)}function partialMatchKey(o,a){return o===a?!0:typeof o!=typeof a?!1:o&&a&&typeof o=="object"&&typeof a=="object"?Object.keys(a).every(n=>partialMatchKey(o[n],a[n])):!1}var hasOwn=Object.prototype.hasOwnProperty;function replaceEqualDeep(o,a,n=0){if(o===a)return o;if(n>500)return a;const d=isPlainArray(o)&&isPlainArray(a);if(!d&&!(isPlainObject$1(o)&&isPlainObject$1(a)))return a;const S=(d?o:Object.keys(o)).length,j=d?a:Object.keys(a),p=j.length,v=d?new Array(p):{};let D=0;for(let x=0;x<p;x++){const A=d?x:j[x],L=o[A],w=a[A];if(L===w){v[A]=L,(d?x<S:hasOwn.call(o,A))&&D++;continue}if(L===null||w===null||typeof L!="object"||typeof w!="object"){v[A]=w;continue}const b=replaceEqualDeep(L,w,n+1);v[A]=b,b===L&&D++}return S===p&&D===S?o:v}function shallowEqualObjects(o,a){if(!a||Object.keys(o).length!==Object.keys(a).length)return!1;for(const n in o)if(o[n]!==a[n])return!1;return!0}function isPlainArray(o){return Array.isArray(o)&&o.length===Object.keys(o).length}function isPlainObject$1(o){if(!hasObjectPrototype(o))return!1;const a=o.constructor;if(a===void 0)return!0;const n=a.prototype;return!(!hasObjectPrototype(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(o)!==Object.prototype)}function hasObjectPrototype(o){return Object.prototype.toString.call(o)==="[object Object]"}function sleep(o){return new Promise(a=>{timeoutManager.setTimeout(a,o)})}function replaceData(o,a,n){return typeof n.structuralSharing=="function"?n.structuralSharing(o,a):n.structuralSharing!==!1?replaceEqualDeep(o,a):a}function addToEnd(o,a,n=0){const d=[...o,a];return n&&d.length>n?d.slice(1):d}function addToStart(o,a,n=0){const d=[a,...o];return n&&d.length>n?d.slice(0,-1):d}var skipToken=Symbol();function ensureQueryFn(o,a){return!o.queryFn&&a?.initialPromise?()=>a.initialPromise:!o.queryFn||o.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${o.queryHash}'`)):o.queryFn}function shouldThrowError(o,a){return typeof o=="function"?o(...a):!!o}function addConsumeAwareSignal(o,a,n){let d=!1,R;return Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(R??=a(),d||(d=!0,R.aborted?n():R.addEventListener("abort",n,{once:!0})),R)}),o}var FocusManager=class extends Subscribable{#e;#t;#r;constructor(){super(),this.#r=o=>{if(!isServer&&window.addEventListener){const a=()=>o();return window.addEventListener("visibilitychange",a,!1),()=>{window.removeEventListener("visibilitychange",a)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(o){this.#r=o,this.#t?.(),this.#t=o(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()})}setFocused(o){this.#e!==o&&(this.#e=o,this.onFocus())}onFocus(){const o=this.isFocused();this.listeners.forEach(a=>{a(o)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},focusManager=new FocusManager;function pendingThenable(){let o,a;const n=new Promise((R,S)=>{o=R,a=S});n.status="pending",n.catch(()=>{});function d(R){Object.assign(n,R),delete n.resolve,delete n.reject}return n.resolve=R=>{d({status:"fulfilled",value:R}),o(R)},n.reject=R=>{d({status:"rejected",reason:R}),a(R)},n}var defaultScheduler=systemSetTimeoutZero;function createNotifyManager(){let o=[],a=0,n=p=>{p()},d=p=>{p()},R=defaultScheduler;const S=p=>{a?o.push(p):R(()=>{n(p)})},j=()=>{const p=o;o=[],p.length&&R(()=>{d(()=>{p.forEach(v=>{n(v)})})})};return{batch:p=>{let v;a++;try{v=p()}finally{a--,a||j()}return v},batchCalls:p=>(...v)=>{S(()=>{p(...v)})},schedule:S,setNotifyFunction:p=>{n=p},setBatchNotifyFunction:p=>{d=p},setScheduler:p=>{R=p}}}var notifyManager=createNotifyManager(),OnlineManager=class extends Subscribable{#e=!0;#t;#r;constructor(){super(),this.#r=o=>{if(!isServer&&window.addEventListener){const a=()=>o(!0),n=()=>o(!1);return window.addEventListener("online",a,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(o){this.#r=o,this.#t?.(),this.#t=o(this.setOnline.bind(this))}setOnline(o){this.#e!==o&&(this.#e=o,this.listeners.forEach(n=>{n(o)}))}isOnline(){return this.#e}},onlineManager=new OnlineManager;function defaultRetryDelay(o){return Math.min(1e3*2**o,3e4)}function canFetch(o){return(o??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(o){super("CancelledError"),this.revert=o?.revert,this.silent=o?.silent}};function createRetryer(o){let a=!1,n=0,d;const R=pendingThenable(),S=()=>R.status!=="pending",j=u=>{if(!S()){const i=new CancelledError(u);L(i),o.onCancel?.(i)}},p=()=>{a=!0},v=()=>{a=!1},D=()=>focusManager.isFocused()&&(o.networkMode==="always"||onlineManager.isOnline())&&o.canRun(),x=()=>canFetch(o.networkMode)&&o.canRun(),A=u=>{S()||(d?.(),R.resolve(u))},L=u=>{S()||(d?.(),R.reject(u))},w=()=>new Promise(u=>{d=i=>{(S()||D())&&u(i)},o.onPause?.()}).then(()=>{d=void 0,S()||o.onContinue?.()}),b=()=>{if(S())return;let u;const i=n===0?o.initialPromise:void 0;try{u=i??o.fn()}catch(s){u=Promise.reject(s)}Promise.resolve(u).then(A).catch(s=>{if(S())return;const h=o.retry??(isServer?0:3),g=o.retryDelay??defaultRetryDelay,y=typeof g=="function"?g(n,s):g,E=h===!0||typeof h=="number"&&n<h||typeof h=="function"&&h(n,s);if(a||!E){L(s);return}n++,o.onFail?.(n,s),sleep(y).then(()=>D()?void 0:w()).then(()=>{a?L(s):b()})})};return{promise:R,status:()=>R.status,cancel:j,continue:()=>(d?.(),R),cancelRetry:p,continueRetry:v,canStart:x,start:()=>(x()?b():w().then(b),R)}}var Removable=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&(this.#e=timeoutManager.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(o){this.gcTime=Math.max(this.gcTime||0,o??(isServer?1/0:300*1e3))}clearGcTimeout(){this.#e&&(timeoutManager.clearTimeout(this.#e),this.#e=void 0)}},Query=class extends Removable{#e;#t;#r;#n;#i;#a;#o;constructor(o){super(),this.#o=!1,this.#a=o.defaultOptions,this.setOptions(o.options),this.observers=[],this.#n=o.client,this.#r=this.#n.getQueryCache(),this.queryKey=o.queryKey,this.queryHash=o.queryHash,this.#e=getDefaultState$1(this.options),this.state=o.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#i?.promise}setOptions(o){if(this.options={...this.#a,...o},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const a=getDefaultState$1(this.options);a.data!==void 0&&(this.setState(successState(a.data,a.dataUpdatedAt)),this.#e=a)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(o,a){const n=replaceData(this.state.data,o,this.options);return this.#s({data:n,type:"success",dataUpdatedAt:a?.updatedAt,manual:a?.manual}),n}setState(o,a){this.#s({type:"setState",state:o,setStateOptions:a})}cancel(o){const a=this.#i?.promise;return this.#i?.cancel(o),a?a.then(noop$1).catch(noop$1):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(o=>resolveEnabled(o.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(o=>resolveStaleTime(o.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(o=>o.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(o=0){return this.state.data===void 0?!0:o==="static"?!1:this.state.isInvalidated?!0:!timeUntilStale(this.state.dataUpdatedAt,o)}onFocus(){this.observers.find(a=>a.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#i?.continue()}onOnline(){this.observers.find(a=>a.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#i?.continue()}addObserver(o){this.observers.includes(o)||(this.observers.push(o),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:o}))}removeObserver(o){this.observers.includes(o)&&(this.observers=this.observers.filter(a=>a!==o),this.observers.length||(this.#i&&(this.#o?this.#i.cancel({revert:!0}):this.#i.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:o}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(o,a){if(this.state.fetchStatus!=="idle"&&this.#i?.status()!=="rejected"){if(this.state.data!==void 0&&a?.cancelRefetch)this.cancel({silent:!0});else if(this.#i)return this.#i.continueRetry(),this.#i.promise}if(o&&this.setOptions(o),!this.options.queryFn){const p=this.observers.find(v=>v.options.queryFn);p&&this.setOptions(p.options)}const n=new AbortController,d=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},R=()=>{const p=ensureQueryFn(this.options,a),D=(()=>{const x={client:this.#n,queryKey:this.queryKey,meta:this.meta};return d(x),x})();return this.#o=!1,this.options.persister?this.options.persister(p,D,this):p(D)},j=(()=>{const p={fetchOptions:a,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:R};return d(p),p})();this.options.behavior?.onFetch(j,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==j.fetchOptions?.meta)&&this.#s({type:"fetch",meta:j.fetchOptions?.meta}),this.#i=createRetryer({initialPromise:a?.initialPromise,fn:j.fetchFn,onCancel:p=>{p instanceof CancelledError&&p.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(p,v)=>{this.#s({type:"failed",failureCount:p,error:v})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:j.options.retry,retryDelay:j.options.retryDelay,networkMode:j.options.networkMode,canRun:()=>!0});try{const p=await this.#i.start();if(p===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(p),this.#r.config.onSuccess?.(p,this),this.#r.config.onSettled?.(p,this.state.error,this),p}catch(p){if(p instanceof CancelledError){if(p.silent)return this.#i.promise;if(p.revert){if(this.state.data===void 0)throw p;return this.state.data}}throw this.#s({type:"error",error:p}),this.#r.config.onError?.(p,this),this.#r.config.onSettled?.(this.state.data,p,this),p}finally{this.scheduleGc()}}#s(o){const a=n=>{switch(o.type){case"failed":return{...n,fetchFailureCount:o.failureCount,fetchFailureReason:o.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...fetchState(n.data,this.options),fetchMeta:o.meta??null};case"success":const d={...n,...successState(o.data,o.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!o.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=o.manual?d:void 0,d;case"error":const R=o.error;return{...n,error:R,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:R,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...o.state}}};this.state=a(this.state),notifyManager.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:o})})}};function fetchState(o,a){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(a.networkMode)?"fetching":"paused",...o===void 0&&{error:null,status:"pending"}}}function successState(o,a){return{data:o,dataUpdatedAt:a??Date.now(),error:null,isInvalidated:!1,status:"success"}}function getDefaultState$1(o){const a=typeof o.initialData=="function"?o.initialData():o.initialData,n=a!==void 0,d=n?typeof o.initialDataUpdatedAt=="function"?o.initialDataUpdatedAt():o.initialDataUpdatedAt:0;return{data:a,dataUpdateCount:0,dataUpdatedAt:n?d??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var QueryObserver=class extends Subscribable{constructor(o,a){super(),this.options=a,this.#e=o,this.#s=null,this.#o=pendingThenable(),this.bindMethods(),this.setOptions(a)}#e;#t=void 0;#r=void 0;#n=void 0;#i;#a;#o;#s;#p;#h;#f;#u;#c;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),shouldFetchOnMount(this.#t,this.options)?this.#d():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return shouldFetchOn(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return shouldFetchOn(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#_(),this.#b(),this.#t.removeObserver(this)}setOptions(o){const a=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(o),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof resolveEnabled(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),a._defaulted&&!shallowEqualObjects(this.options,a)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const d=this.hasListeners();d&&shouldFetchOptionally(this.#t,n,this.options,a)&&this.#d(),this.updateResult(),d&&(this.#t!==n||resolveEnabled(this.options.enabled,this.#t)!==resolveEnabled(a.enabled,this.#t)||resolveStaleTime(this.options.staleTime,this.#t)!==resolveStaleTime(a.staleTime,this.#t))&&this.#g();const R=this.#x();d&&(this.#t!==n||resolveEnabled(this.options.enabled,this.#t)!==resolveEnabled(a.enabled,this.#t)||R!==this.#l)&&this.#v(R)}getOptimisticResult(o){const a=this.#e.getQueryCache().build(this.#e,o),n=this.createResult(a,o);return shouldAssignObserverCurrentProperties(this,n)&&(this.#n=n,this.#a=this.options,this.#i=this.#t.state),n}getCurrentResult(){return this.#n}trackResult(o,a){return new Proxy(o,{get:(n,d)=>(this.trackProp(d),a?.(d),d==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,d))})}trackProp(o){this.#m.add(o)}getCurrentQuery(){return this.#t}refetch({...o}={}){return this.fetch({...o})}fetchOptimistic(o){const a=this.#e.defaultQueryOptions(o),n=this.#e.getQueryCache().build(this.#e,a);return n.fetch().then(()=>this.createResult(n,a))}fetch(o){return this.#d({...o,cancelRefetch:o.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#d(o){this.#E();let a=this.#t.fetch(this.options,o);return o?.throwOnError||(a=a.catch(noop$1)),a}#g(){this.#_();const o=resolveStaleTime(this.options.staleTime,this.#t);if(isServer||this.#n.isStale||!isValidTimeout(o))return;const n=timeUntilStale(this.#n.dataUpdatedAt,o)+1;this.#u=timeoutManager.setTimeout(()=>{this.#n.isStale||this.updateResult()},n)}#x(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(o){this.#b(),this.#l=o,!(isServer||resolveEnabled(this.options.enabled,this.#t)===!1||!isValidTimeout(this.#l)||this.#l===0)&&(this.#c=timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||focusManager.isFocused())&&this.#d()},this.#l))}#y(){this.#g(),this.#v(this.#x())}#_(){this.#u&&(timeoutManager.clearTimeout(this.#u),this.#u=void 0)}#b(){this.#c&&(timeoutManager.clearInterval(this.#c),this.#c=void 0)}createResult(o,a){const n=this.#t,d=this.options,R=this.#n,S=this.#i,j=this.#a,v=o!==n?o.state:this.#r,{state:D}=o;let x={...D},A=!1,L;if(a._optimisticResults){const m=this.hasListeners(),C=!m&&shouldFetchOnMount(o,a),T=m&&shouldFetchOptionally(o,n,a,d);(C||T)&&(x={...x,...fetchState(D.data,o.options)}),a._optimisticResults==="isRestoring"&&(x.fetchStatus="idle")}let{error:w,errorUpdatedAt:b,status:u}=x;L=x.data;let i=!1;if(a.placeholderData!==void 0&&L===void 0&&u==="pending"){let m;R?.isPlaceholderData&&a.placeholderData===j?.placeholderData?(m=R.data,i=!0):m=typeof a.placeholderData=="function"?a.placeholderData(this.#f?.state.data,this.#f):a.placeholderData,m!==void 0&&(u="success",L=replaceData(R?.data,m,a),A=!0)}if(a.select&&L!==void 0&&!i)if(R&&L===S?.data&&a.select===this.#p)L=this.#h;else try{this.#p=a.select,L=a.select(L),L=replaceData(R?.data,L,a),this.#h=L,this.#s=null}catch(m){this.#s=m}this.#s&&(w=this.#s,L=this.#h,b=Date.now(),u="error");const s=x.fetchStatus==="fetching",h=u==="pending",g=u==="error",y=h&&s,E=L!==void 0,f={status:u,fetchStatus:x.fetchStatus,isPending:h,isSuccess:u==="success",isError:g,isInitialLoading:y,isLoading:y,data:L,dataUpdatedAt:x.dataUpdatedAt,error:w,errorUpdatedAt:b,failureCount:x.fetchFailureCount,failureReason:x.fetchFailureReason,errorUpdateCount:x.errorUpdateCount,isFetched:x.dataUpdateCount>0||x.errorUpdateCount>0,isFetchedAfterMount:x.dataUpdateCount>v.dataUpdateCount||x.errorUpdateCount>v.errorUpdateCount,isFetching:s,isRefetching:s&&!h,isLoadingError:g&&!E,isPaused:x.fetchStatus==="paused",isPlaceholderData:A,isRefetchError:g&&E,isStale:isStale(o,a),refetch:this.refetch,promise:this.#o,isEnabled:resolveEnabled(a.enabled,o)!==!1};if(this.options.experimental_prefetchInRender){const m=f.data!==void 0,C=f.status==="error"&&!m,T=N=>{C?N.reject(f.error):m&&N.resolve(f.data)},P=()=>{const N=this.#o=f.promise=pendingThenable();T(N)},F=this.#o;switch(F.status){case"pending":o.queryHash===n.queryHash&&T(F);break;case"fulfilled":(C||f.data!==F.value)&&P();break;case"rejected":(!C||f.error!==F.reason)&&P();break}}return f}updateResult(){const o=this.#n,a=this.createResult(this.#t,this.options);if(this.#i=this.#t.state,this.#a=this.options,this.#i.data!==void 0&&(this.#f=this.#t),shallowEqualObjects(a,o))return;this.#n=a;const n=()=>{if(!o)return!0;const{notifyOnChangeProps:d}=this.options,R=typeof d=="function"?d():d;if(R==="all"||!R&&!this.#m.size)return!0;const S=new Set(R??this.#m);return this.options.throwOnError&&S.add("error"),Object.keys(this.#n).some(j=>{const p=j;return this.#n[p]!==o[p]&&S.has(p)})};this.#w({listeners:n()})}#E(){const o=this.#e.getQueryCache().build(this.#e,this.options);if(o===this.#t)return;const a=this.#t;this.#t=o,this.#r=o.state,this.hasListeners()&&(a?.removeObserver(this),o.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#w(o){notifyManager.batch(()=>{o.listeners&&this.listeners.forEach(a=>{a(this.#n)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function shouldLoadOnMount(o,a){return resolveEnabled(a.enabled,o)!==!1&&o.state.data===void 0&&!(o.state.status==="error"&&a.retryOnMount===!1)}function shouldFetchOnMount(o,a){return shouldLoadOnMount(o,a)||o.state.data!==void 0&&shouldFetchOn(o,a,a.refetchOnMount)}function shouldFetchOn(o,a,n){if(resolveEnabled(a.enabled,o)!==!1&&resolveStaleTime(a.staleTime,o)!=="static"){const d=typeof n=="function"?n(o):n;return d==="always"||d!==!1&&isStale(o,a)}return!1}function shouldFetchOptionally(o,a,n,d){return(o!==a||resolveEnabled(d.enabled,o)===!1)&&(!n.suspense||o.state.status!=="error")&&isStale(o,n)}function isStale(o,a){return resolveEnabled(a.enabled,o)!==!1&&o.isStaleByTime(resolveStaleTime(a.staleTime,o))}function shouldAssignObserverCurrentProperties(o,a){return!shallowEqualObjects(o.getCurrentResult(),a)}function infiniteQueryBehavior(o){return{onFetch:(a,n)=>{const d=a.options,R=a.fetchOptions?.meta?.fetchMore?.direction,S=a.state.data?.pages||[],j=a.state.data?.pageParams||[];let p={pages:[],pageParams:[]},v=0;const D=async()=>{let x=!1;const A=b=>{addConsumeAwareSignal(b,()=>a.signal,()=>x=!0)},L=ensureQueryFn(a.options,a.fetchOptions),w=async(b,u,i)=>{if(x)return Promise.reject();if(u==null&&b.pages.length)return Promise.resolve(b);const h=(()=>{const l={client:a.client,queryKey:a.queryKey,pageParam:u,direction:i?"backward":"forward",meta:a.options.meta};return A(l),l})(),g=await L(h),{maxPages:y}=a.options,E=i?addToStart:addToEnd;return{pages:E(b.pages,g,y),pageParams:E(b.pageParams,u,y)}};if(R&&S.length){const b=R==="backward",u=b?getPreviousPageParam:getNextPageParam,i={pages:S,pageParams:j},s=u(d,i);p=await w(i,s,b)}else{const b=o??S.length;do{const u=v===0?j[0]??d.initialPageParam:getNextPageParam(d,p);if(v>0&&u==null)break;p=await w(p,u),v++}while(v<b)}return p};a.options.persister?a.fetchFn=()=>a.options.persister?.(D,{client:a.client,queryKey:a.queryKey,meta:a.options.meta,signal:a.signal},n):a.fetchFn=D}}}function getNextPageParam(o,{pages:a,pageParams:n}){const d=a.length-1;return a.length>0?o.getNextPageParam(a[d],a,n[d],n):void 0}function getPreviousPageParam(o,{pages:a,pageParams:n}){return a.length>0?o.getPreviousPageParam?.(a[0],a,n[0],n):void 0}var Mutation=class extends Removable{#e;#t;#r;#n;constructor(o){super(),this.#e=o.client,this.mutationId=o.mutationId,this.#r=o.mutationCache,this.#t=[],this.state=o.state||getDefaultState(),this.setOptions(o.options),this.scheduleGc()}setOptions(o){this.options=o,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(o){this.#t.includes(o)||(this.#t.push(o),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:o}))}removeObserver(o){this.#t=this.#t.filter(a=>a!==o),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:o})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(o){const a=()=>{this.#i({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#n=createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(o,n):Promise.reject(new Error("No mutationFn found")),onFail:(S,j)=>{this.#i({type:"failed",failureCount:S,error:j})},onPause:()=>{this.#i({type:"pause"})},onContinue:a,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const d=this.state.status==="pending",R=!this.#n.canStart();try{if(d)a();else{this.#i({type:"pending",variables:o,isPaused:R}),this.#r.config.onMutate&&await this.#r.config.onMutate(o,this,n);const j=await this.options.onMutate?.(o,n);j!==this.state.context&&this.#i({type:"pending",context:j,variables:o,isPaused:R})}const S=await this.#n.start();return await this.#r.config.onSuccess?.(S,o,this.state.context,this,n),await this.options.onSuccess?.(S,o,this.state.context,n),await this.#r.config.onSettled?.(S,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(S,null,o,this.state.context,n),this.#i({type:"success",data:S}),S}catch(S){try{await this.#r.config.onError?.(S,o,this.state.context,this,n)}catch(j){Promise.reject(j)}try{await this.options.onError?.(S,o,this.state.context,n)}catch(j){Promise.reject(j)}try{await this.#r.config.onSettled?.(void 0,S,this.state.variables,this.state.context,this,n)}catch(j){Promise.reject(j)}try{await this.options.onSettled?.(void 0,S,o,this.state.context,n)}catch(j){Promise.reject(j)}throw this.#i({type:"error",error:S}),S}finally{this.#r.runNext(this)}}#i(o){const a=n=>{switch(o.type){case"failed":return{...n,failureCount:o.failureCount,failureReason:o.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:o.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:o.isPaused,status:"pending",variables:o.variables,submittedAt:Date.now()};case"success":return{...n,data:o.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:o.error,failureCount:n.failureCount+1,failureReason:o.error,isPaused:!1,status:"error"}}};this.state=a(this.state),notifyManager.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(o)}),this.#r.notify({mutation:this,type:"updated",action:o})})}};function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var MutationCache=class extends Subscribable{constructor(o={}){super(),this.config=o,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(o,a,n){const d=new Mutation({client:o,mutationCache:this,mutationId:++this.#r,options:o.defaultMutationOptions(a),state:n});return this.add(d),d}add(o){this.#e.add(o);const a=scopeFor(o);if(typeof a=="string"){const n=this.#t.get(a);n?n.push(o):this.#t.set(a,[o])}this.notify({type:"added",mutation:o})}remove(o){if(this.#e.delete(o)){const a=scopeFor(o);if(typeof a=="string"){const n=this.#t.get(a);if(n)if(n.length>1){const d=n.indexOf(o);d!==-1&&n.splice(d,1)}else n[0]===o&&this.#t.delete(a)}}this.notify({type:"removed",mutation:o})}canRun(o){const a=scopeFor(o);if(typeof a=="string"){const d=this.#t.get(a)?.find(R=>R.state.status==="pending");return!d||d===o}else return!0}runNext(o){const a=scopeFor(o);return typeof a=="string"?this.#t.get(a)?.find(d=>d!==o&&d.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){notifyManager.batch(()=>{this.#e.forEach(o=>{this.notify({type:"removed",mutation:o})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(o){const a={exact:!0,...o};return this.getAll().find(n=>matchMutation(a,n))}findAll(o={}){return this.getAll().filter(a=>matchMutation(o,a))}notify(o){notifyManager.batch(()=>{this.listeners.forEach(a=>{a(o)})})}resumePausedMutations(){const o=this.getAll().filter(a=>a.state.isPaused);return notifyManager.batch(()=>Promise.all(o.map(a=>a.continue().catch(noop$1))))}};function scopeFor(o){return o.options.scope?.id}var MutationObserver$1=class extends Subscribable{#e;#t=void 0;#r;#n;constructor(a,n){super(),this.#e=a,this.setOptions(n),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){const n=this.options;this.options=this.#e.defaultMutationOptions(a),shallowEqualObjects(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),n?.mutationKey&&this.options.mutationKey&&hashKey(n.mutationKey)!==hashKey(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(a){this.#i(),this.#a(a)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#i(),this.#a()}mutate(a,n){return this.#n=n,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(a)}#i(){const a=this.#r?.state??getDefaultState();this.#t={...a,isPending:a.status==="pending",isSuccess:a.status==="success",isError:a.status==="error",isIdle:a.status==="idle",mutate:this.mutate,reset:this.reset}}#a(a){notifyManager.batch(()=>{if(this.#n&&this.hasListeners()){const n=this.#t.variables,d=this.#t.context,R={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(a?.type==="success"){try{this.#n.onSuccess?.(a.data,n,d,R)}catch(S){Promise.reject(S)}try{this.#n.onSettled?.(a.data,null,n,d,R)}catch(S){Promise.reject(S)}}else if(a?.type==="error"){try{this.#n.onError?.(a.error,n,d,R)}catch(S){Promise.reject(S)}try{this.#n.onSettled?.(void 0,a.error,n,d,R)}catch(S){Promise.reject(S)}}}this.listeners.forEach(n=>{n(this.#t)})})}},QueryCache=class extends Subscribable{constructor(o={}){super(),this.config=o,this.#e=new Map}#e;build(o,a,n){const d=a.queryKey,R=a.queryHash??hashQueryKeyByOptions(d,a);let S=this.get(R);return S||(S=new Query({client:o,queryKey:d,queryHash:R,options:o.defaultQueryOptions(a),state:n,defaultOptions:o.getQueryDefaults(d)}),this.add(S)),S}add(o){this.#e.has(o.queryHash)||(this.#e.set(o.queryHash,o),this.notify({type:"added",query:o}))}remove(o){const a=this.#e.get(o.queryHash);a&&(o.destroy(),a===o&&this.#e.delete(o.queryHash),this.notify({type:"removed",query:o}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(o=>{this.remove(o)})})}get(o){return this.#e.get(o)}getAll(){return[...this.#e.values()]}find(o){const a={exact:!0,...o};return this.getAll().find(n=>matchQuery(a,n))}findAll(o={}){const a=this.getAll();return Object.keys(o).length>0?a.filter(n=>matchQuery(o,n)):a}notify(o){notifyManager.batch(()=>{this.listeners.forEach(a=>{a(o)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(o=>{o.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(o=>{o.onOnline()})})}},QueryClient=class{#e;#t;#r;#n;#i;#a;#o;#s;constructor(o={}){this.#e=o.queryCache||new QueryCache,this.#t=o.mutationCache||new MutationCache,this.#r=o.defaultOptions||{},this.#n=new Map,this.#i=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=focusManager.subscribe(async o=>{o&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=onlineManager.subscribe(async o=>{o&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(o){return this.#e.findAll({...o,fetchStatus:"fetching"}).length}isMutating(o){return this.#t.findAll({...o,status:"pending"}).length}getQueryData(o){const a=this.defaultQueryOptions({queryKey:o});return this.#e.get(a.queryHash)?.state.data}ensureQueryData(o){const a=this.defaultQueryOptions(o),n=this.#e.build(this,a),d=n.state.data;return d===void 0?this.fetchQuery(o):(o.revalidateIfStale&&n.isStaleByTime(resolveStaleTime(a.staleTime,n))&&this.prefetchQuery(a),Promise.resolve(d))}getQueriesData(o){return this.#e.findAll(o).map(({queryKey:a,state:n})=>{const d=n.data;return[a,d]})}setQueryData(o,a,n){const d=this.defaultQueryOptions({queryKey:o}),S=this.#e.get(d.queryHash)?.state.data,j=functionalUpdate(a,S);if(j!==void 0)return this.#e.build(this,d).setData(j,{...n,manual:!0})}setQueriesData(o,a,n){return notifyManager.batch(()=>this.#e.findAll(o).map(({queryKey:d})=>[d,this.setQueryData(d,a,n)]))}getQueryState(o){const a=this.defaultQueryOptions({queryKey:o});return this.#e.get(a.queryHash)?.state}removeQueries(o){const a=this.#e;notifyManager.batch(()=>{a.findAll(o).forEach(n=>{a.remove(n)})})}resetQueries(o,a){const n=this.#e;return notifyManager.batch(()=>(n.findAll(o).forEach(d=>{d.reset()}),this.refetchQueries({type:"active",...o},a)))}cancelQueries(o,a={}){const n={revert:!0,...a},d=notifyManager.batch(()=>this.#e.findAll(o).map(R=>R.cancel(n)));return Promise.all(d).then(noop$1).catch(noop$1)}invalidateQueries(o,a={}){return notifyManager.batch(()=>(this.#e.findAll(o).forEach(n=>{n.invalidate()}),o?.refetchType==="none"?Promise.resolve():this.refetchQueries({...o,type:o?.refetchType??o?.type??"active"},a)))}refetchQueries(o,a={}){const n={...a,cancelRefetch:a.cancelRefetch??!0},d=notifyManager.batch(()=>this.#e.findAll(o).filter(R=>!R.isDisabled()&&!R.isStatic()).map(R=>{let S=R.fetch(void 0,n);return n.throwOnError||(S=S.catch(noop$1)),R.state.fetchStatus==="paused"?Promise.resolve():S}));return Promise.all(d).then(noop$1)}fetchQuery(o){const a=this.defaultQueryOptions(o);a.retry===void 0&&(a.retry=!1);const n=this.#e.build(this,a);return n.isStaleByTime(resolveStaleTime(a.staleTime,n))?n.fetch(a):Promise.resolve(n.state.data)}prefetchQuery(o){return this.fetchQuery(o).then(noop$1).catch(noop$1)}fetchInfiniteQuery(o){return o.behavior=infiniteQueryBehavior(o.pages),this.fetchQuery(o)}prefetchInfiniteQuery(o){return this.fetchInfiniteQuery(o).then(noop$1).catch(noop$1)}ensureInfiniteQueryData(o){return o.behavior=infiniteQueryBehavior(o.pages),this.ensureQueryData(o)}resumePausedMutations(){return onlineManager.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(o){this.#r=o}setQueryDefaults(o,a){this.#n.set(hashKey(o),{queryKey:o,defaultOptions:a})}getQueryDefaults(o){const a=[...this.#n.values()],n={};return a.forEach(d=>{partialMatchKey(o,d.queryKey)&&Object.assign(n,d.defaultOptions)}),n}setMutationDefaults(o,a){this.#i.set(hashKey(o),{mutationKey:o,defaultOptions:a})}getMutationDefaults(o){const a=[...this.#i.values()],n={};return a.forEach(d=>{partialMatchKey(o,d.mutationKey)&&Object.assign(n,d.defaultOptions)}),n}defaultQueryOptions(o){if(o._defaulted)return o;const a={...this.#r.queries,...this.getQueryDefaults(o.queryKey),...o,_defaulted:!0};return a.queryHash||(a.queryHash=hashQueryKeyByOptions(a.queryKey,a)),a.refetchOnReconnect===void 0&&(a.refetchOnReconnect=a.networkMode!=="always"),a.throwOnError===void 0&&(a.throwOnError=!!a.suspense),!a.networkMode&&a.persister&&(a.networkMode="offlineFirst"),a.queryFn===skipToken&&(a.enabled=!1),a}defaultMutationOptions(o){return o?._defaulted?o:{...this.#r.mutations,...o?.mutationKey&&this.getMutationDefaults(o.mutationKey),...o,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},QueryClientContext=reactExports.createContext(void 0),useQueryClient=o=>{const a=reactExports.useContext(QueryClientContext);if(!a)throw new Error("No QueryClient set, use QueryClientProvider to set one");return a},QueryClientProvider=({client:o,children:a})=>(reactExports.useEffect(()=>(o.mount(),()=>{o.unmount()}),[o]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:o,children:a})),IsRestoringContext=reactExports.createContext(!1),useIsRestoring=()=>reactExports.useContext(IsRestoringContext);IsRestoringContext.Provider;function createValue(){let o=!1;return{clearReset:()=>{o=!1},reset:()=>{o=!0},isReset:()=>o}}var QueryErrorResetBoundaryContext=reactExports.createContext(createValue()),useQueryErrorResetBoundary=()=>reactExports.useContext(QueryErrorResetBoundaryContext),ensurePreventErrorBoundaryRetry=(o,a,n)=>{const d=n?.state.error&&typeof o.throwOnError=="function"?shouldThrowError(o.throwOnError,[n.state.error,n]):o.throwOnError;(o.suspense||o.experimental_prefetchInRender||d)&&(a.isReset()||(o.retryOnMount=!1))},useClearResetErrorBoundary=o=>{reactExports.useEffect(()=>{o.clearReset()},[o])},getHasError=({result:o,errorResetBoundary:a,throwOnError:n,query:d,suspense:R})=>o.isError&&!a.isReset()&&!o.isFetching&&d&&(R&&o.data===void 0||shouldThrowError(n,[o.error,d])),ensureSuspenseTimers=o=>{if(o.suspense){const n=R=>R==="static"?R:Math.max(R??1e3,1e3),d=o.staleTime;o.staleTime=typeof d=="function"?(...R)=>n(d(...R)):n(d),typeof o.gcTime=="number"&&(o.gcTime=Math.max(o.gcTime,1e3))}},willFetch=(o,a)=>o.isLoading&&o.isFetching&&!a,shouldSuspend=(o,a)=>o?.suspense&&a.isPending,fetchOptimistic=(o,a,n)=>a.fetchOptimistic(o).catch(()=>{n.clearReset()});function useBaseQuery(o,a,n){const d=useIsRestoring(),R=useQueryErrorResetBoundary(),S=useQueryClient(),j=S.defaultQueryOptions(o);S.getDefaultOptions().queries?._experimental_beforeQuery?.(j);const p=S.getQueryCache().get(j.queryHash);j._optimisticResults=d?"isRestoring":"optimistic",ensureSuspenseTimers(j),ensurePreventErrorBoundaryRetry(j,R,p),useClearResetErrorBoundary(R);const v=!S.getQueryCache().get(j.queryHash),[D]=reactExports.useState(()=>new a(S,j)),x=D.getOptimisticResult(j),A=!d&&o.subscribed!==!1;if(reactExports.useSyncExternalStore(reactExports.useCallback(L=>{const w=A?D.subscribe(notifyManager.batchCalls(L)):noop$1;return D.updateResult(),w},[D,A]),()=>D.getCurrentResult(),()=>D.getCurrentResult()),reactExports.useEffect(()=>{D.setOptions(j)},[j,D]),shouldSuspend(j,x))throw fetchOptimistic(j,D,R);if(getHasError({result:x,errorResetBoundary:R,throwOnError:j.throwOnError,query:p,suspense:j.suspense}))throw x.error;return S.getDefaultOptions().queries?._experimental_afterQuery?.(j,x),j.experimental_prefetchInRender&&!isServer&&willFetch(x,d)&&(v?fetchOptimistic(j,D,R):p?.promise)?.catch(noop$1).finally(()=>{D.updateResult()}),j.notifyOnChangeProps?x:D.trackResult(x)}function useQuery(o,a){return useBaseQuery(o,QueryObserver)}function useMutation(o,a){const n=useQueryClient(),[d]=reactExports.useState(()=>new MutationObserver$1(n,o));reactExports.useEffect(()=>{d.setOptions(o)},[d,o]);const R=reactExports.useSyncExternalStore(reactExports.useCallback(j=>d.subscribe(notifyManager.batchCalls(j)),[d]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),S=reactExports.useCallback((j,p)=>{d.mutate(j,p).catch(noop$1)},[d]);if(R.error&&shouldThrowError(d.options.throwOnError,[R.error]))throw R.error;return{...R,mutate:S,mutateAsync:R.mutate}}const THEME="dark",ThemeContext=reactExports.createContext(void 0);function ThemeProvider({children:o}){return reactExports.useEffect(()=>{document.documentElement.classList.add("dark")},[]),jsxRuntimeExports.jsx(ThemeContext.Provider,{value:{theme:THEME},children:o})}function useTheme(){const o=reactExports.useContext(ThemeContext);if(!o)throw new Error("useTheme must be used within a ThemeProvider");return o}function r(o){var a,n,d="";if(typeof o=="string"||typeof o=="number")d+=o;else if(typeof o=="object")if(Array.isArray(o)){var R=o.length;for(a=0;a<R;a++)o[a]&&(n=r(o[a]))&&(d&&(d+=" "),d+=n)}else for(n in o)o[n]&&(d&&(d+=" "),d+=n);return d}function clsx(){for(var o,a,n=0,d="",R=arguments.length;n<R;n++)(o=arguments[n])&&(a=r(o))&&(d&&(d+=" "),d+=a);return d}const Card=({children:o,className:a,hoverable:n=!1,onClick:d,onMouseEnter:R,onMouseLeave:S})=>jsxRuntimeExports.jsx("div",{className:clsx("bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-xl border border-gray-100/50 dark:border-gray-700/50 p-6 glow-card",n&&"transition-all duration-200 hover:-translate-y-0.5",d&&"cursor-pointer",a),onClick:d,onMouseEnter:R,onMouseLeave:S,children:o}),Button=({variant:o="primary",size:a="md",loading:n=!1,disabled:d,children:R,className:S,...j})=>{const p="font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2",v={primary:"bg-primary-500 text-white hover:bg-primary-600 focus:ring-primary-500 disabled:bg-gray-300",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500 disabled:bg-gray-100",outline:"border-2 border-primary-500 text-primary-500 hover:bg-primary-50 focus:ring-primary-500 disabled:border-gray-300 disabled:text-gray-300"},D={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return jsxRuntimeExports.jsx("button",{className:clsx(p,v[o],D[a],(d||n)&&"opacity-50 cursor-not-allowed",S),disabled:d||n,...j,children:n?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),R]}):R})};function bind(o,a){return function(){return o.apply(a,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,{iterator,toStringTag}=Symbol,kindOf=(o=>a=>{const n=toString.call(a);return o[n]||(o[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=o=>(o=o.toLowerCase(),a=>kindOf(a)===o),typeOfTest=o=>a=>typeof a===o,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(o){return o!==null&&!isUndefined(o)&&o.constructor!==null&&!isUndefined(o.constructor)&&isFunction$1(o.constructor.isBuffer)&&o.constructor.isBuffer(o)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(o){let a;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?a=ArrayBuffer.isView(o):a=o&&o.buffer&&isArrayBuffer(o.buffer),a}const isString=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=o=>o!==null&&typeof o=="object",isBoolean=o=>o===!0||o===!1,isPlainObject=o=>{if(kindOf(o)!=="object")return!1;const a=getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(toStringTag in o)&&!(iterator in o)},isEmptyObject=o=>{if(!isObject(o)||isBuffer(o))return!1;try{return Object.keys(o).length===0&&Object.getPrototypeOf(o)===Object.prototype}catch{return!1}},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=o=>isObject(o)&&isFunction$1(o.pipe),isFormData=o=>{let a;return o&&(typeof FormData=="function"&&o instanceof FormData||isFunction$1(o.append)&&((a=kindOf(o))==="formdata"||a==="object"&&isFunction$1(o.toString)&&o.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=o=>o.trim?o.trim():o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(o,a,{allOwnKeys:n=!1}={}){if(o===null||typeof o>"u")return;let d,R;if(typeof o!="object"&&(o=[o]),isArray(o))for(d=0,R=o.length;d<R;d++)a.call(null,o[d],d,o);else{if(isBuffer(o))return;const S=n?Object.getOwnPropertyNames(o):Object.keys(o),j=S.length;let p;for(d=0;d<j;d++)p=S[d],a.call(null,o[p],p,o)}}function findKey(o,a){if(isBuffer(o))return null;a=a.toLowerCase();const n=Object.keys(o);let d=n.length,R;for(;d-- >0;)if(R=n[d],a===R.toLowerCase())return R;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=o=>!isUndefined(o)&&o!==_global;function merge(){const{caseless:o,skipUndefined:a}=isContextDefined(this)&&this||{},n={},d=(R,S)=>{const j=o&&findKey(n,S)||S;isPlainObject(n[j])&&isPlainObject(R)?n[j]=merge(n[j],R):isPlainObject(R)?n[j]=merge({},R):isArray(R)?n[j]=R.slice():(!a||!isUndefined(R))&&(n[j]=R)};for(let R=0,S=arguments.length;R<S;R++)arguments[R]&&forEach(arguments[R],d);return n}const extend=(o,a,n,{allOwnKeys:d}={})=>(forEach(a,(R,S)=>{n&&isFunction$1(R)?Object.defineProperty(o,S,{value:bind(R,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(o,S,{value:R,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:d}),o),stripBOM=o=>(o.charCodeAt(0)===65279&&(o=o.slice(1)),o),inherits=(o,a,n,d)=>{o.prototype=Object.create(a.prototype,d),Object.defineProperty(o.prototype,"constructor",{value:o,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(o,"super",{value:a.prototype}),n&&Object.assign(o.prototype,n)},toFlatObject=(o,a,n,d)=>{let R,S,j;const p={};if(a=a||{},o==null)return a;do{for(R=Object.getOwnPropertyNames(o),S=R.length;S-- >0;)j=R[S],(!d||d(j,o,a))&&!p[j]&&(a[j]=o[j],p[j]=!0);o=n!==!1&&getPrototypeOf(o)}while(o&&(!n||n(o,a))&&o!==Object.prototype);return a},endsWith=(o,a,n)=>{o=String(o),(n===void 0||n>o.length)&&(n=o.length),n-=a.length;const d=o.indexOf(a,n);return d!==-1&&d===n},toArray=o=>{if(!o)return null;if(isArray(o))return o;let a=o.length;if(!isNumber(a))return null;const n=new Array(a);for(;a-- >0;)n[a]=o[a];return n},isTypedArray=(o=>a=>o&&a instanceof o)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(o,a)=>{const d=(o&&o[iterator]).call(o);let R;for(;(R=d.next())&&!R.done;){const S=R.value;a.call(o,S[0],S[1])}},matchAll=(o,a)=>{let n;const d=[];for(;(n=o.exec(a))!==null;)d.push(n);return d},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=o=>o.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,d,R){return d.toUpperCase()+R}),hasOwnProperty=(({hasOwnProperty:o})=>(a,n)=>o.call(a,n))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(o,a)=>{const n=Object.getOwnPropertyDescriptors(o),d={};forEach(n,(R,S)=>{let j;(j=a(R,S,o))!==!1&&(d[S]=j||R)}),Object.defineProperties(o,d)},freezeMethods=o=>{reduceDescriptors(o,(a,n)=>{if(isFunction$1(o)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const d=o[n];if(isFunction$1(d)){if(a.enumerable=!1,"writable"in a){a.writable=!1;return}a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},toObjectSet=(o,a)=>{const n={},d=R=>{R.forEach(S=>{n[S]=!0})};return isArray(o)?d(o):d(String(o).split(a)),n},noop=()=>{},toFiniteNumber=(o,a)=>o!=null&&Number.isFinite(o=+o)?o:a;function isSpecCompliantForm(o){return!!(o&&isFunction$1(o.append)&&o[toStringTag]==="FormData"&&o[iterator])}const toJSONObject=o=>{const a=new Array(10),n=(d,R)=>{if(isObject(d)){if(a.indexOf(d)>=0)return;if(isBuffer(d))return d;if(!("toJSON"in d)){a[R]=d;const S=isArray(d)?[]:{};return forEach(d,(j,p)=>{const v=n(j,R+1);!isUndefined(v)&&(S[p]=v)}),a[R]=void 0,S}}return d};return n(o,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=o=>o&&(isObject(o)||isFunction$1(o))&&isFunction$1(o.then)&&isFunction$1(o.catch),_setImmediate=((o,a)=>o?setImmediate:a?((n,d)=>(_global.addEventListener("message",({source:R,data:S})=>{R===_global&&S===n&&d.length&&d.shift()()},!1),R=>{d.push(R),_global.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",isFunction$1(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,isIterable=o=>o!=null&&isFunction$1(o[iterator]),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isEmptyObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap,isIterable};let AxiosError$1=class Tc extends Error{static from(a,n,d,R,S,j){const p=new Tc(a.message,n||a.code,d,R,S);return p.cause=a,p.name=a.name,j&&Object.assign(p,j),p}constructor(a,n,d,R,S){super(a),this.name="AxiosError",this.isAxiosError=!0,n&&(this.code=n),d&&(this.config=d),R&&(this.request=R),S&&(this.response=S,this.status=S.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}};AxiosError$1.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";AxiosError$1.ERR_BAD_OPTION="ERR_BAD_OPTION";AxiosError$1.ECONNABORTED="ECONNABORTED";AxiosError$1.ETIMEDOUT="ETIMEDOUT";AxiosError$1.ERR_NETWORK="ERR_NETWORK";AxiosError$1.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";AxiosError$1.ERR_DEPRECATED="ERR_DEPRECATED";AxiosError$1.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";AxiosError$1.ERR_BAD_REQUEST="ERR_BAD_REQUEST";AxiosError$1.ERR_CANCELED="ERR_CANCELED";AxiosError$1.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";AxiosError$1.ERR_INVALID_URL="ERR_INVALID_URL";const httpAdapter=null;function isVisitable(o){return utils$1.isPlainObject(o)||utils$1.isArray(o)}function removeBrackets(o){return utils$1.endsWith(o,"[]")?o.slice(0,-2):o}function renderKey(o,a,n){return o?o.concat(a).map(function(R,S){return R=removeBrackets(R),!n&&S?"["+R+"]":R}).join(n?".":""):a}function isFlatArray(o){return utils$1.isArray(o)&&!o.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(a){return/^is[A-Z]/.test(a)});function toFormData$1(o,a,n){if(!utils$1.isObject(o))throw new TypeError("target must be an object");a=a||new FormData,n=utils$1.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(u,i){return!utils$1.isUndefined(i[u])});const d=n.metaTokens,R=n.visitor||x,S=n.dots,j=n.indexes,v=(n.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(a);if(!utils$1.isFunction(R))throw new TypeError("visitor must be a function");function D(b){if(b===null)return"";if(utils$1.isDate(b))return b.toISOString();if(utils$1.isBoolean(b))return b.toString();if(!v&&utils$1.isBlob(b))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(b)||utils$1.isTypedArray(b)?v&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function x(b,u,i){let s=b;if(b&&!i&&typeof b=="object"){if(utils$1.endsWith(u,"{}"))u=d?u:u.slice(0,-2),b=JSON.stringify(b);else if(utils$1.isArray(b)&&isFlatArray(b)||(utils$1.isFileList(b)||utils$1.endsWith(u,"[]"))&&(s=utils$1.toArray(b)))return u=removeBrackets(u),s.forEach(function(g,y){!(utils$1.isUndefined(g)||g===null)&&a.append(j===!0?renderKey([u],y,S):j===null?u:u+"[]",D(g))}),!1}return isVisitable(b)?!0:(a.append(renderKey(i,u,S),D(b)),!1)}const A=[],L=Object.assign(predicates,{defaultVisitor:x,convertValue:D,isVisitable});function w(b,u){if(!utils$1.isUndefined(b)){if(A.indexOf(b)!==-1)throw Error("Circular reference detected in "+u.join("."));A.push(b),utils$1.forEach(b,function(s,h){(!(utils$1.isUndefined(s)||s===null)&&R.call(a,s,utils$1.isString(h)?h.trim():h,u,L))===!0&&w(s,u?u.concat(h):[h])}),A.pop()}}if(!utils$1.isObject(o))throw new TypeError("data must be an object");return w(o),a}function encode$1(o){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(o).replace(/[!'()~]|%20|%00/g,function(d){return a[d]})}function AxiosURLSearchParams(o,a){this._pairs=[],o&&toFormData$1(o,this,a)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(a,n){this._pairs.push([a,n])};prototype.toString=function(a){const n=a?function(d){return a.call(this,d,encode$1)}:encode$1;return this._pairs.map(function(R){return n(R[0])+"="+n(R[1])},"").join("&")};function encode(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function buildURL(o,a,n){if(!a)return o;const d=n&&n.encode||encode,R=utils$1.isFunction(n)?{serialize:n}:n,S=R&&R.serialize;let j;if(S?j=S(a,R):j=utils$1.isURLSearchParams(a)?a.toString():new AxiosURLSearchParams(a,R).toString(d),j){const p=o.indexOf("#");p!==-1&&(o=o.slice(0,p)),o+=(o.indexOf("?")===-1?"?":"&")+j}return o}class InterceptorManager{constructor(){this.handlers=[]}use(a,n,d){return this.handlers.push({fulfilled:a,rejected:n,synchronous:d?d.synchronous:!1,runWhen:d?d.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){utils$1.forEach(this.handlers,function(d){d!==null&&a(d)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(o,a){return toFormData$1(o,new platform.classes.URLSearchParams,{visitor:function(n,d,R,S){return platform.isNode&&utils$1.isBuffer(n)?(this.append(d,n.toString("base64")),!1):S.defaultVisitor.apply(this,arguments)},...a})}function parsePropPath(o){return utils$1.matchAll(/\w+|\[(\w*)]/g,o).map(a=>a[0]==="[]"?"":a[1]||a[0])}function arrayToObject(o){const a={},n=Object.keys(o);let d;const R=n.length;let S;for(d=0;d<R;d++)S=n[d],a[S]=o[S];return a}function formDataToJSON(o){function a(n,d,R,S){let j=n[S++];if(j==="__proto__")return!0;const p=Number.isFinite(+j),v=S>=n.length;return j=!j&&utils$1.isArray(R)?R.length:j,v?(utils$1.hasOwnProp(R,j)?R[j]=[R[j],d]:R[j]=d,!p):((!R[j]||!utils$1.isObject(R[j]))&&(R[j]=[]),a(n,d,R[j],S)&&utils$1.isArray(R[j])&&(R[j]=arrayToObject(R[j])),!p)}if(utils$1.isFormData(o)&&utils$1.isFunction(o.entries)){const n={};return utils$1.forEachEntry(o,(d,R)=>{a(parsePropPath(d),R,n,0)}),n}return null}function stringifySafely(o,a,n){if(utils$1.isString(o))try{return(a||JSON.parse)(o),utils$1.trim(o)}catch(d){if(d.name!=="SyntaxError")throw d}return(n||JSON.stringify)(o)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(a,n){const d=n.getContentType()||"",R=d.indexOf("application/json")>-1,S=utils$1.isObject(a);if(S&&utils$1.isHTMLForm(a)&&(a=new FormData(a)),utils$1.isFormData(a))return R?JSON.stringify(formDataToJSON(a)):a;if(utils$1.isArrayBuffer(a)||utils$1.isBuffer(a)||utils$1.isStream(a)||utils$1.isFile(a)||utils$1.isBlob(a)||utils$1.isReadableStream(a))return a;if(utils$1.isArrayBufferView(a))return a.buffer;if(utils$1.isURLSearchParams(a))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();let p;if(S){if(d.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(a,this.formSerializer).toString();if((p=utils$1.isFileList(a))||d.indexOf("multipart/form-data")>-1){const v=this.env&&this.env.FormData;return toFormData$1(p?{"files[]":a}:a,v&&new v,this.formSerializer)}}return S||R?(n.setContentType("application/json",!1),stringifySafely(a)):a}],transformResponse:[function(a){const n=this.transitional||defaults.transitional,d=n&&n.forcedJSONParsing,R=this.responseType==="json";if(utils$1.isResponse(a)||utils$1.isReadableStream(a))return a;if(a&&utils$1.isString(a)&&(d&&!this.responseType||R)){const j=!(n&&n.silentJSONParsing)&&R;try{return JSON.parse(a,this.parseReviver)}catch(p){if(j)throw p.name==="SyntaxError"?AxiosError$1.from(p,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):p}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],o=>{defaults.headers[o]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=o=>{const a={};let n,d,R;return o&&o.split(`
`).forEach(function(j){R=j.indexOf(":"),n=j.substring(0,R).trim().toLowerCase(),d=j.substring(R+1).trim(),!(!n||a[n]&&ignoreDuplicateOf[n])&&(n==="set-cookie"?a[n]?a[n].push(d):a[n]=[d]:a[n]=a[n]?a[n]+", "+d:d)}),a},$internals=Symbol("internals");function normalizeHeader(o){return o&&String(o).trim().toLowerCase()}function normalizeValue(o){return o===!1||o==null?o:utils$1.isArray(o)?o.map(normalizeValue):String(o)}function parseTokens(o){const a=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let d;for(;d=n.exec(o);)a[d[1]]=d[2];return a}const isValidHeaderName=o=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(o.trim());function matchHeaderValue(o,a,n,d,R){if(utils$1.isFunction(d))return d.call(this,a,n);if(R&&(a=n),!!utils$1.isString(a)){if(utils$1.isString(d))return a.indexOf(d)!==-1;if(utils$1.isRegExp(d))return d.test(a)}}function formatHeader(o){return o.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,n,d)=>n.toUpperCase()+d)}function buildAccessors(o,a){const n=utils$1.toCamelCase(" "+a);["get","set","has"].forEach(d=>{Object.defineProperty(o,d+n,{value:function(R,S,j){return this[d].call(this,a,R,S,j)},configurable:!0})})}let AxiosHeaders$1=class{constructor(a){a&&this.set(a)}set(a,n,d){const R=this;function S(p,v,D){const x=normalizeHeader(v);if(!x)throw new Error("header name must be a non-empty string");const A=utils$1.findKey(R,x);(!A||R[A]===void 0||D===!0||D===void 0&&R[A]!==!1)&&(R[A||v]=normalizeValue(p))}const j=(p,v)=>utils$1.forEach(p,(D,x)=>S(D,x,v));if(utils$1.isPlainObject(a)||a instanceof this.constructor)j(a,n);else if(utils$1.isString(a)&&(a=a.trim())&&!isValidHeaderName(a))j(parseHeaders(a),n);else if(utils$1.isObject(a)&&utils$1.isIterable(a)){let p={},v,D;for(const x of a){if(!utils$1.isArray(x))throw TypeError("Object iterator must return a key-value pair");p[D=x[0]]=(v=p[D])?utils$1.isArray(v)?[...v,x[1]]:[v,x[1]]:x[1]}j(p,n)}else a!=null&&S(n,a,d);return this}get(a,n){if(a=normalizeHeader(a),a){const d=utils$1.findKey(this,a);if(d){const R=this[d];if(!n)return R;if(n===!0)return parseTokens(R);if(utils$1.isFunction(n))return n.call(this,R,d);if(utils$1.isRegExp(n))return n.exec(R);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,n){if(a=normalizeHeader(a),a){const d=utils$1.findKey(this,a);return!!(d&&this[d]!==void 0&&(!n||matchHeaderValue(this,this[d],d,n)))}return!1}delete(a,n){const d=this;let R=!1;function S(j){if(j=normalizeHeader(j),j){const p=utils$1.findKey(d,j);p&&(!n||matchHeaderValue(d,d[p],p,n))&&(delete d[p],R=!0)}}return utils$1.isArray(a)?a.forEach(S):S(a),R}clear(a){const n=Object.keys(this);let d=n.length,R=!1;for(;d--;){const S=n[d];(!a||matchHeaderValue(this,this[S],S,a,!0))&&(delete this[S],R=!0)}return R}normalize(a){const n=this,d={};return utils$1.forEach(this,(R,S)=>{const j=utils$1.findKey(d,S);if(j){n[j]=normalizeValue(R),delete n[S];return}const p=a?formatHeader(S):String(S).trim();p!==S&&delete n[S],n[p]=normalizeValue(R),d[p]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){const n=Object.create(null);return utils$1.forEach(this,(d,R)=>{d!=null&&d!==!1&&(n[R]=a&&utils$1.isArray(d)?d.join(", "):d)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,n])=>a+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...n){const d=new this(a);return n.forEach(R=>d.set(R)),d}static accessor(a){const d=(this[$internals]=this[$internals]={accessors:{}}).accessors,R=this.prototype;function S(j){const p=normalizeHeader(j);d[p]||(buildAccessors(R,j),d[p]=!0)}return utils$1.isArray(a)?a.forEach(S):S(a),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:o},a)=>{let n=a[0].toUpperCase()+a.slice(1);return{get:()=>o,set(d){this[n]=d}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(o,a){const n=this||defaults,d=a||n,R=AxiosHeaders$1.from(d.headers);let S=d.data;return utils$1.forEach(o,function(p){S=p.call(n,S,R.normalize(),a?a.status:void 0)}),R.normalize(),S}function isCancel$1(o){return!!(o&&o.__CANCEL__)}let CanceledError$1=class extends AxiosError$1{constructor(a,n,d){super(a??"canceled",AxiosError$1.ERR_CANCELED,n,d),this.name="CanceledError",this.__CANCEL__=!0}};function settle(o,a,n){const d=n.config.validateStatus;!n.status||!d||d(n.status)?o(n):a(new AxiosError$1("Request failed with status code "+n.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function parseProtocol(o){const a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return a&&a[1]||""}function speedometer(o,a){o=o||10;const n=new Array(o),d=new Array(o);let R=0,S=0,j;return a=a!==void 0?a:1e3,function(v){const D=Date.now(),x=d[S];j||(j=D),n[R]=v,d[R]=D;let A=S,L=0;for(;A!==R;)L+=n[A++],A=A%o;if(R=(R+1)%o,R===S&&(S=(S+1)%o),D-j<a)return;const w=x&&D-x;return w?Math.round(L*1e3/w):void 0}}function throttle(o,a){let n=0,d=1e3/a,R,S;const j=(D,x=Date.now())=>{n=x,R=null,S&&(clearTimeout(S),S=null),o(...D)};return[(...D)=>{const x=Date.now(),A=x-n;A>=d?j(D,x):(R=D,S||(S=setTimeout(()=>{S=null,j(R)},d-A)))},()=>R&&j(R)]}const progressEventReducer=(o,a,n=3)=>{let d=0;const R=speedometer(50,250);return throttle(S=>{const j=S.loaded,p=S.lengthComputable?S.total:void 0,v=j-d,D=R(v),x=j<=p;d=j;const A={loaded:j,total:p,progress:p?j/p:void 0,bytes:v,rate:D||void 0,estimated:D&&p&&x?(p-j)/D:void 0,event:S,lengthComputable:p!=null,[a?"download":"upload"]:!0};o(A)},n)},progressEventDecorator=(o,a)=>{const n=o!=null;return[d=>a[0]({lengthComputable:n,total:o,loaded:d}),a[1]]},asyncDecorator=o=>(...a)=>utils$1.asap(()=>o(...a)),isURLSameOrigin=platform.hasStandardBrowserEnv?((o,a)=>n=>(n=new URL(n,platform.origin),o.protocol===n.protocol&&o.host===n.host&&(a||o.port===n.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(o,a,n,d,R,S,j){if(typeof document>"u")return;const p=[`${o}=${encodeURIComponent(a)}`];utils$1.isNumber(n)&&p.push(`expires=${new Date(n).toUTCString()}`),utils$1.isString(d)&&p.push(`path=${d}`),utils$1.isString(R)&&p.push(`domain=${R}`),S===!0&&p.push("secure"),utils$1.isString(j)&&p.push(`SameSite=${j}`),document.cookie=p.join("; ")},read(o){if(typeof document>"u")return null;const a=document.cookie.match(new RegExp("(?:^|; )"+o+"=([^;]*)"));return a?decodeURIComponent(a[1]):null},remove(o){this.write(o,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}function combineURLs(o,a){return a?o.replace(/\/?\/$/,"")+"/"+a.replace(/^\/+/,""):o}function buildFullPath(o,a,n){let d=!isAbsoluteURL(a);return o&&(d||n==!1)?combineURLs(o,a):a}const headersToObject=o=>o instanceof AxiosHeaders$1?{...o}:o;function mergeConfig$1(o,a){a=a||{};const n={};function d(D,x,A,L){return utils$1.isPlainObject(D)&&utils$1.isPlainObject(x)?utils$1.merge.call({caseless:L},D,x):utils$1.isPlainObject(x)?utils$1.merge({},x):utils$1.isArray(x)?x.slice():x}function R(D,x,A,L){if(utils$1.isUndefined(x)){if(!utils$1.isUndefined(D))return d(void 0,D,A,L)}else return d(D,x,A,L)}function S(D,x){if(!utils$1.isUndefined(x))return d(void 0,x)}function j(D,x){if(utils$1.isUndefined(x)){if(!utils$1.isUndefined(D))return d(void 0,D)}else return d(void 0,x)}function p(D,x,A){if(A in a)return d(D,x);if(A in o)return d(void 0,D)}const v={url:S,method:S,data:S,baseURL:j,transformRequest:j,transformResponse:j,paramsSerializer:j,timeout:j,timeoutMessage:j,withCredentials:j,withXSRFToken:j,adapter:j,responseType:j,xsrfCookieName:j,xsrfHeaderName:j,onUploadProgress:j,onDownloadProgress:j,decompress:j,maxContentLength:j,maxBodyLength:j,beforeRedirect:j,transport:j,httpAgent:j,httpsAgent:j,cancelToken:j,socketPath:j,responseEncoding:j,validateStatus:p,headers:(D,x,A)=>R(headersToObject(D),headersToObject(x),A,!0)};return utils$1.forEach(Object.keys({...o,...a}),function(x){const A=v[x]||R,L=A(o[x],a[x],x);utils$1.isUndefined(L)&&A!==p||(n[x]=L)}),n}const resolveConfig=o=>{const a=mergeConfig$1({},o);let{data:n,withXSRFToken:d,xsrfHeaderName:R,xsrfCookieName:S,headers:j,auth:p}=a;if(a.headers=j=AxiosHeaders$1.from(j),a.url=buildURL(buildFullPath(a.baseURL,a.url,a.allowAbsoluteUrls),o.params,o.paramsSerializer),p&&j.set("Authorization","Basic "+btoa((p.username||"")+":"+(p.password?unescape(encodeURIComponent(p.password)):""))),utils$1.isFormData(n)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)j.setContentType(void 0);else if(utils$1.isFunction(n.getHeaders)){const v=n.getHeaders(),D=["content-type","content-length"];Object.entries(v).forEach(([x,A])=>{D.includes(x.toLowerCase())&&j.set(x,A)})}}if(platform.hasStandardBrowserEnv&&(d&&utils$1.isFunction(d)&&(d=d(a)),d||d!==!1&&isURLSameOrigin(a.url))){const v=R&&S&&cookies.read(S);v&&j.set(R,v)}return a},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(o){return new Promise(function(n,d){const R=resolveConfig(o);let S=R.data;const j=AxiosHeaders$1.from(R.headers).normalize();let{responseType:p,onUploadProgress:v,onDownloadProgress:D}=R,x,A,L,w,b;function u(){w&&w(),b&&b(),R.cancelToken&&R.cancelToken.unsubscribe(x),R.signal&&R.signal.removeEventListener("abort",x)}let i=new XMLHttpRequest;i.open(R.method.toUpperCase(),R.url,!0),i.timeout=R.timeout;function s(){if(!i)return;const g=AxiosHeaders$1.from("getAllResponseHeaders"in i&&i.getAllResponseHeaders()),E={data:!p||p==="text"||p==="json"?i.responseText:i.response,status:i.status,statusText:i.statusText,headers:g,config:o,request:i};settle(function(f){n(f),u()},function(f){d(f),u()},E),i=null}"onloadend"in i?i.onloadend=s:i.onreadystatechange=function(){!i||i.readyState!==4||i.status===0&&!(i.responseURL&&i.responseURL.indexOf("file:")===0)||setTimeout(s)},i.onabort=function(){i&&(d(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,o,i)),i=null)},i.onerror=function(y){const E=y&&y.message?y.message:"Network Error",l=new AxiosError$1(E,AxiosError$1.ERR_NETWORK,o,i);l.event=y||null,d(l),i=null},i.ontimeout=function(){let y=R.timeout?"timeout of "+R.timeout+"ms exceeded":"timeout exceeded";const E=R.transitional||transitionalDefaults;R.timeoutErrorMessage&&(y=R.timeoutErrorMessage),d(new AxiosError$1(y,E.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,o,i)),i=null},S===void 0&&j.setContentType(null),"setRequestHeader"in i&&utils$1.forEach(j.toJSON(),function(y,E){i.setRequestHeader(E,y)}),utils$1.isUndefined(R.withCredentials)||(i.withCredentials=!!R.withCredentials),p&&p!=="json"&&(i.responseType=R.responseType),D&&([L,b]=progressEventReducer(D,!0),i.addEventListener("progress",L)),v&&i.upload&&([A,w]=progressEventReducer(v),i.upload.addEventListener("progress",A),i.upload.addEventListener("loadend",w)),(R.cancelToken||R.signal)&&(x=g=>{i&&(d(!g||g.type?new CanceledError$1(null,o,i):g),i.abort(),i=null)},R.cancelToken&&R.cancelToken.subscribe(x),R.signal&&(R.signal.aborted?x():R.signal.addEventListener("abort",x)));const h=parseProtocol(R.url);if(h&&platform.protocols.indexOf(h)===-1){d(new AxiosError$1("Unsupported protocol "+h+":",AxiosError$1.ERR_BAD_REQUEST,o));return}i.send(S||null)})},composeSignals=(o,a)=>{const{length:n}=o=o?o.filter(Boolean):[];if(a||n){let d=new AbortController,R;const S=function(D){if(!R){R=!0,p();const x=D instanceof Error?D:this.reason;d.abort(x instanceof AxiosError$1?x:new CanceledError$1(x instanceof Error?x.message:x))}};let j=a&&setTimeout(()=>{j=null,S(new AxiosError$1(`timeout of ${a}ms exceeded`,AxiosError$1.ETIMEDOUT))},a);const p=()=>{o&&(j&&clearTimeout(j),j=null,o.forEach(D=>{D.unsubscribe?D.unsubscribe(S):D.removeEventListener("abort",S)}),o=null)};o.forEach(D=>D.addEventListener("abort",S));const{signal:v}=d;return v.unsubscribe=()=>utils$1.asap(p),v}},streamChunk=function*(o,a){let n=o.byteLength;if(n<a){yield o;return}let d=0,R;for(;d<n;)R=d+a,yield o.slice(d,R),d=R},readBytes=async function*(o,a){for await(const n of readStream(o))yield*streamChunk(n,a)},readStream=async function*(o){if(o[Symbol.asyncIterator]){yield*o;return}const a=o.getReader();try{for(;;){const{done:n,value:d}=await a.read();if(n)break;yield d}}finally{await a.cancel()}},trackStream=(o,a,n,d)=>{const R=readBytes(o,a);let S=0,j,p=v=>{j||(j=!0,d&&d(v))};return new ReadableStream({async pull(v){try{const{done:D,value:x}=await R.next();if(D){p(),v.close();return}let A=x.byteLength;if(n){let L=S+=A;n(L)}v.enqueue(new Uint8Array(x))}catch(D){throw p(D),D}},cancel(v){return p(v),R.return()}},{highWaterMark:2})},DEFAULT_CHUNK_SIZE=64*1024,{isFunction}=utils$1,globalFetchAPI=(({Request:o,Response:a})=>({Request:o,Response:a}))(utils$1.global),{ReadableStream:ReadableStream$1,TextEncoder:TextEncoder$1}=utils$1.global,test=(o,...a)=>{try{return!!o(...a)}catch{return!1}},factory=o=>{o=utils$1.merge.call({skipUndefined:!0},globalFetchAPI,o);const{fetch:a,Request:n,Response:d}=o,R=a?isFunction(a):typeof fetch=="function",S=isFunction(n),j=isFunction(d);if(!R)return!1;const p=R&&isFunction(ReadableStream$1),v=R&&(typeof TextEncoder$1=="function"?(b=>u=>b.encode(u))(new TextEncoder$1):async b=>new Uint8Array(await new n(b).arrayBuffer())),D=S&&p&&test(()=>{let b=!1;const u=new n(platform.origin,{body:new ReadableStream$1,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!u}),x=j&&p&&test(()=>utils$1.isReadableStream(new d("").body)),A={stream:x&&(b=>b.body)};R&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!A[b]&&(A[b]=(u,i)=>{let s=u&&u[b];if(s)return s.call(u);throw new AxiosError$1(`Response type '${b}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,i)})});const L=async b=>{if(b==null)return 0;if(utils$1.isBlob(b))return b.size;if(utils$1.isSpecCompliantForm(b))return(await new n(platform.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(b)||utils$1.isArrayBuffer(b))return b.byteLength;if(utils$1.isURLSearchParams(b)&&(b=b+""),utils$1.isString(b))return(await v(b)).byteLength},w=async(b,u)=>{const i=utils$1.toFiniteNumber(b.getContentLength());return i??L(u)};return async b=>{let{url:u,method:i,data:s,signal:h,cancelToken:g,timeout:y,onDownloadProgress:E,onUploadProgress:l,responseType:f,headers:m,withCredentials:C="same-origin",fetchOptions:T}=resolveConfig(b),P=a||fetch;f=f?(f+"").toLowerCase():"text";let F=composeSignals([h,g&&g.toAbortSignal()],y),N=null;const B=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let U;try{if(l&&D&&i!=="get"&&i!=="head"&&(U=await w(m,s))!==0){let k=new n(u,{method:"POST",body:s,duplex:"half"}),Y;if(utils$1.isFormData(s)&&(Y=k.headers.get("content-type"))&&m.setContentType(Y),k.body){const[ie,ne]=progressEventDecorator(U,progressEventReducer(asyncDecorator(l)));s=trackStream(k.body,DEFAULT_CHUNK_SIZE,ie,ne)}}utils$1.isString(C)||(C=C?"include":"omit");const K=S&&"credentials"in n.prototype,H={...T,signal:F,method:i.toUpperCase(),headers:m.normalize().toJSON(),body:s,duplex:"half",credentials:K?C:void 0};N=S&&new n(u,H);let G=await(S?P(N,T):P(u,H));const $=x&&(f==="stream"||f==="response");if(x&&(E||$&&B)){const k={};["status","statusText","headers"].forEach(he=>{k[he]=G[he]});const Y=utils$1.toFiniteNumber(G.headers.get("content-length")),[ie,ne]=E&&progressEventDecorator(Y,progressEventReducer(asyncDecorator(E),!0))||[];G=new d(trackStream(G.body,DEFAULT_CHUNK_SIZE,ie,()=>{ne&&ne(),B&&B()}),k)}f=f||"text";let V=await A[utils$1.findKey(A,f)||"text"](G,b);return!$&&B&&B(),await new Promise((k,Y)=>{settle(k,Y,{data:V,headers:AxiosHeaders$1.from(G.headers),status:G.status,statusText:G.statusText,config:b,request:N})})}catch(K){throw B&&B(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,b,N),{cause:K.cause||K}):AxiosError$1.from(K,K&&K.code,b,N)}}},seedCache=new Map,getFetch=o=>{let a=o&&o.env||{};const{fetch:n,Request:d,Response:R}=a,S=[d,R,n];let j=S.length,p=j,v,D,x=seedCache;for(;p--;)v=S[p],D=x.get(v),D===void 0&&x.set(v,D=p?new Map:factory(a)),x=D;return D};getFetch();const knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:{get:getFetch}};utils$1.forEach(knownAdapters,(o,a)=>{if(o){try{Object.defineProperty(o,"name",{value:a})}catch{}Object.defineProperty(o,"adapterName",{value:a})}});const renderReason=o=>`- ${o}`,isResolvedHandle=o=>utils$1.isFunction(o)||o===null||o===!1;function getAdapter$1(o,a){o=utils$1.isArray(o)?o:[o];const{length:n}=o;let d,R;const S={};for(let j=0;j<n;j++){d=o[j];let p;if(R=d,!isResolvedHandle(d)&&(R=knownAdapters[(p=String(d)).toLowerCase()],R===void 0))throw new AxiosError$1(`Unknown adapter '${p}'`);if(R&&(utils$1.isFunction(R)||(R=R.get(a))))break;S[p||"#"+j]=R}if(!R){const j=Object.entries(S).map(([v,D])=>`adapter ${v} `+(D===!1?"is not supported by the environment":"is not available in the build"));let p=n?j.length>1?`since :
`+j.map(renderReason).join(`
`):" "+renderReason(j[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+p,"ERR_NOT_SUPPORT")}return R}const adapters={getAdapter:getAdapter$1,adapters:knownAdapters};function throwIfCancellationRequested(o){if(o.cancelToken&&o.cancelToken.throwIfRequested(),o.signal&&o.signal.aborted)throw new CanceledError$1(null,o)}function dispatchRequest(o){return throwIfCancellationRequested(o),o.headers=AxiosHeaders$1.from(o.headers),o.data=transformData.call(o,o.transformRequest),["post","put","patch"].indexOf(o.method)!==-1&&o.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(o.adapter||defaults.adapter,o)(o).then(function(d){return throwIfCancellationRequested(o),d.data=transformData.call(o,o.transformResponse,d),d.headers=AxiosHeaders$1.from(d.headers),d},function(d){return isCancel$1(d)||(throwIfCancellationRequested(o),d&&d.response&&(d.response.data=transformData.call(o,o.transformResponse,d.response),d.response.headers=AxiosHeaders$1.from(d.response.headers))),Promise.reject(d)})}const VERSION$1="1.13.4",validators$1={};["object","boolean","number","function","string","symbol"].forEach((o,a)=>{validators$1[o]=function(d){return typeof d===o||"a"+(a<1?"n ":" ")+o}});const deprecatedWarnings={};validators$1.transitional=function(a,n,d){function R(S,j){return"[Axios v"+VERSION$1+"] Transitional option '"+S+"'"+j+(d?". "+d:"")}return(S,j,p)=>{if(a===!1)throw new AxiosError$1(R(j," has been removed"+(n?" in "+n:"")),AxiosError$1.ERR_DEPRECATED);return n&&!deprecatedWarnings[j]&&(deprecatedWarnings[j]=!0,console.warn(R(j," has been deprecated since v"+n+" and will be removed in the near future"))),a?a(S,j,p):!0}};validators$1.spelling=function(a){return(n,d)=>(console.warn(`${d} is likely a misspelling of ${a}`),!0)};function assertOptions(o,a,n){if(typeof o!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const d=Object.keys(o);let R=d.length;for(;R-- >0;){const S=d[R],j=a[S];if(j){const p=o[S],v=p===void 0||j(p,S,o);if(v!==!0)throw new AxiosError$1("option "+S+" must be "+v,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new AxiosError$1("Unknown option "+S,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(a){this.defaults=a||{},this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(a,n){try{return await this._request(a,n)}catch(d){if(d instanceof Error){let R={};Error.captureStackTrace?Error.captureStackTrace(R):R=new Error;const S=R.stack?R.stack.replace(/^.+\n/,""):"";try{d.stack?S&&!String(d.stack).endsWith(S.replace(/^.+\n.+\n/,""))&&(d.stack+=`
`+S):d.stack=S}catch{}}throw d}}_request(a,n){typeof a=="string"?(n=n||{},n.url=a):n=a||{},n=mergeConfig$1(this.defaults,n);const{transitional:d,paramsSerializer:R,headers:S}=n;d!==void 0&&validator.assertOptions(d,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),R!=null&&(utils$1.isFunction(R)?n.paramsSerializer={serialize:R}:validator.assertOptions(R,{encode:validators.function,serialize:validators.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),validator.assertOptions(n,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let j=S&&utils$1.merge(S.common,S[n.method]);S&&utils$1.forEach(["delete","get","head","post","put","patch","common"],b=>{delete S[b]}),n.headers=AxiosHeaders$1.concat(j,S);const p=[];let v=!0;this.interceptors.request.forEach(function(u){typeof u.runWhen=="function"&&u.runWhen(n)===!1||(v=v&&u.synchronous,p.unshift(u.fulfilled,u.rejected))});const D=[];this.interceptors.response.forEach(function(u){D.push(u.fulfilled,u.rejected)});let x,A=0,L;if(!v){const b=[dispatchRequest.bind(this),void 0];for(b.unshift(...p),b.push(...D),L=b.length,x=Promise.resolve(n);A<L;)x=x.then(b[A++],b[A++]);return x}L=p.length;let w=n;for(;A<L;){const b=p[A++],u=p[A++];try{w=b(w)}catch(i){u.call(this,i);break}}try{x=dispatchRequest.call(this,w)}catch(b){return Promise.reject(b)}for(A=0,L=D.length;A<L;)x=x.then(D[A++],D[A++]);return x}getUri(a){a=mergeConfig$1(this.defaults,a);const n=buildFullPath(a.baseURL,a.url,a.allowAbsoluteUrls);return buildURL(n,a.params,a.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function(a){Axios$1.prototype[a]=function(n,d){return this.request(mergeConfig$1(d||{},{method:a,url:n,data:(d||{}).data}))}});utils$1.forEach(["post","put","patch"],function(a){function n(d){return function(S,j,p){return this.request(mergeConfig$1(p||{},{method:a,headers:d?{"Content-Type":"multipart/form-data"}:{},url:S,data:j}))}}Axios$1.prototype[a]=n(),Axios$1.prototype[a+"Form"]=n(!0)});let CancelToken$1=class jc{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(S){n=S});const d=this;this.promise.then(R=>{if(!d._listeners)return;let S=d._listeners.length;for(;S-- >0;)d._listeners[S](R);d._listeners=null}),this.promise.then=R=>{let S;const j=new Promise(p=>{d.subscribe(p),S=p}).then(R);return j.cancel=function(){d.unsubscribe(S)},j},a(function(S,j,p){d.reason||(d.reason=new CanceledError$1(S,j,p),n(d.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){if(this.reason){a(this.reason);return}this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const n=this._listeners.indexOf(a);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const a=new AbortController,n=d=>{a.abort(d)};return this.subscribe(n),a.signal.unsubscribe=()=>this.unsubscribe(n),a.signal}static source(){let a;return{token:new jc(function(R){a=R}),cancel:a}}};function spread$1(o){return function(n){return o.apply(null,n)}}function isAxiosError$1(o){return utils$1.isObject(o)&&o.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(HttpStatusCode$1).forEach(([o,a])=>{HttpStatusCode$1[a]=o});function createInstance(o){const a=new Axios$1(o),n=bind(Axios$1.prototype.request,a);return utils$1.extend(n,Axios$1.prototype,a,{allOwnKeys:!0}),utils$1.extend(n,a,null,{allOwnKeys:!0}),n.create=function(R){return createInstance(mergeConfig$1(o,R))},n}const axios=createInstance(defaults);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$1;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(a){return Promise.all(a)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=o=>formDataToJSON(utils$1.isHTMLForm(o)?new FormData(o):o);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,PUBCHEM_BASE_URL="https://pubchem.ncbi.nlm.nih.gov/rest",searchCompounds=async(o,a=10)=>{if(!o||o.length<2)return[];try{const{data:n}=await axios.get(`${PUBCHEM_BASE_URL}/autocomplete/compound/${encodeURIComponent(o)}/json`,{params:{limit:a},timeout:5e3});return(n.dictionary_terms?.compound||[]).map(R=>({name:R}))}catch(n){return console.error("PubChem search error:",n),[]}},usePubChemSearch=(o,a=!0)=>useQuery({queryKey:["pubchem-search",o],queryFn:()=>searchCompounds(o,10),enabled:a&&o.length>=2,staleTime:300*1e3,retry:1}),LoadingSpinner$1=({size:o="md",className:a})=>{const n={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return jsxRuntimeExports.jsxs("svg",{className:clsx("animate-spin text-primary-500",n[o],a),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},AutocompleteInput=({value:o,onChange:a,onSelect:n,placeholder:d="Type to search...",className:R})=>{const[S,j]=reactExports.useState(!1),[p,v]=reactExports.useState(o),D=reactExports.useRef(null);reactExports.useEffect(()=>{const b=setTimeout(()=>{v(o)},300);return()=>clearTimeout(b)},[o]);const{data:x=[],isLoading:A}=usePubChemSearch(p,S);reactExports.useEffect(()=>{const b=u=>{D.current&&!D.current.contains(u.target)&&j(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const L=b=>{const u=b.target.value;a(u),j(u.length>=2)},w=b=>{n(b),j(!1)};return jsxRuntimeExports.jsxs("div",{ref:D,className:clsx("relative",R),children:[jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:L,onFocus:()=>o.length>=2&&j(!0),placeholder:d,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"}),S&&p.length>=2&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:A?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-4",children:[jsxRuntimeExports.jsx(LoadingSpinner$1,{size:"sm"}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:"Searching..."})]}):x.length>0?jsxRuntimeExports.jsx("ul",{className:"py-1",children:x.map((b,u)=>jsxRuntimeExports.jsx("li",{onClick:()=>w(b.name),className:"px-4 py-2 hover:bg-primary-50 dark:hover:bg-gray-700 cursor-pointer transition-colors duration-150",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-900 dark:text-white",children:b.name}),b.cid&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["CID: ",b.cid]})]})},u))}):jsxRuntimeExports.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400 text-center",children:"No compounds found"})})]})},AnalysisForm=({onSubmit:o,isLoading:a=!1})=>{const[n,d]=reactExports.useState(""),[R,S]=reactExports.useState(!1),j=v=>{v.preventDefault(),n.trim()&&o({ingredient_name:n.trim(),enable_predictions:R})},p=v=>{d(v)};return jsxRuntimeExports.jsx(Card,{className:"max-w-2xl mx-auto",children:jsxRuntimeExports.jsxs("form",{onSubmit:j,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Analyze Active Ingredient"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter a compound or active ingredient name to analyze its biological pathways and targets."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{htmlFor:"ingredient",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Ingredient Name ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx(AutocompleteInput,{value:n,onChange:d,onSelect:p,placeholder:"Start typing (e.g., ibuprofen, aspirin)..."}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Suggestions are powered by PubChem. Type at least 2 characters."})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{id:"predictions",type:"checkbox",checked:R,onChange:v=>S(v.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700"}),jsxRuntimeExports.jsxs("label",{htmlFor:"predictions",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:["Enable predictions (computational docking/ML)",jsxRuntimeExports.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:"Includes predicted targets (lower confidence, longer analysis time)"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",size:"lg",loading:a,disabled:!n.trim()||a,className:"flex-1",children:a?"Analyzing...":"Analyze Compound"}),n&&jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",size:"lg",onClick:()=>{d(""),S(!1)},children:"Clear"})]})]})})},scriptRel="modulepreload",assetsURL=function(o){return"/"+o},seen={},__vitePreload=function(a,n,d){let R=Promise.resolve();if(n&&n.length>0){let v=function(D){return Promise.all(D.map(x=>Promise.resolve(x).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};document.getElementsByTagName("link");const j=document.querySelector("meta[property=csp-nonce]"),p=j?.nonce||j?.getAttribute("nonce");R=v(n.map(D=>{if(D=assetsURL(D),D in seen)return;seen[D]=!0;const x=D.endsWith(".css"),A=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${D}"]${A}`))return;const L=document.createElement("link");if(L.rel=x?"stylesheet":scriptRel,x||(L.as="script"),L.crossOrigin="",L.href=D,p&&L.setAttribute("nonce",p),document.head.appendChild(L),x)return new Promise((w,b)=>{L.addEventListener("load",w),L.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${D}`)))})}))}function S(j){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=j,window.dispatchEvent(p),!p.defaultPrevented)throw j}return R.then(j=>{for(const p of j||[])p.status==="rejected"&&S(p.reason);return a().catch(S)})},PlantIdentification=({onAnalysisComplete:o,onError:a,isLoading:n,setIsLoading:d})=>{const[R,S]=reactExports.useState(null),[j,p]=reactExports.useState(null),[v,D]=reactExports.useState(["leaf"]),[x,A]=reactExports.useState(5),[L,w]=reactExports.useState(!1),b=reactExports.useRef(null),u=reactExports.useCallback(E=>{if(!E.type.startsWith("image/")){a("Please select an image file (JPEG or PNG)");return}if(E.size>10*1024*1024){a("Image file is too large. Maximum size is 10MB.");return}S(E);const l=URL.createObjectURL(E);p(l)},[a]),i=E=>{const l=E.target.files?.[0];l&&u(l)},s=E=>{D(l=>l.includes(E)?l.length===1?l:l.filter(f=>f!==E):[...l,E])},h=async E=>{if(E.preventDefault(),!R){a("Please select an image first");return}d(!0);try{const{analyzePlantUpload:l}=await __vitePreload(async()=>{const{analyzePlantUpload:m}=await import("./plantApi-BnZW1Mqy.js");return{analyzePlantUpload:m}},[]),f=await l(R,v,x,L);o(f)}catch(l){a(l instanceof Error?l.message:"Plant analysis failed")}finally{d(!1)}},g=()=>{S(null),j&&URL.revokeObjectURL(j),p(null),D(["leaf"]),A(5),w(!1),b.current&&(b.current.value="")},y=[{id:"leaf",label:"Leaf",icon:""},{id:"flower",label:"Flower",icon:""},{id:"fruit",label:"Fruit",icon:""},{id:"bark",label:"Bark",icon:""},{id:"root",label:"Root",icon:""}];return jsxRuntimeExports.jsx(Card,{className:"max-w-2xl mx-auto",children:jsxRuntimeExports.jsxs("form",{onSubmit:h,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Identify Plant from Photo"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Upload a photo of a plant to identify its species and analyze its medicinal compounds."})]}),jsxRuntimeExports.jsx("input",{ref:b,type:"file",accept:"image/jpeg,image/png,image/jpg",onChange:i,className:"hidden"}),j?jsxRuntimeExports.jsxs("div",{className:"border-2 border-green-500 bg-green-50 dark:bg-green-900/20 rounded-xl p-6 text-center",children:[jsxRuntimeExports.jsx("img",{src:j,alt:"Selected plant",className:"max-h-64 mx-auto rounded-lg shadow-md mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:R?.name}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>b.current?.click(),className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 text-sm font-medium",children:"Change Photo"})]}):jsxRuntimeExports.jsxs("div",{className:"border-2 border-gray-200 dark:border-gray-700 rounded-xl p-8 text-center bg-gray-50 dark:bg-gray-800/50",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Upload a Plant Photo"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Take or upload a clear photo of a plant to identify it"}),jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>b.current?.click(),className:"inline-flex items-center px-6 py-3 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-lg transition-colors shadow-md",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Choose Photo"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-3",children:"Supports JPEG and PNG (max 10MB)"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What part of the plant is visible?"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(E=>jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>s(E.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${v.includes(E.id)?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:E.icon}),E.label]},E.id))}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Helps improve identification accuracy"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Compounds to analyze: ",x]}),jsxRuntimeExports.jsx("input",{type:"range",min:"1",max:"10",value:x,onChange:E=>A(parseInt(E.target.value)),className:"w-32 h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{id:"plant-predictions",type:"checkbox",checked:L,onChange:E=>w(E.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700"}),jsxRuntimeExports.jsxs("label",{htmlFor:"plant-predictions",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:["Enable ML predictions",jsxRuntimeExports.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:"Includes predicted targets (longer analysis time)"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",size:"lg",loading:n,disabled:!R||n,className:"flex-1",children:n?"Analyzing Plant...":"Identify & Analyze"}),R&&jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",size:"lg",onClick:g,disabled:n,children:"Clear"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-sm",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-400 mb-1",children:"How it works:"}),jsxRuntimeExports.jsxs("ol",{className:"list-decimal list-inside text-blue-800 dark:text-blue-300 space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"PlantNet AI identifies the plant species from your photo"}),jsxRuntimeExports.jsx("li",{children:"We look up known medicinal compounds for that plant"}),jsxRuntimeExports.jsx("li",{children:"Each compound is analyzed through ChEMBL for biological pathways"}),jsxRuntimeExports.jsx("li",{children:"Results show how plant compounds may affect your body"})]})]})]})})},PlantAnalysisResults=({result:o,onNewAnalysis:a})=>{const{identification:n,compounds_found:d,compound_analyses:R,aggregate_pathways:S,summary:j}=o,p=A=>A>=.8?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":A>=.5?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",v=A=>A>=.7?"text-green-600 dark:text-green-400":A>=.4?"text-yellow-600 dark:text-yellow-400":"text-gray-600 dark:text-gray-400",D=A=>A>=.7?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":A>=.5?"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300":A>=.3?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",x=A=>A>=.8?"Well-Researched":A>=.6?"Moderate Research":A>=.4?"Limited Research":"Minimal Research";return n.success?jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-6",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl",children:""}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j.plant_identified}),j.common_names&&j.common_names.length>0&&jsxRuntimeExports.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:j.common_names.join(", ")}),j.family&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:["Family: ",j.family]}),jsxRuntimeExports.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[jsxRuntimeExports.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p(j.identification_confidence)}`,children:[(j.identification_confidence*100).toFixed(0),"% confidence"]}),jsxRuntimeExports.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:[j.compounds_analyzed," compounds analyzed"]}),jsxRuntimeExports.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:[j.total_pathways_affected," pathways affected"]}),j.average_research_confidence!==void 0&&jsxRuntimeExports.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:x(j.average_research_confidence)})]})]})]})}),j.drug_interaction_warning&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 rounded-xl p-5",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl",children:""}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-red-800 dark:text-red-300 text-lg mb-2",children:"Drug Interaction Warning"}),jsxRuntimeExports.jsx("p",{className:"text-red-700 dark:text-red-400",children:j.drug_interaction_warning}),j.high_interaction_compounds&&j.high_interaction_compounds.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:j.high_interaction_compounds.map((A,L)=>jsxRuntimeExports.jsxs("span",{className:"px-3 py-1 bg-red-200 dark:bg-red-800 text-red-900 dark:text-red-200 rounded-full text-sm font-medium",children:[A.name," (",(A.risk_level*100).toFixed(0),"% risk)"]},L))})]})]})}),j.lifestyle_categories_affected&&j.lifestyle_categories_affected.length>0&&jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Body Systems Affected"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"This plant's compounds may influence these aspects of health and lifestyle:"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:j.lifestyle_categories_affected.map((A,L)=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-800 dark:text-indigo-300 rounded-full text-sm capitalize",children:A},L))})]}),j.traditional_uses&&j.traditional_uses.length>0&&jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Traditional Uses"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:j.traditional_uses.map((A,L)=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 rounded-full text-sm",children:A},L))})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Active Compounds"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Compounds are ranked by research depth, biological impact, and drug interaction importance."}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((A,L)=>{const w=R.find(b=>b.compound_name===A.name);return jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-l-4 border-primary-500",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-lg font-bold text-primary-500",children:["#",L+1]}),jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-900 dark:text-white capitalize",children:A.name})]}),A.chembl_id&&jsxRuntimeExports.jsx("a",{href:`https://www.ebi.ac.uk/chembl/compound_report_card/${A.chembl_id}/`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary-500 hover:text-primary-600",children:A.chembl_id})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[A.drug_interaction_risk!==void 0&&A.drug_interaction_risk>=.5&&jsxRuntimeExports.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${D(A.drug_interaction_risk)}`,children:[A.drug_interaction_risk>=.7?"High":"Moderate"," Interaction Risk"]}),A.research_level!==void 0&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300",children:x(A.research_level)})]}),A.lifestyle_categories&&A.lifestyle_categories.length>0&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:A.lifestyle_categories.map((b,u)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded text-xs capitalize",children:b},u))}),w&&jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsxs("span",{className:"mr-3",children:[w.targets_found," targets"]}),jsxRuntimeExports.jsxs("span",{children:[w.pathways_found," pathways"]})]})]},L)})})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Most Affected Biological Pathways"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Pathways affected by multiple compounds from this plant receive higher aggregate scores."}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:S.slice(0,10).map((A,L)=>jsxRuntimeExports.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-lg font-semibold text-gray-500 dark:text-gray-400",children:["#",L+1]}),jsxRuntimeExports.jsx("a",{href:A.pathway_url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-gray-900 dark:text-white hover:text-primary-500",children:A.pathway_name})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:A.compounds.map((w,b)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 rounded text-xs",children:w},b))})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsxs("div",{className:`text-xl font-bold ${v(A.aggregate_score)}`,children:[(A.aggregate_score*100).toFixed(0),"%"]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[A.num_compounds," compound",A.num_compounds>1?"s":""]})]})]})},A.pathway_id))})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Analysis Summary"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-primary-600 dark:text-primary-400",children:j.compounds_analyzed}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Compounds"})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:j.total_targets_found}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Targets"})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:j.total_pathways_affected}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pathways"})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:[(j.identification_confidence*100).toFixed(0),"%"]}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"ID Confidence"})]})]})]}),j.top_pathways&&j.top_pathways.length>0&&jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Key Biological Effects"}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:j.top_pathways.map((A,L)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:A.name}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:A.compounds_involved.map((w,b)=>jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[w,b<A.compounds_involved.length-1?", ":""]},b))})]}),jsxRuntimeExports.jsxs("span",{className:`font-bold ${v(A.score)}`,children:[(A.score*100).toFixed(0),"%"]})]},L))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 text-sm",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-yellow-900 dark:text-yellow-400 mb-1",children:"Disclaimer"}),jsxRuntimeExports.jsx("p",{className:"text-yellow-800 dark:text-yellow-300",children:j.disclaimer})]}),j.warning&&jsxRuntimeExports.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4 text-sm",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-orange-900 dark:text-orange-400 mb-1",children:"Notice"}),jsxRuntimeExports.jsx("p",{className:"text-orange-800 dark:text-orange-300",children:j.warning})]}),jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("button",{onClick:a,className:"px-6 py-3 bg-primary-500 text-white font-medium rounded-lg hover:bg-primary-600 transition-colors",children:"Analyze Another Plant"})})]}):jsxRuntimeExports.jsx(Card,{className:"max-w-4xl mx-auto",children:jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"text-5xl mb-4",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Plant Identification Failed"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:n.error||"Unable to identify the plant from the image."}),jsxRuntimeExports.jsx("button",{onClick:a,className:"px-6 py-3 bg-primary-500 text-white font-medium rounded-lg hover:bg-primary-600 transition-colors",children:"Try Another Photo"})]})})},CompoundInfo=({compound:o})=>jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Compound Identity"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Name"}),jsxRuntimeExports.jsx("p",{className:"text-base text-gray-900 dark:text-white mt-1",children:o.ingredient_name})]}),o.pubchem_cid&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"PubChem CID"}),jsxRuntimeExports.jsx("p",{className:"text-base text-gray-900 dark:text-white mt-1",children:jsxRuntimeExports.jsx("a",{href:`https://pubchem.ncbi.nlm.nih.gov/compound/${o.pubchem_cid}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 hover:underline",children:o.pubchem_cid})})]}),o.molecular_formula&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Molecular Formula"}),jsxRuntimeExports.jsx("p",{className:"text-base text-gray-900 dark:text-white mt-1 font-mono",children:o.molecular_formula})]}),o.molecular_weight&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Molecular Weight"}),jsxRuntimeExports.jsxs("p",{className:"text-base text-gray-900 dark:text-white mt-1",children:[o.molecular_weight.toFixed(2)," g/mol"]})]}),o.canonical_smiles&&jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"SMILES"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-200 mt-1 font-mono break-all bg-gray-50 dark:bg-gray-700 p-2 rounded",children:o.canonical_smiles})]}),o.inchikey&&jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"InChIKey"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-200 mt-1 font-mono break-all bg-gray-50 dark:bg-gray-700 p-2 rounded",children:o.inchikey})]}),o.iupac_name&&jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"IUPAC Name"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:o.iupac_name})]})]})]}),formatNumber=(o,a=2)=>o==null?"N/A":o.toFixed(a),formatPChEMBL=o=>o==null?"N/A":o.toFixed(1),formatImpactScore=o=>o==null?"N/A":`${(o*100).toFixed(0)}%`,getPotencyDescription=o=>o==null?"Unknown":o>=8?"Very High":o>=6?"High":o>=4?"Moderate":"Low",SummaryCard=({report:o})=>{const{final_summary:a,known_targets:n,pathways:d}=o,R=[...n,...d],S=R.length>0?R.reduce((v,D)=>v+(D.confidence_score||0),0)/R.length:0,p=(v=>v>=.8?{label:"High",color:"text-green-600 dark:text-green-400"}:v>=.6?{label:"Good",color:"text-blue-600 dark:text-blue-400"}:v>=.4?{label:"Moderate",color:"text-yellow-600 dark:text-yellow-400"}:{label:"Low",color:"text-gray-600 dark:text-gray-400"})(S);return jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[jsxRuntimeExports.jsxs(Card,{className:"text-center",children:[jsxRuntimeExports.jsxs("div",{className:"text-3xl font-bold text-primary-600 dark:text-primary-400",children:[a.total_targets_measured,a.total_targets_predicted>0&&jsxRuntimeExports.jsxs("span",{className:"text-gray-400 dark:text-gray-500 text-2xl",children:[" +",a.total_targets_predicted]})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:[a.total_targets_measured>0?"Measured":""," ",a.total_targets_predicted>0?"& Predicted ":"","Target",a.total_targets_measured+a.total_targets_predicted>1?"s":""]})]}),jsxRuntimeExports.jsxs(Card,{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-primary-600 dark:text-primary-400",children:a.total_pathways_affected}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Biological Pathway",a.total_pathways_affected>1?"s":""," Affected"]})]}),jsxRuntimeExports.jsxs(Card,{className:"text-center",children:[jsxRuntimeExports.jsxs("div",{className:`text-3xl font-bold ${p.color}`,children:[formatNumber(S*100,0),"%"]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Average Confidence ",jsxRuntimeExports.jsx("span",{className:p.color,children:p.label})]})]})]})},TIER_COLORS={A:{bg:"bg-green-100",text:"text-green-800",border:"border-green-300",badge:"bg-green-500",label:"Measured",description:"Experimental bioassay evidence"},B:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-300",badge:"bg-yellow-500",label:"Inferred",description:"Pathway role from known targets"},C:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-300",badge:"bg-gray-500",label:"Predicted",description:"Computational prediction"}},getTierColor=o=>TIER_COLORS[o]||TIER_COLORS.C,Badge=({tier:o,children:a,className:n})=>{const d=o?getTierColor(o):null;return jsxRuntimeExports.jsx("span",{className:clsx("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",o&&d?`${d.bg} ${d.text}`:"bg-gray-100 text-gray-800",n),children:a})},getTargetBodyEffects=(o,a)=>{const n=o.toLowerCase();return n.includes("cyclooxygenase")||n.includes("prostaglandin")||a==="P23219"||a==="P35354"?{systems:["Inflammatory Response","Pain Signaling","Cardiovascular","Gastrointestinal"],effects:[{metric:"Prostaglandin Production",effect:"Reduces inflammatory prostaglandins",direction:"decrease"},{metric:"Pain Perception",effect:"Decreases pain signaling",direction:"decrease"},{metric:"Inflammation",effect:"Reduces swelling and redness",direction:"decrease"},{metric:"Platelet Aggregation",effect:"May affect blood clotting",direction:"modulate"},{metric:"Gastric Protection",effect:"May reduce stomach lining protection",direction:"decrease"}],evidence:[{source:"ChEMBL",description:"Bioactivity data from curated medicinal chemistry literature"},{source:"UniProt P23219/P35354",description:"Prostaglandin G/H synthase (COX-1/COX-2) - validated drug targets"}]}:n.includes("lipoxygenase")||a==="P09917"?{systems:["Inflammatory Response","Immune System","Respiratory"],effects:[{metric:"Leukotriene Production",effect:"Modulates leukotriene synthesis",direction:"modulate"},{metric:"Airway Inflammation",effect:"Affects bronchial constriction",direction:"modulate"},{metric:"Allergic Response",effect:"Influences allergic reactions",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"Bioactivity data from medicinal chemistry sources"},{source:"UniProt P09917",description:"Arachidonate 5-lipoxygenase"}]}:n.includes("cytochrome")||n.includes("cyp")||a.startsWith("P11")?{systems:["Drug Metabolism","Liver Function","Detoxification"],effects:[{metric:"Drug Metabolism",effect:"Alters drug processing speed",direction:"modulate"},{metric:"Drug Interactions",effect:"May affect other medication levels",direction:"modulate"},{metric:"Liver Enzyme Activity",effect:"Influences hepatic function",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"CYP450 interaction data"},{source:"DrugBank",description:"Drug metabolism pathway annotations"}]}:n.includes("aldo-keto")||n.includes("reductase")?{systems:["Steroid Metabolism","Prostaglandin Metabolism","Detoxification"],effects:[{metric:"Steroid Levels",effect:"Modulates steroid hormone metabolism",direction:"modulate"},{metric:"Prostaglandin Levels",effect:"Affects prostaglandin inactivation",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"Enzyme activity data"}]}:n.includes("phospholipase")?{systems:["Cell Signaling","Inflammatory Response","Membrane Function"],effects:[{metric:"Arachidonic Acid Release",effect:"Affects inflammatory precursor release",direction:"modulate"},{metric:"Cell Membrane Integrity",effect:"Influences membrane composition",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"Phospholipase activity assays"}]}:n.includes("kinase")?{systems:["Cell Signaling","Cell Growth","Metabolism"],effects:[{metric:"Cell Proliferation",effect:"Modulates cell growth signals",direction:"modulate"},{metric:"Protein Phosphorylation",effect:"Affects cellular signaling cascades",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"Kinase inhibition assays"}]}:n.includes("channel")||n.includes("receptor")?{systems:["Nervous System","Cell Signaling","Muscle Function"],effects:[{metric:"Neural Signaling",effect:"Modulates nerve impulse transmission",direction:"modulate"},{metric:"Cellular Excitability",effect:"Affects cell responsiveness",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"Receptor binding assays"}]}:{systems:["Cellular Function"],effects:[{metric:"Protein Activity",effect:"Modulates target protein function",direction:"modulate"}],evidence:[{source:"ChEMBL",description:"Bioactivity screening data"}]}},getConfidenceExplanation=(o,a)=>o==="A"?{explanation:"High confidence binding supported by multiple experimental assays with strong potency values.",sources:["ChEMBL curated bioactivity data","Peer-reviewed medicinal chemistry literature",a&&a>=7?"pChEMBL >= 7 indicates sub-micromolar potency":""].filter(Boolean)}:o==="B"?{explanation:"Moderate confidence based on experimental data with moderate potency or fewer confirmatory assays.",sources:["ChEMBL bioactivity data","Limited assay replication"]}:{explanation:"Lower confidence - may be based on predicted interactions or weak experimental binding.",sources:["Computational prediction or weak binding data","Requires additional experimental validation"]},TargetsList=({targets:o})=>{const[a,n]=reactExports.useState("potency"),[d,R]=reactExports.useState(null),S=[...o].sort((v,D)=>a==="name"?v.target_name.localeCompare(D.target_name):(D.pchembl_value||0)-(v.pchembl_value||0)),j=v=>{R(d===v?null:v)},p=v=>{switch(v){case"increase":return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})});case"decrease":return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})});default:return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}};return jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Known Targets"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[o.length," target",o.length!==1?"s":""," with measured potency"]})]}),jsxRuntimeExports.jsxs("select",{value:a,onChange:v=>n(v.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[jsxRuntimeExports.jsx("option",{value:"potency",children:"Sort by Potency"}),jsxRuntimeExports.jsx("option",{value:"name",children:"Sort by Name"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[S.map((v,D)=>{const x=d===D,A=getTargetBodyEffects(v.target_name,v.target_id),L=getConfidenceExplanation(v.confidence_tier,v.pchembl_value);return jsxRuntimeExports.jsxs("div",{className:clsx("border rounded-lg transition-all duration-200 overflow-hidden",x?"border-primary-400 dark:border-primary-500 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-primary-300 dark:hover:border-primary-600"),children:[jsxRuntimeExports.jsxs("div",{onClick:()=>j(D),className:"p-4 cursor-pointer",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:v.target_name}),jsxRuntimeExports.jsx("svg",{className:clsx("w-4 h-4 text-gray-400 transition-transform duration-200",x&&"rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:v.target_id})]}),jsxRuntimeExports.jsxs(Badge,{tier:v.confidence_tier,children:["Tier ",v.confidence_tier]})]}),v.pchembl_value&&jsxRuntimeExports.jsxs("div",{className:"mt-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["pChEMBL: ",formatPChEMBL(v.pchembl_value)]}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[getPotencyDescription(v.pchembl_value)," Potency"]})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-red-500 via-yellow-500 to-green-500 transition-all duration-300",style:{width:`${v.pchembl_value/10*100}%`}})}),v.standard_type&&v.standard_value&&v.standard_units&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[v.standard_type,": ",v.standard_value," ",v.standard_units]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsxs("span",{children:["Source: ",v.source]}),v.assay_references?.length>0&&jsxRuntimeExports.jsxs("span",{children:[" ",v.assay_references.length," assay",v.assay_references.length>1?"s":""]}),jsxRuntimeExports.jsx("span",{className:"ml-auto text-primary-500 dark:text-primary-400",children:x?"Click to collapse":"Click for details"})]})]}),x&&jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-900/50 p-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:clsx("p-3 rounded-lg border",v.confidence_tier==="A"&&"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",v.confidence_tier==="B"&&"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800",v.confidence_tier==="C"&&"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700"),children:[jsxRuntimeExports.jsxs("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Confidence Evidence (Tier ",v.confidence_tier,")"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:L.explanation}),jsxRuntimeExports.jsx("div",{className:"space-y-1",children:L.sources.map((w,b)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4"})}),w]},b))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-200 dark:border-blue-800",children:[jsxRuntimeExports.jsxs("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Data Sources"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[A.evidence.map((w,b)=>jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"font-medium text-blue-800 dark:text-blue-200",children:[w.source,":"]}),jsxRuntimeExports.jsx("span",{className:"text-blue-700 dark:text-blue-300 ml-1",children:w.description})]},b)),v.assay_references?.length>0&&jsxRuntimeExports.jsxs("div",{className:"pt-2 border-t border-blue-200 dark:border-blue-700",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-blue-800 dark:text-blue-200",children:"Assay References:"}),jsxRuntimeExports.jsx("div",{className:"mt-1 space-y-1",children:v.assay_references.slice(0,3).map((w,b)=>jsxRuntimeExports.jsxs("a",{href:w.source_url,target:"_blank",rel:"noopener noreferrer",className:"block text-xs text-blue-600 dark:text-blue-400 hover:underline truncate",children:[w.assay_id,": ",w.assay_description||"View assay details"]},b))})]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),"Affected Body Systems"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:A.systems.map((w,b)=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded-full",children:w},b))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Physiological Effects"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:A.effects.map((w,b)=>jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-100 dark:border-gray-700",children:[jsxRuntimeExports.jsx("div",{className:"mt-0.5",children:p(w.direction)}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:w.metric}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:w.effect})]}),jsxRuntimeExports.jsx("span",{className:clsx("text-xs px-2 py-0.5 rounded-full",w.direction==="increase"&&"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",w.direction==="decrease"&&"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",w.direction==="modulate"&&"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300"),children:w.direction==="increase"?"Increases":w.direction==="decrease"?"Decreases":"Modulates"})]},b))})]})]})]},D)}),o.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No known targets found for this compound."})]})]})},API_BASE_URL="",apiClient=axios.create({baseURL:API_BASE_URL,headers:{"Content-Type":"application/json"},timeout:3e5});apiClient.interceptors.response.use(o=>o,o=>{const a=o.response?.data?.detail||o.message||"An error occurred";return Promise.reject(new Error(a))});const analysisAPI={analyzeSync:async o=>{const{data:a}=await apiClient.post("/analyze_sync",o);return a}},reactomeAPI={getPathwayDetails:async o=>{const{data:a}=await apiClient.get(`/api/reactome/pathway/${o}`);return a},getPathwayParticipants:async o=>{const{data:a}=await apiClient.get(`/api/reactome/pathway/${o}/participants`);return a},getRelatedPathways:async o=>{const{data:a}=await apiClient.get(`/api/reactome/pathway/${o}/related`);return a},getFullPathwayInfo:async o=>{const{data:a}=await apiClient.get(`/api/reactome/pathway/${o}/full`);return a}},pathwayPatterns=[{patterns:[/arachidonic acid/i,/prostaglandin/i,/leukotriene/i,/thromboxane/i,/eicosanoid/i],info:{bodySystems:["immune","cardiovascular","musculoskeletal"],primarySystem:"immune",healthImpact:"mixed",healthDescription:"Controls inflammation, pain signaling, and blood clotting. Modulating this pathway affects how your body responds to injury and infection.",clinicalRelevance:"Target of NSAIDs like ibuprofen and aspirin. Important for managing pain, fever, and inflammation.",relatedConditions:["Arthritis","Cardiovascular disease","Asthma","Inflammatory disorders"],physiologicalRole:"Produces signaling molecules that regulate inflammation, pain, fever, and blood vessel function.",icon:""}},{patterns:[/interleukin/i,/cytokine/i,/interferon/i,/tnf/i,/tumor necrosis/i],info:{bodySystems:["immune","cellular"],primarySystem:"immune",healthImpact:"mixed",healthDescription:"Regulates immune cell communication and inflammatory responses throughout the body.",clinicalRelevance:"Targeted by biologics for autoimmune diseases. Critical for fighting infections but can cause damage if overactive.",relatedConditions:["Rheumatoid arthritis","Psoriasis","Inflammatory bowel disease","COVID-19 cytokine storm"],physiologicalRole:"Coordinates immune responses between cells, activates defense mechanisms, and regulates inflammation duration.",icon:""}},{patterns:[/toll-like receptor/i,/pattern recognition/i,/innate immune/i,/nf-?kb/i],info:{bodySystems:["immune","cellular"],primarySystem:"immune",healthImpact:"mixed",healthDescription:"First line of defense against pathogens. Triggers rapid immune responses to infections.",clinicalRelevance:"Overactivation linked to chronic inflammation. Target for immunomodulatory therapies.",relatedConditions:["Sepsis","Autoimmune diseases","Chronic inflammation","Allergies"],physiologicalRole:"Detects invading microorganisms and damaged cells, initiating protective immune responses.",icon:""}},{patterns:[/platelet/i,/coagulation/i,/hemostasis/i,/fibrin/i,/thrombin/i,/clotting/i],info:{bodySystems:["cardiovascular"],primarySystem:"cardiovascular",healthImpact:"caution",healthDescription:"Controls blood clotting. Affects how quickly bleeding stops and risk of dangerous clots.",clinicalRelevance:"Critical consideration for patients on blood thinners or with clotting disorders.",relatedConditions:["Heart attack","Stroke","Deep vein thrombosis","Bleeding disorders"],physiologicalRole:"Balances blood fluidity with the ability to form clots to stop bleeding from injuries.",icon:""}},{patterns:[/nitric oxide/i,/vasodilation/i,/vascular/i,/endothel/i,/blood pressure/i],info:{bodySystems:["cardiovascular"],primarySystem:"cardiovascular",healthImpact:"beneficial",healthDescription:"Regulates blood vessel dilation and blood pressure. Supports healthy circulation.",clinicalRelevance:"Important for cardiovascular health. Dysfunction linked to hypertension and erectile dysfunction.",relatedConditions:["Hypertension","Atherosclerosis","Erectile dysfunction","Raynaud's disease"],physiologicalRole:"Controls blood vessel diameter, regulating blood flow and pressure throughout the body.",icon:""}},{patterns:[/cardiac/i,/heart/i,/myocardial/i,/atrial/i,/ventricular/i],info:{bodySystems:["cardiovascular"],primarySystem:"cardiovascular",healthImpact:"caution",healthDescription:"Directly affects heart muscle function and rhythm. Important for cardiac health monitoring.",clinicalRelevance:"Compounds affecting this pathway require cardiac safety evaluation.",relatedConditions:["Heart failure","Arrhythmias","Cardiomyopathy","Heart attack"],physiologicalRole:"Controls heart muscle contraction, rhythm, and the heart's ability to pump blood effectively.",icon:""}},{patterns:[/neuronal/i,/synap/i,/neurotransmit/i,/dopamine/i,/serotonin/i,/gaba/i,/glutamate/i],info:{bodySystems:["nervous"],primarySystem:"nervous",healthImpact:"mixed",healthDescription:"Affects brain signaling and nerve communication. May influence mood, cognition, and behavior.",clinicalRelevance:"Target of many psychiatric and neurological medications. Effects depend on specific neurotransmitter affected.",relatedConditions:["Depression","Anxiety","Parkinson's disease","Schizophrenia","ADHD"],physiologicalRole:"Enables communication between nerve cells, controlling thoughts, emotions, movement, and sensations.",icon:""}},{patterns:[/pain/i,/nocicept/i,/opioid/i,/analges/i],info:{bodySystems:["nervous","musculoskeletal"],primarySystem:"nervous",healthImpact:"beneficial",healthDescription:"Modulates pain perception and transmission. Can provide relief from acute and chronic pain.",clinicalRelevance:"Important for pain management. Some pathways carry addiction risk.",relatedConditions:["Chronic pain","Neuropathy","Fibromyalgia","Post-surgical pain"],physiologicalRole:"Processes and regulates pain signals from the body to the brain, determining pain intensity.",icon:""}},{patterns:[/acetylcholin/i,/cholinergic/i,/muscarinic/i,/nicotinic/i],info:{bodySystems:["nervous","musculoskeletal"],primarySystem:"nervous",healthImpact:"mixed",healthDescription:"Controls muscle movement and memory formation. Affects both voluntary movement and organ function.",clinicalRelevance:"Important in Alzheimer's treatment and anesthesia. Also affects digestion and heart rate.",relatedConditions:["Alzheimer's disease","Myasthenia gravis","Parkinson's disease"],physiologicalRole:"Enables nerve-to-muscle communication and is essential for learning and memory.",icon:""}},{patterns:[/glycolysis/i,/gluconeogenesis/i,/glucose/i,/insulin/i,/diabetes/i],info:{bodySystems:["metabolic","endocrine"],primarySystem:"metabolic",healthImpact:"mixed",healthDescription:"Regulates blood sugar levels and energy production from carbohydrates.",clinicalRelevance:"Critical for diabetes management. Affects energy levels and weight.",relatedConditions:["Type 2 diabetes","Metabolic syndrome","Hypoglycemia","Obesity"],physiologicalRole:"Converts glucose to energy and maintains stable blood sugar levels for cellular function.",icon:""}},{patterns:[/lipid/i,/cholesterol/i,/fatty acid/i,/triglyceride/i,/lipoprotein/i],info:{bodySystems:["metabolic","cardiovascular"],primarySystem:"metabolic",healthImpact:"mixed",healthDescription:"Controls fat processing and cholesterol levels. Impacts cardiovascular disease risk.",clinicalRelevance:"Target of statins and other lipid-lowering drugs. Important for heart disease prevention.",relatedConditions:["High cholesterol","Atherosclerosis","Fatty liver disease","Heart disease"],physiologicalRole:"Processes and transports fats throughout the body for energy storage and cell membrane building.",icon:""}},{patterns:[/mitochondr/i,/oxidative phosphorylation/i,/electron transport/i,/atp/i,/citric acid/i,/krebs/i,/tca cycle/i],info:{bodySystems:["metabolic","cellular"],primarySystem:"cellular",healthImpact:"neutral",healthDescription:"Cellular energy production. Affects how efficiently cells generate power for all body functions.",clinicalRelevance:"Mitochondrial dysfunction linked to fatigue, aging, and neurodegenerative diseases.",relatedConditions:["Chronic fatigue","Mitochondrial diseases","Aging-related decline"],physiologicalRole:"Produces ATP, the energy currency that powers all cellular activities.",icon:""}},{patterns:[/cytochrome p450/i,/cyp\d/i,/drug metabolism/i,/xenobiotic/i,/detoxification/i,/hepatic/i],info:{bodySystems:["digestive","metabolic"],primarySystem:"digestive",healthImpact:"caution",healthDescription:"Processes medications and toxins in the liver. Affects how long drugs stay active in your body.",clinicalRelevance:"Critical for drug interactions. May alter effectiveness or side effects of other medications.",relatedConditions:["Drug interactions","Liver disease","Medication toxicity"],physiologicalRole:"Chemically transforms drugs and toxins for elimination, determining drug duration and intensity.",icon:""}},{patterns:[/bile/i,/bilirubin/i,/gallbladder/i],info:{bodySystems:["digestive"],primarySystem:"digestive",healthImpact:"neutral",healthDescription:"Bile production and fat digestion. Supports absorption of fat-soluble vitamins.",clinicalRelevance:"Relevant for gallbladder conditions and fat malabsorption.",relatedConditions:["Gallstones","Jaundice","Fat malabsorption"],physiologicalRole:"Produces bile for fat digestion and eliminates waste products from red blood cell breakdown.",icon:""}},{patterns:[/apoptosis/i,/cell death/i,/caspase/i,/bcl-?2/i],info:{bodySystems:["cellular"],primarySystem:"cellular",healthImpact:"mixed",healthDescription:"Programmed cell death. Essential for removing damaged or potentially cancerous cells.",clinicalRelevance:"Target of cancer therapies. Dysregulation linked to cancer and autoimmune diseases.",relatedConditions:["Cancer","Autoimmune diseases","Neurodegenerative diseases"],physiologicalRole:"Eliminates old, damaged, or abnormal cells to maintain tissue health and prevent cancer.",icon:""}},{patterns:[/cell cycle/i,/proliferation/i,/mitosis/i,/cell division/i,/dna replication/i],info:{bodySystems:["cellular"],primarySystem:"cellular",healthImpact:"caution",healthDescription:"Controls cell division and growth. Affects tissue repair but also cancer development.",clinicalRelevance:"Target of chemotherapy drugs. Important for wound healing and immune cell production.",relatedConditions:["Cancer","Wound healing disorders","Bone marrow conditions"],physiologicalRole:"Regulates when and how cells divide, essential for growth, repair, and immune function.",icon:""}},{patterns:[/p53/i,/tumor suppress/i,/oncogene/i,/cancer/i,/carcinogen/i],info:{bodySystems:["cellular"],primarySystem:"cellular",healthImpact:"beneficial",healthDescription:"Cancer surveillance and prevention. Detects and eliminates potentially cancerous cells.",clinicalRelevance:"Critical for cancer prevention. Mutations in these pathways increase cancer risk.",relatedConditions:["Various cancers","Li-Fraumeni syndrome"],physiologicalRole:"Acts as the body's defense against cancer by stopping damaged cells from dividing.",icon:""}},{patterns:[/dna repair/i,/base excision/i,/nucleotide excision/i,/mismatch repair/i],info:{bodySystems:["cellular"],primarySystem:"cellular",healthImpact:"beneficial",healthDescription:"Fixes DNA damage to prevent mutations. Protects genetic integrity.",clinicalRelevance:"Important for cancer prevention and aging. Some chemotherapies target cancer cells' DNA repair.",relatedConditions:["Cancer susceptibility","Premature aging syndromes"],physiologicalRole:"Continuously repairs DNA damage from normal metabolism and environmental exposure.",icon:""}},{patterns:[/transcription/i,/gene expression/i,/chromatin/i,/histone/i,/epigenetic/i],info:{bodySystems:["cellular"],primarySystem:"cellular",healthImpact:"neutral",healthDescription:"Controls which genes are active. Affects how cells respond to their environment.",clinicalRelevance:"Emerging target for cancer and metabolic disease treatments.",relatedConditions:["Cancer","Developmental disorders","Metabolic diseases"],physiologicalRole:"Determines which proteins cells produce, adapting cell behavior to current needs.",icon:""}},{patterns:[/estrogen/i,/androgen/i,/testosterone/i,/steroid hormone/i,/progesterone/i],info:{bodySystems:["endocrine","reproductive"],primarySystem:"endocrine",healthImpact:"mixed",healthDescription:"Sex hormone signaling. Affects reproduction, bone health, mood, and metabolism.",clinicalRelevance:"Important for hormone replacement therapy. Some cancers are hormone-sensitive.",relatedConditions:["Breast cancer","Prostate cancer","Osteoporosis","Menopause symptoms"],physiologicalRole:"Regulates sexual development, reproductive function, and many metabolic processes.",icon:""}},{patterns:[/thyroid/i,/thyroxine/i,/t3/i,/t4/i],info:{bodySystems:["endocrine","metabolic"],primarySystem:"endocrine",healthImpact:"mixed",healthDescription:"Thyroid hormone function. Controls metabolic rate, energy, and body temperature.",clinicalRelevance:"Relevant for thyroid disorders. Affects weight, energy levels, and heart function.",relatedConditions:["Hypothyroidism","Hyperthyroidism","Goiter","Thyroid cancer"],physiologicalRole:"Sets the body's metabolic pace, affecting how fast you burn calories and produce energy.",icon:""}},{patterns:[/cortisol/i,/glucocorticoid/i,/adrenal/i,/stress hormone/i,/hpa axis/i],info:{bodySystems:["endocrine","immune"],primarySystem:"endocrine",healthImpact:"mixed",healthDescription:"Stress response and cortisol regulation. Affects immune function, metabolism, and inflammation.",clinicalRelevance:"Corticosteroids are powerful anti-inflammatories but have significant side effects.",relatedConditions:["Cushing's syndrome","Addison's disease","Chronic stress effects"],physiologicalRole:"Manages the body's stress response and helps regulate immune function and metabolism.",icon:""}},{patterns:[/respiratory/i,/pulmonary/i,/lung/i,/bronch/i,/airway/i],info:{bodySystems:["respiratory"],primarySystem:"respiratory",healthImpact:"mixed",healthDescription:"Lung and airway function. Affects breathing ease and oxygen delivery.",clinicalRelevance:"Important for asthma, COPD, and other respiratory conditions.",relatedConditions:["Asthma","COPD","Bronchitis","Pulmonary fibrosis"],physiologicalRole:"Controls airway diameter, mucus production, and gas exchange in the lungs.",icon:""}},{patterns:[/renal/i,/kidney/i,/nephro/i,/urinary/i,/diuretic/i],info:{bodySystems:["urinary"],primarySystem:"urinary",healthImpact:"caution",healthDescription:"Kidney function and fluid balance. Affects blood pressure and waste removal.",clinicalRelevance:"Many drugs require kidney function monitoring. NSAIDs can affect kidney blood flow.",relatedConditions:["Chronic kidney disease","Kidney stones","Hypertension","Edema"],physiologicalRole:"Filters blood, removes waste, and maintains fluid and electrolyte balance.",icon:""}},{patterns:[/bone/i,/osteoclast/i,/osteoblast/i,/calcium homeostasis/i,/bone remodel/i],info:{bodySystems:["musculoskeletal"],primarySystem:"musculoskeletal",healthImpact:"mixed",healthDescription:"Bone formation and resorption. Affects bone strength and fracture risk.",clinicalRelevance:"Important for osteoporosis prevention and treatment.",relatedConditions:["Osteoporosis","Osteoarthritis","Fractures","Paget's disease"],physiologicalRole:"Continuously rebuilds bone tissue, maintaining skeletal strength and calcium reserves.",icon:""}},{patterns:[/muscle/i,/myocyte/i,/skeletal/i,/sarco/i],info:{bodySystems:["musculoskeletal"],primarySystem:"musculoskeletal",healthImpact:"neutral",healthDescription:"Muscle function and development. Affects strength, movement, and metabolism.",clinicalRelevance:"Relevant for muscle disorders and some drug side effects (e.g., statins).",relatedConditions:["Muscular dystrophy","Myopathy","Sarcopenia"],physiologicalRole:"Controls muscle contraction, movement, and contributes to metabolic health.",icon:""}},{patterns:[/histamine/i,/mast cell/i,/allergy/i,/ige/i,/anaphyla/i],info:{bodySystems:["immune","respiratory"],primarySystem:"immune",healthImpact:"mixed",healthDescription:"Allergic response and histamine release. Affects allergic symptoms and inflammation.",clinicalRelevance:"Target of antihistamines. Important for allergy and anaphylaxis management.",relatedConditions:["Allergies","Asthma","Anaphylaxis","Urticaria"],physiologicalRole:"Triggers protective responses to allergens, causing symptoms like itching, swelling, and mucus production.",icon:""}},{patterns:[/antioxidant/i,/oxidative stress/i,/reactive oxygen/i,/ros/i,/glutathione/i,/nrf2/i,/free radical/i],info:{bodySystems:["cellular","metabolic"],primarySystem:"cellular",healthImpact:"beneficial",healthDescription:"Protects cells from oxidative damage. Supports cellular health and longevity.",clinicalRelevance:"Antioxidant support may help prevent chronic diseases and aging-related damage.",relatedConditions:["Aging","Neurodegenerative diseases","Cardiovascular disease","Cancer"],physiologicalRole:"Neutralizes harmful free radicals that can damage DNA, proteins, and cell membranes.",icon:""}}],defaultPathwayInfo={bodySystems:["cellular"],primarySystem:"cellular",healthImpact:"neutral",healthDescription:"Cellular biological process. May affect various aspects of cell function and health.",clinicalRelevance:"Biological significance depends on specific pathway involvement.",relatedConditions:[],physiologicalRole:"Contributes to cellular function and homeostasis.",icon:""};function getPathwayHealthInfo(o){for(const a of pathwayPatterns)for(const n of a.patterns)if(n.test(o))return a.info;return defaultPathwayInfo}function getBodySystemDisplayName(o){return{cardiovascular:"Cardiovascular System",nervous:"Nervous System",immune:"Immune System",digestive:"Digestive System",respiratory:"Respiratory System",musculoskeletal:"Musculoskeletal System",endocrine:"Endocrine System",urinary:"Urinary System",integumentary:"Skin & Integumentary",reproductive:"Reproductive System",metabolic:"Metabolism",cellular:"Cellular Processes"}[o]}function getHealthImpactColors(o){switch(o){case"beneficial":return{bg:"bg-green-50 dark:bg-green-900/20",text:"text-green-700 dark:text-green-300",border:"border-green-200 dark:border-green-700",dot:"bg-green-500"};case"caution":return{bg:"bg-amber-50 dark:bg-amber-900/20",text:"text-amber-700 dark:text-amber-300",border:"border-amber-200 dark:border-amber-700",dot:"bg-amber-500"};case"mixed":return{bg:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-700 dark:text-blue-300",border:"border-blue-200 dark:border-blue-700",dot:"bg-blue-500"};default:return{bg:"bg-gray-50 dark:bg-gray-800",text:"text-gray-700 dark:text-gray-300",border:"border-gray-200 dark:border-gray-700",dot:"bg-gray-500"}}}function getBodySystemIcon(o){return{cardiovascular:"",nervous:"",immune:"",digestive:"",respiratory:"",musculoskeletal:"",endocrine:"",urinary:"",integumentary:"",reproductive:"",metabolic:"",cellular:""}[o]}const HealthImpactBadge=({impact:o})=>{const a=getHealthImpactColors(o),n={beneficial:"Beneficial",caution:"Use Caution",mixed:"Mixed Effects",neutral:"Neutral"};return jsxRuntimeExports.jsxs("span",{className:clsx("inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium",a.bg,a.text),children:[jsxRuntimeExports.jsx("span",{className:clsx("w-1.5 h-1.5 rounded-full",a.dot)}),n[o]]})},BodySystemPills=({systems:o,primarySystem:a})=>jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1.5",children:o.map((n,d)=>jsxRuntimeExports.jsxs("span",{className:clsx("inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs",n===a?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 font-medium":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"),children:[jsxRuntimeExports.jsx("span",{children:getBodySystemIcon(n)}),getBodySystemDisplayName(n)]},d))}),LoadingSpinner=()=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-sm text-gray-500 dark:text-gray-400",children:"Loading Reactome data..."})]}),PathwayDetail=({pathway:o,isExpanded:a})=>{const[n,d]=reactExports.useState(null),[R,S]=reactExports.useState(!1),[j,p]=reactExports.useState(null),v=getPathwayHealthInfo(o.pathway_name),D=getHealthImpactColors(v.healthImpact);return reactExports.useEffect(()=>{a&&!n&&!R&&(S(!0),p(null),reactomeAPI.getFullPathwayInfo(o.pathway_id).then(x=>{d(x),S(!1)}).catch(x=>{console.error("Failed to fetch Reactome data:",x),p("Could not load pathway details from Reactome"),S(!1)}))},[a,o.pathway_id,n,R]),R?jsxRuntimeExports.jsx(LoadingSpinner,{}):jsxRuntimeExports.jsxs("div",{className:"mt-4 space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:[n?.summation&&jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[jsxRuntimeExports.jsxs("h5",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Reactome Description"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 leading-relaxed",children:n.summation}),jsxRuntimeExports.jsx("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:"Source: Reactome Database"})]}),j&&jsxRuntimeExports.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-lg p-3 border border-amber-200 dark:border-amber-700",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:j})}),jsxRuntimeExports.jsx("div",{className:clsx("p-4 rounded-lg border",D.bg,D.border),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:v.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h5",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Health Relevance Analysis"}),jsxRuntimeExports.jsx("p",{className:clsx("text-sm",D.text),children:v.healthDescription})]})]})}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Physiological Role"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:v.physiologicalRole})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Clinical Relevance"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:v.clinicalRelevance})]})]}),n&&n.participants.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Pathway Participants (",n.total_participants," proteins)"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[n.participants.map((x,A)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded text-xs font-mono",children:x},A)),n.has_more_participants&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 rounded text-xs",children:["+",n.total_participants-n.participants.length," more"]})]})]}),n&&n.related_pathways.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Related Pathways (",n.related_pathway_count,")"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1.5",children:n.related_pathways.map((x,A)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-xs font-mono",children:x},A))})]}),v.relatedConditions.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Related Health Conditions"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:v.relatedConditions.map((x,A)=>jsxRuntimeExports.jsx("span",{className:"px-2.5 py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-full text-xs text-gray-700 dark:text-gray-300",children:x},A))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Affected Body Systems"]}),jsxRuntimeExports.jsx(BodySystemPills,{systems:v.bodySystems,primarySystem:v.primarySystem})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Technical Details"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Pathway ID"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900 dark:text-white font-mono text-xs",children:o.pathway_id})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Species"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900 dark:text-white",children:o.pathway_species})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Measured Targets"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900 dark:text-white",children:o.measured_targets_count})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Predicted Targets"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900 dark:text-white",children:o.predicted_targets_count})]})]}),o.matched_targets.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-gray-400 block mb-1",children:"Matched Targets"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:o.matched_targets.map((x,A)=>jsxRuntimeExports.jsx("span",{className:"px-1.5 py-0.5 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded text-xs font-mono",children:x},A))})]})]}),o.explanation&&jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 italic bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 rounded-lg p-3",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Analysis Note: "}),o.explanation]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 pt-2 border-t border-gray-200 dark:border-gray-700",children:"Pathway data from Reactome (reactome.org)  Health relevance analysis based on mechanism of action"})]})},PathwaysList=({pathways:o})=>{const[a,n]=reactExports.useState(null),d=[...o].sort((S,j)=>j.impact_score-S.impact_score),R=S=>{n(a===S?null:S)};return jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between mb-4",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Affected Pathways"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[o.length," biological pathway",o.length!==1?"s":""," affected  Click to load Reactome details"]})]})}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[d.map((S,j)=>{const p=getPathwayHealthInfo(S.pathway_name),v=a===j;return jsxRuntimeExports.jsxs("div",{className:clsx("border rounded-xl transition-all duration-200 overflow-hidden",v?"border-primary-300 dark:border-primary-600 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-primary-200 dark:hover:border-primary-700"),children:[jsxRuntimeExports.jsxs("div",{onClick:()=>R(j),className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:p.icon}),jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white truncate",children:S.pathway_name})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx(HealthImpactBadge,{impact:p.healthImpact}),jsxRuntimeExports.jsxs(Badge,{tier:S.confidence_tier,children:["Tier ",S.confidence_tier]}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[getBodySystemIcon(p.primarySystem)," ",getBodySystemDisplayName(p.primarySystem)]})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:p.healthDescription})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-end gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:formatImpactScore(S.impact_score)}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Impact"})]}),jsxRuntimeExports.jsx("button",{className:clsx("p-1.5 rounded-full transition-transform duration-200",v&&"rotate-180"),children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:jsxRuntimeExports.jsx("div",{className:"h-1.5 rounded-full transition-all duration-300",style:{width:`${S.impact_score*100}%`,backgroundColor:S.confidence_tier==="A"?"#10b981":S.confidence_tier==="B"?"#f59e0b":"#6b7280"}})})})]}),v&&jsxRuntimeExports.jsx("div",{className:"px-4 pb-4",children:jsxRuntimeExports.jsx(PathwayDetail,{pathway:S,isExpanded:v})})]},j)}),o.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No pathways found for this compound."})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Health Impact Legend"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-4 text-xs",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Beneficial - Generally positive health effects"})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Mixed - Both benefits and considerations"})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Caution - Monitor for potential effects"})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-gray-500"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Neutral - Standard biological process"})]})]})]})]})},BODY_SYSTEMS={cardiovascular:{name:"Cardiovascular System",organs:["Heart","Blood Vessels","Blood Pressure"],keywords:["ACE","ADRB","HTN","CYP2D6","calcium","potassium","renin"],color:"#ef4444"},respiratory:{name:"Respiratory System",organs:["Lungs","Airways","Bronchi"],keywords:["bronch","respir","asthma","COPD","histamine","leukotriene"],color:"#f59e0b"},digestive:{name:"Digestive System",organs:["Stomach","Intestines","Liver"],keywords:["stomach","GI","digestive","acid","PPI","CYP3A4","CYP2C9","hepatic"],color:"#eab308"},nervous:{name:"Nervous System",organs:["Brain","Spinal Cord","Neurons"],keywords:["dopamine","serotonin","GABA","glutamate","acetylcholine","CNS","neurotransmitter"],color:"#8b5cf6"},immune:{name:"Immune System",organs:["Lymph Nodes","Spleen","Thymus"],keywords:["immune","inflammation","TNF","IL-","COX","NSAID","interferon","cytokine"],color:"#06b6d4"},endocrine:{name:"Endocrine System",organs:["Pancreas","Thyroid","Pituitary"],keywords:["glucose","insulin","diabetes","thyroid","hormone","cortisol","estrogen"],color:"#ec4899"},metabolic:{name:"Metabolic System",organs:["Liver","Kidneys","Mitochondria"],keywords:["metabolism","CYP450","gluconeogenesis","HMGCR","statin","kidney","renal"],color:"#10b981"},musculoskeletal:{name:"Musculoskeletal System",organs:["Muscles","Bones","Joints"],keywords:["muscle","bone","joint","arthritis","calcium","vitamin D","RANKL"],color:"#f97316"}},BodyDiagram=({targets:o,pathways:a,compoundName:n})=>{const[d,R]=reactExports.useState(!1),S=reactExports.useMemo(()=>{const p=[...o.map(D=>`${D.target_name} ${D.target_id}`),...a.map(D=>`${D.pathway_name} ${D.explanation||""}`)].join(" ").toLowerCase(),v=Object.entries(BODY_SYSTEMS).filter(([D,x])=>x.keywords.some(A=>p.includes(A.toLowerCase())));return v.length>0?v:Object.entries(BODY_SYSTEMS).slice(0,3)},[o,a]),j=S.length;return jsxRuntimeExports.jsxs(Card,{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-600 text-primary-700 dark:text-primary-300 mb-2",children:"Body Systems Affected"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[n," may affect ",j," major body system",j!==1?"s":""]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:S.map(([p,v])=>jsxRuntimeExports.jsx("div",{className:"p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md",style:{borderColor:v.color,backgroundColor:`${v.color}10`},children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 text-white font-bold text-lg",style:{backgroundColor:v.color},children:v.name.charAt(0)}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-600 text-gray-900 dark:text-gray-100 mb-1",children:v.name}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:v.organs.map((D,x)=>jsxRuntimeExports.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border",style:{borderColor:v.color},children:D},x))})]})]})},p))}),(o.length>0||a.length>0)&&jsxRuntimeExports.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsxs("h4",{className:"text-sm font-600 text-gray-900 dark:text-gray-100",children:["Related Mechanisms (",o.length+a.length,")"]}),(o.length>5||a.length>3)&&jsxRuntimeExports.jsx("button",{onClick:()=>R(!d),className:"text-xs px-3 py-1 rounded bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 hover:bg-primary-200 dark:hover:bg-primary-900/50 transition-colors",children:d?"Collapse":"Expand All"})]}),jsxRuntimeExports.jsxs("div",{className:`space-y-2 text-sm ${d?"max-h-96 overflow-y-auto pr-2":""}`,children:[(d?o:o.slice(0,5)).map(p=>jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2 p-2 rounded bg-gray-50 dark:bg-gray-800",children:[jsxRuntimeExports.jsx("span",{className:"text-primary-600 dark:text-primary-400 font-bold",children:""}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:p.target_name}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[p.organism,"  ",p.target_type]})]})]},p.target_id)),(d?a:a.slice(0,3)).map((p,v)=>jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2 p-2 rounded bg-gray-50 dark:bg-gray-800",children:[jsxRuntimeExports.jsx("span",{className:"text-primary-600 dark:text-primary-400 font-bold",children:""}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:p.pathway_name}),p.explanation&&jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:p.explanation})]})]},v))]}),!d&&(o.length>5||a.length>3)&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:['Click "Expand All" to see ',o.length-5+(a.length>3?a.length-3:0)," more mechanism",o.length-5+(a.length>3?a.length-3:0)!==1?"s":""]})]}),jsxRuntimeExports.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[jsxRuntimeExports.jsx("strong",{children:"Body System Impact:"})," This diagram shows which major body systems may be affected based on the drug's known targets and biological pathways. Color intensity indicates the primary systems of action."]})})]})};var _3Dmol$1={exports:{}};var _3Dmol=_3Dmol$1.exports,hasRequired_3Dmol;function require_3Dmol(){return hasRequired_3Dmol||(hasRequired_3Dmol=1,(function(module,exports$1){(function(a,n){module.exports=n()})(_3Dmol,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js"(o,a,n){n.r(a),n.d(a,{IOBuffer:()=>p});var d=n("./node_modules/iobuffer/lib-esm/text.js");const R=1024*8,S=(()=>{const v=new Uint8Array(4),D=new Uint32Array(v.buffer);return!((D[0]=1)&v[0])})(),j={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class p{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(D=R,x={}){let A=!1;typeof D=="number"?D=new ArrayBuffer(D):(A=!0,this.lastWrittenByte=D.byteLength);const L=x.offset?x.offset>>>0:0,w=D.byteLength-L;let b=L;(ArrayBuffer.isView(D)||D instanceof p)&&(D.byteLength!==D.buffer.byteLength&&(b=D.byteOffset+L),D=D.buffer),A?this.lastWrittenByte=w:this.lastWrittenByte=0,this.buffer=D,this.length=w,this.byteLength=w,this.byteOffset=b,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,b,w),this._mark=0,this._marks=[]}available(D=1){return this.offset+D<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(D=1){return this.offset+=D,this}back(D=1){return this.offset-=D,this}seek(D){return this.offset=D,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const D=this._marks.pop();if(D===void 0)throw new Error("Mark stack empty");return this.seek(D),this}rewind(){return this.offset=0,this}ensureAvailable(D=1){if(!this.available(D)){const A=(this.offset+D)*2,L=new Uint8Array(A);L.set(new Uint8Array(this.buffer)),this.buffer=L.buffer,this.length=A,this.byteLength=A,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(D=1){return this.readArray(D,"uint8")}readArray(D,x){const A=j[x].BYTES_PER_ELEMENT*D,L=this.byteOffset+this.offset,w=this.buffer.slice(L,L+A);if(this.littleEndian===S&&x!=="uint8"&&x!=="int8"){const u=new Uint8Array(this.buffer.slice(L,L+A));u.reverse();const i=new j[x](u.buffer);return this.offset+=A,i.reverse(),i}const b=new j[x](w);return this.offset+=A,b}readInt16(){const D=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,D}readUint16(){const D=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,D}readInt32(){const D=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,D}readUint32(){const D=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,D}readFloat32(){const D=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,D}readFloat64(){const D=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,D}readBigInt64(){const D=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,D}readBigUint64(){const D=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,D}readChar(){return String.fromCharCode(this.readInt8())}readChars(D=1){let x="";for(let A=0;A<D;A++)x+=this.readChar();return x}readUtf8(D=1){return(0,d.decode)(this.readBytes(D))}decodeText(D=1,x="utf8"){return(0,d.decode)(this.readBytes(D),x)}writeBoolean(D){return this.writeUint8(D?255:0),this}writeInt8(D){return this.ensureAvailable(1),this._data.setInt8(this.offset++,D),this._updateLastWrittenByte(),this}writeUint8(D){return this.ensureAvailable(1),this._data.setUint8(this.offset++,D),this._updateLastWrittenByte(),this}writeByte(D){return this.writeUint8(D)}writeBytes(D){this.ensureAvailable(D.length);for(let x=0;x<D.length;x++)this._data.setUint8(this.offset++,D[x]);return this._updateLastWrittenByte(),this}writeInt16(D){return this.ensureAvailable(2),this._data.setInt16(this.offset,D,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(D){return this.ensureAvailable(2),this._data.setUint16(this.offset,D,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(D){return this.ensureAvailable(4),this._data.setInt32(this.offset,D,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(D){return this.ensureAvailable(4),this._data.setUint32(this.offset,D,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(D){return this.ensureAvailable(4),this._data.setFloat32(this.offset,D,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(D){return this.ensureAvailable(8),this._data.setFloat64(this.offset,D,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(D){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,D,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(D){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,D,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(D){return this.writeUint8(D.charCodeAt(0))}writeChars(D){for(let x=0;x<D.length;x++)this.writeUint8(D.charCodeAt(x));return this}writeUtf8(D){return this.writeBytes((0,d.encode)(D))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},"./node_modules/iobuffer/lib-esm/text.js"(o,a,n){n.r(a),n.d(a,{decode:()=>d,encode:()=>S});function d(j,p="utf8"){return new TextDecoder(p).decode(j)}const R=new TextEncoder;function S(j){return R.encode(j)}},"./node_modules/netcdfjs/lib-esm/data.js"(o,a,n){n.r(a),n.d(a,{nonRecord:()=>R,record:()=>S});var d=n("./node_modules/netcdfjs/lib-esm/types.js");function R(j,p){const v=(0,d.str2num)(p.type),D=p.size/(0,d.num2bytes)(v),x=new Array(D);for(let A=0;A<D;A++)x[A]=(0,d.readType)(j,v,1);return x}function S(j,p,v){const D=(0,d.str2num)(p.type),x=p.size?p.size/(0,d.num2bytes)(D):1,A=v.length,L=new Array(A),w=v.recordStep;if(w)for(let b=0;b<A;b++){const u=j.offset;L[b]=(0,d.readType)(j,D,x),j.seek(u+w)}else throw new Error("recordDimension.recordStep is undefined");return L}},"./node_modules/netcdfjs/lib-esm/header.js"(o,a,n){n.r(a),n.d(a,{header:()=>x});var d=n("./node_modules/netcdfjs/lib-esm/types.js"),R=n("./node_modules/netcdfjs/lib-esm/utils.js");const S=0,j=10,p=11,v=12,D=0;function x(b,u){const i={version:u},s={length:b.readUint32()},h=A(b);Array.isArray(h)||(s.id=h.recordId,s.name=h.recordName,i.dimensions=h.dimensions),i.globalAttributes=L(b);const g=w(b,s?.id,u);return Array.isArray(g)||(i.variables=g.variables,s.recordStep=g.recordStep),i.recordDimension=s,i}function A(b){const u={};let i,s;const h=b.readUint32();let g;if(h===S)return(0,R.notNetcdf)(b.readUint32()!==S,"wrong empty tag for list of dimensions"),[];{(0,R.notNetcdf)(h!==j,"wrong tag for list of dimensions");const y=b.readUint32();g=new Array(y);for(let E=0;E<y;E++){const l=(0,R.readName)(b),f=b.readUint32();f===D&&(i=E,s=l),g[E]={name:l,size:f}}}return i!==void 0&&(u.recordId=i),s!==void 0&&(u.recordName=s),u.dimensions=g,u}function L(b){const u=b.readUint32();let i;if(u===S)return(0,R.notNetcdf)(b.readUint32()!==S,"wrong empty tag for list of attributes"),[];{(0,R.notNetcdf)(u!==v,"wrong tag for list of attributes");const s=b.readUint32();i=new Array(s);for(let h=0;h<s;h++){const g=(0,R.readName)(b),y=b.readUint32();(0,R.notNetcdf)(y<1||y>6,`non valid type ${y}`);const E=b.readUint32(),l=(0,d.readType)(b,y,E);(0,R.padding)(b),i[h]={name:g,type:(0,d.num2str)(y),value:l}}}return i}function w(b,u,i){const s=b.readUint32();let h=0,g;if(s===S)return(0,R.notNetcdf)(b.readUint32()!==S,"wrong empty tag for list of variables"),[];{(0,R.notNetcdf)(s!==p,"wrong tag for list of variables");const y=b.readUint32();g=new Array(y);for(let E=0;E<y;E++){const l=(0,R.readName)(b),f=b.readUint32(),m=new Array(f);for(let B=0;B<f;B++)m[B]=b.readUint32();const C=L(b),T=b.readUint32();(0,R.notNetcdf)(T<1&&T>6,`non valid type ${T}`);const P=b.readUint32();let F=b.readUint32();i===2&&((0,R.notNetcdf)(F>0,"offsets larger than 4GB not supported"),F=b.readUint32());let N=!1;typeof u<"u"&&m[0]===u&&(h+=P,N=!0),g[E]={name:l,dimensions:m,attributes:C,type:(0,d.num2str)(T),size:P,offset:F,record:N}}}return{variables:g,recordStep:h}}},"./node_modules/netcdfjs/lib-esm/index.js"(o,a,n){n.r(a),n.d(a,{NetCDFReader:()=>d.NetCDFReader});var d=n("./node_modules/netcdfjs/lib-esm/parser.js")},"./node_modules/netcdfjs/lib-esm/parser.js"(o,a,n){n.r(a),n.d(a,{NetCDFReader:()=>v});var d=n("./node_modules/iobuffer/lib-esm/IOBuffer.js"),R=n("./node_modules/netcdfjs/lib-esm/data.js"),S=n("./node_modules/netcdfjs/lib-esm/header.js"),j=n("./node_modules/netcdfjs/lib-esm/toString.js"),p=n("./node_modules/netcdfjs/lib-esm/utils.js");class v{constructor(x){this.toString=j.toString;const A=new d.IOBuffer(x);A.setBigEndian(),(0,p.notNetcdf)(A.readChars(3)!=="CDF","should start with CDF");const L=A.readByte();(0,p.notNetcdf)(L>2,"unknown version"),this.header=(0,S.header)(A,L),this.buffer=A}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(x){const A=this.globalAttributes.find(L=>L.name===x);return A?A.value:null}getDataVariableAsString(x){const A=this.getDataVariable(x);return A?A.join(""):null}get variables(){return this.header.variables}getDataVariable(x){let A;if(typeof x=="string"?A=this.header.variables.find(L=>L.name===x):A=x,A===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(A.offset),A.record?(0,R.record)(this.buffer,A,this.header.recordDimension):(0,R.nonRecord)(this.buffer,A)}dataVariableExists(x){return this.header.variables.find(L=>L.name===x)!==void 0}attributeExists(x){return this.globalAttributes.find(L=>L.name===x)!==void 0}}},"./node_modules/netcdfjs/lib-esm/toString.js"(o,a,n){n.r(a),n.d(a,{toString:()=>d});function d(){const R=[];R.push("DIMENSIONS");for(const j of this.dimensions)R.push(`  ${j.name.padEnd(30)} = size: ${j.size}`);R.push(""),R.push("GLOBAL ATTRIBUTES");for(const j of this.globalAttributes)R.push(`  ${j.name.padEnd(30)} = ${j.value}`);const S=JSON.parse(JSON.stringify(this.variables));R.push(""),R.push("VARIABLES:");for(const j of S){j.value=this.getDataVariable(j);let p=JSON.stringify(j.value);p.length>50&&(p=p.substring(0,50)),isNaN(j.value.length)||(p+=` (length: ${j.value.length})`),R.push(`  ${j.name.padEnd(30)} = ${p}`)}return R.join(`
`)}},"./node_modules/netcdfjs/lib-esm/types.js"(o,a,n){n.r(a),n.d(a,{num2bytes:()=>S,num2str:()=>R,readType:()=>v,str2num:()=>j});const d={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function R(x){switch(Number(x)){case d.BYTE:return"byte";case d.CHAR:return"char";case d.SHORT:return"short";case d.INT:return"int";case d.FLOAT:return"float";case d.DOUBLE:return"double";default:return"undefined"}}function S(x){switch(Number(x)){case d.BYTE:return 1;case d.CHAR:return 1;case d.SHORT:return 2;case d.INT:return 4;case d.FLOAT:return 4;case d.DOUBLE:return 8;default:return-1}}function j(x){switch(String(x)){case"byte":return d.BYTE;case"char":return d.CHAR;case"short":return d.SHORT;case"int":return d.INT;case"float":return d.FLOAT;case"double":return d.DOUBLE;default:return-1}}function p(x,A){if(x!==1){const L=new Array(x);for(let w=0;w<x;w++)L[w]=A();return L}else return A()}function v(x,A,L){switch(A){case d.BYTE:return Array.from(x.readBytes(L));case d.CHAR:return D(x.readChars(L));case d.SHORT:return p(L,x.readInt16.bind(x));case d.INT:return p(L,x.readInt32.bind(x));case d.FLOAT:return p(L,x.readFloat32.bind(x));case d.DOUBLE:return p(L,x.readFloat64.bind(x));default:throw new Error(`non valid type ${A}`)}}function D(x){return x.charCodeAt(x.length-1)===0?x.substring(0,x.length-1):x}},"./node_modules/netcdfjs/lib-esm/utils.js"(o,a,n){n.r(a),n.d(a,{notNetcdf:()=>d,padding:()=>R,readName:()=>S});function d(j,p){if(j)throw new TypeError(`Not a valid NetCDF v3.x file: ${p}`)}function R(j){j.offset%4!==0&&j.skip(4-j.offset%4)}function S(j){const p=j.readUint32(),v=j.readChars(p);return R(j),v}},"./node_modules/pako/dist/pako.esm.mjs"(o,a,n){n.r(a),n.d(a,{Deflate:()=>da,Inflate:()=>ha,constants:()=>Ni,default:()=>Ss,deflate:()=>Xr,deflateRaw:()=>Bn,gzip:()=>Rs,inflate:()=>so,inflateRaw:()=>li,ungzip:()=>Ii});const d=4,R=0,S=1,j=2;function p(_){let X=_.length;for(;--X>=0;)_[X]=0}const v=0,D=1,x=2,A=3,L=258,w=29,b=256,u=b+1+w,i=30,s=19,h=2*u+1,g=15,y=16,E=7,l=256,f=16,m=17,C=18,T=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),P=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),F=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B=512,U=new Array((u+2)*2);p(U);const K=new Array(i*2);p(K);const H=new Array(B);p(H);const G=new Array(L-A+1);p(G);const $=new Array(w);p($);const V=new Array(i);p(V);function k(_,X,O,te,oe){this.static_tree=_,this.extra_bits=X,this.extra_base=O,this.elems=te,this.max_length=oe,this.has_stree=_&&_.length}let Y,ie,ne;function he(_,X){this.dyn_tree=_,this.max_code=0,this.stat_desc=X}const le=_=>_<256?H[_]:H[256+(_>>>7)],xe=(_,X)=>{_.pending_buf[_.pending++]=X&255,_.pending_buf[_.pending++]=X>>>8&255},fe=(_,X,O)=>{_.bi_valid>y-O?(_.bi_buf|=X<<_.bi_valid&65535,xe(_,_.bi_buf),_.bi_buf=X>>y-_.bi_valid,_.bi_valid+=O-y):(_.bi_buf|=X<<_.bi_valid&65535,_.bi_valid+=O)},pe=(_,X,O)=>{fe(_,O[X*2],O[X*2+1])},Te=(_,X)=>{let O=0;do O|=_&1,_>>>=1,O<<=1;while(--X>0);return O>>>1},ke=_=>{_.bi_valid===16?(xe(_,_.bi_buf),_.bi_buf=0,_.bi_valid=0):_.bi_valid>=8&&(_.pending_buf[_.pending++]=_.bi_buf&255,_.bi_buf>>=8,_.bi_valid-=8)},$e=(_,X)=>{const O=X.dyn_tree,te=X.max_code,oe=X.stat_desc.static_tree,ae=X.stat_desc.has_stree,Oe=X.stat_desc.extra_bits,Re=X.stat_desc.extra_base,ht=X.stat_desc.max_length;let ye,je,Tt,st,Xe,_t,tr=0;for(st=0;st<=g;st++)_.bl_count[st]=0;for(O[_.heap[_.heap_max]*2+1]=0,ye=_.heap_max+1;ye<h;ye++)je=_.heap[ye],st=O[O[je*2+1]*2+1]+1,st>ht&&(st=ht,tr++),O[je*2+1]=st,!(je>te)&&(_.bl_count[st]++,Xe=0,je>=Re&&(Xe=Oe[je-Re]),_t=O[je*2],_.opt_len+=_t*(st+Xe),ae&&(_.static_len+=_t*(oe[je*2+1]+Xe)));if(tr!==0){do{for(st=ht-1;_.bl_count[st]===0;)st--;_.bl_count[st]--,_.bl_count[st+1]+=2,_.bl_count[ht]--,tr-=2}while(tr>0);for(st=ht;st!==0;st--)for(je=_.bl_count[st];je!==0;)Tt=_.heap[--ye],!(Tt>te)&&(O[Tt*2+1]!==st&&(_.opt_len+=(st-O[Tt*2+1])*O[Tt*2],O[Tt*2+1]=st),je--)}},Le=(_,X,O)=>{const te=new Array(g+1);let oe=0,ae,Oe;for(ae=1;ae<=g;ae++)oe=oe+O[ae-1]<<1,te[ae]=oe;for(Oe=0;Oe<=X;Oe++){let Re=_[Oe*2+1];Re!==0&&(_[Oe*2]=Te(te[Re]++,Re))}},ue=()=>{let _,X,O,te,oe;const ae=new Array(g+1);for(O=0,te=0;te<w-1;te++)for($[te]=O,_=0;_<1<<T[te];_++)G[O++]=te;for(G[O-1]=te,oe=0,te=0;te<16;te++)for(V[te]=oe,_=0;_<1<<P[te];_++)H[oe++]=te;for(oe>>=7;te<i;te++)for(V[te]=oe<<7,_=0;_<1<<P[te]-7;_++)H[256+oe++]=te;for(X=0;X<=g;X++)ae[X]=0;for(_=0;_<=143;)U[_*2+1]=8,_++,ae[8]++;for(;_<=255;)U[_*2+1]=9,_++,ae[9]++;for(;_<=279;)U[_*2+1]=7,_++,ae[7]++;for(;_<=287;)U[_*2+1]=8,_++,ae[8]++;for(Le(U,u+1,ae),_=0;_<i;_++)K[_*2+1]=5,K[_*2]=Te(_,5);Y=new k(U,T,b+1,u,g),ie=new k(K,P,0,i,g),ne=new k(new Array(0),F,0,s,E)},Me=_=>{let X;for(X=0;X<u;X++)_.dyn_ltree[X*2]=0;for(X=0;X<i;X++)_.dyn_dtree[X*2]=0;for(X=0;X<s;X++)_.bl_tree[X*2]=0;_.dyn_ltree[l*2]=1,_.opt_len=_.static_len=0,_.sym_next=_.matches=0},Ge=_=>{_.bi_valid>8?xe(_,_.bi_buf):_.bi_valid>0&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0},Je=(_,X,O,te)=>{const oe=X*2,ae=O*2;return _[oe]<_[ae]||_[oe]===_[ae]&&te[X]<=te[O]},qe=(_,X,O)=>{const te=_.heap[O];let oe=O<<1;for(;oe<=_.heap_len&&(oe<_.heap_len&&Je(X,_.heap[oe+1],_.heap[oe],_.depth)&&oe++,!Je(X,te,_.heap[oe],_.depth));)_.heap[O]=_.heap[oe],O=oe,oe<<=1;_.heap[O]=te},tt=(_,X,O)=>{let te,oe,ae=0,Oe,Re;if(_.sym_next!==0)do te=_.pending_buf[_.sym_buf+ae++]&255,te+=(_.pending_buf[_.sym_buf+ae++]&255)<<8,oe=_.pending_buf[_.sym_buf+ae++],te===0?pe(_,oe,X):(Oe=G[oe],pe(_,Oe+b+1,X),Re=T[Oe],Re!==0&&(oe-=$[Oe],fe(_,oe,Re)),te--,Oe=le(te),pe(_,Oe,O),Re=P[Oe],Re!==0&&(te-=V[Oe],fe(_,te,Re)));while(ae<_.sym_next);pe(_,l,X)},Ze=(_,X)=>{const O=X.dyn_tree,te=X.stat_desc.static_tree,oe=X.stat_desc.has_stree,ae=X.stat_desc.elems;let Oe,Re,ht=-1,ye;for(_.heap_len=0,_.heap_max=h,Oe=0;Oe<ae;Oe++)O[Oe*2]!==0?(_.heap[++_.heap_len]=ht=Oe,_.depth[Oe]=0):O[Oe*2+1]=0;for(;_.heap_len<2;)ye=_.heap[++_.heap_len]=ht<2?++ht:0,O[ye*2]=1,_.depth[ye]=0,_.opt_len--,oe&&(_.static_len-=te[ye*2+1]);for(X.max_code=ht,Oe=_.heap_len>>1;Oe>=1;Oe--)qe(_,O,Oe);ye=ae;do Oe=_.heap[1],_.heap[1]=_.heap[_.heap_len--],qe(_,O,1),Re=_.heap[1],_.heap[--_.heap_max]=Oe,_.heap[--_.heap_max]=Re,O[ye*2]=O[Oe*2]+O[Re*2],_.depth[ye]=(_.depth[Oe]>=_.depth[Re]?_.depth[Oe]:_.depth[Re])+1,O[Oe*2+1]=O[Re*2+1]=ye,_.heap[1]=ye++,qe(_,O,1);while(_.heap_len>=2);_.heap[--_.heap_max]=_.heap[1],$e(_,X),Le(O,ht,_.bl_count)},Ve=(_,X,O)=>{let te,oe=-1,ae,Oe=X[1],Re=0,ht=7,ye=4;for(Oe===0&&(ht=138,ye=3),X[(O+1)*2+1]=65535,te=0;te<=O;te++)ae=Oe,Oe=X[(te+1)*2+1],!(++Re<ht&&ae===Oe)&&(Re<ye?_.bl_tree[ae*2]+=Re:ae!==0?(ae!==oe&&_.bl_tree[ae*2]++,_.bl_tree[f*2]++):Re<=10?_.bl_tree[m*2]++:_.bl_tree[C*2]++,Re=0,oe=ae,Oe===0?(ht=138,ye=3):ae===Oe?(ht=6,ye=3):(ht=7,ye=4))},Ye=(_,X,O)=>{let te,oe=-1,ae,Oe=X[1],Re=0,ht=7,ye=4;for(Oe===0&&(ht=138,ye=3),te=0;te<=O;te++)if(ae=Oe,Oe=X[(te+1)*2+1],!(++Re<ht&&ae===Oe)){if(Re<ye)do pe(_,ae,_.bl_tree);while(--Re!==0);else ae!==0?(ae!==oe&&(pe(_,ae,_.bl_tree),Re--),pe(_,f,_.bl_tree),fe(_,Re-3,2)):Re<=10?(pe(_,m,_.bl_tree),fe(_,Re-3,3)):(pe(_,C,_.bl_tree),fe(_,Re-11,7));Re=0,oe=ae,Oe===0?(ht=138,ye=3):ae===Oe?(ht=6,ye=3):(ht=7,ye=4)}},Ke=_=>{let X;for(Ve(_,_.dyn_ltree,_.l_desc.max_code),Ve(_,_.dyn_dtree,_.d_desc.max_code),Ze(_,_.bl_desc),X=s-1;X>=3&&_.bl_tree[N[X]*2+1]===0;X--);return _.opt_len+=3*(X+1)+5+5+4,X},We=(_,X,O,te)=>{let oe;for(fe(_,X-257,5),fe(_,O-1,5),fe(_,te-4,4),oe=0;oe<te;oe++)fe(_,_.bl_tree[N[oe]*2+1],3);Ye(_,_.dyn_ltree,X-1),Ye(_,_.dyn_dtree,O-1)},nt=_=>{let X=4093624447,O;for(O=0;O<=31;O++,X>>>=1)if(X&1&&_.dyn_ltree[O*2]!==0)return R;if(_.dyn_ltree[18]!==0||_.dyn_ltree[20]!==0||_.dyn_ltree[26]!==0)return S;for(O=32;O<b;O++)if(_.dyn_ltree[O*2]!==0)return S;return R};let at=!1;const q=_=>{at||(ue(),at=!0),_.l_desc=new he(_.dyn_ltree,Y),_.d_desc=new he(_.dyn_dtree,ie),_.bl_desc=new he(_.bl_tree,ne),_.bi_buf=0,_.bi_valid=0,Me(_)},re=(_,X,O,te)=>{fe(_,(v<<1)+(te?1:0),3),Ge(_),xe(_,O),xe(_,~O),O&&_.pending_buf.set(_.window.subarray(X,X+O),_.pending),_.pending+=O},se=_=>{fe(_,D<<1,3),pe(_,l,U),ke(_)},Se=(_,X,O,te)=>{let oe,ae,Oe=0;_.level>0?(_.strm.data_type===j&&(_.strm.data_type=nt(_)),Ze(_,_.l_desc),Ze(_,_.d_desc),Oe=Ke(_),oe=_.opt_len+3+7>>>3,ae=_.static_len+3+7>>>3,ae<=oe&&(oe=ae)):oe=ae=O+5,O+4<=oe&&X!==-1?re(_,X,O,te):_.strategy===d||ae===oe?(fe(_,(D<<1)+(te?1:0),3),tt(_,U,K)):(fe(_,(x<<1)+(te?1:0),3),We(_,_.l_desc.max_code+1,_.d_desc.max_code+1,Oe+1),tt(_,_.dyn_ltree,_.dyn_dtree)),Me(_),te&&Ge(_)},we=(_,X,O)=>(_.pending_buf[_.sym_buf+_.sym_next++]=X,_.pending_buf[_.sym_buf+_.sym_next++]=X>>8,_.pending_buf[_.sym_buf+_.sym_next++]=O,X===0?_.dyn_ltree[O*2]++:(_.matches++,X--,_.dyn_ltree[(G[O]+b+1)*2]++,_.dyn_dtree[le(X)*2]++),_.sym_next===_.sym_end);var ze=q,Be=re,Z=Se,ge=we,Ce=se,Ue={_tr_init:ze,_tr_stored_block:Be,_tr_flush_block:Z,_tr_tally:ge,_tr_align:Ce},Pe=(_,X,O,te)=>{let oe=_&65535|0,ae=_>>>16&65535|0,Oe=0;for(;O!==0;){Oe=O>2e3?2e3:O,O-=Oe;do oe=oe+X[te++]|0,ae=ae+oe|0;while(--Oe);oe%=65521,ae%=65521}return oe|ae<<16|0};const Q=()=>{let _,X=[];for(var O=0;O<256;O++){_=O;for(var te=0;te<8;te++)_=_&1?3988292384^_>>>1:_>>>1;X[O]=_}return X},Ne=new Uint32Array(Q());var z=(_,X,O,te)=>{const oe=Ne,ae=te+O;_^=-1;for(let Oe=te;Oe<ae;Oe++)_=_>>>8^oe[(_^X[Oe])&255];return _^-1},be={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_e={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ee,_tr_stored_block:me,_tr_flush_block:Ae,_tr_tally:ut,_tr_align:ot}=Ue,{Z_NO_FLUSH:rt,Z_PARTIAL_FLUSH:yt,Z_FULL_FLUSH:Xt,Z_FINISH:bt,Z_BLOCK:xt,Z_OK:vt,Z_STREAM_END:Pt,Z_STREAM_ERROR:Dt,Z_DATA_ERROR:ir,Z_BUF_ERROR:Vt,Z_DEFAULT_COMPRESSION:Rt,Z_FILTERED:At,Z_HUFFMAN_ONLY:St,Z_RLE:Ht,Z_FIXED:Yt,Z_DEFAULT_STRATEGY:rr,Z_UNKNOWN:cr,Z_DEFLATED:dr}=_e,Hr=9,Vi=15,er=8,Zn=256+1+29,Qn=30,Io=19,Aa=2*Zn+1,Jn=15,Lt=3,fi=258,ar=fi+Lt+1,No=32,Ki=42,ks=57,$i=69,Yi=73,Ri=91,Xi=103,Si=113,Rn=666,fr=1,Ai=2,ei=3,Kr=4,zo=3,ti=(_,X)=>(_.msg=be[X],X),Kt=_=>_*2-(_>4?9:0),ri=_=>{let X=_.length;for(;--X>=0;)_[X]=0},Ma=_=>{let X,O,te,oe=_.w_size;X=_.hash_size,te=X;do O=_.head[--te],_.head[te]=O>=oe?O-oe:0;while(--X);X=oe,te=X;do O=_.prev[--te],_.prev[te]=O>=oe?O-oe:0;while(--X)};let ii=(_,X,O)=>(X<<_.hash_shift^O)&_.hash_mask;const wr=_=>{const X=_.state;let O=X.pending;O>_.avail_out&&(O=_.avail_out),O!==0&&(_.output.set(X.pending_buf.subarray(X.pending_out,X.pending_out+O),_.next_out),_.next_out+=O,X.pending_out+=O,_.total_out+=O,_.avail_out-=O,X.pending-=O,X.pending===0&&(X.pending_out=0))},Cr=(_,X)=>{Ae(_,_.block_start>=0?_.block_start:-1,_.strstart-_.block_start,X),_.block_start=_.strstart,wr(_.strm)},Bt=(_,X)=>{_.pending_buf[_.pending++]=X},mi=(_,X)=>{_.pending_buf[_.pending++]=X>>>8&255,_.pending_buf[_.pending++]=X&255},$r=(_,X,O,te)=>{let oe=_.avail_in;return oe>te&&(oe=te),oe===0?0:(_.avail_in-=oe,X.set(_.input.subarray(_.next_in,_.next_in+oe),O),_.state.wrap===1?_.adler=Pe(_.adler,X,oe,O):_.state.wrap===2&&(_.adler=z(_.adler,X,oe,O)),_.next_in+=oe,_.total_in+=oe,oe)},ni=(_,X)=>{let O=_.max_chain_length,te=_.strstart,oe,ae,Oe=_.prev_length,Re=_.nice_match;const ht=_.strstart>_.w_size-ar?_.strstart-(_.w_size-ar):0,ye=_.window,je=_.w_mask,Tt=_.prev,st=_.strstart+fi;let Xe=ye[te+Oe-1],_t=ye[te+Oe];_.prev_length>=_.good_match&&(O>>=2),Re>_.lookahead&&(Re=_.lookahead);do if(oe=X,!(ye[oe+Oe]!==_t||ye[oe+Oe-1]!==Xe||ye[oe]!==ye[te]||ye[++oe]!==ye[te+1])){te+=2,oe++;do;while(ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&ye[++te]===ye[++oe]&&te<st);if(ae=fi-(st-te),te=st-fi,ae>Oe){if(_.match_start=X,Oe=ae,ae>=Re)break;Xe=ye[te+Oe-1],_t=ye[te+Oe]}}while((X=Tt[X&je])>ht&&--O!==0);return Oe<=_.lookahead?Oe:_.lookahead},Dr=_=>{const X=_.w_size;let O,te,oe;do{if(te=_.window_size-_.lookahead-_.strstart,_.strstart>=X+(X-ar)&&(_.window.set(_.window.subarray(X,X+X-te),0),_.match_start-=X,_.strstart-=X,_.block_start-=X,_.insert>_.strstart&&(_.insert=_.strstart),Ma(_),te+=X),_.strm.avail_in===0)break;if(O=$r(_.strm,_.window,_.strstart+_.lookahead,te),_.lookahead+=O,_.lookahead+_.insert>=Lt)for(oe=_.strstart-_.insert,_.ins_h=_.window[oe],_.ins_h=ii(_,_.ins_h,_.window[oe+1]);_.insert&&(_.ins_h=ii(_,_.ins_h,_.window[oe+Lt-1]),_.prev[oe&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=oe,oe++,_.insert--,!(_.lookahead+_.insert<Lt)););}while(_.lookahead<ar&&_.strm.avail_in!==0)},Zi=(_,X)=>{let O=_.pending_buf_size-5>_.w_size?_.w_size:_.pending_buf_size-5,te,oe,ae,Oe=0,Re=_.strm.avail_in;do{if(te=65535,ae=_.bi_valid+42>>3,_.strm.avail_out<ae||(ae=_.strm.avail_out-ae,oe=_.strstart-_.block_start,te>oe+_.strm.avail_in&&(te=oe+_.strm.avail_in),te>ae&&(te=ae),te<O&&(te===0&&X!==bt||X===rt||te!==oe+_.strm.avail_in)))break;Oe=X===bt&&te===oe+_.strm.avail_in?1:0,me(_,0,0,Oe),_.pending_buf[_.pending-4]=te,_.pending_buf[_.pending-3]=te>>8,_.pending_buf[_.pending-2]=~te,_.pending_buf[_.pending-1]=~te>>8,wr(_.strm),oe&&(oe>te&&(oe=te),_.strm.output.set(_.window.subarray(_.block_start,_.block_start+oe),_.strm.next_out),_.strm.next_out+=oe,_.strm.avail_out-=oe,_.strm.total_out+=oe,_.block_start+=oe,te-=oe),te&&($r(_.strm,_.strm.output,_.strm.next_out,te),_.strm.next_out+=te,_.strm.avail_out-=te,_.strm.total_out+=te)}while(Oe===0);return Re-=_.strm.avail_in,Re&&(Re>=_.w_size?(_.matches=2,_.window.set(_.strm.input.subarray(_.strm.next_in-_.w_size,_.strm.next_in),0),_.strstart=_.w_size,_.insert=_.strstart):(_.window_size-_.strstart<=Re&&(_.strstart-=_.w_size,_.window.set(_.window.subarray(_.w_size,_.w_size+_.strstart),0),_.matches<2&&_.matches++,_.insert>_.strstart&&(_.insert=_.strstart)),_.window.set(_.strm.input.subarray(_.strm.next_in-Re,_.strm.next_in),_.strstart),_.strstart+=Re,_.insert+=Re>_.w_size-_.insert?_.w_size-_.insert:Re),_.block_start=_.strstart),_.high_water<_.strstart&&(_.high_water=_.strstart),Oe?Kr:X!==rt&&X!==bt&&_.strm.avail_in===0&&_.strstart===_.block_start?Ai:(ae=_.window_size-_.strstart,_.strm.avail_in>ae&&_.block_start>=_.w_size&&(_.block_start-=_.w_size,_.strstart-=_.w_size,_.window.set(_.window.subarray(_.w_size,_.w_size+_.strstart),0),_.matches<2&&_.matches++,ae+=_.w_size,_.insert>_.strstart&&(_.insert=_.strstart)),ae>_.strm.avail_in&&(ae=_.strm.avail_in),ae&&($r(_.strm,_.window,_.strstart,ae),_.strstart+=ae,_.insert+=ae>_.w_size-_.insert?_.w_size-_.insert:ae),_.high_water<_.strstart&&(_.high_water=_.strstart),ae=_.bi_valid+42>>3,ae=_.pending_buf_size-ae>65535?65535:_.pending_buf_size-ae,O=ae>_.w_size?_.w_size:ae,oe=_.strstart-_.block_start,(oe>=O||(oe||X===bt)&&X!==rt&&_.strm.avail_in===0&&oe<=ae)&&(te=oe>ae?ae:oe,Oe=X===bt&&_.strm.avail_in===0&&te===oe?1:0,me(_,_.block_start,te,Oe),_.block_start+=te,wr(_.strm)),Oe?ei:fr)},Mi=(_,X)=>{let O,te;for(;;){if(_.lookahead<ar){if(Dr(_),_.lookahead<ar&&X===rt)return fr;if(_.lookahead===0)break}if(O=0,_.lookahead>=Lt&&(_.ins_h=ii(_,_.ins_h,_.window[_.strstart+Lt-1]),O=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),O!==0&&_.strstart-O<=_.w_size-ar&&(_.match_length=ni(_,O)),_.match_length>=Lt)if(te=ut(_,_.strstart-_.match_start,_.match_length-Lt),_.lookahead-=_.match_length,_.match_length<=_.max_lazy_match&&_.lookahead>=Lt){_.match_length--;do _.strstart++,_.ins_h=ii(_,_.ins_h,_.window[_.strstart+Lt-1]),O=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart;while(--_.match_length!==0);_.strstart++}else _.strstart+=_.match_length,_.match_length=0,_.ins_h=_.window[_.strstart],_.ins_h=ii(_,_.ins_h,_.window[_.strstart+1]);else te=ut(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++;if(te&&(Cr(_,!1),_.strm.avail_out===0))return fr}return _.insert=_.strstart<Lt-1?_.strstart:Lt-1,X===bt?(Cr(_,!0),_.strm.avail_out===0?ei:Kr):_.sym_next&&(Cr(_,!1),_.strm.avail_out===0)?fr:Ai},Or=(_,X)=>{let O,te,oe;for(;;){if(_.lookahead<ar){if(Dr(_),_.lookahead<ar&&X===rt)return fr;if(_.lookahead===0)break}if(O=0,_.lookahead>=Lt&&(_.ins_h=ii(_,_.ins_h,_.window[_.strstart+Lt-1]),O=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),_.prev_length=_.match_length,_.prev_match=_.match_start,_.match_length=Lt-1,O!==0&&_.prev_length<_.max_lazy_match&&_.strstart-O<=_.w_size-ar&&(_.match_length=ni(_,O),_.match_length<=5&&(_.strategy===At||_.match_length===Lt&&_.strstart-_.match_start>4096)&&(_.match_length=Lt-1)),_.prev_length>=Lt&&_.match_length<=_.prev_length){oe=_.strstart+_.lookahead-Lt,te=ut(_,_.strstart-1-_.prev_match,_.prev_length-Lt),_.lookahead-=_.prev_length-1,_.prev_length-=2;do++_.strstart<=oe&&(_.ins_h=ii(_,_.ins_h,_.window[_.strstart+Lt-1]),O=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart);while(--_.prev_length!==0);if(_.match_available=0,_.match_length=Lt-1,_.strstart++,te&&(Cr(_,!1),_.strm.avail_out===0))return fr}else if(_.match_available){if(te=ut(_,0,_.window[_.strstart-1]),te&&Cr(_,!1),_.strstart++,_.lookahead--,_.strm.avail_out===0)return fr}else _.match_available=1,_.strstart++,_.lookahead--}return _.match_available&&(te=ut(_,0,_.window[_.strstart-1]),_.match_available=0),_.insert=_.strstart<Lt-1?_.strstart:Lt-1,X===bt?(Cr(_,!0),_.strm.avail_out===0?ei:Kr):_.sym_next&&(Cr(_,!1),_.strm.avail_out===0)?fr:Ai},Fo=(_,X)=>{let O,te,oe,ae;const Oe=_.window;for(;;){if(_.lookahead<=fi){if(Dr(_),_.lookahead<=fi&&X===rt)return fr;if(_.lookahead===0)break}if(_.match_length=0,_.lookahead>=Lt&&_.strstart>0&&(oe=_.strstart-1,te=Oe[oe],te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe])){ae=_.strstart+fi;do;while(te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe]&&te===Oe[++oe]&&oe<ae);_.match_length=fi-(ae-oe),_.match_length>_.lookahead&&(_.match_length=_.lookahead)}if(_.match_length>=Lt?(O=ut(_,1,_.match_length-Lt),_.lookahead-=_.match_length,_.strstart+=_.match_length,_.match_length=0):(O=ut(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++),O&&(Cr(_,!1),_.strm.avail_out===0))return fr}return _.insert=0,X===bt?(Cr(_,!0),_.strm.avail_out===0?ei:Kr):_.sym_next&&(Cr(_,!1),_.strm.avail_out===0)?fr:Ai},Ta=(_,X)=>{let O;for(;;){if(_.lookahead===0&&(Dr(_),_.lookahead===0)){if(X===rt)return fr;break}if(_.match_length=0,O=ut(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++,O&&(Cr(_,!1),_.strm.avail_out===0))return fr}return _.insert=0,X===bt?(Cr(_,!0),_.strm.avail_out===0?ei:Kr):_.sym_next&&(Cr(_,!1),_.strm.avail_out===0)?fr:Ai};function Rr(_,X,O,te,oe){this.good_length=_,this.max_lazy=X,this.nice_length=O,this.max_chain=te,this.func=oe}const Sn=[new Rr(0,0,0,0,Zi),new Rr(4,4,8,4,Mi),new Rr(4,5,16,8,Mi),new Rr(4,6,32,32,Mi),new Rr(4,4,16,16,Or),new Rr(8,16,32,32,Or),new Rr(8,16,128,128,Or),new Rr(8,32,128,256,Or),new Rr(32,128,258,1024,Or),new Rr(32,258,258,4096,Or)],ja=_=>{_.window_size=2*_.w_size,ri(_.head),_.max_lazy_match=Sn[_.level].max_lazy,_.good_match=Sn[_.level].good_length,_.nice_match=Sn[_.level].nice_length,_.max_chain_length=Sn[_.level].max_chain,_.strstart=0,_.block_start=0,_.lookahead=0,_.insert=0,_.match_length=_.prev_length=Lt-1,_.match_available=0,_.ins_h=0};function qn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Aa*2),this.dyn_dtree=new Uint16Array((2*Qn+1)*2),this.bl_tree=new Uint16Array((2*Io+1)*2),ri(this.dyn_ltree),ri(this.dyn_dtree),ri(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Jn+1),this.heap=new Uint16Array(2*Zn+1),ri(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Zn+1),ri(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Qi=_=>{if(!_)return 1;const X=_.state;return!X||X.strm!==_||X.status!==Ki&&X.status!==ks&&X.status!==$i&&X.status!==Yi&&X.status!==Ri&&X.status!==Xi&&X.status!==Si&&X.status!==Rn?1:0},Da=_=>{if(Qi(_))return ti(_,Dt);_.total_in=_.total_out=0,_.data_type=cr;const X=_.state;return X.pending=0,X.pending_out=0,X.wrap<0&&(X.wrap=-X.wrap),X.status=X.wrap===2?ks:X.wrap?Ki:Si,_.adler=X.wrap===2?0:1,X.last_flush=-2,ee(X),vt},Ji=_=>{const X=Da(_);return X===vt&&ja(_.state),X},An=(_,X)=>Qi(_)||_.state.wrap!==2?Dt:(_.state.gzhead=X,vt),Li=(_,X,O,te,oe,ae)=>{if(!_)return Dt;let Oe=1;if(X===Rt&&(X=6),te<0?(Oe=0,te=-te):te>15&&(Oe=2,te-=16),oe<1||oe>Hr||O!==dr||te<8||te>15||X<0||X>9||ae<0||ae>Yt||te===8&&Oe!==1)return ti(_,Dt);te===8&&(te=9);const Re=new qn;return _.state=Re,Re.strm=_,Re.status=Ki,Re.wrap=Oe,Re.gzhead=null,Re.w_bits=te,Re.w_size=1<<Re.w_bits,Re.w_mask=Re.w_size-1,Re.hash_bits=oe+7,Re.hash_size=1<<Re.hash_bits,Re.hash_mask=Re.hash_size-1,Re.hash_shift=~~((Re.hash_bits+Lt-1)/Lt),Re.window=new Uint8Array(Re.w_size*2),Re.head=new Uint16Array(Re.hash_size),Re.prev=new Uint16Array(Re.w_size),Re.lit_bufsize=1<<oe+6,Re.pending_buf_size=Re.lit_bufsize*4,Re.pending_buf=new Uint8Array(Re.pending_buf_size),Re.sym_buf=Re.lit_bufsize,Re.sym_end=(Re.lit_bufsize-1)*3,Re.level=X,Re.strategy=ae,Re.method=O,Ji(_)},es=(_,X)=>Li(_,X,dr,Vi,er,rr),Bo=(_,X)=>{if(Qi(_)||X>xt||X<0)return _?ti(_,Dt):Dt;const O=_.state;if(!_.output||_.avail_in!==0&&!_.input||O.status===Rn&&X!==bt)return ti(_,_.avail_out===0?Vt:Dt);const te=O.last_flush;if(O.last_flush=X,O.pending!==0){if(wr(_),_.avail_out===0)return O.last_flush=-1,vt}else if(_.avail_in===0&&Kt(X)<=Kt(te)&&X!==bt)return ti(_,Vt);if(O.status===Rn&&_.avail_in!==0)return ti(_,Vt);if(O.status===Ki&&O.wrap===0&&(O.status=Si),O.status===Ki){let oe=dr+(O.w_bits-8<<4)<<8,ae=-1;if(O.strategy>=St||O.level<2?ae=0:O.level<6?ae=1:O.level===6?ae=2:ae=3,oe|=ae<<6,O.strstart!==0&&(oe|=No),oe+=31-oe%31,mi(O,oe),O.strstart!==0&&(mi(O,_.adler>>>16),mi(O,_.adler&65535)),_.adler=1,O.status=Si,wr(_),O.pending!==0)return O.last_flush=-1,vt}if(O.status===ks){if(_.adler=0,Bt(O,31),Bt(O,139),Bt(O,8),O.gzhead)Bt(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),Bt(O,O.gzhead.time&255),Bt(O,O.gzhead.time>>8&255),Bt(O,O.gzhead.time>>16&255),Bt(O,O.gzhead.time>>24&255),Bt(O,O.level===9?2:O.strategy>=St||O.level<2?4:0),Bt(O,O.gzhead.os&255),O.gzhead.extra&&O.gzhead.extra.length&&(Bt(O,O.gzhead.extra.length&255),Bt(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(_.adler=z(_.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=$i;else if(Bt(O,0),Bt(O,0),Bt(O,0),Bt(O,0),Bt(O,0),Bt(O,O.level===9?2:O.strategy>=St||O.level<2?4:0),Bt(O,zo),O.status=Si,wr(_),O.pending!==0)return O.last_flush=-1,vt}if(O.status===$i){if(O.gzhead.extra){let oe=O.pending,ae=(O.gzhead.extra.length&65535)-O.gzindex;for(;O.pending+ae>O.pending_buf_size;){let Re=O.pending_buf_size-O.pending;if(O.pending_buf.set(O.gzhead.extra.subarray(O.gzindex,O.gzindex+Re),O.pending),O.pending=O.pending_buf_size,O.gzhead.hcrc&&O.pending>oe&&(_.adler=z(_.adler,O.pending_buf,O.pending-oe,oe)),O.gzindex+=Re,wr(_),O.pending!==0)return O.last_flush=-1,vt;oe=0,ae-=Re}let Oe=new Uint8Array(O.gzhead.extra);O.pending_buf.set(Oe.subarray(O.gzindex,O.gzindex+ae),O.pending),O.pending+=ae,O.gzhead.hcrc&&O.pending>oe&&(_.adler=z(_.adler,O.pending_buf,O.pending-oe,oe)),O.gzindex=0}O.status=Yi}if(O.status===Yi){if(O.gzhead.name){let oe=O.pending,ae;do{if(O.pending===O.pending_buf_size){if(O.gzhead.hcrc&&O.pending>oe&&(_.adler=z(_.adler,O.pending_buf,O.pending-oe,oe)),wr(_),O.pending!==0)return O.last_flush=-1,vt;oe=0}O.gzindex<O.gzhead.name.length?ae=O.gzhead.name.charCodeAt(O.gzindex++)&255:ae=0,Bt(O,ae)}while(ae!==0);O.gzhead.hcrc&&O.pending>oe&&(_.adler=z(_.adler,O.pending_buf,O.pending-oe,oe)),O.gzindex=0}O.status=Ri}if(O.status===Ri){if(O.gzhead.comment){let oe=O.pending,ae;do{if(O.pending===O.pending_buf_size){if(O.gzhead.hcrc&&O.pending>oe&&(_.adler=z(_.adler,O.pending_buf,O.pending-oe,oe)),wr(_),O.pending!==0)return O.last_flush=-1,vt;oe=0}O.gzindex<O.gzhead.comment.length?ae=O.gzhead.comment.charCodeAt(O.gzindex++)&255:ae=0,Bt(O,ae)}while(ae!==0);O.gzhead.hcrc&&O.pending>oe&&(_.adler=z(_.adler,O.pending_buf,O.pending-oe,oe))}O.status=Xi}if(O.status===Xi){if(O.gzhead.hcrc){if(O.pending+2>O.pending_buf_size&&(wr(_),O.pending!==0))return O.last_flush=-1,vt;Bt(O,_.adler&255),Bt(O,_.adler>>8&255),_.adler=0}if(O.status=Si,wr(_),O.pending!==0)return O.last_flush=-1,vt}if(_.avail_in!==0||O.lookahead!==0||X!==rt&&O.status!==Rn){let oe=O.level===0?Zi(O,X):O.strategy===St?Ta(O,X):O.strategy===Ht?Fo(O,X):Sn[O.level].func(O,X);if((oe===ei||oe===Kr)&&(O.status=Rn),oe===fr||oe===ei)return _.avail_out===0&&(O.last_flush=-1),vt;if(oe===Ai&&(X===yt?ot(O):X!==xt&&(me(O,0,0,!1),X===Xt&&(ri(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),wr(_),_.avail_out===0))return O.last_flush=-1,vt}return X!==bt?vt:O.wrap<=0?Pt:(O.wrap===2?(Bt(O,_.adler&255),Bt(O,_.adler>>8&255),Bt(O,_.adler>>16&255),Bt(O,_.adler>>24&255),Bt(O,_.total_in&255),Bt(O,_.total_in>>8&255),Bt(O,_.total_in>>16&255),Bt(O,_.total_in>>24&255)):(mi(O,_.adler>>>16),mi(O,_.adler&65535)),wr(_),O.wrap>0&&(O.wrap=-O.wrap),O.pending!==0?vt:Pt)},Uo=_=>{if(Qi(_))return Dt;const X=_.state.status;return _.state=null,X===Si?ti(_,ir):vt},Is=(_,X)=>{let O=X.length;if(Qi(_))return Dt;const te=_.state,oe=te.wrap;if(oe===2||oe===1&&te.status!==Ki||te.lookahead)return Dt;if(oe===1&&(_.adler=Pe(_.adler,X,O,0)),te.wrap=0,O>=te.w_size){oe===0&&(ri(te.head),te.strstart=0,te.block_start=0,te.insert=0);let ht=new Uint8Array(te.w_size);ht.set(X.subarray(O-te.w_size,O),0),X=ht,O=te.w_size}const ae=_.avail_in,Oe=_.next_in,Re=_.input;for(_.avail_in=O,_.next_in=0,_.input=X,Dr(te);te.lookahead>=Lt;){let ht=te.strstart,ye=te.lookahead-(Lt-1);do te.ins_h=ii(te,te.ins_h,te.window[ht+Lt-1]),te.prev[ht&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=ht,ht++;while(--ye);te.strstart=ht,te.lookahead=Lt-1,Dr(te)}return te.strstart+=te.lookahead,te.block_start=te.strstart,te.insert=te.lookahead,te.lookahead=0,te.match_length=te.prev_length=Lt-1,te.match_available=0,_.next_in=Oe,_.input=Re,_.avail_in=ae,te.wrap=oe,vt};var ts=es,Ns=Li,Oa=Ji,pi=Da,zs=An,rs=Bo,Pa=Uo,is=Is,ns="pako deflate (from Nodeca project)",qi={deflateInit:ts,deflateInit2:Ns,deflateReset:Oa,deflateResetKeep:pi,deflateSetHeader:zs,deflate:rs,deflateEnd:Pa,deflateSetDictionary:is,deflateInfo:ns};const Pr=(_,X)=>Object.prototype.hasOwnProperty.call(_,X);var en=function(_){const X=Array.prototype.slice.call(arguments,1);for(;X.length;){const O=X.shift();if(O){if(typeof O!="object")throw new TypeError(O+"must be non-object");for(const te in O)Pr(O,te)&&(_[te]=O[te])}}return _},Fs=_=>{let X=0;for(let te=0,oe=_.length;te<oe;te++)X+=_[te].length;const O=new Uint8Array(X);for(let te=0,oe=0,ae=_.length;te<ae;te++){let Oe=_[te];O.set(Oe,oe),oe+=Oe.length}return O},gi={assign:en,flattenChunks:Fs};let ka=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ka=!1}const Ti=new Uint8Array(256);for(let _=0;_<256;_++)Ti[_]=_>=252?6:_>=248?5:_>=240?4:_>=224?3:_>=192?2:1;Ti[254]=Ti[254]=1;var Bs=_=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(_);let X,O,te,oe,ae,Oe=_.length,Re=0;for(oe=0;oe<Oe;oe++)O=_.charCodeAt(oe),(O&64512)===55296&&oe+1<Oe&&(te=_.charCodeAt(oe+1),(te&64512)===56320&&(O=65536+(O-55296<<10)+(te-56320),oe++)),Re+=O<128?1:O<2048?2:O<65536?3:4;for(X=new Uint8Array(Re),ae=0,oe=0;ae<Re;oe++)O=_.charCodeAt(oe),(O&64512)===55296&&oe+1<Oe&&(te=_.charCodeAt(oe+1),(te&64512)===56320&&(O=65536+(O-55296<<10)+(te-56320),oe++)),O<128?X[ae++]=O:O<2048?(X[ae++]=192|O>>>6,X[ae++]=128|O&63):O<65536?(X[ae++]=224|O>>>12,X[ae++]=128|O>>>6&63,X[ae++]=128|O&63):(X[ae++]=240|O>>>18,X[ae++]=128|O>>>12&63,X[ae++]=128|O>>>6&63,X[ae++]=128|O&63);return X};const Mn=(_,X)=>{if(X<65534&&_.subarray&&ka)return String.fromCharCode.apply(null,_.length===X?_:_.subarray(0,X));let O="";for(let te=0;te<X;te++)O+=String.fromCharCode(_[te]);return O};var ss=(_,X)=>{const O=X||_.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(_.subarray(0,X));let te,oe;const ae=new Array(O*2);for(oe=0,te=0;te<O;){let Oe=_[te++];if(Oe<128){ae[oe++]=Oe;continue}let Re=Ti[Oe];if(Re>4){ae[oe++]=65533,te+=Re-1;continue}for(Oe&=Re===2?31:Re===3?15:7;Re>1&&te<O;)Oe=Oe<<6|_[te++]&63,Re--;if(Re>1){ae[oe++]=65533;continue}Oe<65536?ae[oe++]=Oe:(Oe-=65536,ae[oe++]=55296|Oe>>10&1023,ae[oe++]=56320|Oe&1023)}return Mn(ae,oe)},Ia=(_,X)=>{X=X||_.length,X>_.length&&(X=_.length);let O=X-1;for(;O>=0&&(_[O]&192)===128;)O--;return O<0||O===0?X:O+Ti[_[O]]>X?O:X},Ln={string2buf:Bs,buf2string:ss,utf8border:Ia};function Wo(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Na=Wo;const as=Object.prototype.toString,{Z_NO_FLUSH:Go,Z_SYNC_FLUSH:Vo,Z_FULL_FLUSH:Ho,Z_FINISH:Ko,Z_OK:os,Z_STREAM_END:za,Z_DEFAULT_COMPRESSION:$o,Z_DEFAULT_STRATEGY:Yo,Z_DEFLATED:Xo}=_e;function Tn(_){this.options=gi.assign({level:$o,method:Xo,chunkSize:16384,windowBits:15,memLevel:8,strategy:Yo},_||{});let X=this.options;X.raw&&X.windowBits>0?X.windowBits=-X.windowBits:X.gzip&&X.windowBits>0&&X.windowBits<16&&(X.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Na,this.strm.avail_out=0;let O=qi.deflateInit2(this.strm,X.level,X.method,X.windowBits,X.memLevel,X.strategy);if(O!==os)throw new Error(be[O]);if(X.header&&qi.deflateSetHeader(this.strm,X.header),X.dictionary){let te;if(typeof X.dictionary=="string"?te=Ln.string2buf(X.dictionary):as.call(X.dictionary)==="[object ArrayBuffer]"?te=new Uint8Array(X.dictionary):te=X.dictionary,O=qi.deflateSetDictionary(this.strm,te),O!==os)throw new Error(be[O]);this._dict_set=!0}}Tn.prototype.push=function(_,X){const O=this.strm,te=this.options.chunkSize;let oe,ae;if(this.ended)return!1;for(X===~~X?ae=X:ae=X===!0?Ko:Go,typeof _=="string"?O.input=Ln.string2buf(_):as.call(_)==="[object ArrayBuffer]"?O.input=new Uint8Array(_):O.input=_,O.next_in=0,O.avail_in=O.input.length;;){if(O.avail_out===0&&(O.output=new Uint8Array(te),O.next_out=0,O.avail_out=te),(ae===Vo||ae===Ho)&&O.avail_out<=6){this.onData(O.output.subarray(0,O.next_out)),O.avail_out=0;continue}if(oe=qi.deflate(O,ae),oe===za)return O.next_out>0&&this.onData(O.output.subarray(0,O.next_out)),oe=qi.deflateEnd(this.strm),this.onEnd(oe),this.ended=!0,oe===os;if(O.avail_out===0){this.onData(O.output);continue}if(ae>0&&O.next_out>0){this.onData(O.output.subarray(0,O.next_out)),O.avail_out=0;continue}if(O.avail_in===0)break}return!0},Tn.prototype.onData=function(_){this.chunks.push(_)},Tn.prototype.onEnd=function(_){_===os&&(this.result=gi.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function jn(_,X){const O=new Tn(X);if(O.push(_,!0),O.err)throw O.msg||be[O.err];return O.result}function Zo(_,X){return X=X||{},X.raw=!0,jn(_,X)}function Qo(_,X){return X=X||{},X.gzip=!0,jn(_,X)}var Jo=Tn,Fa=jn,qo=Zo,el=Qo,tl={Deflate:Jo,deflate:Fa,deflateRaw:qo,gzip:el};const ls=16209,rl=16191;var il=function(X,O){let te,oe,ae,Oe,Re,ht,ye,je,Tt,st,Xe,_t,tr,Nt,Ot,Ut,kt,ct,zt,or,Et,Wt,It,jt;const Ft=X.state;te=X.next_in,It=X.input,oe=te+(X.avail_in-5),ae=X.next_out,jt=X.output,Oe=ae-(O-X.avail_out),Re=ae+(X.avail_out-257),ht=Ft.dmax,ye=Ft.wsize,je=Ft.whave,Tt=Ft.wnext,st=Ft.window,Xe=Ft.hold,_t=Ft.bits,tr=Ft.lencode,Nt=Ft.distcode,Ot=(1<<Ft.lenbits)-1,Ut=(1<<Ft.distbits)-1;e:do{_t<15&&(Xe+=It[te++]<<_t,_t+=8,Xe+=It[te++]<<_t,_t+=8),kt=tr[Xe&Ot];t:for(;;){if(ct=kt>>>24,Xe>>>=ct,_t-=ct,ct=kt>>>16&255,ct===0)jt[ae++]=kt&65535;else if(ct&16){zt=kt&65535,ct&=15,ct&&(_t<ct&&(Xe+=It[te++]<<_t,_t+=8),zt+=Xe&(1<<ct)-1,Xe>>>=ct,_t-=ct),_t<15&&(Xe+=It[te++]<<_t,_t+=8,Xe+=It[te++]<<_t,_t+=8),kt=Nt[Xe&Ut];r:for(;;){if(ct=kt>>>24,Xe>>>=ct,_t-=ct,ct=kt>>>16&255,ct&16){if(or=kt&65535,ct&=15,_t<ct&&(Xe+=It[te++]<<_t,_t+=8,_t<ct&&(Xe+=It[te++]<<_t,_t+=8)),or+=Xe&(1<<ct)-1,or>ht){X.msg="invalid distance too far back",Ft.mode=ls;break e}if(Xe>>>=ct,_t-=ct,ct=ae-Oe,or>ct){if(ct=or-ct,ct>je&&Ft.sane){X.msg="invalid distance too far back",Ft.mode=ls;break e}if(Et=0,Wt=st,Tt===0){if(Et+=ye-ct,ct<zt){zt-=ct;do jt[ae++]=st[Et++];while(--ct);Et=ae-or,Wt=jt}}else if(Tt<ct){if(Et+=ye+Tt-ct,ct-=Tt,ct<zt){zt-=ct;do jt[ae++]=st[Et++];while(--ct);if(Et=0,Tt<zt){ct=Tt,zt-=ct;do jt[ae++]=st[Et++];while(--ct);Et=ae-or,Wt=jt}}}else if(Et+=Tt-ct,ct<zt){zt-=ct;do jt[ae++]=st[Et++];while(--ct);Et=ae-or,Wt=jt}for(;zt>2;)jt[ae++]=Wt[Et++],jt[ae++]=Wt[Et++],jt[ae++]=Wt[Et++],zt-=3;zt&&(jt[ae++]=Wt[Et++],zt>1&&(jt[ae++]=Wt[Et++]))}else{Et=ae-or;do jt[ae++]=jt[Et++],jt[ae++]=jt[Et++],jt[ae++]=jt[Et++],zt-=3;while(zt>2);zt&&(jt[ae++]=jt[Et++],zt>1&&(jt[ae++]=jt[Et++]))}}else if((ct&64)===0){kt=Nt[(kt&65535)+(Xe&(1<<ct)-1)];continue r}else{X.msg="invalid distance code",Ft.mode=ls;break e}break}}else if((ct&64)===0){kt=tr[(kt&65535)+(Xe&(1<<ct)-1)];continue t}else if(ct&32){Ft.mode=rl;break e}else{X.msg="invalid literal/length code",Ft.mode=ls;break e}break}}while(te<oe&&ae<Re);zt=_t>>3,te-=zt,_t-=zt<<3,Xe&=(1<<_t)-1,X.next_in=te,X.next_out=ae,X.avail_in=te<oe?5+(oe-te):5-(te-oe),X.avail_out=ae<Re?257+(Re-ae):257-(ae-Re),Ft.hold=Xe,Ft.bits=_t};const tn=15,us=852,rn=592,Ba=0,cs=1,Us=2,Ua=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Wa=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ga=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nn=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Dn=(_,X,O,te,oe,ae,Oe,Re)=>{const ht=Re.bits;let ye=0,je=0,Tt=0,st=0,Xe=0,_t=0,tr=0,Nt=0,Ot=0,Ut=0,kt,ct,zt,or,Et,Wt=null,It;const jt=new Uint16Array(tn+1),Ft=new Uint16Array(tn+1);let zr=null,fa,zi,Fi;for(ye=0;ye<=tn;ye++)jt[ye]=0;for(je=0;je<te;je++)jt[X[O+je]]++;for(Xe=ht,st=tn;st>=1&&jt[st]===0;st--);if(Xe>st&&(Xe=st),st===0)return oe[ae++]=1<<24|64<<16|0,oe[ae++]=1<<24|64<<16|0,Re.bits=1,0;for(Tt=1;Tt<st&&jt[Tt]===0;Tt++);for(Xe<Tt&&(Xe=Tt),Nt=1,ye=1;ye<=tn;ye++)if(Nt<<=1,Nt-=jt[ye],Nt<0)return-1;if(Nt>0&&(_===Ba||st!==1))return-1;for(Ft[1]=0,ye=1;ye<tn;ye++)Ft[ye+1]=Ft[ye]+jt[ye];for(je=0;je<te;je++)X[O+je]!==0&&(Oe[Ft[X[O+je]]++]=je);if(_===Ba?(Wt=zr=Oe,It=20):_===cs?(Wt=Ua,zr=Wa,It=257):(Wt=Ga,zr=nn,It=0),Ut=0,je=0,ye=Tt,Et=ae,_t=Xe,tr=0,zt=-1,Ot=1<<Xe,or=Ot-1,_===cs&&Ot>us||_===Us&&Ot>rn)return 1;for(;;){fa=ye-tr,Oe[je]+1<It?(zi=0,Fi=Oe[je]):Oe[je]>=It?(zi=zr[Oe[je]-It],Fi=Wt[Oe[je]-It]):(zi=96,Fi=0),kt=1<<ye-tr,ct=1<<_t,Tt=ct;do ct-=kt,oe[Et+(Ut>>tr)+ct]=fa<<24|zi<<16|Fi|0;while(ct!==0);for(kt=1<<ye-1;Ut&kt;)kt>>=1;if(kt!==0?(Ut&=kt-1,Ut+=kt):Ut=0,je++,--jt[ye]===0){if(ye===st)break;ye=X[O+Oe[je]]}if(ye>Xe&&(Ut&or)!==zt){for(tr===0&&(tr=Xe),Et+=Tt,_t=ye-tr,Nt=1<<_t;_t+tr<st&&(Nt-=jt[_t+tr],!(Nt<=0));)_t++,Nt<<=1;if(Ot+=1<<_t,_===cs&&Ot>us||_===Us&&Ot>rn)return 1;zt=Ut&or,oe[zt]=Xe<<24|_t<<16|Et-ae|0}}return Ut!==0&&(oe[Et+Ut]=ye-tr<<24|64<<16|0),Re.bits=Xe,0};const nl=0,Ws=1,Gs=2,{Z_FINISH:sn,Z_BLOCK:On,Z_TREES:ds,Z_OK:Yr,Z_STREAM_END:sl,Z_NEED_DICT:Va,Z_STREAM_ERROR:Sr,Z_DATA_ERROR:hs,Z_MEM_ERROR:Vs,Z_BUF_ERROR:Ha,Z_DEFLATED:Hs}=_e,fs=16180,Ka=16181,$a=16182,Ya=16183,Xa=16184,Nr=16185,an=16186,Ks=16187,$s=16188,Ys=16189,Pn=16190,Wr=16191,Xs=16192,Za=16193,xi=16194,ms=16195,on=16196,ps=16197,Zs=16198,ji=16199,si=16200,gs=16201,Qs=16202,kn=16203,Js=16204,qs=16205,xs=16206,ea=16207,ta=16208,Jt=16209,ai=16210,vs=16211,ra=852,al=592,In=15,Qa=_=>(_>>>24&255)+(_>>>8&65280)+((_&65280)<<8)+((_&255)<<24);function Ja(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const vi=_=>{if(!_)return 1;const X=_.state;return!X||X.strm!==_||X.mode<fs||X.mode>vs?1:0},Zt=_=>{if(vi(_))return Sr;const X=_.state;return _.total_in=_.total_out=X.total=0,_.msg="",X.wrap&&(_.adler=X.wrap&1),X.mode=fs,X.last=0,X.havedict=0,X.flags=-1,X.dmax=32768,X.head=null,X.hold=0,X.bits=0,X.lencode=X.lendyn=new Int32Array(ra),X.distcode=X.distdyn=new Int32Array(al),X.sane=1,X.back=-1,Yr},ys=_=>{if(vi(_))return Sr;const X=_.state;return X.wsize=0,X.whave=0,X.wnext=0,Zt(_)},Nn=(_,X)=>{let O;if(vi(_))return Sr;const te=_.state;return X<0?(O=0,X=-X):(O=(X>>4)+5,X<48&&(X&=15)),X&&(X<8||X>15)?Sr:(te.window!==null&&te.wbits!==X&&(te.window=null),te.wrap=O,te.wbits=X,ys(_))},ln=(_,X)=>{if(!_)return Sr;const O=new Ja;_.state=O,O.strm=_,O.window=null,O.mode=fs;const te=Nn(_,X);return te!==Yr&&(_.state=null),te},qa=_=>ln(_,In);let _s=!0,Di,un;const cn=_=>{if(_s){Di=new Int32Array(512),un=new Int32Array(32);let X=0;for(;X<144;)_.lens[X++]=8;for(;X<256;)_.lens[X++]=9;for(;X<280;)_.lens[X++]=7;for(;X<288;)_.lens[X++]=8;for(Dn(Ws,_.lens,0,288,Di,0,_.work,{bits:9}),X=0;X<32;)_.lens[X++]=5;Dn(Gs,_.lens,0,32,un,0,_.work,{bits:5}),_s=!1}_.lencode=Di,_.lenbits=9,_.distcode=un,_.distbits=5},ia=(_,X,O,te)=>{let oe;const ae=_.state;return ae.window===null&&(ae.wsize=1<<ae.wbits,ae.wnext=0,ae.whave=0,ae.window=new Uint8Array(ae.wsize)),te>=ae.wsize?(ae.window.set(X.subarray(O-ae.wsize,O),0),ae.wnext=0,ae.whave=ae.wsize):(oe=ae.wsize-ae.wnext,oe>te&&(oe=te),ae.window.set(X.subarray(O-te,O-te+oe),ae.wnext),te-=oe,te?(ae.window.set(X.subarray(O-te,O),0),ae.wnext=te,ae.whave=ae.wsize):(ae.wnext+=oe,ae.wnext===ae.wsize&&(ae.wnext=0),ae.whave<ae.wsize&&(ae.whave+=oe))),0},ol=(_,X)=>{let O,te,oe,ae,Oe,Re,ht,ye,je,Tt,st,Xe,_t,tr,Nt=0,Ot,Ut,kt,ct,zt,or,Et,Wt;const It=new Uint8Array(4);let jt,Ft;const zr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(vi(_)||!_.output||!_.input&&_.avail_in!==0)return Sr;O=_.state,O.mode===Wr&&(O.mode=Xs),Oe=_.next_out,oe=_.output,ht=_.avail_out,ae=_.next_in,te=_.input,Re=_.avail_in,ye=O.hold,je=O.bits,Tt=Re,st=ht,Wt=Yr;e:for(;;)switch(O.mode){case fs:if(O.wrap===0){O.mode=Xs;break}for(;je<16;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(O.wrap&2&&ye===35615){O.wbits===0&&(O.wbits=15),O.check=0,It[0]=ye&255,It[1]=ye>>>8&255,O.check=z(O.check,It,2,0),ye=0,je=0,O.mode=Ka;break}if(O.head&&(O.head.done=!1),!(O.wrap&1)||(((ye&255)<<8)+(ye>>8))%31){_.msg="incorrect header check",O.mode=Jt;break}if((ye&15)!==Hs){_.msg="unknown compression method",O.mode=Jt;break}if(ye>>>=4,je-=4,Et=(ye&15)+8,O.wbits===0&&(O.wbits=Et),Et>15||Et>O.wbits){_.msg="invalid window size",O.mode=Jt;break}O.dmax=1<<O.wbits,O.flags=0,_.adler=O.check=1,O.mode=ye&512?Ys:Wr,ye=0,je=0;break;case Ka:for(;je<16;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(O.flags=ye,(O.flags&255)!==Hs){_.msg="unknown compression method",O.mode=Jt;break}if(O.flags&57344){_.msg="unknown header flags set",O.mode=Jt;break}O.head&&(O.head.text=ye>>8&1),O.flags&512&&O.wrap&4&&(It[0]=ye&255,It[1]=ye>>>8&255,O.check=z(O.check,It,2,0)),ye=0,je=0,O.mode=$a;case $a:for(;je<32;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}O.head&&(O.head.time=ye),O.flags&512&&O.wrap&4&&(It[0]=ye&255,It[1]=ye>>>8&255,It[2]=ye>>>16&255,It[3]=ye>>>24&255,O.check=z(O.check,It,4,0)),ye=0,je=0,O.mode=Ya;case Ya:for(;je<16;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}O.head&&(O.head.xflags=ye&255,O.head.os=ye>>8),O.flags&512&&O.wrap&4&&(It[0]=ye&255,It[1]=ye>>>8&255,O.check=z(O.check,It,2,0)),ye=0,je=0,O.mode=Xa;case Xa:if(O.flags&1024){for(;je<16;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}O.length=ye,O.head&&(O.head.extra_len=ye),O.flags&512&&O.wrap&4&&(It[0]=ye&255,It[1]=ye>>>8&255,O.check=z(O.check,It,2,0)),ye=0,je=0}else O.head&&(O.head.extra=null);O.mode=Nr;case Nr:if(O.flags&1024&&(Xe=O.length,Xe>Re&&(Xe=Re),Xe&&(O.head&&(Et=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Uint8Array(O.head.extra_len)),O.head.extra.set(te.subarray(ae,ae+Xe),Et)),O.flags&512&&O.wrap&4&&(O.check=z(O.check,te,Xe,ae)),Re-=Xe,ae+=Xe,O.length-=Xe),O.length))break e;O.length=0,O.mode=an;case an:if(O.flags&2048){if(Re===0)break e;Xe=0;do Et=te[ae+Xe++],O.head&&Et&&O.length<65536&&(O.head.name+=String.fromCharCode(Et));while(Et&&Xe<Re);if(O.flags&512&&O.wrap&4&&(O.check=z(O.check,te,Xe,ae)),Re-=Xe,ae+=Xe,Et)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=Ks;case Ks:if(O.flags&4096){if(Re===0)break e;Xe=0;do Et=te[ae+Xe++],O.head&&Et&&O.length<65536&&(O.head.comment+=String.fromCharCode(Et));while(Et&&Xe<Re);if(O.flags&512&&O.wrap&4&&(O.check=z(O.check,te,Xe,ae)),Re-=Xe,ae+=Xe,Et)break e}else O.head&&(O.head.comment=null);O.mode=$s;case $s:if(O.flags&512){for(;je<16;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(O.wrap&4&&ye!==(O.check&65535)){_.msg="header crc mismatch",O.mode=Jt;break}ye=0,je=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),_.adler=O.check=0,O.mode=Wr;break;case Ys:for(;je<32;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}_.adler=O.check=Qa(ye),ye=0,je=0,O.mode=Pn;case Pn:if(O.havedict===0)return _.next_out=Oe,_.avail_out=ht,_.next_in=ae,_.avail_in=Re,O.hold=ye,O.bits=je,Va;_.adler=O.check=1,O.mode=Wr;case Wr:if(X===On||X===ds)break e;case Xs:if(O.last){ye>>>=je&7,je-=je&7,O.mode=xs;break}for(;je<3;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}switch(O.last=ye&1,ye>>>=1,je-=1,ye&3){case 0:O.mode=Za;break;case 1:if(cn(O),O.mode=ji,X===ds){ye>>>=2,je-=2;break e}break;case 2:O.mode=on;break;case 3:_.msg="invalid block type",O.mode=Jt}ye>>>=2,je-=2;break;case Za:for(ye>>>=je&7,je-=je&7;je<32;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if((ye&65535)!==(ye>>>16^65535)){_.msg="invalid stored block lengths",O.mode=Jt;break}if(O.length=ye&65535,ye=0,je=0,O.mode=xi,X===ds)break e;case xi:O.mode=ms;case ms:if(Xe=O.length,Xe){if(Xe>Re&&(Xe=Re),Xe>ht&&(Xe=ht),Xe===0)break e;oe.set(te.subarray(ae,ae+Xe),Oe),Re-=Xe,ae+=Xe,ht-=Xe,Oe+=Xe,O.length-=Xe;break}O.mode=Wr;break;case on:for(;je<14;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(O.nlen=(ye&31)+257,ye>>>=5,je-=5,O.ndist=(ye&31)+1,ye>>>=5,je-=5,O.ncode=(ye&15)+4,ye>>>=4,je-=4,O.nlen>286||O.ndist>30){_.msg="too many length or distance symbols",O.mode=Jt;break}O.have=0,O.mode=ps;case ps:for(;O.have<O.ncode;){for(;je<3;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}O.lens[zr[O.have++]]=ye&7,ye>>>=3,je-=3}for(;O.have<19;)O.lens[zr[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,jt={bits:O.lenbits},Wt=Dn(nl,O.lens,0,19,O.lencode,0,O.work,jt),O.lenbits=jt.bits,Wt){_.msg="invalid code lengths set",O.mode=Jt;break}O.have=0,O.mode=Zs;case Zs:for(;O.have<O.nlen+O.ndist;){for(;Nt=O.lencode[ye&(1<<O.lenbits)-1],Ot=Nt>>>24,Ut=Nt>>>16&255,kt=Nt&65535,!(Ot<=je);){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(kt<16)ye>>>=Ot,je-=Ot,O.lens[O.have++]=kt;else{if(kt===16){for(Ft=Ot+2;je<Ft;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(ye>>>=Ot,je-=Ot,O.have===0){_.msg="invalid bit length repeat",O.mode=Jt;break}Et=O.lens[O.have-1],Xe=3+(ye&3),ye>>>=2,je-=2}else if(kt===17){for(Ft=Ot+3;je<Ft;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}ye>>>=Ot,je-=Ot,Et=0,Xe=3+(ye&7),ye>>>=3,je-=3}else{for(Ft=Ot+7;je<Ft;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}ye>>>=Ot,je-=Ot,Et=0,Xe=11+(ye&127),ye>>>=7,je-=7}if(O.have+Xe>O.nlen+O.ndist){_.msg="invalid bit length repeat",O.mode=Jt;break}for(;Xe--;)O.lens[O.have++]=Et}}if(O.mode===Jt)break;if(O.lens[256]===0){_.msg="invalid code -- missing end-of-block",O.mode=Jt;break}if(O.lenbits=9,jt={bits:O.lenbits},Wt=Dn(Ws,O.lens,0,O.nlen,O.lencode,0,O.work,jt),O.lenbits=jt.bits,Wt){_.msg="invalid literal/lengths set",O.mode=Jt;break}if(O.distbits=6,O.distcode=O.distdyn,jt={bits:O.distbits},Wt=Dn(Gs,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,jt),O.distbits=jt.bits,Wt){_.msg="invalid distances set",O.mode=Jt;break}if(O.mode=ji,X===ds)break e;case ji:O.mode=si;case si:if(Re>=6&&ht>=258){_.next_out=Oe,_.avail_out=ht,_.next_in=ae,_.avail_in=Re,O.hold=ye,O.bits=je,il(_,st),Oe=_.next_out,oe=_.output,ht=_.avail_out,ae=_.next_in,te=_.input,Re=_.avail_in,ye=O.hold,je=O.bits,O.mode===Wr&&(O.back=-1);break}for(O.back=0;Nt=O.lencode[ye&(1<<O.lenbits)-1],Ot=Nt>>>24,Ut=Nt>>>16&255,kt=Nt&65535,!(Ot<=je);){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(Ut&&(Ut&240)===0){for(ct=Ot,zt=Ut,or=kt;Nt=O.lencode[or+((ye&(1<<ct+zt)-1)>>ct)],Ot=Nt>>>24,Ut=Nt>>>16&255,kt=Nt&65535,!(ct+Ot<=je);){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}ye>>>=ct,je-=ct,O.back+=ct}if(ye>>>=Ot,je-=Ot,O.back+=Ot,O.length=kt,Ut===0){O.mode=qs;break}if(Ut&32){O.back=-1,O.mode=Wr;break}if(Ut&64){_.msg="invalid literal/length code",O.mode=Jt;break}O.extra=Ut&15,O.mode=gs;case gs:if(O.extra){for(Ft=O.extra;je<Ft;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}O.length+=ye&(1<<O.extra)-1,ye>>>=O.extra,je-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=Qs;case Qs:for(;Nt=O.distcode[ye&(1<<O.distbits)-1],Ot=Nt>>>24,Ut=Nt>>>16&255,kt=Nt&65535,!(Ot<=je);){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if((Ut&240)===0){for(ct=Ot,zt=Ut,or=kt;Nt=O.distcode[or+((ye&(1<<ct+zt)-1)>>ct)],Ot=Nt>>>24,Ut=Nt>>>16&255,kt=Nt&65535,!(ct+Ot<=je);){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}ye>>>=ct,je-=ct,O.back+=ct}if(ye>>>=Ot,je-=Ot,O.back+=Ot,Ut&64){_.msg="invalid distance code",O.mode=Jt;break}O.offset=kt,O.extra=Ut&15,O.mode=kn;case kn:if(O.extra){for(Ft=O.extra;je<Ft;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}O.offset+=ye&(1<<O.extra)-1,ye>>>=O.extra,je-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){_.msg="invalid distance too far back",O.mode=Jt;break}O.mode=Js;case Js:if(ht===0)break e;if(Xe=st-ht,O.offset>Xe){if(Xe=O.offset-Xe,Xe>O.whave&&O.sane){_.msg="invalid distance too far back",O.mode=Jt;break}Xe>O.wnext?(Xe-=O.wnext,_t=O.wsize-Xe):_t=O.wnext-Xe,Xe>O.length&&(Xe=O.length),tr=O.window}else tr=oe,_t=Oe-O.offset,Xe=O.length;Xe>ht&&(Xe=ht),ht-=Xe,O.length-=Xe;do oe[Oe++]=tr[_t++];while(--Xe);O.length===0&&(O.mode=si);break;case qs:if(ht===0)break e;oe[Oe++]=O.length,ht--,O.mode=si;break;case xs:if(O.wrap){for(;je<32;){if(Re===0)break e;Re--,ye|=te[ae++]<<je,je+=8}if(st-=ht,_.total_out+=st,O.total+=st,O.wrap&4&&st&&(_.adler=O.check=O.flags?z(O.check,oe,st,Oe-st):Pe(O.check,oe,st,Oe-st)),st=ht,O.wrap&4&&(O.flags?ye:Qa(ye))!==O.check){_.msg="incorrect data check",O.mode=Jt;break}ye=0,je=0}O.mode=ea;case ea:if(O.wrap&&O.flags){for(;je<32;){if(Re===0)break e;Re--,ye+=te[ae++]<<je,je+=8}if(O.wrap&4&&ye!==(O.total&4294967295)){_.msg="incorrect length check",O.mode=Jt;break}ye=0,je=0}O.mode=ta;case ta:Wt=sl;break e;case Jt:Wt=hs;break e;case ai:return Vs;case vs:default:return Sr}return _.next_out=Oe,_.avail_out=ht,_.next_in=ae,_.avail_in=Re,O.hold=ye,O.bits=je,(O.wsize||st!==_.avail_out&&O.mode<Jt&&(O.mode<xs||X!==sn))&&ia(_,_.output,_.next_out,st-_.avail_out),Tt-=_.avail_in,st-=_.avail_out,_.total_in+=Tt,_.total_out+=st,O.total+=st,O.wrap&4&&st&&(_.adler=O.check=O.flags?z(O.check,oe,st,_.next_out-st):Pe(O.check,oe,st,_.next_out-st)),_.data_type=O.bits+(O.last?64:0)+(O.mode===Wr?128:0)+(O.mode===ji||O.mode===xi?256:0),(Tt===0&&st===0||X===sn)&&Wt===Yr&&(Wt=Ha),Wt},ll=_=>{if(vi(_))return Sr;let X=_.state;return X.window&&(X.window=null),_.state=null,Yr},eo=(_,X)=>{if(vi(_))return Sr;const O=_.state;return(O.wrap&2)===0?Sr:(O.head=X,X.done=!1,Yr)},bs=(_,X)=>{const O=X.length;let te,oe,ae;return vi(_)||(te=_.state,te.wrap!==0&&te.mode!==Pn)?Sr:te.mode===Pn&&(oe=1,oe=Pe(oe,X,O,0),oe!==te.check)?hs:(ae=ia(_,X,O,O),ae?(te.mode=ai,Vs):(te.havedict=1,Yr))};var Es=ys,na=Nn,sa=Zt,aa=qa,oa=ln,ul=ol,to=ll,cl=eo,dl=bs,la="pako inflate (from Nodeca project)",gr={inflateReset:Es,inflateReset2:na,inflateResetKeep:sa,inflateInit:aa,inflateInit2:oa,inflate:ul,inflateEnd:to,inflateGetHeader:cl,inflateSetDictionary:dl,inflateInfo:la};function ro(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var dn=ro;const Gr=Object.prototype.toString,{Z_NO_FLUSH:zn,Z_FINISH:oi,Z_OK:Oi,Z_STREAM_END:ua,Z_NEED_DICT:ca,Z_STREAM_ERROR:Pi,Z_DATA_ERROR:hn,Z_MEM_ERROR:fn}=_e;function yi(_){this.options=gi.assign({chunkSize:65536,windowBits:15,to:""},_||{});const X=this.options;X.raw&&X.windowBits>=0&&X.windowBits<16&&(X.windowBits=-X.windowBits,X.windowBits===0&&(X.windowBits=-15)),X.windowBits>=0&&X.windowBits<16&&!(_&&_.windowBits)&&(X.windowBits+=32),X.windowBits>15&&X.windowBits<48&&(X.windowBits&15)===0&&(X.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Na,this.strm.avail_out=0;let O=gr.inflateInit2(this.strm,X.windowBits);if(O!==Oi)throw new Error(be[O]);if(this.header=new dn,gr.inflateGetHeader(this.strm,this.header),X.dictionary&&(typeof X.dictionary=="string"?X.dictionary=Ln.string2buf(X.dictionary):Gr.call(X.dictionary)==="[object ArrayBuffer]"&&(X.dictionary=new Uint8Array(X.dictionary)),X.raw&&(O=gr.inflateSetDictionary(this.strm,X.dictionary),O!==Oi)))throw new Error(be[O])}yi.prototype.push=function(_,X){const O=this.strm,te=this.options.chunkSize,oe=this.options.dictionary;let ae,Oe,Re;if(this.ended)return!1;for(X===~~X?Oe=X:Oe=X===!0?oi:zn,Gr.call(_)==="[object ArrayBuffer]"?O.input=new Uint8Array(_):O.input=_,O.next_in=0,O.avail_in=O.input.length;;){for(O.avail_out===0&&(O.output=new Uint8Array(te),O.next_out=0,O.avail_out=te),ae=gr.inflate(O,Oe),ae===ca&&oe&&(ae=gr.inflateSetDictionary(O,oe),ae===Oi?ae=gr.inflate(O,Oe):ae===hn&&(ae=ca));O.avail_in>0&&ae===ua&&O.state.wrap>0&&_[O.next_in]!==0;)gr.inflateReset(O),ae=gr.inflate(O,Oe);switch(ae){case Pi:case hn:case ca:case fn:return this.onEnd(ae),this.ended=!0,!1}if(Re=O.avail_out,O.next_out&&(O.avail_out===0||ae===ua))if(this.options.to==="string"){let ht=Ln.utf8border(O.output,O.next_out),ye=O.next_out-ht,je=Ln.buf2string(O.output,ht);O.next_out=ye,O.avail_out=te-ye,ye&&O.output.set(O.output.subarray(ht,ht+ye),0),this.onData(je)}else this.onData(O.output.length===O.next_out?O.output:O.output.subarray(0,O.next_out));if(!(ae===Oi&&Re===0)){if(ae===ua)return ae=gr.inflateEnd(this.strm),this.onEnd(ae),this.ended=!0,!0;if(O.avail_in===0)break}}return!0},yi.prototype.onData=function(_){this.chunks.push(_)},yi.prototype.onEnd=function(_){_===Oi&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gi.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function Fn(_,X){const O=new yi(X);if(O.push(_),O.err)throw O.msg||be[O.err];return O.result}function mn(_,X){return X=X||{},X.raw=!0,Fn(_,X)}var _i=yi,qt=Fn,Qt=mn,bi=Fn,xr={Inflate:_i,inflate:qt,inflateRaw:Qt,ungzip:bi};const{Deflate:Ar,deflate:ki,deflateRaw:pn,gzip:Mr}=tl,{Inflate:ws,inflate:io,inflateRaw:no,ungzip:Cs}=xr;var da=Ar,Xr=ki,Bn=pn,Rs=Mr,ha=ws,so=io,li=no,Ii=Cs,Ni=_e,Ss={Deflate:da,deflate:Xr,deflateRaw:Bn,gzip:Rs,Inflate:ha,inflate:so,inflateRaw:li,ungzip:Ii,constants:Ni}},"./node_modules/upng-js/UPNG.js"(o,a,n){(function(){var d={},R;o.exports=d,R=n("./node_modules/upng-js/node_modules/pako/index.js"),(function(S,j){S.toRGBA8=function(p){var v=p.width,D=p.height;if(p.tabs.acTL==null)return[S.toRGBA8.decodeImage(p.data,v,D,p).buffer];var x=[];p.frames[0].data==null&&(p.frames[0].data=p.data);for(var A,L=new Uint8Array(v*D*4),w=0;w<p.frames.length;w++){var b=p.frames[w],u=b.rect.x,i=b.rect.y,s=b.rect.width,h=b.rect.height,g=S.toRGBA8.decodeImage(b.data,s,h,p);if(w==0?A=g:b.blend==0?S._copyTile(g,s,h,A,v,D,u,i,0):b.blend==1&&S._copyTile(g,s,h,A,v,D,u,i,1),x.push(A.buffer),A=A.slice(0),b.dispose!=0){if(b.dispose==1)S._copyTile(L,s,h,A,v,D,u,i,0);else if(b.dispose==2){for(var y=w-1;p.frames[y].dispose==2;)y--;A=new Uint8Array(x[y]).slice(0)}}}return x},S.toRGBA8.decodeImage=function(p,v,D,x){var A=v*D,L=S.decode._getBPP(x),w=Math.ceil(v*L/8),b=new Uint8Array(A*4),u=new Uint32Array(b.buffer),i=x.ctype,s=x.depth,h=S._bin.readUshort;if(i==6){var g=A<<2;if(s==8)for(var y=0;y<g;y++)b[y]=p[y];if(s==16)for(var y=0;y<g;y++)b[y]=p[y<<1]}else if(i==2){var E=x.tabs.tRNS,l=-1,f=-1,m=-1;if(E&&(l=E[0],f=E[1],m=E[2]),s==8)for(var y=0;y<A;y++){var C=y<<2,T=y*3;b[C]=p[T],b[C+1]=p[T+1],b[C+2]=p[T+2],b[C+3]=255,l!=-1&&p[T]==l&&p[T+1]==f&&p[T+2]==m&&(b[C+3]=0)}if(s==16)for(var y=0;y<A;y++){var C=y<<2,T=y*6;b[C]=p[T],b[C+1]=p[T+2],b[C+2]=p[T+4],b[C+3]=255,l!=-1&&h(p,T)==l&&h(p,T+2)==f&&h(p,T+4)==m&&(b[C+3]=0)}}else if(i==3){var P=x.tabs.PLTE,F=x.tabs.tRNS,N=F?F.length:0;if(s==1)for(var B=0;B<D;B++)for(var U=B*w,K=B*v,y=0;y<v;y++){var C=K+y<<2,H=p[U+(y>>3)]>>7-((y&7)<<0)&1,G=3*H;b[C]=P[G],b[C+1]=P[G+1],b[C+2]=P[G+2],b[C+3]=H<N?F[H]:255}if(s==2)for(var B=0;B<D;B++)for(var U=B*w,K=B*v,y=0;y<v;y++){var C=K+y<<2,H=p[U+(y>>2)]>>6-((y&3)<<1)&3,G=3*H;b[C]=P[G],b[C+1]=P[G+1],b[C+2]=P[G+2],b[C+3]=H<N?F[H]:255}if(s==4)for(var B=0;B<D;B++)for(var U=B*w,K=B*v,y=0;y<v;y++){var C=K+y<<2,H=p[U+(y>>1)]>>4-((y&1)<<2)&15,G=3*H;b[C]=P[G],b[C+1]=P[G+1],b[C+2]=P[G+2],b[C+3]=H<N?F[H]:255}if(s==8)for(var y=0;y<A;y++){var C=y<<2,H=p[y],G=3*H;b[C]=P[G],b[C+1]=P[G+1],b[C+2]=P[G+2],b[C+3]=H<N?F[H]:255}}else if(i==4){if(s==8)for(var y=0;y<A;y++){var C=y<<2,$=y<<1,V=p[$];b[C]=V,b[C+1]=V,b[C+2]=V,b[C+3]=p[$+1]}if(s==16)for(var y=0;y<A;y++){var C=y<<2,$=y<<2,V=p[$];b[C]=V,b[C+1]=V,b[C+2]=V,b[C+3]=p[$+2]}}else if(i==0){var l=x.tabs.tRNS?x.tabs.tRNS:-1;if(s==1)for(var y=0;y<A;y++){var V=255*(p[y>>3]>>7-(y&7)&1),k=V==l*255?0:255;u[y]=k<<24|V<<16|V<<8|V}if(s==2)for(var y=0;y<A;y++){var V=85*(p[y>>2]>>6-((y&3)<<1)&3),k=V==l*85?0:255;u[y]=k<<24|V<<16|V<<8|V}if(s==4)for(var y=0;y<A;y++){var V=17*(p[y>>1]>>4-((y&1)<<2)&15),k=V==l*17?0:255;u[y]=k<<24|V<<16|V<<8|V}if(s==8)for(var y=0;y<A;y++){var V=p[y],k=V==l?0:255;u[y]=k<<24|V<<16|V<<8|V}if(s==16)for(var y=0;y<A;y++){var V=p[y<<1],k=h(p,y<<1)==l?0:255;u[y]=k<<24|V<<16|V<<8|V}}return b},S.decode=function(p){for(var v=new Uint8Array(p),D=8,x=S._bin,A=x.readUshort,L=x.readUint,w={tabs:{},frames:[]},b=new Uint8Array(v.length),u=0,i,s=0,h=[137,80,78,71,13,10,26,10],g=0;g<8;g++)if(v[g]!=h[g])throw"The input is not a PNG file!";for(;D<v.length;){var y=x.readUint(v,D);D+=4;var E=x.readASCII(v,D,4);if(D+=4,E=="IHDR")S.decode._IHDR(v,D,w);else if(E=="IDAT"){for(var g=0;g<y;g++)b[u+g]=v[D+g];u+=y}else if(E=="acTL")w.tabs[E]={num_frames:L(v,D),num_plays:L(v,D+4)},i=new Uint8Array(v.length);else if(E=="fcTL"){if(s!=0){var l=w.frames[w.frames.length-1];l.data=S.decode._decompress(w,i.slice(0,s),l.rect.width,l.rect.height),s=0}var f={x:L(v,D+12),y:L(v,D+16),width:L(v,D+4),height:L(v,D+8)},m=A(v,D+22);m=A(v,D+20)/(m==0?100:m);var C={rect:f,delay:Math.round(m*1e3),dispose:v[D+24],blend:v[D+25]};w.frames.push(C)}else if(E=="fdAT"){for(var g=0;g<y-4;g++)i[s+g]=v[D+g+4];s+=y-4}else if(E=="pHYs")w.tabs[E]=[x.readUint(v,D),x.readUint(v,D+4),v[D+8]];else if(E=="cHRM"){w.tabs[E]=[];for(var g=0;g<8;g++)w.tabs[E].push(x.readUint(v,D+g*4))}else if(E=="tEXt"){w.tabs[E]==null&&(w.tabs[E]={});var T=x.nextZero(v,D),P=x.readASCII(v,D,T-D),F=x.readASCII(v,T+1,D+y-T-1);w.tabs[E][P]=F}else if(E=="iTXt"){w.tabs[E]==null&&(w.tabs[E]={});var T=0,N=D;T=x.nextZero(v,N);var P=x.readASCII(v,N,T-N);N=T+1,v[N],v[N+1],N+=2,T=x.nextZero(v,N),x.readASCII(v,N,T-N),N=T+1,T=x.nextZero(v,N),x.readUTF8(v,N,T-N),N=T+1;var F=x.readUTF8(v,N,y-(N-D));w.tabs[E][P]=F}else if(E=="PLTE")w.tabs[E]=x.readBytes(v,D,y);else if(E=="hIST"){var B=w.tabs.PLTE.length/3;w.tabs[E]=[];for(var g=0;g<B;g++)w.tabs[E].push(A(v,D+g*2))}else if(E=="tRNS")w.ctype==3?w.tabs[E]=x.readBytes(v,D,y):w.ctype==0?w.tabs[E]=A(v,D):w.ctype==2&&(w.tabs[E]=[A(v,D),A(v,D+2),A(v,D+4)]);else if(E=="gAMA")w.tabs[E]=x.readUint(v,D)/1e5;else if(E=="sRGB")w.tabs[E]=v[D];else if(E=="bKGD")w.ctype==0||w.ctype==4?w.tabs[E]=[A(v,D)]:w.ctype==2||w.ctype==6?w.tabs[E]=[A(v,D),A(v,D+2),A(v,D+4)]:w.ctype==3&&(w.tabs[E]=v[D]);else if(E=="IEND"){if(s!=0){var l=w.frames[w.frames.length-1];l.data=S.decode._decompress(w,i.slice(0,s),l.rect.width,l.rect.height),s=0}w.data=S.decode._decompress(w,b,w.width,w.height);break}D+=y,x.readUint(v,D),D+=4}return delete w.compress,delete w.interlace,delete w.filter,w},S.decode._decompress=function(p,v,D,x){return p.compress==0&&(v=S.decode._inflate(v)),p.interlace==0?v=S.decode._filterZero(v,p,0,D,x):p.interlace==1&&(v=S.decode._readInterlace(v,p)),v},S.decode._inflate=function(p){return j.inflate(p)},S.decode._readInterlace=function(p,v){for(var D=v.width,x=v.height,A=S.decode._getBPP(v),L=A>>3,w=Math.ceil(D*A/8),b=new Uint8Array(x*w),u=0,i=[0,0,4,0,2,0,1],s=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],g=[8,8,4,4,2,2,1],y=0;y<7;){for(var E=h[y],l=g[y],f=0,m=0,C=i[y];C<x;)C+=E,m++;for(var T=s[y];T<D;)T+=l,f++;var P=Math.ceil(f*A/8);S.decode._filterZero(p,v,u,f,m);for(var F=0,N=i[y];N<x;){for(var B=s[y],U=u+F*P<<3;B<D;){if(A==1){var K=p[U>>3];K=K>>7-(U&7)&1,b[N*w+(B>>3)]|=K<<7-((B&3)<<0)}if(A==2){var K=p[U>>3];K=K>>6-(U&7)&3,b[N*w+(B>>2)]|=K<<6-((B&3)<<1)}if(A==4){var K=p[U>>3];K=K>>4-(U&7)&15,b[N*w+(B>>1)]|=K<<4-((B&1)<<2)}if(A>=8)for(var H=N*w+B*L,G=0;G<L;G++)b[H+G]=p[(U>>3)+G];U+=A,B+=l}F++,N+=E}f*m!=0&&(u+=m*(1+P)),y=y+1}return b},S.decode._getBPP=function(p){var v=[1,null,3,1,2,null,4][p.ctype];return v*p.depth},S.decode._filterZero=function(p,v,D,x,A){var L=S.decode._getBPP(v),w=Math.ceil(x*L/8),b=S.decode._paeth;L=Math.ceil(L/8);for(var u=0;u<A;u++){var i=D+u*w,s=i+u+1,h=p[s-1];if(h==0)for(var g=0;g<w;g++)p[i+g]=p[s+g];else if(h==1){for(var g=0;g<L;g++)p[i+g]=p[s+g];for(var g=L;g<w;g++)p[i+g]=p[s+g]+p[i+g-L]&255}else if(u==0){for(var g=0;g<L;g++)p[i+g]=p[s+g];if(h==2)for(var g=L;g<w;g++)p[i+g]=p[s+g]&255;if(h==3)for(var g=L;g<w;g++)p[i+g]=p[s+g]+(p[i+g-L]>>1)&255;if(h==4)for(var g=L;g<w;g++)p[i+g]=p[s+g]+b(p[i+g-L],0,0)&255}else{if(h==2)for(var g=0;g<w;g++)p[i+g]=p[s+g]+p[i+g-w]&255;if(h==3){for(var g=0;g<L;g++)p[i+g]=p[s+g]+(p[i+g-w]>>1)&255;for(var g=L;g<w;g++)p[i+g]=p[s+g]+(p[i+g-w]+p[i+g-L]>>1)&255}if(h==4){for(var g=0;g<L;g++)p[i+g]=p[s+g]+b(0,p[i+g-w],0)&255;for(var g=L;g<w;g++)p[i+g]=p[s+g]+b(p[i+g-L],p[i+g-w],p[i+g-L-w])&255}}}return p},S.decode._paeth=function(p,v,D){var x=p+v-D,A=Math.abs(x-p),L=Math.abs(x-v),w=Math.abs(x-D);return A<=L&&A<=w?p:L<=w?v:D},S.decode._IHDR=function(p,v,D){var x=S._bin;D.width=x.readUint(p,v),v+=4,D.height=x.readUint(p,v),v+=4,D.depth=p[v],v++,D.ctype=p[v],v++,D.compress=p[v],v++,D.filter=p[v],v++,D.interlace=p[v],v++},S._bin={nextZero:function(p,v){for(;p[v]!=0;)v++;return v},readUshort:function(p,v){return p[v]<<8|p[v+1]},writeUshort:function(p,v,D){p[v]=D>>8&255,p[v+1]=D&255},readUint:function(p,v){return p[v]*16777216+(p[v+1]<<16|p[v+2]<<8|p[v+3])},writeUint:function(p,v,D){p[v]=D>>24&255,p[v+1]=D>>16&255,p[v+2]=D>>8&255,p[v+3]=D&255},readASCII:function(p,v,D){for(var x="",A=0;A<D;A++)x+=String.fromCharCode(p[v+A]);return x},writeASCII:function(p,v,D){for(var x=0;x<D.length;x++)p[v+x]=D.charCodeAt(x)},readBytes:function(p,v,D){for(var x=[],A=0;A<D;A++)x.push(p[v+A]);return x},pad:function(p){return p.length<2?"0"+p:p},readUTF8:function(p,v,D){for(var x="",A,L=0;L<D;L++)x+="%"+S._bin.pad(p[v+L].toString(16));try{A=decodeURIComponent(x)}catch{return S._bin.readASCII(p,v,D)}return A}},S._copyTile=function(p,v,D,x,A,L,w,b,u){for(var i=Math.min(v,A),s=Math.min(D,L),h=0,g=0,y=0;y<s;y++)for(var E=0;E<i;E++)if(w>=0&&b>=0?(h=y*v+E<<2,g=(b+y)*A+w+E<<2):(h=(-b+y)*v-w+E<<2,g=y*A+E<<2),u==0)x[g]=p[h],x[g+1]=p[h+1],x[g+2]=p[h+2],x[g+3]=p[h+3];else if(u==1){var l=p[h+3]*.00392156862745098,f=p[h]*l,m=p[h+1]*l,C=p[h+2]*l,T=x[g+3]*(1/255),P=x[g]*T,F=x[g+1]*T,N=x[g+2]*T,B=1-l,U=l+T*B,K=U==0?0:1/U;x[g+3]=255*U,x[g+0]=(f+P*B)*K,x[g+1]=(m+F*B)*K,x[g+2]=(C+N*B)*K}else if(u==2){var l=p[h+3],f=p[h],m=p[h+1],C=p[h+2],T=x[g+3],P=x[g],F=x[g+1],N=x[g+2];l==T&&f==P&&m==F&&C==N?(x[g]=0,x[g+1]=0,x[g+2]=0,x[g+3]=0):(x[g]=f,x[g+1]=m,x[g+2]=C,x[g+3]=l)}else if(u==3){var l=p[h+3],f=p[h],m=p[h+1],C=p[h+2],T=x[g+3],P=x[g],F=x[g+1],N=x[g+2];if(l==T&&f==P&&m==F&&C==N)continue;if(l<220&&T>20)return!1}return!0},S.encode=function(p,v,D,x,A,L){x==null&&(x=0),L==null&&(L=!1);for(var w=new Uint8Array(p[0].byteLength*p.length+100),b=[137,80,78,71,13,10,26,10],u=0;u<8;u++)w[u]=b[u];var i=8,s=S._bin,h=S.crc.crc,g=s.writeUint,y=s.writeUshort,E=s.writeASCII,l=S.encode.compressPNG(p,v,D,x,L);g(w,i,13),i+=4,E(w,i,"IHDR"),i+=4,g(w,i,v),i+=4,g(w,i,D),i+=4,w[i]=l.depth,i++,w[i]=l.ctype,i++,w[i]=0,i++,w[i]=0,i++,w[i]=0,i++,g(w,i,h(w,i-17,17)),i+=4,g(w,i,1),i+=4,E(w,i,"sRGB"),i+=4,w[i]=1,i++,g(w,i,h(w,i-5,5)),i+=4;var f=p.length>1;if(f&&(g(w,i,8),i+=4,E(w,i,"acTL"),i+=4,g(w,i,p.length),i+=4,g(w,i,0),i+=4,g(w,i,h(w,i-12,12)),i+=4),l.ctype==3){var m=l.plte.length;g(w,i,m*3),i+=4,E(w,i,"PLTE"),i+=4;for(var u=0;u<m;u++){var C=u*3,T=l.plte[u],P=T&255,F=T>>8&255,N=T>>16&255;w[i+C+0]=P,w[i+C+1]=F,w[i+C+2]=N}if(i+=m*3,g(w,i,h(w,i-m*3-4,m*3+4)),i+=4,l.gotAlpha){g(w,i,m),i+=4,E(w,i,"tRNS"),i+=4;for(var u=0;u<m;u++)w[i+u]=l.plte[u]>>24&255;i+=m,g(w,i,h(w,i-m-4,m+4)),i+=4}}for(var B=0,U=0;U<l.frames.length;U++){var K=l.frames[U];f&&(g(w,i,26),i+=4,E(w,i,"fcTL"),i+=4,g(w,i,B++),i+=4,g(w,i,K.rect.width),i+=4,g(w,i,K.rect.height),i+=4,g(w,i,K.rect.x),i+=4,g(w,i,K.rect.y),i+=4,y(w,i,A[U]),i+=2,y(w,i,1e3),i+=2,w[i]=K.dispose,i++,w[i]=K.blend,i++,g(w,i,h(w,i-30,30)),i+=4);var H=K.cimg,m=H.length;g(w,i,m+(U==0?0:4)),i+=4;var G=i;E(w,i,U==0?"IDAT":"fdAT"),i+=4,U!=0&&(g(w,i,B++),i+=4);for(var u=0;u<m;u++)w[i+u]=H[u];i+=m,g(w,i,h(w,G,i-G)),i+=4}return g(w,i,0),i+=4,E(w,i,"IEND"),i+=4,g(w,i,h(w,i-4,4)),i+=4,w.buffer.slice(0,i)},S.encode.compressPNG=function(p,v,D,x,A){for(var L=S.encode.compress(p,v,D,x,!1,A),w=0;w<p.length;w++){var b=L.frames[w];b.rect.width;var u=b.rect.height,i=b.bpl,s=b.bpp,h=new Uint8Array(u*i+u);b.cimg=S.encode._filterZero(b.img,u,s,i,h)}return L},S.encode.compress=function(p,v,D,x,A,L){L==null&&(L=!1);for(var w=6,b=8,u=4,i=255,s=0;s<p.length;s++)for(var h=new Uint8Array(p[s]),g=h.length,y=0;y<g;y+=4)i&=h[y+3];var E=i!=255,l={},f=[];if(p.length!=0&&(l[0]=0,f.push(0),x!=0&&x--),x!=0){var m=S.quantize(p,x,A);p=m.bufs;for(var y=0;y<m.plte.length;y++){var C=m.plte[y].est.rgba;l[C]==null&&(l[C]=f.length,f.push(C))}}else for(var s=0;s<p.length;s++)for(var T=new Uint32Array(p[s]),g=T.length,y=0;y<g;y++){var C=T[y];if((y<v||C!=T[y-1]&&C!=T[y-v])&&l[C]==null&&(l[C]=f.length,f.push(C),f.length>=300))break}var P=E?A:!1,F=f.length;F<=256&&L==!1&&(F<=2?b=1:F<=4?b=2:F<=16?b=4:b=8,A&&(b=8),E=!0);for(var N=[],s=0;s<p.length;s++){var B=new Uint8Array(p[s]),U=new Uint32Array(B.buffer),K=0,H=0,G=v,$=D,V=0;if(s!=0&&!P){for(var k=A||s==1||N[N.length-2].dispose==2?1:2,Y=0,ie=1e9,ne=0;ne<k;ne++){for(var Le=new Uint8Array(p[s-1-ne]),he=new Uint32Array(p[s-1-ne]),le=v,xe=D,fe=-1,pe=-1,Te=0;Te<D;Te++)for(var ke=0;ke<v;ke++){var y=Te*v+ke;U[y]!=he[y]&&(ke<le&&(le=ke),ke>fe&&(fe=ke),Te<xe&&(xe=Te),Te>pe&&(pe=Te))}var $e=fe==-1?1:(fe-le+1)*(pe-xe+1);$e<ie&&(ie=$e,Y=ne,fe==-1?(K=H=0,G=$=1):(K=le,H=xe,G=fe-le+1,$=pe-xe+1))}var Le=new Uint8Array(p[s-1-Y]);Y==1&&(N[N.length-1].dispose=2);var ue=new Uint8Array(G*$*4);new Uint32Array(ue.buffer),S._copyTile(Le,v,D,ue,G,$,-K,-H,0),S._copyTile(B,v,D,ue,G,$,-K,-H,3)?(S._copyTile(B,v,D,ue,G,$,-K,-H,2),V=1):(S._copyTile(B,v,D,ue,G,$,-K,-H,0),V=0),B=ue,U=new Uint32Array(B.buffer)}var Me=4*G;if(F<=256&&L==!1){Me=Math.ceil(b*G/8);for(var ue=new Uint8Array(Me*$),Te=0;Te<$;Te++){var y=Te*Me,Ge=Te*G;if(b==8)for(var ke=0;ke<G;ke++)ue[y+ke]=l[U[Ge+ke]];else if(b==4)for(var ke=0;ke<G;ke++)ue[y+(ke>>1)]|=l[U[Ge+ke]]<<4-(ke&1)*4;else if(b==2)for(var ke=0;ke<G;ke++)ue[y+(ke>>2)]|=l[U[Ge+ke]]<<6-(ke&3)*2;else if(b==1)for(var ke=0;ke<G;ke++)ue[y+(ke>>3)]|=l[U[Ge+ke]]<<7-(ke&7)*1}B=ue,w=3,u=1}else if(E==!1&&p.length==1){for(var ue=new Uint8Array(G*$*3),Je=G*$,y=0;y<Je;y++){var qe=y*3,tt=y*4;ue[qe]=B[tt],ue[qe+1]=B[tt+1],ue[qe+2]=B[tt+2]}B=ue,w=2,u=3,Me=3*G}N.push({rect:{x:K,y:H,width:G,height:$},img:B,bpl:Me,bpp:u,blend:V,dispose:P?1:0})}return{ctype:w,depth:b,plte:f,gotAlpha:E,frames:N}},S.encode._filterZero=function(p,v,D,x,A){for(var L=[],w=0;w<5;w++)if(!(v*x>5e5&&(w==2||w==3||w==4))){for(var b=0;b<v;b++)S.encode._filterLine(A,p,b,x,D,w);if(L.push(j.deflate(A)),D==1)break}for(var u,i=1e9,s=0;s<L.length;s++)L[s].length<i&&(u=s,i=L[s].length);return L[u]},S.encode._filterLine=function(p,v,D,x,A,L){var w=D*x,b=w+D,u=S.decode._paeth;if(p[b]=L,b++,L==0)for(var i=0;i<x;i++)p[b+i]=v[w+i];else if(L==1){for(var i=0;i<A;i++)p[b+i]=v[w+i];for(var i=A;i<x;i++)p[b+i]=v[w+i]-v[w+i-A]+256&255}else if(D==0){for(var i=0;i<A;i++)p[b+i]=v[w+i];if(L==2)for(var i=A;i<x;i++)p[b+i]=v[w+i];if(L==3)for(var i=A;i<x;i++)p[b+i]=v[w+i]-(v[w+i-A]>>1)+256&255;if(L==4)for(var i=A;i<x;i++)p[b+i]=v[w+i]-u(v[w+i-A],0,0)+256&255}else{if(L==2)for(var i=0;i<x;i++)p[b+i]=v[w+i]+256-v[w+i-x]&255;if(L==3){for(var i=0;i<A;i++)p[b+i]=v[w+i]+256-(v[w+i-x]>>1)&255;for(var i=A;i<x;i++)p[b+i]=v[w+i]+256-(v[w+i-x]+v[w+i-A]>>1)&255}if(L==4){for(var i=0;i<A;i++)p[b+i]=v[w+i]+256-u(0,v[w+i-x],0)&255;for(var i=A;i<x;i++)p[b+i]=v[w+i]+256-u(v[w+i-A],v[w+i-x],v[w+i-A-x])&255}}},S.crc={table:(function(){for(var p=new Uint32Array(256),v=0;v<256;v++){for(var D=v,x=0;x<8;x++)D&1?D=3988292384^D>>>1:D=D>>>1;p[v]=D}return p})(),update:function(p,v,D,x){for(var A=0;A<x;A++)p=S.crc.table[(p^v[D+A])&255]^p>>>8;return p},crc:function(p,v,D){return S.crc.update(4294967295,p,v,D)^4294967295}},S.quantize=function(p,v,D){for(var x=[],A=0,L=0;L<p.length;L++)x.push(S.encode.alphaMul(new Uint8Array(p[L]),D)),A+=p[L].byteLength;for(var w=new Uint8Array(A),b=new Uint32Array(w.buffer),u=0,L=0;L<x.length;L++){for(var i=x[L],s=i.length,h=0;h<s;h++)w[u+h]=i[h];u+=s}var g={i0:0,i1:w.length,bst:null,est:null,tdst:0,left:null,right:null};g.bst=S.quantize.stats(w,g.i0,g.i1),g.est=S.quantize.estats(g.bst);for(var y=[g];y.length<v;){for(var E=0,l=0,L=0;L<y.length;L++)y[L].est.L>E&&(E=y[L].est.L,l=L);if(E<.001)break;var f=y[l],m=S.quantize.splitPixels(w,b,f.i0,f.i1,f.est.e,f.est.eMq255),C={i0:f.i0,i1:m,bst:null,est:null,tdst:0,left:null,right:null};C.bst=S.quantize.stats(w,C.i0,C.i1),C.est=S.quantize.estats(C.bst);var T={i0:m,i1:f.i1,bst:null,est:null,tdst:0,left:null,right:null};T.bst={R:[],m:[],N:f.bst.N-C.bst.N};for(var L=0;L<16;L++)T.bst.R[L]=f.bst.R[L]-C.bst.R[L];for(var L=0;L<4;L++)T.bst.m[L]=f.bst.m[L]-C.bst.m[L];T.est=S.quantize.estats(T.bst),f.left=C,f.right=T,y[l]=C,y.push(T)}y.sort(function(k,Y){return Y.bst.N-k.bst.N});for(var P=0;P<x.length;P++){for(var F=S.quantize.planeDst,N=new Uint8Array(x[P].buffer),B=new Uint32Array(x[P].buffer),U=N.length,L=0;L<U;L+=4){for(var K=N[L]*.00392156862745098,H=N[L+1]*(1/255),G=N[L+2]*(1/255),$=N[L+3]*(1/255),V=g;V.left;)V=F(V.est,K,H,G,$)<=0?V.left:V.right;B[L>>2]=V.est.rgba}x[P]=B.buffer}return{bufs:x,plte:y}},S.quantize.getNearest=function(p,v,D,x,A){if(p.left==null)return p.tdst=S.quantize.dist(p.est.q,v,D,x,A),p;var L=S.quantize.planeDst(p.est,v,D,x,A),w=p.left,b=p.right;L>0&&(w=p.right,b=p.left);var u=S.quantize.getNearest(w,v,D,x,A);if(u.tdst<=L*L)return u;var i=S.quantize.getNearest(b,v,D,x,A);return i.tdst<u.tdst?i:u},S.quantize.planeDst=function(p,v,D,x,A){var L=p.e;return L[0]*v+L[1]*D+L[2]*x+L[3]*A-p.eMq},S.quantize.dist=function(p,v,D,x,A){var L=v-p[0],w=D-p[1],b=x-p[2],u=A-p[3];return L*L+w*w+b*b+u*u},S.quantize.splitPixels=function(p,v,D,x,A,L){var w=S.quantize.vecDot;for(x-=4;D<x;){for(;w(p,D,A)<=L;)D+=4;for(;w(p,x,A)>L;)x-=4;if(D>=x)break;var b=v[D>>2];v[D>>2]=v[x>>2],v[x>>2]=b,D+=4,x-=4}for(;w(p,D,A)>L;)D-=4;return D+4},S.quantize.vecDot=function(p,v,D){return p[v]*D[0]+p[v+1]*D[1]+p[v+2]*D[2]+p[v+3]*D[3]},S.quantize.stats=function(p,v,D){for(var x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],L=D-v>>2,w=v;w<D;w+=4){var b=p[w]*.00392156862745098,u=p[w+1]*(1/255),i=p[w+2]*(1/255),s=p[w+3]*(1/255);A[0]+=b,A[1]+=u,A[2]+=i,A[3]+=s,x[0]+=b*b,x[1]+=b*u,x[2]+=b*i,x[3]+=b*s,x[5]+=u*u,x[6]+=u*i,x[7]+=u*s,x[10]+=i*i,x[11]+=i*s,x[15]+=s*s}return x[4]=x[1],x[8]=x[2],x[12]=x[3],x[9]=x[6],x[13]=x[7],x[14]=x[11],{R:x,m:A,N:L}},S.quantize.estats=function(p){var v=p.R,D=p.m,x=p.N,A=D[0],L=D[1],w=D[2],b=D[3],u=x==0?0:1/x,i=[v[0]-A*A*u,v[1]-A*L*u,v[2]-A*w*u,v[3]-A*b*u,v[4]-L*A*u,v[5]-L*L*u,v[6]-L*w*u,v[7]-L*b*u,v[8]-w*A*u,v[9]-w*L*u,v[10]-w*w*u,v[11]-w*b*u,v[12]-b*A*u,v[13]-b*L*u,v[14]-b*w*u,v[15]-b*b*u],s=i,h=S.M4,g=[.5,.5,.5,.5],y=0,E=0;if(x!=0)for(var l=0;l<10&&(g=h.multVec(s,g),E=Math.sqrt(h.dot(g,g)),g=h.sml(1/E,g),!(Math.abs(E-y)<1e-9));l++)y=E;var f=[A*u,L*u,w*u,b*u],m=h.dot(h.sml(255,f),g),C=f[3]<.001?0:1/f[3];return{Cov:i,q:f,e:g,L:y,eMq255:m,eMq:h.dot(g,f),rgba:(Math.round(255*f[3])<<24|Math.round(255*f[2]*C)<<16|Math.round(255*f[1]*C)<<8|Math.round(255*f[0]*C)<<0)>>>0}},S.M4={multVec:function(p,v){return[p[0]*v[0]+p[1]*v[1]+p[2]*v[2]+p[3]*v[3],p[4]*v[0]+p[5]*v[1]+p[6]*v[2]+p[7]*v[3],p[8]*v[0]+p[9]*v[1]+p[10]*v[2]+p[11]*v[3],p[12]*v[0]+p[13]*v[1]+p[14]*v[2]+p[15]*v[3]]},dot:function(p,v){return p[0]*v[0]+p[1]*v[1]+p[2]*v[2]+p[3]*v[3]},sml:function(p,v){return[p*v[0],p*v[1],p*v[2],p*v[3]]}},S.encode.alphaMul=function(p,v){for(var D=new Uint8Array(p.length),x=p.length>>2,A=0;A<x;A++){var L=A<<2,w=p[L+3];v&&(w=w<128?0:255);var b=w*(1/255);D[L+0]=p[L+0]*b,D[L+1]=p[L+1]*b,D[L+2]=p[L+2]*b,D[L+3]=w}return D}})(d,R)})()},"./node_modules/upng-js/node_modules/pako/index.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,R=n("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),S=n("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),j=n("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p={};d(p,R,S,j),o.exports=p},"./node_modules/upng-js/node_modules/pako/lib/deflate.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),R=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),S=n("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),j=n("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),p=n("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),v=Object.prototype.toString,D=0,x=4,A=0,L=1,w=2,b=-1,u=0,i=8;function s(E){if(!(this instanceof s))return new s(E);this.options=R.assign({level:b,method:i,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},E||{});var l=this.options;l.raw&&l.windowBits>0?l.windowBits=-l.windowBits:l.gzip&&l.windowBits>0&&l.windowBits<16&&(l.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var f=d.deflateInit2(this.strm,l.level,l.method,l.windowBits,l.memLevel,l.strategy);if(f!==A)throw new Error(j[f]);if(l.header&&d.deflateSetHeader(this.strm,l.header),l.dictionary){var m;if(typeof l.dictionary=="string"?m=S.string2buf(l.dictionary):v.call(l.dictionary)==="[object ArrayBuffer]"?m=new Uint8Array(l.dictionary):m=l.dictionary,f=d.deflateSetDictionary(this.strm,m),f!==A)throw new Error(j[f]);this._dict_set=!0}}s.prototype.push=function(E,l){var f=this.strm,m=this.options.chunkSize,C,T;if(this.ended)return!1;T=l===~~l?l:l===!0?x:D,typeof E=="string"?f.input=S.string2buf(E):v.call(E)==="[object ArrayBuffer]"?f.input=new Uint8Array(E):f.input=E,f.next_in=0,f.avail_in=f.input.length;do{if(f.avail_out===0&&(f.output=new R.Buf8(m),f.next_out=0,f.avail_out=m),C=d.deflate(f,T),C!==L&&C!==A)return this.onEnd(C),this.ended=!0,!1;(f.avail_out===0||f.avail_in===0&&(T===x||T===w))&&(this.options.to==="string"?this.onData(S.buf2binstring(R.shrinkBuf(f.output,f.next_out))):this.onData(R.shrinkBuf(f.output,f.next_out)))}while((f.avail_in>0||f.avail_out===0)&&C!==L);return T===x?(C=d.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===A):(T===w&&(this.onEnd(A),f.avail_out=0),!0)},s.prototype.onData=function(E){this.chunks.push(E)},s.prototype.onEnd=function(E){E===A&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=R.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg};function h(E,l){var f=new s(l);if(f.push(E,!0),f.err)throw f.msg||j[f.err];return f.result}function g(E,l){return l=l||{},l.raw=!0,h(E,l)}function y(E,l){return l=l||{},l.gzip=!0,h(E,l)}a.Deflate=s,a.deflate=h,a.deflateRaw=g,a.gzip=y},"./node_modules/upng-js/node_modules/pako/lib/inflate.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),R=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),S=n("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),j=n("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p=n("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),v=n("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),D=n("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),x=Object.prototype.toString;function A(b){if(!(this instanceof A))return new A(b);this.options=R.assign({chunkSize:16384,windowBits:0,to:""},b||{});var u=this.options;u.raw&&u.windowBits>=0&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),u.windowBits>=0&&u.windowBits<16&&!(b&&b.windowBits)&&(u.windowBits+=32),u.windowBits>15&&u.windowBits<48&&(u.windowBits&15)===0&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var i=d.inflateInit2(this.strm,u.windowBits);if(i!==j.Z_OK)throw new Error(p[i]);if(this.header=new D,d.inflateGetHeader(this.strm,this.header),u.dictionary&&(typeof u.dictionary=="string"?u.dictionary=S.string2buf(u.dictionary):x.call(u.dictionary)==="[object ArrayBuffer]"&&(u.dictionary=new Uint8Array(u.dictionary)),u.raw&&(i=d.inflateSetDictionary(this.strm,u.dictionary),i!==j.Z_OK)))throw new Error(p[i])}A.prototype.push=function(b,u){var i=this.strm,s=this.options.chunkSize,h=this.options.dictionary,g,y,E,l,f,m=!1;if(this.ended)return!1;y=u===~~u?u:u===!0?j.Z_FINISH:j.Z_NO_FLUSH,typeof b=="string"?i.input=S.binstring2buf(b):x.call(b)==="[object ArrayBuffer]"?i.input=new Uint8Array(b):i.input=b,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new R.Buf8(s),i.next_out=0,i.avail_out=s),g=d.inflate(i,j.Z_NO_FLUSH),g===j.Z_NEED_DICT&&h&&(g=d.inflateSetDictionary(this.strm,h)),g===j.Z_BUF_ERROR&&m===!0&&(g=j.Z_OK,m=!1),g!==j.Z_STREAM_END&&g!==j.Z_OK)return this.onEnd(g),this.ended=!0,!1;i.next_out&&(i.avail_out===0||g===j.Z_STREAM_END||i.avail_in===0&&(y===j.Z_FINISH||y===j.Z_SYNC_FLUSH))&&(this.options.to==="string"?(E=S.utf8border(i.output,i.next_out),l=i.next_out-E,f=S.buf2string(i.output,E),i.next_out=l,i.avail_out=s-l,l&&R.arraySet(i.output,i.output,E,l,0),this.onData(f)):this.onData(R.shrinkBuf(i.output,i.next_out))),i.avail_in===0&&i.avail_out===0&&(m=!0)}while((i.avail_in>0||i.avail_out===0)&&g!==j.Z_STREAM_END);return g===j.Z_STREAM_END&&(y=j.Z_FINISH),y===j.Z_FINISH?(g=d.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===j.Z_OK):(y===j.Z_SYNC_FLUSH&&(this.onEnd(j.Z_OK),i.avail_out=0),!0)},A.prototype.onData=function(b){this.chunks.push(b)},A.prototype.onEnd=function(b){b===j.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=R.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function L(b,u){var i=new A(u);if(i.push(b,!0),i.err)throw i.msg||p[i.err];return i.result}function w(b,u){return u=u||{},u.raw=!0,L(b,u)}a.Inflate=A,a.inflate=L,a.inflateRaw=w,a.ungzip=L},"./node_modules/upng-js/node_modules/pako/lib/utils/common.js"(o,a){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function d(j,p){return Object.prototype.hasOwnProperty.call(j,p)}a.assign=function(j){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var v=p.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var D in v)d(v,D)&&(j[D]=v[D])}}return j},a.shrinkBuf=function(j,p){return j.length===p?j:j.subarray?j.subarray(0,p):(j.length=p,j)};var R={arraySet:function(j,p,v,D,x){if(p.subarray&&j.subarray){j.set(p.subarray(v,v+D),x);return}for(var A=0;A<D;A++)j[x+A]=p[v+A]},flattenChunks:function(j){var p,v,D,x,A,L;for(D=0,p=0,v=j.length;p<v;p++)D+=j[p].length;for(L=new Uint8Array(D),x=0,p=0,v=j.length;p<v;p++)A=j[p],L.set(A,x),x+=A.length;return L}},S={arraySet:function(j,p,v,D,x){for(var A=0;A<D;A++)j[x+A]=p[v+A]},flattenChunks:function(j){return[].concat.apply([],j)}};a.setTyped=function(j){j?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,R)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,S))},a.setTyped(n)},"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),R=!0,S=!0;try{String.fromCharCode.apply(null,[0])}catch{R=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{S=!1}for(var j=new d.Buf8(256),p=0;p<256;p++)j[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;j[254]=j[254]=1,a.string2buf=function(D){var x,A,L,w,b,u=D.length,i=0;for(w=0;w<u;w++)A=D.charCodeAt(w),(A&64512)===55296&&w+1<u&&(L=D.charCodeAt(w+1),(L&64512)===56320&&(A=65536+(A-55296<<10)+(L-56320),w++)),i+=A<128?1:A<2048?2:A<65536?3:4;for(x=new d.Buf8(i),b=0,w=0;b<i;w++)A=D.charCodeAt(w),(A&64512)===55296&&w+1<u&&(L=D.charCodeAt(w+1),(L&64512)===56320&&(A=65536+(A-55296<<10)+(L-56320),w++)),A<128?x[b++]=A:A<2048?(x[b++]=192|A>>>6,x[b++]=128|A&63):A<65536?(x[b++]=224|A>>>12,x[b++]=128|A>>>6&63,x[b++]=128|A&63):(x[b++]=240|A>>>18,x[b++]=128|A>>>12&63,x[b++]=128|A>>>6&63,x[b++]=128|A&63);return x};function v(D,x){if(x<65534&&(D.subarray&&S||!D.subarray&&R))return String.fromCharCode.apply(null,d.shrinkBuf(D,x));for(var A="",L=0;L<x;L++)A+=String.fromCharCode(D[L]);return A}a.buf2binstring=function(D){return v(D,D.length)},a.binstring2buf=function(D){for(var x=new d.Buf8(D.length),A=0,L=x.length;A<L;A++)x[A]=D.charCodeAt(A);return x},a.buf2string=function(D,x){var A,L,w,b,u=x||D.length,i=new Array(u*2);for(L=0,A=0;A<u;){if(w=D[A++],w<128){i[L++]=w;continue}if(b=j[w],b>4){i[L++]=65533,A+=b-1;continue}for(w&=b===2?31:b===3?15:7;b>1&&A<u;)w=w<<6|D[A++]&63,b--;if(b>1){i[L++]=65533;continue}w<65536?i[L++]=w:(w-=65536,i[L++]=55296|w>>10&1023,i[L++]=56320|w&1023)}return v(i,L)},a.utf8border=function(D,x){var A;for(x=x||D.length,x>D.length&&(x=D.length),A=x-1;A>=0&&(D[A]&192)===128;)A--;return A<0||A===0?x:A+j[D[A]]>x?A:x}},"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"(o){function a(n,d,R,S){for(var j=n&65535|0,p=n>>>16&65535|0,v=0;R!==0;){v=R>2e3?2e3:R,R-=v;do j=j+d[S++]|0,p=p+j|0;while(--v);j%=65521,p%=65521}return j|p<<16|0}o.exports=a},"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"(o){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"(o){function a(){for(var R,S=[],j=0;j<256;j++){R=j;for(var p=0;p<8;p++)R=R&1?3988292384^R>>>1:R>>>1;S[j]=R}return S}var n=a();function d(R,S,j,p){var v=n,D=p+j;R^=-1;for(var x=p;x<D;x++)R=R>>>8^v[(R^S[x])&255];return R^-1}o.exports=d},"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),R=n("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),S=n("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),j=n("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),p=n("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),v=0,D=1,x=3,A=4,L=5,w=0,b=1,u=-2,i=-3,s=-5,h=-1,g=1,y=2,E=3,l=4,f=0,m=2,C=8,T=9,P=15,F=8,N=29,B=256,U=B+1+N,K=30,H=19,G=2*U+1,$=15,V=3,k=258,Y=k+V+1,ie=32,ne=42,he=69,le=73,xe=91,fe=103,pe=113,Te=666,ke=1,$e=2,Le=3,ue=4,Me=3;function Ge(z,be){return z.msg=p[be],be}function Je(z){return(z<<1)-(z>4?9:0)}function qe(z){for(var be=z.length;--be>=0;)z[be]=0}function tt(z){var be=z.state,_e=be.pending;_e>z.avail_out&&(_e=z.avail_out),_e!==0&&(d.arraySet(z.output,be.pending_buf,be.pending_out,_e,z.next_out),z.next_out+=_e,be.pending_out+=_e,z.total_out+=_e,z.avail_out-=_e,be.pending-=_e,be.pending===0&&(be.pending_out=0))}function Ze(z,be){R._tr_flush_block(z,z.block_start>=0?z.block_start:-1,z.strstart-z.block_start,be),z.block_start=z.strstart,tt(z.strm)}function Ve(z,be){z.pending_buf[z.pending++]=be}function Ye(z,be){z.pending_buf[z.pending++]=be>>>8&255,z.pending_buf[z.pending++]=be&255}function Ke(z,be,_e,ee){var me=z.avail_in;return me>ee&&(me=ee),me===0?0:(z.avail_in-=me,d.arraySet(be,z.input,z.next_in,me,_e),z.state.wrap===1?z.adler=S(z.adler,be,me,_e):z.state.wrap===2&&(z.adler=j(z.adler,be,me,_e)),z.next_in+=me,z.total_in+=me,me)}function We(z,be){var _e=z.max_chain_length,ee=z.strstart,me,Ae,ut=z.prev_length,ot=z.nice_match,rt=z.strstart>z.w_size-Y?z.strstart-(z.w_size-Y):0,yt=z.window,Xt=z.w_mask,bt=z.prev,xt=z.strstart+k,vt=yt[ee+ut-1],Pt=yt[ee+ut];z.prev_length>=z.good_match&&(_e>>=2),ot>z.lookahead&&(ot=z.lookahead);do if(me=be,!(yt[me+ut]!==Pt||yt[me+ut-1]!==vt||yt[me]!==yt[ee]||yt[++me]!==yt[ee+1])){ee+=2,me++;do;while(yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&yt[++ee]===yt[++me]&&ee<xt);if(Ae=k-(xt-ee),ee=xt-k,Ae>ut){if(z.match_start=be,ut=Ae,Ae>=ot)break;vt=yt[ee+ut-1],Pt=yt[ee+ut]}}while((be=bt[be&Xt])>rt&&--_e!==0);return ut<=z.lookahead?ut:z.lookahead}function nt(z){var be=z.w_size,_e,ee,me,Ae,ut;do{if(Ae=z.window_size-z.lookahead-z.strstart,z.strstart>=be+(be-Y)){d.arraySet(z.window,z.window,be,be,0),z.match_start-=be,z.strstart-=be,z.block_start-=be,ee=z.hash_size,_e=ee;do me=z.head[--_e],z.head[_e]=me>=be?me-be:0;while(--ee);ee=be,_e=ee;do me=z.prev[--_e],z.prev[_e]=me>=be?me-be:0;while(--ee);Ae+=be}if(z.strm.avail_in===0)break;if(ee=Ke(z.strm,z.window,z.strstart+z.lookahead,Ae),z.lookahead+=ee,z.lookahead+z.insert>=V)for(ut=z.strstart-z.insert,z.ins_h=z.window[ut],z.ins_h=(z.ins_h<<z.hash_shift^z.window[ut+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[ut+V-1])&z.hash_mask,z.prev[ut&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=ut,ut++,z.insert--,!(z.lookahead+z.insert<V)););}while(z.lookahead<Y&&z.strm.avail_in!==0)}function at(z,be){var _e=65535;for(_e>z.pending_buf_size-5&&(_e=z.pending_buf_size-5);;){if(z.lookahead<=1){if(nt(z),z.lookahead===0&&be===v)return ke;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var ee=z.block_start+_e;if((z.strstart===0||z.strstart>=ee)&&(z.lookahead=z.strstart-ee,z.strstart=ee,Ze(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-Y&&(Ze(z,!1),z.strm.avail_out===0))return ke}return z.insert=0,be===A?(Ze(z,!0),z.strm.avail_out===0?Le:ue):(z.strstart>z.block_start&&(Ze(z,!1),z.strm.avail_out===0),ke)}function q(z,be){for(var _e,ee;;){if(z.lookahead<Y){if(nt(z),z.lookahead<Y&&be===v)return ke;if(z.lookahead===0)break}if(_e=0,z.lookahead>=V&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+V-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),_e!==0&&z.strstart-_e<=z.w_size-Y&&(z.match_length=We(z,_e)),z.match_length>=V)if(ee=R._tr_tally(z,z.strstart-z.match_start,z.match_length-V),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=V){z.match_length--;do z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+V-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart;while(--z.match_length!==0);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else ee=R._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(ee&&(Ze(z,!1),z.strm.avail_out===0))return ke}return z.insert=z.strstart<V-1?z.strstart:V-1,be===A?(Ze(z,!0),z.strm.avail_out===0?Le:ue):z.last_lit&&(Ze(z,!1),z.strm.avail_out===0)?ke:$e}function re(z,be){for(var _e,ee,me;;){if(z.lookahead<Y){if(nt(z),z.lookahead<Y&&be===v)return ke;if(z.lookahead===0)break}if(_e=0,z.lookahead>=V&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+V-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=V-1,_e!==0&&z.prev_length<z.max_lazy_match&&z.strstart-_e<=z.w_size-Y&&(z.match_length=We(z,_e),z.match_length<=5&&(z.strategy===g||z.match_length===V&&z.strstart-z.match_start>4096)&&(z.match_length=V-1)),z.prev_length>=V&&z.match_length<=z.prev_length){me=z.strstart+z.lookahead-V,ee=R._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-V),z.lookahead-=z.prev_length-1,z.prev_length-=2;do++z.strstart<=me&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+V-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart);while(--z.prev_length!==0);if(z.match_available=0,z.match_length=V-1,z.strstart++,ee&&(Ze(z,!1),z.strm.avail_out===0))return ke}else if(z.match_available){if(ee=R._tr_tally(z,0,z.window[z.strstart-1]),ee&&Ze(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return ke}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(ee=R._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<V-1?z.strstart:V-1,be===A?(Ze(z,!0),z.strm.avail_out===0?Le:ue):z.last_lit&&(Ze(z,!1),z.strm.avail_out===0)?ke:$e}function se(z,be){for(var _e,ee,me,Ae,ut=z.window;;){if(z.lookahead<=k){if(nt(z),z.lookahead<=k&&be===v)return ke;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=V&&z.strstart>0&&(me=z.strstart-1,ee=ut[me],ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me])){Ae=z.strstart+k;do;while(ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me]&&ee===ut[++me]&&me<Ae);z.match_length=k-(Ae-me),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=V?(_e=R._tr_tally(z,1,z.match_length-V),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(_e=R._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),_e&&(Ze(z,!1),z.strm.avail_out===0))return ke}return z.insert=0,be===A?(Ze(z,!0),z.strm.avail_out===0?Le:ue):z.last_lit&&(Ze(z,!1),z.strm.avail_out===0)?ke:$e}function Se(z,be){for(var _e;;){if(z.lookahead===0&&(nt(z),z.lookahead===0)){if(be===v)return ke;break}if(z.match_length=0,_e=R._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,_e&&(Ze(z,!1),z.strm.avail_out===0))return ke}return z.insert=0,be===A?(Ze(z,!0),z.strm.avail_out===0?Le:ue):z.last_lit&&(Ze(z,!1),z.strm.avail_out===0)?ke:$e}function we(z,be,_e,ee,me){this.good_length=z,this.max_lazy=be,this.nice_length=_e,this.max_chain=ee,this.func=me}var ze;ze=[new we(0,0,0,0,at),new we(4,4,8,4,q),new we(4,5,16,8,q),new we(4,6,32,32,q),new we(4,4,16,16,re),new we(8,16,32,32,re),new we(8,16,128,128,re),new we(8,32,128,256,re),new we(32,128,258,1024,re),new we(32,258,258,4096,re)];function Be(z){z.window_size=2*z.w_size,qe(z.head),z.max_lazy_match=ze[z.level].max_lazy,z.good_match=ze[z.level].good_length,z.nice_match=ze[z.level].nice_length,z.max_chain_length=ze[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=V-1,z.match_available=0,z.ins_h=0}function Z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(G*2),this.dyn_dtree=new d.Buf16((2*K+1)*2),this.bl_tree=new d.Buf16((2*H+1)*2),qe(this.dyn_ltree),qe(this.dyn_dtree),qe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16($+1),this.heap=new d.Buf16(2*U+1),qe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*U+1),qe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ge(z){var be;return!z||!z.state?Ge(z,u):(z.total_in=z.total_out=0,z.data_type=m,be=z.state,be.pending=0,be.pending_out=0,be.wrap<0&&(be.wrap=-be.wrap),be.status=be.wrap?ne:pe,z.adler=be.wrap===2?0:1,be.last_flush=v,R._tr_init(be),w)}function Ce(z){var be=ge(z);return be===w&&Be(z.state),be}function Ue(z,be){return!z||!z.state||z.state.wrap!==2?u:(z.state.gzhead=be,w)}function ce(z,be,_e,ee,me,Ae){if(!z)return u;var ut=1;if(be===h&&(be=6),ee<0?(ut=0,ee=-ee):ee>15&&(ut=2,ee-=16),me<1||me>T||_e!==C||ee<8||ee>15||be<0||be>9||Ae<0||Ae>l)return Ge(z,u);ee===8&&(ee=9);var ot=new Z;return z.state=ot,ot.strm=z,ot.wrap=ut,ot.gzhead=null,ot.w_bits=ee,ot.w_size=1<<ot.w_bits,ot.w_mask=ot.w_size-1,ot.hash_bits=me+7,ot.hash_size=1<<ot.hash_bits,ot.hash_mask=ot.hash_size-1,ot.hash_shift=~~((ot.hash_bits+V-1)/V),ot.window=new d.Buf8(ot.w_size*2),ot.head=new d.Buf16(ot.hash_size),ot.prev=new d.Buf16(ot.w_size),ot.lit_bufsize=1<<me+6,ot.pending_buf_size=ot.lit_bufsize*4,ot.pending_buf=new d.Buf8(ot.pending_buf_size),ot.d_buf=1*ot.lit_bufsize,ot.l_buf=3*ot.lit_bufsize,ot.level=be,ot.strategy=Ae,ot.method=_e,Ce(z)}function Pe(z,be){return ce(z,be,C,P,F,f)}function Q(z,be){var _e,ee,me,Ae;if(!z||!z.state||be>L||be<0)return z?Ge(z,u):u;if(ee=z.state,!z.output||!z.input&&z.avail_in!==0||ee.status===Te&&be!==A)return Ge(z,z.avail_out===0?s:u);if(ee.strm=z,_e=ee.last_flush,ee.last_flush=be,ee.status===ne)if(ee.wrap===2)z.adler=0,Ve(ee,31),Ve(ee,139),Ve(ee,8),ee.gzhead?(Ve(ee,(ee.gzhead.text?1:0)+(ee.gzhead.hcrc?2:0)+(ee.gzhead.extra?4:0)+(ee.gzhead.name?8:0)+(ee.gzhead.comment?16:0)),Ve(ee,ee.gzhead.time&255),Ve(ee,ee.gzhead.time>>8&255),Ve(ee,ee.gzhead.time>>16&255),Ve(ee,ee.gzhead.time>>24&255),Ve(ee,ee.level===9?2:ee.strategy>=y||ee.level<2?4:0),Ve(ee,ee.gzhead.os&255),ee.gzhead.extra&&ee.gzhead.extra.length&&(Ve(ee,ee.gzhead.extra.length&255),Ve(ee,ee.gzhead.extra.length>>8&255)),ee.gzhead.hcrc&&(z.adler=j(z.adler,ee.pending_buf,ee.pending,0)),ee.gzindex=0,ee.status=he):(Ve(ee,0),Ve(ee,0),Ve(ee,0),Ve(ee,0),Ve(ee,0),Ve(ee,ee.level===9?2:ee.strategy>=y||ee.level<2?4:0),Ve(ee,Me),ee.status=pe);else{var ut=C+(ee.w_bits-8<<4)<<8,ot=-1;ee.strategy>=y||ee.level<2?ot=0:ee.level<6?ot=1:ee.level===6?ot=2:ot=3,ut|=ot<<6,ee.strstart!==0&&(ut|=ie),ut+=31-ut%31,ee.status=pe,Ye(ee,ut),ee.strstart!==0&&(Ye(ee,z.adler>>>16),Ye(ee,z.adler&65535)),z.adler=1}if(ee.status===he)if(ee.gzhead.extra){for(me=ee.pending;ee.gzindex<(ee.gzhead.extra.length&65535)&&!(ee.pending===ee.pending_buf_size&&(ee.gzhead.hcrc&&ee.pending>me&&(z.adler=j(z.adler,ee.pending_buf,ee.pending-me,me)),tt(z),me=ee.pending,ee.pending===ee.pending_buf_size));)Ve(ee,ee.gzhead.extra[ee.gzindex]&255),ee.gzindex++;ee.gzhead.hcrc&&ee.pending>me&&(z.adler=j(z.adler,ee.pending_buf,ee.pending-me,me)),ee.gzindex===ee.gzhead.extra.length&&(ee.gzindex=0,ee.status=le)}else ee.status=le;if(ee.status===le)if(ee.gzhead.name){me=ee.pending;do{if(ee.pending===ee.pending_buf_size&&(ee.gzhead.hcrc&&ee.pending>me&&(z.adler=j(z.adler,ee.pending_buf,ee.pending-me,me)),tt(z),me=ee.pending,ee.pending===ee.pending_buf_size)){Ae=1;break}ee.gzindex<ee.gzhead.name.length?Ae=ee.gzhead.name.charCodeAt(ee.gzindex++)&255:Ae=0,Ve(ee,Ae)}while(Ae!==0);ee.gzhead.hcrc&&ee.pending>me&&(z.adler=j(z.adler,ee.pending_buf,ee.pending-me,me)),Ae===0&&(ee.gzindex=0,ee.status=xe)}else ee.status=xe;if(ee.status===xe)if(ee.gzhead.comment){me=ee.pending;do{if(ee.pending===ee.pending_buf_size&&(ee.gzhead.hcrc&&ee.pending>me&&(z.adler=j(z.adler,ee.pending_buf,ee.pending-me,me)),tt(z),me=ee.pending,ee.pending===ee.pending_buf_size)){Ae=1;break}ee.gzindex<ee.gzhead.comment.length?Ae=ee.gzhead.comment.charCodeAt(ee.gzindex++)&255:Ae=0,Ve(ee,Ae)}while(Ae!==0);ee.gzhead.hcrc&&ee.pending>me&&(z.adler=j(z.adler,ee.pending_buf,ee.pending-me,me)),Ae===0&&(ee.status=fe)}else ee.status=fe;if(ee.status===fe&&(ee.gzhead.hcrc?(ee.pending+2>ee.pending_buf_size&&tt(z),ee.pending+2<=ee.pending_buf_size&&(Ve(ee,z.adler&255),Ve(ee,z.adler>>8&255),z.adler=0,ee.status=pe)):ee.status=pe),ee.pending!==0){if(tt(z),z.avail_out===0)return ee.last_flush=-1,w}else if(z.avail_in===0&&Je(be)<=Je(_e)&&be!==A)return Ge(z,s);if(ee.status===Te&&z.avail_in!==0)return Ge(z,s);if(z.avail_in!==0||ee.lookahead!==0||be!==v&&ee.status!==Te){var rt=ee.strategy===y?Se(ee,be):ee.strategy===E?se(ee,be):ze[ee.level].func(ee,be);if((rt===Le||rt===ue)&&(ee.status=Te),rt===ke||rt===Le)return z.avail_out===0&&(ee.last_flush=-1),w;if(rt===$e&&(be===D?R._tr_align(ee):be!==L&&(R._tr_stored_block(ee,0,0,!1),be===x&&(qe(ee.head),ee.lookahead===0&&(ee.strstart=0,ee.block_start=0,ee.insert=0))),tt(z),z.avail_out===0))return ee.last_flush=-1,w}return be!==A?w:ee.wrap<=0?b:(ee.wrap===2?(Ve(ee,z.adler&255),Ve(ee,z.adler>>8&255),Ve(ee,z.adler>>16&255),Ve(ee,z.adler>>24&255),Ve(ee,z.total_in&255),Ve(ee,z.total_in>>8&255),Ve(ee,z.total_in>>16&255),Ve(ee,z.total_in>>24&255)):(Ye(ee,z.adler>>>16),Ye(ee,z.adler&65535)),tt(z),ee.wrap>0&&(ee.wrap=-ee.wrap),ee.pending!==0?w:b)}function Ne(z){var be;return!z||!z.state?u:(be=z.state.status,be!==ne&&be!==he&&be!==le&&be!==xe&&be!==fe&&be!==pe&&be!==Te?Ge(z,u):(z.state=null,be===pe?Ge(z,i):w))}function He(z,be){var _e=be.length,ee,me,Ae,ut,ot,rt,yt,Xt;if(!z||!z.state||(ee=z.state,ut=ee.wrap,ut===2||ut===1&&ee.status!==ne||ee.lookahead))return u;for(ut===1&&(z.adler=S(z.adler,be,_e,0)),ee.wrap=0,_e>=ee.w_size&&(ut===0&&(qe(ee.head),ee.strstart=0,ee.block_start=0,ee.insert=0),Xt=new d.Buf8(ee.w_size),d.arraySet(Xt,be,_e-ee.w_size,ee.w_size,0),be=Xt,_e=ee.w_size),ot=z.avail_in,rt=z.next_in,yt=z.input,z.avail_in=_e,z.next_in=0,z.input=be,nt(ee);ee.lookahead>=V;){me=ee.strstart,Ae=ee.lookahead-(V-1);do ee.ins_h=(ee.ins_h<<ee.hash_shift^ee.window[me+V-1])&ee.hash_mask,ee.prev[me&ee.w_mask]=ee.head[ee.ins_h],ee.head[ee.ins_h]=me,me++;while(--Ae);ee.strstart=me,ee.lookahead=V-1,nt(ee)}return ee.strstart+=ee.lookahead,ee.block_start=ee.strstart,ee.insert=ee.lookahead,ee.lookahead=0,ee.match_length=ee.prev_length=V-1,ee.match_available=0,z.next_in=rt,z.input=yt,z.avail_in=ot,ee.wrap=ut,w}a.deflateInit=Pe,a.deflateInit2=ce,a.deflateReset=Ce,a.deflateResetKeep=ge,a.deflateSetHeader=Ue,a.deflate=Q,a.deflateEnd=Ne,a.deflateSetDictionary=He,a.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"(o){function a(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}o.exports=a},"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"(o){var a=30,n=12;o.exports=function(R,S){var j,p,v,D,x,A,L,w,b,u,i,s,h,g,y,E,l,f,m,C,T,P,F,N,B;j=R.state,p=R.next_in,N=R.input,v=p+(R.avail_in-5),D=R.next_out,B=R.output,x=D-(S-R.avail_out),A=D+(R.avail_out-257),L=j.dmax,w=j.wsize,b=j.whave,u=j.wnext,i=j.window,s=j.hold,h=j.bits,g=j.lencode,y=j.distcode,E=(1<<j.lenbits)-1,l=(1<<j.distbits)-1;e:do{h<15&&(s+=N[p++]<<h,h+=8,s+=N[p++]<<h,h+=8),f=g[s&E];t:for(;;){if(m=f>>>24,s>>>=m,h-=m,m=f>>>16&255,m===0)B[D++]=f&65535;else if(m&16){C=f&65535,m&=15,m&&(h<m&&(s+=N[p++]<<h,h+=8),C+=s&(1<<m)-1,s>>>=m,h-=m),h<15&&(s+=N[p++]<<h,h+=8,s+=N[p++]<<h,h+=8),f=y[s&l];r:for(;;){if(m=f>>>24,s>>>=m,h-=m,m=f>>>16&255,m&16){if(T=f&65535,m&=15,h<m&&(s+=N[p++]<<h,h+=8,h<m&&(s+=N[p++]<<h,h+=8)),T+=s&(1<<m)-1,T>L){R.msg="invalid distance too far back",j.mode=a;break e}if(s>>>=m,h-=m,m=D-x,T>m){if(m=T-m,m>b&&j.sane){R.msg="invalid distance too far back",j.mode=a;break e}if(P=0,F=i,u===0){if(P+=w-m,m<C){C-=m;do B[D++]=i[P++];while(--m);P=D-T,F=B}}else if(u<m){if(P+=w+u-m,m-=u,m<C){C-=m;do B[D++]=i[P++];while(--m);if(P=0,u<C){m=u,C-=m;do B[D++]=i[P++];while(--m);P=D-T,F=B}}}else if(P+=u-m,m<C){C-=m;do B[D++]=i[P++];while(--m);P=D-T,F=B}for(;C>2;)B[D++]=F[P++],B[D++]=F[P++],B[D++]=F[P++],C-=3;C&&(B[D++]=F[P++],C>1&&(B[D++]=F[P++]))}else{P=D-T;do B[D++]=B[P++],B[D++]=B[P++],B[D++]=B[P++],C-=3;while(C>2);C&&(B[D++]=B[P++],C>1&&(B[D++]=B[P++]))}}else if((m&64)===0){f=y[(f&65535)+(s&(1<<m)-1)];continue r}else{R.msg="invalid distance code",j.mode=a;break e}break}}else if((m&64)===0){f=g[(f&65535)+(s&(1<<m)-1)];continue t}else if(m&32){j.mode=n;break e}else{R.msg="invalid literal/length code",j.mode=a;break e}break}}while(p<v&&D<A);C=h>>3,p-=C,h-=C<<3,s&=(1<<h)-1,R.next_in=p,R.next_out=D,R.avail_in=p<v?5+(v-p):5-(p-v),R.avail_out=D<A?257+(A-D):257-(D-A),j.hold=s,j.bits=h}},"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),R=n("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),S=n("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),j=n("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),p=n("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),v=0,D=1,x=2,A=4,L=5,w=6,b=0,u=1,i=2,s=-2,h=-3,g=-4,y=-5,E=8,l=1,f=2,m=3,C=4,T=5,P=6,F=7,N=8,B=9,U=10,K=11,H=12,G=13,$=14,V=15,k=16,Y=17,ie=18,ne=19,he=20,le=21,xe=22,fe=23,pe=24,Te=25,ke=26,$e=27,Le=28,ue=29,Me=30,Ge=31,Je=32,qe=852,tt=592,Ze=15,Ve=Ze;function Ye(ce){return(ce>>>24&255)+(ce>>>8&65280)+((ce&65280)<<8)+((ce&255)<<24)}function Ke(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function We(ce){var Pe;return!ce||!ce.state?s:(Pe=ce.state,ce.total_in=ce.total_out=Pe.total=0,ce.msg="",Pe.wrap&&(ce.adler=Pe.wrap&1),Pe.mode=l,Pe.last=0,Pe.havedict=0,Pe.dmax=32768,Pe.head=null,Pe.hold=0,Pe.bits=0,Pe.lencode=Pe.lendyn=new d.Buf32(qe),Pe.distcode=Pe.distdyn=new d.Buf32(tt),Pe.sane=1,Pe.back=-1,b)}function nt(ce){var Pe;return!ce||!ce.state?s:(Pe=ce.state,Pe.wsize=0,Pe.whave=0,Pe.wnext=0,We(ce))}function at(ce,Pe){var Q,Ne;return!ce||!ce.state||(Ne=ce.state,Pe<0?(Q=0,Pe=-Pe):(Q=(Pe>>4)+1,Pe<48&&(Pe&=15)),Pe&&(Pe<8||Pe>15))?s:(Ne.window!==null&&Ne.wbits!==Pe&&(Ne.window=null),Ne.wrap=Q,Ne.wbits=Pe,nt(ce))}function q(ce,Pe){var Q,Ne;return ce?(Ne=new Ke,ce.state=Ne,Ne.window=null,Q=at(ce,Pe),Q!==b&&(ce.state=null),Q):s}function re(ce){return q(ce,Ve)}var se=!0,Se,we;function ze(ce){if(se){var Pe;for(Se=new d.Buf32(512),we=new d.Buf32(32),Pe=0;Pe<144;)ce.lens[Pe++]=8;for(;Pe<256;)ce.lens[Pe++]=9;for(;Pe<280;)ce.lens[Pe++]=7;for(;Pe<288;)ce.lens[Pe++]=8;for(p(D,ce.lens,0,288,Se,0,ce.work,{bits:9}),Pe=0;Pe<32;)ce.lens[Pe++]=5;p(x,ce.lens,0,32,we,0,ce.work,{bits:5}),se=!1}ce.lencode=Se,ce.lenbits=9,ce.distcode=we,ce.distbits=5}function Be(ce,Pe,Q,Ne){var He,z=ce.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new d.Buf8(z.wsize)),Ne>=z.wsize?(d.arraySet(z.window,Pe,Q-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(He=z.wsize-z.wnext,He>Ne&&(He=Ne),d.arraySet(z.window,Pe,Q-Ne,He,z.wnext),Ne-=He,Ne?(d.arraySet(z.window,Pe,Q-Ne,Ne,0),z.wnext=Ne,z.whave=z.wsize):(z.wnext+=He,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=He))),0}function Z(ce,Pe){var Q,Ne,He,z,be,_e,ee,me,Ae,ut,ot,rt,yt,Xt,bt=0,xt,vt,Pt,Dt,ir,Vt,Rt,At,St=new d.Buf8(4),Ht,Yt,rr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ce||!ce.state||!ce.output||!ce.input&&ce.avail_in!==0)return s;Q=ce.state,Q.mode===H&&(Q.mode=G),be=ce.next_out,He=ce.output,ee=ce.avail_out,z=ce.next_in,Ne=ce.input,_e=ce.avail_in,me=Q.hold,Ae=Q.bits,ut=_e,ot=ee,At=b;e:for(;;)switch(Q.mode){case l:if(Q.wrap===0){Q.mode=G;break}for(;Ae<16;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(Q.wrap&2&&me===35615){Q.check=0,St[0]=me&255,St[1]=me>>>8&255,Q.check=S(Q.check,St,2,0),me=0,Ae=0,Q.mode=f;break}if(Q.flags=0,Q.head&&(Q.head.done=!1),!(Q.wrap&1)||(((me&255)<<8)+(me>>8))%31){ce.msg="incorrect header check",Q.mode=Me;break}if((me&15)!==E){ce.msg="unknown compression method",Q.mode=Me;break}if(me>>>=4,Ae-=4,Rt=(me&15)+8,Q.wbits===0)Q.wbits=Rt;else if(Rt>Q.wbits){ce.msg="invalid window size",Q.mode=Me;break}Q.dmax=1<<Rt,ce.adler=Q.check=1,Q.mode=me&512?U:H,me=0,Ae=0;break;case f:for(;Ae<16;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(Q.flags=me,(Q.flags&255)!==E){ce.msg="unknown compression method",Q.mode=Me;break}if(Q.flags&57344){ce.msg="unknown header flags set",Q.mode=Me;break}Q.head&&(Q.head.text=me>>8&1),Q.flags&512&&(St[0]=me&255,St[1]=me>>>8&255,Q.check=S(Q.check,St,2,0)),me=0,Ae=0,Q.mode=m;case m:for(;Ae<32;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}Q.head&&(Q.head.time=me),Q.flags&512&&(St[0]=me&255,St[1]=me>>>8&255,St[2]=me>>>16&255,St[3]=me>>>24&255,Q.check=S(Q.check,St,4,0)),me=0,Ae=0,Q.mode=C;case C:for(;Ae<16;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}Q.head&&(Q.head.xflags=me&255,Q.head.os=me>>8),Q.flags&512&&(St[0]=me&255,St[1]=me>>>8&255,Q.check=S(Q.check,St,2,0)),me=0,Ae=0,Q.mode=T;case T:if(Q.flags&1024){for(;Ae<16;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}Q.length=me,Q.head&&(Q.head.extra_len=me),Q.flags&512&&(St[0]=me&255,St[1]=me>>>8&255,Q.check=S(Q.check,St,2,0)),me=0,Ae=0}else Q.head&&(Q.head.extra=null);Q.mode=P;case P:if(Q.flags&1024&&(rt=Q.length,rt>_e&&(rt=_e),rt&&(Q.head&&(Rt=Q.head.extra_len-Q.length,Q.head.extra||(Q.head.extra=new Array(Q.head.extra_len)),d.arraySet(Q.head.extra,Ne,z,rt,Rt)),Q.flags&512&&(Q.check=S(Q.check,Ne,rt,z)),_e-=rt,z+=rt,Q.length-=rt),Q.length))break e;Q.length=0,Q.mode=F;case F:if(Q.flags&2048){if(_e===0)break e;rt=0;do Rt=Ne[z+rt++],Q.head&&Rt&&Q.length<65536&&(Q.head.name+=String.fromCharCode(Rt));while(Rt&&rt<_e);if(Q.flags&512&&(Q.check=S(Q.check,Ne,rt,z)),_e-=rt,z+=rt,Rt)break e}else Q.head&&(Q.head.name=null);Q.length=0,Q.mode=N;case N:if(Q.flags&4096){if(_e===0)break e;rt=0;do Rt=Ne[z+rt++],Q.head&&Rt&&Q.length<65536&&(Q.head.comment+=String.fromCharCode(Rt));while(Rt&&rt<_e);if(Q.flags&512&&(Q.check=S(Q.check,Ne,rt,z)),_e-=rt,z+=rt,Rt)break e}else Q.head&&(Q.head.comment=null);Q.mode=B;case B:if(Q.flags&512){for(;Ae<16;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(me!==(Q.check&65535)){ce.msg="header crc mismatch",Q.mode=Me;break}me=0,Ae=0}Q.head&&(Q.head.hcrc=Q.flags>>9&1,Q.head.done=!0),ce.adler=Q.check=0,Q.mode=H;break;case U:for(;Ae<32;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}ce.adler=Q.check=Ye(me),me=0,Ae=0,Q.mode=K;case K:if(Q.havedict===0)return ce.next_out=be,ce.avail_out=ee,ce.next_in=z,ce.avail_in=_e,Q.hold=me,Q.bits=Ae,i;ce.adler=Q.check=1,Q.mode=H;case H:if(Pe===L||Pe===w)break e;case G:if(Q.last){me>>>=Ae&7,Ae-=Ae&7,Q.mode=$e;break}for(;Ae<3;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}switch(Q.last=me&1,me>>>=1,Ae-=1,me&3){case 0:Q.mode=$;break;case 1:if(ze(Q),Q.mode=he,Pe===w){me>>>=2,Ae-=2;break e}break;case 2:Q.mode=Y;break;case 3:ce.msg="invalid block type",Q.mode=Me}me>>>=2,Ae-=2;break;case $:for(me>>>=Ae&7,Ae-=Ae&7;Ae<32;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if((me&65535)!==(me>>>16^65535)){ce.msg="invalid stored block lengths",Q.mode=Me;break}if(Q.length=me&65535,me=0,Ae=0,Q.mode=V,Pe===w)break e;case V:Q.mode=k;case k:if(rt=Q.length,rt){if(rt>_e&&(rt=_e),rt>ee&&(rt=ee),rt===0)break e;d.arraySet(He,Ne,z,rt,be),_e-=rt,z+=rt,ee-=rt,be+=rt,Q.length-=rt;break}Q.mode=H;break;case Y:for(;Ae<14;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(Q.nlen=(me&31)+257,me>>>=5,Ae-=5,Q.ndist=(me&31)+1,me>>>=5,Ae-=5,Q.ncode=(me&15)+4,me>>>=4,Ae-=4,Q.nlen>286||Q.ndist>30){ce.msg="too many length or distance symbols",Q.mode=Me;break}Q.have=0,Q.mode=ie;case ie:for(;Q.have<Q.ncode;){for(;Ae<3;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}Q.lens[rr[Q.have++]]=me&7,me>>>=3,Ae-=3}for(;Q.have<19;)Q.lens[rr[Q.have++]]=0;if(Q.lencode=Q.lendyn,Q.lenbits=7,Ht={bits:Q.lenbits},At=p(v,Q.lens,0,19,Q.lencode,0,Q.work,Ht),Q.lenbits=Ht.bits,At){ce.msg="invalid code lengths set",Q.mode=Me;break}Q.have=0,Q.mode=ne;case ne:for(;Q.have<Q.nlen+Q.ndist;){for(;bt=Q.lencode[me&(1<<Q.lenbits)-1],xt=bt>>>24,vt=bt>>>16&255,Pt=bt&65535,!(xt<=Ae);){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(Pt<16)me>>>=xt,Ae-=xt,Q.lens[Q.have++]=Pt;else{if(Pt===16){for(Yt=xt+2;Ae<Yt;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(me>>>=xt,Ae-=xt,Q.have===0){ce.msg="invalid bit length repeat",Q.mode=Me;break}Rt=Q.lens[Q.have-1],rt=3+(me&3),me>>>=2,Ae-=2}else if(Pt===17){for(Yt=xt+3;Ae<Yt;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}me>>>=xt,Ae-=xt,Rt=0,rt=3+(me&7),me>>>=3,Ae-=3}else{for(Yt=xt+7;Ae<Yt;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}me>>>=xt,Ae-=xt,Rt=0,rt=11+(me&127),me>>>=7,Ae-=7}if(Q.have+rt>Q.nlen+Q.ndist){ce.msg="invalid bit length repeat",Q.mode=Me;break}for(;rt--;)Q.lens[Q.have++]=Rt}}if(Q.mode===Me)break;if(Q.lens[256]===0){ce.msg="invalid code -- missing end-of-block",Q.mode=Me;break}if(Q.lenbits=9,Ht={bits:Q.lenbits},At=p(D,Q.lens,0,Q.nlen,Q.lencode,0,Q.work,Ht),Q.lenbits=Ht.bits,At){ce.msg="invalid literal/lengths set",Q.mode=Me;break}if(Q.distbits=6,Q.distcode=Q.distdyn,Ht={bits:Q.distbits},At=p(x,Q.lens,Q.nlen,Q.ndist,Q.distcode,0,Q.work,Ht),Q.distbits=Ht.bits,At){ce.msg="invalid distances set",Q.mode=Me;break}if(Q.mode=he,Pe===w)break e;case he:Q.mode=le;case le:if(_e>=6&&ee>=258){ce.next_out=be,ce.avail_out=ee,ce.next_in=z,ce.avail_in=_e,Q.hold=me,Q.bits=Ae,j(ce,ot),be=ce.next_out,He=ce.output,ee=ce.avail_out,z=ce.next_in,Ne=ce.input,_e=ce.avail_in,me=Q.hold,Ae=Q.bits,Q.mode===H&&(Q.back=-1);break}for(Q.back=0;bt=Q.lencode[me&(1<<Q.lenbits)-1],xt=bt>>>24,vt=bt>>>16&255,Pt=bt&65535,!(xt<=Ae);){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(vt&&(vt&240)===0){for(Dt=xt,ir=vt,Vt=Pt;bt=Q.lencode[Vt+((me&(1<<Dt+ir)-1)>>Dt)],xt=bt>>>24,vt=bt>>>16&255,Pt=bt&65535,!(Dt+xt<=Ae);){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}me>>>=Dt,Ae-=Dt,Q.back+=Dt}if(me>>>=xt,Ae-=xt,Q.back+=xt,Q.length=Pt,vt===0){Q.mode=ke;break}if(vt&32){Q.back=-1,Q.mode=H;break}if(vt&64){ce.msg="invalid literal/length code",Q.mode=Me;break}Q.extra=vt&15,Q.mode=xe;case xe:if(Q.extra){for(Yt=Q.extra;Ae<Yt;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}Q.length+=me&(1<<Q.extra)-1,me>>>=Q.extra,Ae-=Q.extra,Q.back+=Q.extra}Q.was=Q.length,Q.mode=fe;case fe:for(;bt=Q.distcode[me&(1<<Q.distbits)-1],xt=bt>>>24,vt=bt>>>16&255,Pt=bt&65535,!(xt<=Ae);){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if((vt&240)===0){for(Dt=xt,ir=vt,Vt=Pt;bt=Q.distcode[Vt+((me&(1<<Dt+ir)-1)>>Dt)],xt=bt>>>24,vt=bt>>>16&255,Pt=bt&65535,!(Dt+xt<=Ae);){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}me>>>=Dt,Ae-=Dt,Q.back+=Dt}if(me>>>=xt,Ae-=xt,Q.back+=xt,vt&64){ce.msg="invalid distance code",Q.mode=Me;break}Q.offset=Pt,Q.extra=vt&15,Q.mode=pe;case pe:if(Q.extra){for(Yt=Q.extra;Ae<Yt;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}Q.offset+=me&(1<<Q.extra)-1,me>>>=Q.extra,Ae-=Q.extra,Q.back+=Q.extra}if(Q.offset>Q.dmax){ce.msg="invalid distance too far back",Q.mode=Me;break}Q.mode=Te;case Te:if(ee===0)break e;if(rt=ot-ee,Q.offset>rt){if(rt=Q.offset-rt,rt>Q.whave&&Q.sane){ce.msg="invalid distance too far back",Q.mode=Me;break}rt>Q.wnext?(rt-=Q.wnext,yt=Q.wsize-rt):yt=Q.wnext-rt,rt>Q.length&&(rt=Q.length),Xt=Q.window}else Xt=He,yt=be-Q.offset,rt=Q.length;rt>ee&&(rt=ee),ee-=rt,Q.length-=rt;do He[be++]=Xt[yt++];while(--rt);Q.length===0&&(Q.mode=le);break;case ke:if(ee===0)break e;He[be++]=Q.length,ee--,Q.mode=le;break;case $e:if(Q.wrap){for(;Ae<32;){if(_e===0)break e;_e--,me|=Ne[z++]<<Ae,Ae+=8}if(ot-=ee,ce.total_out+=ot,Q.total+=ot,ot&&(ce.adler=Q.check=Q.flags?S(Q.check,He,ot,be-ot):R(Q.check,He,ot,be-ot)),ot=ee,(Q.flags?me:Ye(me))!==Q.check){ce.msg="incorrect data check",Q.mode=Me;break}me=0,Ae=0}Q.mode=Le;case Le:if(Q.wrap&&Q.flags){for(;Ae<32;){if(_e===0)break e;_e--,me+=Ne[z++]<<Ae,Ae+=8}if(me!==(Q.total&4294967295)){ce.msg="incorrect length check",Q.mode=Me;break}me=0,Ae=0}Q.mode=ue;case ue:At=u;break e;case Me:At=h;break e;case Ge:return g;case Je:default:return s}return ce.next_out=be,ce.avail_out=ee,ce.next_in=z,ce.avail_in=_e,Q.hold=me,Q.bits=Ae,(Q.wsize||ot!==ce.avail_out&&Q.mode<Me&&(Q.mode<$e||Pe!==A))&&Be(ce,ce.output,ce.next_out,ot-ce.avail_out),ut-=ce.avail_in,ot-=ce.avail_out,ce.total_in+=ut,ce.total_out+=ot,Q.total+=ot,Q.wrap&&ot&&(ce.adler=Q.check=Q.flags?S(Q.check,He,ot,ce.next_out-ot):R(Q.check,He,ot,ce.next_out-ot)),ce.data_type=Q.bits+(Q.last?64:0)+(Q.mode===H?128:0)+(Q.mode===he||Q.mode===V?256:0),(ut===0&&ot===0||Pe===A)&&At===b&&(At=y),At}function ge(ce){if(!ce||!ce.state)return s;var Pe=ce.state;return Pe.window&&(Pe.window=null),ce.state=null,b}function Ce(ce,Pe){var Q;return!ce||!ce.state||(Q=ce.state,(Q.wrap&2)===0)?s:(Q.head=Pe,Pe.done=!1,b)}function Ue(ce,Pe){var Q=Pe.length,Ne,He,z;return!ce||!ce.state||(Ne=ce.state,Ne.wrap!==0&&Ne.mode!==K)?s:Ne.mode===K&&(He=1,He=R(He,Pe,Q,0),He!==Ne.check)?h:(z=Be(ce,Pe,Q,Q),z?(Ne.mode=Ge,g):(Ne.havedict=1,b))}a.inflateReset=nt,a.inflateReset2=at,a.inflateResetKeep=We,a.inflateInit=re,a.inflateInit2=q,a.inflate=Z,a.inflateEnd=ge,a.inflateGetHeader=Ce,a.inflateSetDictionary=Ue,a.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),R=15,S=852,j=592,p=0,v=1,D=2,x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],A=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(u,i,s,h,g,y,E,l){var f=l.bits,m=0,C=0,T=0,P=0,F=0,N=0,B=0,U=0,K=0,H=0,G,$,V,k,Y,ie=null,ne=0,he,le=new d.Buf16(R+1),xe=new d.Buf16(R+1),fe=null,pe=0,Te,ke,$e;for(m=0;m<=R;m++)le[m]=0;for(C=0;C<h;C++)le[i[s+C]]++;for(F=f,P=R;P>=1&&le[P]===0;P--);if(F>P&&(F=P),P===0)return g[y++]=20971520,g[y++]=20971520,l.bits=1,0;for(T=1;T<P&&le[T]===0;T++);for(F<T&&(F=T),U=1,m=1;m<=R;m++)if(U<<=1,U-=le[m],U<0)return-1;if(U>0&&(u===p||P!==1))return-1;for(xe[1]=0,m=1;m<R;m++)xe[m+1]=xe[m]+le[m];for(C=0;C<h;C++)i[s+C]!==0&&(E[xe[i[s+C]]++]=C);if(u===p?(ie=fe=E,he=19):u===v?(ie=x,ne-=257,fe=A,pe-=257,he=256):(ie=L,fe=w,he=-1),H=0,C=0,m=T,Y=y,N=F,B=0,V=-1,K=1<<F,k=K-1,u===v&&K>S||u===D&&K>j)return 1;for(;;){Te=m-B,E[C]<he?(ke=0,$e=E[C]):E[C]>he?(ke=fe[pe+E[C]],$e=ie[ne+E[C]]):(ke=96,$e=0),G=1<<m-B,$=1<<N,T=$;do $-=G,g[Y+(H>>B)+$]=Te<<24|ke<<16|$e|0;while($!==0);for(G=1<<m-1;H&G;)G>>=1;if(G!==0?(H&=G-1,H+=G):H=0,C++,--le[m]===0){if(m===P)break;m=i[s+E[C]]}if(m>F&&(H&k)!==V){for(B===0&&(B=F),Y+=T,N=m-B,U=1<<N;N+B<P&&(U-=le[N+B],!(U<=0));)N++,U<<=1;if(K+=1<<N,u===v&&K>S||u===D&&K>j)return 1;V=H&k,g[V]=F<<24|N<<16|Y-y|0}}return H!==0&&(g[Y+H]=m-B<<24|4194304|0),l.bits=F,0}},"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"(o){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"(o,a,n){var d=n("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),R=4,S=0,j=1,p=2;function v(Z){for(var ge=Z.length;--ge>=0;)Z[ge]=0}var D=0,x=1,A=2,L=3,w=258,b=29,u=256,i=u+1+b,s=30,h=19,g=2*i+1,y=15,E=16,l=7,f=256,m=16,C=17,T=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=512,K=new Array((i+2)*2);v(K);var H=new Array(s*2);v(H);var G=new Array(U);v(G);var $=new Array(w-L+1);v($);var V=new Array(b);v(V);var k=new Array(s);v(k);function Y(Z,ge,Ce,Ue,ce){this.static_tree=Z,this.extra_bits=ge,this.extra_base=Ce,this.elems=Ue,this.max_length=ce,this.has_stree=Z&&Z.length}var ie,ne,he;function le(Z,ge){this.dyn_tree=Z,this.max_code=0,this.stat_desc=ge}function xe(Z){return Z<256?G[Z]:G[256+(Z>>>7)]}function fe(Z,ge){Z.pending_buf[Z.pending++]=ge&255,Z.pending_buf[Z.pending++]=ge>>>8&255}function pe(Z,ge,Ce){Z.bi_valid>E-Ce?(Z.bi_buf|=ge<<Z.bi_valid&65535,fe(Z,Z.bi_buf),Z.bi_buf=ge>>E-Z.bi_valid,Z.bi_valid+=Ce-E):(Z.bi_buf|=ge<<Z.bi_valid&65535,Z.bi_valid+=Ce)}function Te(Z,ge,Ce){pe(Z,Ce[ge*2],Ce[ge*2+1])}function ke(Z,ge){var Ce=0;do Ce|=Z&1,Z>>>=1,Ce<<=1;while(--ge>0);return Ce>>>1}function $e(Z){Z.bi_valid===16?(fe(Z,Z.bi_buf),Z.bi_buf=0,Z.bi_valid=0):Z.bi_valid>=8&&(Z.pending_buf[Z.pending++]=Z.bi_buf&255,Z.bi_buf>>=8,Z.bi_valid-=8)}function Le(Z,ge){var Ce=ge.dyn_tree,Ue=ge.max_code,ce=ge.stat_desc.static_tree,Pe=ge.stat_desc.has_stree,Q=ge.stat_desc.extra_bits,Ne=ge.stat_desc.extra_base,He=ge.stat_desc.max_length,z,be,_e,ee,me,Ae,ut=0;for(ee=0;ee<=y;ee++)Z.bl_count[ee]=0;for(Ce[Z.heap[Z.heap_max]*2+1]=0,z=Z.heap_max+1;z<g;z++)be=Z.heap[z],ee=Ce[Ce[be*2+1]*2+1]+1,ee>He&&(ee=He,ut++),Ce[be*2+1]=ee,!(be>Ue)&&(Z.bl_count[ee]++,me=0,be>=Ne&&(me=Q[be-Ne]),Ae=Ce[be*2],Z.opt_len+=Ae*(ee+me),Pe&&(Z.static_len+=Ae*(ce[be*2+1]+me)));if(ut!==0){do{for(ee=He-1;Z.bl_count[ee]===0;)ee--;Z.bl_count[ee]--,Z.bl_count[ee+1]+=2,Z.bl_count[He]--,ut-=2}while(ut>0);for(ee=He;ee!==0;ee--)for(be=Z.bl_count[ee];be!==0;)_e=Z.heap[--z],!(_e>Ue)&&(Ce[_e*2+1]!==ee&&(Z.opt_len+=(ee-Ce[_e*2+1])*Ce[_e*2],Ce[_e*2+1]=ee),be--)}}function ue(Z,ge,Ce){var Ue=new Array(y+1),ce=0,Pe,Q;for(Pe=1;Pe<=y;Pe++)Ue[Pe]=ce=ce+Ce[Pe-1]<<1;for(Q=0;Q<=ge;Q++){var Ne=Z[Q*2+1];Ne!==0&&(Z[Q*2]=ke(Ue[Ne]++,Ne))}}function Me(){var Z,ge,Ce,Ue,ce,Pe=new Array(y+1);for(Ce=0,Ue=0;Ue<b-1;Ue++)for(V[Ue]=Ce,Z=0;Z<1<<P[Ue];Z++)$[Ce++]=Ue;for($[Ce-1]=Ue,ce=0,Ue=0;Ue<16;Ue++)for(k[Ue]=ce,Z=0;Z<1<<F[Ue];Z++)G[ce++]=Ue;for(ce>>=7;Ue<s;Ue++)for(k[Ue]=ce<<7,Z=0;Z<1<<F[Ue]-7;Z++)G[256+ce++]=Ue;for(ge=0;ge<=y;ge++)Pe[ge]=0;for(Z=0;Z<=143;)K[Z*2+1]=8,Z++,Pe[8]++;for(;Z<=255;)K[Z*2+1]=9,Z++,Pe[9]++;for(;Z<=279;)K[Z*2+1]=7,Z++,Pe[7]++;for(;Z<=287;)K[Z*2+1]=8,Z++,Pe[8]++;for(ue(K,i+1,Pe),Z=0;Z<s;Z++)H[Z*2+1]=5,H[Z*2]=ke(Z,5);ie=new Y(K,P,u+1,i,y),ne=new Y(H,F,0,s,y),he=new Y(new Array(0),N,0,h,l)}function Ge(Z){var ge;for(ge=0;ge<i;ge++)Z.dyn_ltree[ge*2]=0;for(ge=0;ge<s;ge++)Z.dyn_dtree[ge*2]=0;for(ge=0;ge<h;ge++)Z.bl_tree[ge*2]=0;Z.dyn_ltree[f*2]=1,Z.opt_len=Z.static_len=0,Z.last_lit=Z.matches=0}function Je(Z){Z.bi_valid>8?fe(Z,Z.bi_buf):Z.bi_valid>0&&(Z.pending_buf[Z.pending++]=Z.bi_buf),Z.bi_buf=0,Z.bi_valid=0}function qe(Z,ge,Ce,Ue){Je(Z),fe(Z,Ce),fe(Z,~Ce),d.arraySet(Z.pending_buf,Z.window,ge,Ce,Z.pending),Z.pending+=Ce}function tt(Z,ge,Ce,Ue){var ce=ge*2,Pe=Ce*2;return Z[ce]<Z[Pe]||Z[ce]===Z[Pe]&&Ue[ge]<=Ue[Ce]}function Ze(Z,ge,Ce){for(var Ue=Z.heap[Ce],ce=Ce<<1;ce<=Z.heap_len&&(ce<Z.heap_len&&tt(ge,Z.heap[ce+1],Z.heap[ce],Z.depth)&&ce++,!tt(ge,Ue,Z.heap[ce],Z.depth));)Z.heap[Ce]=Z.heap[ce],Ce=ce,ce<<=1;Z.heap[Ce]=Ue}function Ve(Z,ge,Ce){var Ue,ce,Pe=0,Q,Ne;if(Z.last_lit!==0)do Ue=Z.pending_buf[Z.d_buf+Pe*2]<<8|Z.pending_buf[Z.d_buf+Pe*2+1],ce=Z.pending_buf[Z.l_buf+Pe],Pe++,Ue===0?Te(Z,ce,ge):(Q=$[ce],Te(Z,Q+u+1,ge),Ne=P[Q],Ne!==0&&(ce-=V[Q],pe(Z,ce,Ne)),Ue--,Q=xe(Ue),Te(Z,Q,Ce),Ne=F[Q],Ne!==0&&(Ue-=k[Q],pe(Z,Ue,Ne)));while(Pe<Z.last_lit);Te(Z,f,ge)}function Ye(Z,ge){var Ce=ge.dyn_tree,Ue=ge.stat_desc.static_tree,ce=ge.stat_desc.has_stree,Pe=ge.stat_desc.elems,Q,Ne,He=-1,z;for(Z.heap_len=0,Z.heap_max=g,Q=0;Q<Pe;Q++)Ce[Q*2]!==0?(Z.heap[++Z.heap_len]=He=Q,Z.depth[Q]=0):Ce[Q*2+1]=0;for(;Z.heap_len<2;)z=Z.heap[++Z.heap_len]=He<2?++He:0,Ce[z*2]=1,Z.depth[z]=0,Z.opt_len--,ce&&(Z.static_len-=Ue[z*2+1]);for(ge.max_code=He,Q=Z.heap_len>>1;Q>=1;Q--)Ze(Z,Ce,Q);z=Pe;do Q=Z.heap[1],Z.heap[1]=Z.heap[Z.heap_len--],Ze(Z,Ce,1),Ne=Z.heap[1],Z.heap[--Z.heap_max]=Q,Z.heap[--Z.heap_max]=Ne,Ce[z*2]=Ce[Q*2]+Ce[Ne*2],Z.depth[z]=(Z.depth[Q]>=Z.depth[Ne]?Z.depth[Q]:Z.depth[Ne])+1,Ce[Q*2+1]=Ce[Ne*2+1]=z,Z.heap[1]=z++,Ze(Z,Ce,1);while(Z.heap_len>=2);Z.heap[--Z.heap_max]=Z.heap[1],Le(Z,ge),ue(Ce,He,Z.bl_count)}function Ke(Z,ge,Ce){var Ue,ce=-1,Pe,Q=ge[1],Ne=0,He=7,z=4;for(Q===0&&(He=138,z=3),ge[(Ce+1)*2+1]=65535,Ue=0;Ue<=Ce;Ue++)Pe=Q,Q=ge[(Ue+1)*2+1],!(++Ne<He&&Pe===Q)&&(Ne<z?Z.bl_tree[Pe*2]+=Ne:Pe!==0?(Pe!==ce&&Z.bl_tree[Pe*2]++,Z.bl_tree[m*2]++):Ne<=10?Z.bl_tree[C*2]++:Z.bl_tree[T*2]++,Ne=0,ce=Pe,Q===0?(He=138,z=3):Pe===Q?(He=6,z=3):(He=7,z=4))}function We(Z,ge,Ce){var Ue,ce=-1,Pe,Q=ge[1],Ne=0,He=7,z=4;for(Q===0&&(He=138,z=3),Ue=0;Ue<=Ce;Ue++)if(Pe=Q,Q=ge[(Ue+1)*2+1],!(++Ne<He&&Pe===Q)){if(Ne<z)do Te(Z,Pe,Z.bl_tree);while(--Ne!==0);else Pe!==0?(Pe!==ce&&(Te(Z,Pe,Z.bl_tree),Ne--),Te(Z,m,Z.bl_tree),pe(Z,Ne-3,2)):Ne<=10?(Te(Z,C,Z.bl_tree),pe(Z,Ne-3,3)):(Te(Z,T,Z.bl_tree),pe(Z,Ne-11,7));Ne=0,ce=Pe,Q===0?(He=138,z=3):Pe===Q?(He=6,z=3):(He=7,z=4)}}function nt(Z){var ge;for(Ke(Z,Z.dyn_ltree,Z.l_desc.max_code),Ke(Z,Z.dyn_dtree,Z.d_desc.max_code),Ye(Z,Z.bl_desc),ge=h-1;ge>=3&&Z.bl_tree[B[ge]*2+1]===0;ge--);return Z.opt_len+=3*(ge+1)+5+5+4,ge}function at(Z,ge,Ce,Ue){var ce;for(pe(Z,ge-257,5),pe(Z,Ce-1,5),pe(Z,Ue-4,4),ce=0;ce<Ue;ce++)pe(Z,Z.bl_tree[B[ce]*2+1],3);We(Z,Z.dyn_ltree,ge-1),We(Z,Z.dyn_dtree,Ce-1)}function q(Z){var ge=4093624447,Ce;for(Ce=0;Ce<=31;Ce++,ge>>>=1)if(ge&1&&Z.dyn_ltree[Ce*2]!==0)return S;if(Z.dyn_ltree[18]!==0||Z.dyn_ltree[20]!==0||Z.dyn_ltree[26]!==0)return j;for(Ce=32;Ce<u;Ce++)if(Z.dyn_ltree[Ce*2]!==0)return j;return S}var re=!1;function se(Z){re||(Me(),re=!0),Z.l_desc=new le(Z.dyn_ltree,ie),Z.d_desc=new le(Z.dyn_dtree,ne),Z.bl_desc=new le(Z.bl_tree,he),Z.bi_buf=0,Z.bi_valid=0,Ge(Z)}function Se(Z,ge,Ce,Ue){pe(Z,(D<<1)+(Ue?1:0),3),qe(Z,ge,Ce)}function we(Z){pe(Z,x<<1,3),Te(Z,f,K),$e(Z)}function ze(Z,ge,Ce,Ue){var ce,Pe,Q=0;Z.level>0?(Z.strm.data_type===p&&(Z.strm.data_type=q(Z)),Ye(Z,Z.l_desc),Ye(Z,Z.d_desc),Q=nt(Z),ce=Z.opt_len+3+7>>>3,Pe=Z.static_len+3+7>>>3,Pe<=ce&&(ce=Pe)):ce=Pe=Ce+5,Ce+4<=ce&&ge!==-1?Se(Z,ge,Ce,Ue):Z.strategy===R||Pe===ce?(pe(Z,(x<<1)+(Ue?1:0),3),Ve(Z,K,H)):(pe(Z,(A<<1)+(Ue?1:0),3),at(Z,Z.l_desc.max_code+1,Z.d_desc.max_code+1,Q+1),Ve(Z,Z.dyn_ltree,Z.dyn_dtree)),Ge(Z),Ue&&Je(Z)}function Be(Z,ge,Ce){return Z.pending_buf[Z.d_buf+Z.last_lit*2]=ge>>>8&255,Z.pending_buf[Z.d_buf+Z.last_lit*2+1]=ge&255,Z.pending_buf[Z.l_buf+Z.last_lit]=Ce&255,Z.last_lit++,ge===0?Z.dyn_ltree[Ce*2]++:(Z.matches++,ge--,Z.dyn_ltree[($[Ce]+u+1)*2]++,Z.dyn_dtree[xe(ge)*2]++),Z.last_lit===Z.lit_bufsize-1}a._tr_init=se,a._tr_stored_block=Se,a._tr_flush_block=ze,a._tr_tally=Be,a._tr_align=we},"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"(o){function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}o.exports=a},"./src/3Dmol.ts"(o,a,n){n.r(a),n.d(a,{CAP:()=>j.CAP,CC:()=>R.CC,CONTEXTS_PER_VIEWPORT:()=>D.CONTEXTS_PER_VIEWPORT,Color:()=>R.Color,CustomLinear:()=>x.CustomLinear,Cylinder:()=>g.Cylinder,GLDraw:()=>j.GLDraw,GLModel:()=>p.GLModel,GLShape:()=>v.GLShape,GLViewer:()=>D.GLViewer,GLVolumetricRender:()=>s.GLVolumetricRender,Gradient:()=>x.Gradient,GradientType:()=>x.GradientType,Label:()=>A.Label,LabelCount:()=>A.LabelCount,MarchingCube:()=>b.MarchingCube,MarchingCubeInitializer:()=>b.MarchingCubeInitializer,Matrix3:()=>h.Matrix3,Matrix4:()=>h.Matrix4,Parsers:()=>L.Parsers,PausableTimer:()=>u.PausableTimer,PointGrid:()=>b.PointGrid,ProteinSurface:()=>b.ProteinSurface,Quaternion:()=>h.Quaternion,ROYGB:()=>x.ROYGB,RWB:()=>x.RWB,Ray:()=>h.Ray,Sinebow:()=>x.Sinebow,Sphere:()=>g.Sphere,SurfaceType:()=>b.SurfaceType,Triangle:()=>g.Triangle,Vector2:()=>h.Vector2,Vector3:()=>h.Vector3,VolumeData:()=>i.VolumeData,adjustVolumeStyle:()=>u.adjustVolumeStyle,applyPartialCharges:()=>w.applyPartialCharges,autoinit:()=>d.autoinit,autoload:()=>d.autoload,base64ToArray:()=>u.base64ToArray,bondLength:()=>L.bondLength,builtinColorSchemes:()=>R.builtinColorSchemes,builtinGradients:()=>x.builtinGradients,chains:()=>R.chains,clamp:()=>h.clamp,conversionMatrix3:()=>h.conversionMatrix3,createStereoViewer:()=>D.createStereoViewer,createViewer:()=>D.createViewer,createViewerGrid:()=>D.createViewerGrid,deepCopy:()=>u.deepCopy,degToRad:()=>h.degToRad,download:()=>u.download,drawCartoon:()=>S.drawCartoon,elementColors:()=>R.elementColors,extend:()=>u.extend,get:()=>u.get,getAtomProperty:()=>u.getAtomProperty,getColorFromStyle:()=>u.getColorFromStyle,getElement:()=>u.getElement,getExtent:()=>u.getExtent,getGradient:()=>x.getGradient,getPropertyRange:()=>u.getPropertyRange,getbin:()=>u.getbin,htmlColors:()=>R.htmlColors,inflateString:()=>u.inflateString,isEmptyObject:()=>u.isEmptyObject,isNumeric:()=>u.isNumeric,makeFunction:()=>u.makeFunction,mergeGeos:()=>u.mergeGeos,normalizeValue:()=>x.normalizeValue,partialCharges:()=>w.partialCharges,processing_autoinit:()=>d.processing_autoinit,residues:()=>R.residues,setBondLength:()=>L.setBondLength,setSyncSurface:()=>b.setSyncSurface,specStringToObject:()=>u.specStringToObject,splitMesh:()=>v.splitMesh,ssColors:()=>R.ssColors,subdivide_spline:()=>S.subdivide_spline,syncSurface:()=>b.syncSurface,viewers:()=>d.viewers});var d=n("./src/autoload.ts"),R=n("./src/colors.ts"),S=n("./src/glcartoon.ts"),j=n("./src/GLDraw.ts"),p=n("./src/GLModel.ts"),v=n("./src/GLShape.ts"),D=n("./src/GLViewer.ts"),x=n("./src/Gradient.ts"),A=n("./src/Label.ts"),L=n("./src/parsers/index.ts"),w=n("./src/partialCharges.ts"),b=n("./src/ProteinSurface4.ts");n("./src/specs.ts");var u=n("./src/utilities.ts"),i=n("./src/VolumeData.ts"),s=n("./src/VolumetricRender.ts"),h=n("./src/WebGL/math/index.ts"),g=n("./src/WebGL/shapes/index.ts")},"./src/GLDraw.ts"(o,a,n){n.r(a),n.d(a,{CAP:()=>R,GLDraw:()=>S});var d=n("./src/WebGL/math/index.ts"),R;(function(j){j[j.NONE=0]="NONE",j[j.FLAT=1]="FLAT",j[j.ROUND=2]="ROUND"})(R||(R={}));var S;(function(j){function p(u,i,s){var h=Math.hypot(u,i),g,y,E,l,f;h<1e-4?(y=0,E=1):(y=-u/h,E=i/h),i=-y*u+E*i,g=Math.hypot(i,s),g<1e-4?(l=0,f=1):(l=s/g,f=i/g);var m=new Float32Array(9);return m[0]=E,m[1]=y,m[2]=0,m[3]=-y*f,m[4]=E*f,m[5]=l,m[6]=y*l,m[7]=-E*l,m[8]=f,m}class v{constructor(){this.cache={};let i=[],s=4,h=Math.pow(2,s),g=2,y=Math.pow(2,g),E=h/y,l;for(i[0]=new d.Vector3(-1,0,0),i[E]=new d.Vector3(0,0,1),i[E*2]=new d.Vector3(1,0,0),i[E*3]=new d.Vector3(0,0,-1),g=3;g<=s;g++){for(y=Math.pow(2,g-1),E=h/y,l=0;l<y-1;l++)i[E/2+l*E]=i[l*E].clone().add(i[(l+1)*E]).normalize();l=y-1,i[E/2+l*E]=i[l*E].clone().add(i[0]).normalize()}this.basisVectors=i}getVerticesForRadius(i,s,h){if(typeof this.cache<"u"&&this.cache[i]!==void 0&&this.cache[i][s+h]!==void 0)return this.cache[i][s+h];for(var g=this.basisVectors.length,y=[],E=[],l,f=0;f<g;f++)y.push(this.basisVectors[f].clone().multiplyScalar(i)),y.push(this.basisVectors[f].clone().multiplyScalar(i)),l=this.basisVectors[f].clone().normalize(),E.push(l),E.push(l);var m=[],C=10,T=g,P=0,F=Math.PI*2,N=0,B=Math.PI,U,K,H=!1,G=!1;for(K=0;K<=C;K++){H=K===0||K===C,G=K===C/2;var $=[],V=[];for(U=0;U<=T;U++){if(G){var k=U<T?2*U:0;V.push(k+1),$.push(k);continue}var Y=U/T,ie=K/C;if(!H||U===0)if(U<T){var ne=new d.Vector3;ne.x=-i*Math.cos(P+Y*F)*Math.sin(N+ie*B),s==1?ne.y=0:ne.y=i*Math.cos(N+ie*B),ne.z=i*Math.sin(P+Y*F)*Math.sin(N+ie*B),Math.abs(ne.x)<1e-5&&(ne.x=0),Math.abs(ne.y)<1e-5&&(ne.y=0),Math.abs(ne.z)<1e-5&&(ne.z=0),s==R.FLAT?(l=new d.Vector3(0,Math.cos(N+ie*B),0),l.normalize()):(l=new d.Vector3(ne.x,ne.y,ne.z),l.normalize()),y.push(ne),E.push(l),$.push(y.length-1)}else $.push(y.length-T);else H&&$.push(y.length-1)}G&&m.push(V),m.push($)}var he={vertices:y,normals:E,verticesRows:m,w:T,h:C};return i in this.cache||(this.cache[i]={}),this.cache[i][s+h]=he,he}}var D=new v;function x(u,i,s,h,g,y=0,E=0){if(!i||!s)return;let l=function(Ae){if(typeof Ae=="string"){let ut=Ae;return ut.toLowerCase()=="flat"?R.FLAT:ut.toLowerCase()=="round"?R.ROUND:R.NONE}else return Ae};y=l(y),E=l(E);var f=E||y;g=g||{r:0,g:0,b:0};var m=p(s.x-i.x,s.y-i.y,s.z-i.z),C=D.getVerticesForRadius(h,E,"to"),T=C.w,P=C.h,F=f?P*T+2:2*T,N=u.updateGeoGroup(F),B=C.vertices,U=C.normals,K=C.verticesRows,H=K[P/2],G=K[P/2+1],$=N.vertices,V,k,Y,ie,ne,he,le=N.vertexArray,xe=N.normalArray,fe=N.colorArray,pe=N.faceArray;for(Y=0;Y<T;++Y){var Te=2*Y;ie=m[0]*B[Te].x+m[3]*B[Te].y+m[6]*B[Te].z,ne=m[1]*B[Te].x+m[4]*B[Te].y+m[7]*B[Te].z,he=m[5]*B[Te].y+m[8]*B[Te].z,V=3*($+Te),k=N.faceidx,le[V]=ie+i.x,le[V+1]=ne+i.y,le[V+2]=he+i.z,le[V+3]=ie+s.x,le[V+4]=ne+s.y,le[V+5]=he+s.z,xe[V]=ie,xe[V+3]=ie,xe[V+1]=ne,xe[V+4]=ne,xe[V+2]=he,xe[V+5]=he,fe[V]=g.r,fe[V+3]=g.r,fe[V+1]=g.g,fe[V+4]=g.g,fe[V+2]=g.b,fe[V+5]=g.b,pe[k]=G[Y]+$,pe[k+1]=G[Y+1]+$,pe[k+2]=H[Y]+$,pe[k+3]=H[Y]+$,pe[k+4]=G[Y+1]+$,pe[k+5]=H[Y+1]+$,N.faceidx+=6}if(f){var ke=E?0:P/2,$e=y?P+1:P/2+1,Le,ue,Me,Ge,Je,qe,tt,Ze,Ve,Ye,Ke,We,nt,at,q,re,se,Se,we,ze,Be,Z,ge,Ce,Ue,ce,Pe,Q,Ne,He,z,be;for(ne=ke;ne<$e;ne++)if(ne!==P/2){var _e=ne<=P/2?s:i,ee=D.getVerticesForRadius(h,E,"to"),me=D.getVerticesForRadius(h,y,"from");for(_e===s?(B=ee.vertices,U=ee.normals,K=ee.verticesRows):_e==i&&(B=me.vertices,U=me.normals,K=me.verticesRows),ie=0;ie<T;ie++)k=N.faceidx,Le=K[ne][ie+1],Ne=(Le+$)*3,ue=K[ne][ie],He=(ue+$)*3,Me=K[ne+1][ie],z=(Me+$)*3,Ge=K[ne+1][ie+1],be=(Ge+$)*3,Je=m[0]*B[Le].x+m[3]*B[Le].y+m[6]*B[Le].z,qe=m[0]*B[ue].x+m[3]*B[ue].y+m[6]*B[ue].z,tt=m[0]*B[Me].x+m[3]*B[Me].y+m[6]*B[Me].z,Ze=m[0]*B[Ge].x+m[3]*B[Ge].y+m[6]*B[Ge].z,Ve=m[1]*B[Le].x+m[4]*B[Le].y+m[7]*B[Le].z,Ye=m[1]*B[ue].x+m[4]*B[ue].y+m[7]*B[ue].z,Ke=m[1]*B[Me].x+m[4]*B[Me].y+m[7]*B[Me].z,We=m[1]*B[Ge].x+m[4]*B[Ge].y+m[7]*B[Ge].z,nt=m[5]*B[Le].y+m[8]*B[Le].z,at=m[5]*B[ue].y+m[8]*B[ue].z,q=m[5]*B[Me].y+m[8]*B[Me].z,re=m[5]*B[Ge].y+m[8]*B[Ge].z,le[Ne]=Je+_e.x,le[He]=qe+_e.x,le[z]=tt+_e.x,le[be]=Ze+_e.x,le[Ne+1]=Ve+_e.y,le[He+1]=Ye+_e.y,le[z+1]=Ke+_e.y,le[be+1]=We+_e.y,le[Ne+2]=nt+_e.z,le[He+2]=at+_e.z,le[z+2]=q+_e.z,le[be+2]=re+_e.z,fe[Ne]=g.r,fe[He]=g.r,fe[z]=g.r,fe[be]=g.r,fe[Ne+1]=g.g,fe[He+1]=g.g,fe[z+1]=g.g,fe[be+1]=g.g,fe[Ne+2]=g.b,fe[He+2]=g.b,fe[z+2]=g.b,fe[be+2]=g.b,se=m[0]*U[Le].x+m[3]*U[Le].y+m[6]*U[Le].z,Se=m[0]*U[ue].x+m[3]*U[ue].y+m[6]*U[ue].z,we=m[0]*U[Me].x+m[3]*U[Me].y+m[6]*U[Me].z,ze=m[0]*U[Ge].x+m[3]*U[Ge].y+m[6]*U[Ge].z,Be=m[1]*U[Le].x+m[4]*U[Le].y+m[7]*U[Le].z,Z=m[1]*U[ue].x+m[4]*U[ue].y+m[7]*U[ue].z,ge=m[1]*U[Me].x+m[4]*U[Me].y+m[7]*U[Me].z,Ce=m[1]*U[Ge].x+m[4]*U[Ge].y+m[7]*U[Ge].z,Ue=m[5]*U[Le].y+m[8]*U[Le].z,ce=m[5]*U[ue].y+m[8]*U[ue].z,Pe=m[5]*U[Me].y+m[8]*U[Me].z,Q=m[5]*U[Ge].y+m[8]*U[Ge].z,ne===0?(xe[Ne]=se,xe[z]=we,xe[be]=ze,xe[Ne+1]=Be,xe[z+1]=ge,xe[be+1]=Ce,xe[Ne+2]=Ue,xe[z+2]=Pe,xe[be+2]=Q,pe[k]=Le+$,pe[k+1]=Me+$,pe[k+2]=Ge+$,N.faceidx+=3):ne===$e-1?(xe[Ne]=se,xe[He]=Se,xe[z]=we,xe[Ne+1]=Be,xe[He+1]=Z,xe[z+1]=ge,xe[Ne+2]=Ue,xe[He+2]=ce,xe[z+2]=Pe,pe[k]=Le+$,pe[k+1]=ue+$,pe[k+2]=Me+$,N.faceidx+=3):(xe[Ne]=se,xe[He]=Se,xe[be]=ze,xe[Ne+1]=Be,xe[He+1]=Z,xe[be+1]=Ce,xe[Ne+2]=Ue,xe[He+2]=ce,xe[be+2]=Q,xe[He]=Se,xe[z]=we,xe[be]=ze,xe[He+1]=Z,xe[z+1]=ge,xe[be+1]=Ce,xe[He+2]=ce,xe[z+2]=Pe,xe[be+2]=Q,pe[k]=Le+$,pe[k+1]=ue+$,pe[k+2]=Ge+$,pe[k+3]=ue+$,pe[k+4]=Me+$,pe[k+5]=Ge+$,N.faceidx+=6)}}N.vertices+=F}j.drawCylinder=x;function A(u,i,s,h,g){if(!i||!s)return;g=g||{r:0,g:0,b:0};let y=new d.Vector3(s.x-i.x,s.y-i.y,s.z-i.z);var E=p(y.x,y.y,y.z);y=y.normalize();var l=D.basisVectors.length,f=D.basisVectors,m=l+2,C=u.updateGeoGroup(m),T=C.vertices,P,F,N,B,U,K,H=C.vertexArray,G=C.normalArray,$=C.colorArray,V=C.faceArray;for(P=T*3,H[P]=i.x,H[P+1]=i.y,H[P+2]=i.z,G[P]=-y.x,G[P+1]=-y.y,G[P+2]=-y.z,$[P]=g.r,$[P+1]=g.g,$[P+2]=g.b,H[P+3]=s.x,H[P+4]=s.y,H[P+5]=s.z,G[P+3]=y.x,G[P+4]=y.y,G[P+5]=y.z,$[P+3]=g.r,$[P+4]=g.g,$[P+5]=g.b,P+=6,N=0;N<l;++N){var k=f[N].clone();k.multiplyScalar(h),B=E[0]*k.x+E[3]*k.y+E[6]*k.z,U=E[1]*k.x+E[4]*k.y+E[7]*k.z,K=E[5]*k.y+E[8]*k.z,H[P]=B+i.x,H[P+1]=U+i.y,H[P+2]=K+i.z,G[P]=B,G[P+1]=U,G[P+2]=K,$[P]=g.r,$[P+1]=g.g,$[P+2]=g.b,P+=3}for(C.vertices+=l+2,F=C.faceidx,N=0;N<l;N++){var Y=T+2+N,ie=T+2+(N+1)%l;V[F]=Y,V[F+1]=ie,V[F+2]=T,F+=3,V[F]=Y,V[F+1]=ie,V[F+2]=T+1,F+=3}C.faceidx+=6*l}j.drawCone=A;class L{constructor(){this.cache=new Map}getVerticesForRadius(i,s){s=s||2,this.cache.has(s)||this.cache.set(s,new Map);let h=this.cache.get(s);if(h.has(i))return h.get(i);var g={vertices:[],verticesRows:[],normals:[]},y=16*s,E=10*s;i<1&&(y=10*s,E=8*s);var l=0,f=Math.PI*2,m=0,C=Math.PI,T,P;for(P=0;P<=E;P++){let N=[];for(T=0;T<=y;T++){let B=T/y,U=P/E,K=-i*Math.cos(l+B*f)*Math.sin(m+U*C),H=i*Math.cos(m+U*C),G=i*Math.sin(l+B*f)*Math.sin(m+U*C);var F=new d.Vector3(K,H,G);F.normalize(),g.vertices.push({x:K,y:H,z:G}),g.normals.push(F),N.push(g.vertices.length-1)}g.verticesRows.push(N)}return h.set(i,g),g}}var w=new L;function b(u,i,s,h,g){var y=w.getVerticesForRadius(s,g),E=y.vertices,l=y.normals,f=u.updateGeoGroup(E.length),m=f.vertices,C=f.vertexArray,T=f.colorArray,P=f.faceArray,F=f.lineArray,N=f.normalArray;for(let K=0,H=E.length;K<H;++K){let G=3*(m+K),$=E[K];C[G]=$.x+i.x,C[G+1]=$.y+i.y,C[G+2]=$.z+i.z,T[G]=h.r,T[G+1]=h.g,T[G+2]=h.b}f.vertices+=E.length;let B=y.verticesRows,U=B.length-1;for(let K=0;K<U;K++){let H=B[K].length-1;for(let G=0;G<H;G++){let $=f.faceidx,V=f.lineidx,k=B[K][G+1]+m,Y=k*3,ie=B[K][G]+m,ne=ie*3,he=B[K+1][G]+m,le=he*3,xe=B[K+1][G+1]+m,fe=xe*3,pe=l[k-m],Te=l[ie-m],ke=l[he-m],$e=l[xe-m];Math.abs(E[k-m].y)===s?(N[Y]=pe.x,N[le]=ke.x,N[fe]=$e.x,N[Y+1]=pe.y,N[le+1]=ke.y,N[fe+1]=$e.y,N[Y+2]=pe.z,N[le+2]=ke.z,N[fe+2]=$e.z,P[$]=k,P[$+1]=he,P[$+2]=xe,F[V]=k,F[V+1]=he,F[V+2]=k,F[V+3]=xe,F[V+4]=he,F[V+5]=xe,f.faceidx+=3,f.lineidx+=6):Math.abs(E[he-m].y)===s?(N[Y]=pe.x,N[ne]=Te.x,N[le]=ke.x,N[Y+1]=pe.y,N[ne+1]=Te.y,N[le+1]=ke.y,N[Y+2]=pe.z,N[ne+2]=Te.z,N[le+2]=ke.z,P[$]=k,P[$+1]=ie,P[$+2]=he,F[V]=k,F[V+1]=ie,F[V+2]=k,F[V+3]=he,F[V+4]=ie,F[V+5]=he,f.faceidx+=3,f.lineidx+=6):(N[Y]=pe.x,N[ne]=Te.x,N[fe]=$e.x,N[Y+1]=pe.y,N[ne+1]=Te.y,N[fe+1]=$e.y,N[Y+2]=pe.z,N[ne+2]=Te.z,N[fe+2]=$e.z,N[ne]=Te.x,N[le]=ke.x,N[fe]=$e.x,N[ne+1]=Te.y,N[le+1]=ke.y,N[fe+1]=$e.y,N[ne+2]=Te.z,N[le+2]=ke.z,N[fe+2]=$e.z,P[$]=k,P[$+1]=ie,P[$+2]=xe,P[$+3]=ie,P[$+4]=he,P[$+5]=xe,F[V]=k,F[V+1]=ie,F[V+2]=k,F[V+3]=xe,F[V+4]=ie,F[V+5]=he,F[V+6]=he,F[V+7]=xe,f.faceidx+=6,f.lineidx+=8)}}}j.drawSphere=b})(S||(S={}))},"./src/GLModel.ts"(o,a,n){n.r(a),n.d(a,{GLModel:()=>b});var d=n("./src/WebGL/index.ts"),R=n("./src/WebGL/shapes/index.ts"),S=n("./src/WebGL/math/index.ts"),j=n("./src/colors.ts"),p=n("./src/GLDraw.ts"),v=n("./src/glcartoon.ts"),D=n("./src/utilities.ts"),x=n("./src/Gradient.ts"),A=n("./src/parsers/index.ts"),L=n("./node_modules/netcdfjs/lib-esm/index.js"),w=n("./src/parsers/utils/assignBonds.ts");class b{static sameObj(i,s){return i&&s?JSON.stringify(i)==JSON.stringify(s):i==s}constructor(i,s,h){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new S.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=j.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=s||{},this.viewer=h,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:j.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=i}getRadiusFromStyle(i,s){var h=this.defaultSphereRadius;if(typeof s.radius<"u")h=s.radius;else if(b.vdwRadii[i.elem])h=b.vdwRadii[i.elem];else if(i.elem.length>1){let g=i.elem;g=g[0].toUpperCase()+g[1].toLowerCase(),b.vdwRadii[g]&&(h=b.vdwRadii[g])}return typeof s.scale<"u"&&(h*=s.scale),h}drawAtomCross(i,s){if(i.style.cross){var h=i.style.cross;if(!h.hidden){var g=h.linewidth||b.defaultlineWidth;s[g]||(s[g]=new d.Geometry);var y=s[g].updateGeoGroup(6),E=this.getRadiusFromStyle(i,h),l=[[E,0,0],[-E,0,0],[0,E,0],[0,-E,0],[0,0,E],[0,0,-E]],f=i.clickable||i.hoverable;f&&i.intersectionShape===void 0&&(i.intersectionShape={sphere:[],cylinder:[],line:[]});for(var m=(0,D.getColorFromStyle)(i,h),C=y.vertexArray,T=y.colorArray,P=0;P<6;P++){var F=y.vertices*3;if(y.vertices++,C[F]=i.x+l[P][0],C[F+1]=i.y+l[P][1],C[F+2]=i.z+l[P][2],T[F]=m.r,T[F+1]=m.g,T[F+2]=m.b,f){var N=new S.Vector3(l[P][0],l[P][1],l[P][2]);N.multiplyScalar(.1),N.set(N.x+i.x,N.y+i.y,N.z+i.z),i.intersectionShape.line.push(N)}}}}}getGoodCross(i,s,h,g){for(var y=null,E=-1,l=0,f=i.bonds.length;l<f;l++)if(i.bonds[l]!=s.index){let C=i.bonds[l],T=this.atoms[C],F=new S.Vector3(T.x,T.y,T.z).clone();F.sub(h);let N=F.clone();N.cross(g);var m=N.lengthSq();if(m>E&&(E=m,y=N,E>.1))return y}return y}getSideBondV(i,s,h){var g,y,E,l,f,m=new S.Vector3(i.x,i.y,i.z),C=new S.Vector3(s.x,s.y,s.z),T=C.clone(),P=null;if(T.sub(m),i.bonds.length===1)if(s.bonds.length===1)P=T.clone(),Math.abs(P.x)>1e-4?P.y+=1:P.x+=1;else{for(E=null,g=0;g<s.bonds.length;g++)if(y=s.bonds[g],y!==i.index){E=this.atoms[y];break}E?(l=new S.Vector3(E.x,E.y,E.z),f=l.clone(),f.sub(m),P=f.clone(),P.cross(T)):(P=T.clone(),P.x+=1)}else if(P=this.getGoodCross(i,s,m,T),P.lengthSq()<.01){var F=this.getGoodCross(s,i,m,T);F!=null&&(P=F)}return P.lengthSq()<.01&&(P=T.clone(),Math.abs(P.x)>1e-4?P.y+=1:P.x+=1),P.cross(T),P.normalize(),P}addLine(i,s,h,g,y,E){i[h]=g.x,i[h+1]=g.y,i[h+2]=g.z,s[h]=E.r,s[h+1]=E.g,s[h+2]=E.b,i[h+3]=y.x,i[h+4]=y.y,i[h+5]=y.z,s[h+3]=E.r,s[h+4]=E.g,s[h+5]=E.b}drawBondLines(i,s,h){if(i.style.line){var g=i.style.line;if(!g.hidden){var y,E,l,f,m=g.linewidth||b.defaultlineWidth;h[m]||(h[m]=new d.Geometry);for(var C=h[m].updateGeoGroup(6*i.bonds.length),T=C.vertexArray,P=C.colorArray,F=0;F<i.bonds.length;F++){var N=i.bonds[F],B=s[N];if(B.style.line&&!(i.index>=B.index)){var U=new S.Vector3(i.x,i.y,i.z),K=new S.Vector3(B.x,B.y,B.z),H=U.clone().add(K).multiplyScalar(.5),G=!1,$=i.clickable||i.hoverable,V=B.clickable||B.hoverable;($||V)&&($&&(i.intersectionShape===void 0&&(i.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),i.intersectionShape.line.push(U),i.intersectionShape.line.push(H)),V&&(B.intersectionShape===void 0&&(B.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),B.intersectionShape.line.push(H),B.intersectionShape.line.push(K)));var k=(0,D.getColorFromStyle)(i,i.style.line),Y=(0,D.getColorFromStyle)(B,B.style.line);if(i.bondStyles&&i.bondStyles[F]){var ie=i.bondStyles[F];if(!ie.iswire)continue;ie.singleBond&&(G=!0),typeof ie.color1<"u"&&(k=j.CC.color(ie.color1)),typeof ie.color2<"u"&&(Y=j.CC.color(ie.color2))}var ne=C.vertices*3,he,le;if(i.bondOrder[F]>1&&i.bondOrder[F]<4&&!G){var xe=this.getSideBondV(i,B,F),fe=K.clone();fe.sub(U),i.bondOrder[F]==2?(xe.multiplyScalar(.1),y=U.clone(),y.add(xe),E=U.clone(),E.sub(xe),l=y.clone(),l.add(fe),f=E.clone(),f.add(fe),k==Y?(C.vertices+=4,this.addLine(T,P,ne,y,l,k),this.addLine(T,P,ne+6,E,f,k)):(C.vertices+=8,fe.multiplyScalar(.5),he=y.clone(),he.add(fe),le=E.clone(),le.add(fe),this.addLine(T,P,ne,y,he,k),this.addLine(T,P,ne+6,he,l,Y),this.addLine(T,P,ne+12,E,le,k),this.addLine(T,P,ne+18,le,f,Y))):i.bondOrder[F]==3&&(xe.multiplyScalar(.1),y=U.clone(),y.add(xe),E=U.clone(),E.sub(xe),l=y.clone(),l.add(fe),f=E.clone(),f.add(fe),k==Y?(C.vertices+=6,this.addLine(T,P,ne,U,K,k),this.addLine(T,P,ne+6,y,l,k),this.addLine(T,P,ne+12,E,f,k)):(C.vertices+=12,fe.multiplyScalar(.5),he=y.clone(),he.add(fe),le=E.clone(),le.add(fe),this.addLine(T,P,ne,U,H,k),this.addLine(T,P,ne+6,H,K,Y),this.addLine(T,P,ne+12,y,he,k),this.addLine(T,P,ne+18,he,l,Y),this.addLine(T,P,ne+24,E,le,k),this.addLine(T,P,ne+30,le,f,Y)))}else k==Y?(C.vertices+=2,this.addLine(T,P,ne,U,K,k)):(C.vertices+=4,this.addLine(T,P,ne,U,H,k),this.addLine(T,P,ne+6,H,K,Y))}}}}}drawAtomSphere(i,s){if(i.style.sphere){var h=i.style.sphere;if(!h.hidden){var g=(0,D.getColorFromStyle)(i,h),y=this.getRadiusFromStyle(i,h);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var E=new S.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new R.Sphere(E,y))}p.GLDraw.drawSphere(s,i,y,g)}}}drawAtomClickSphere(i){if(i.style.clicksphere){var s=i.style.clicksphere;if(!s.hidden){var h=this.getRadiusFromStyle(i,s);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var g=new S.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new R.Sphere(g,h))}}}}drawAtomInstanced(i,s){if(i.style.sphere){var h=i.style.sphere;if(!h.hidden){var g=this.getRadiusFromStyle(i,h),y=(0,D.getColorFromStyle)(i,h),E=s.updateGeoGroup(1),l=E.vertices,f=l*3,m=E.vertexArray,C=E.colorArray,T=E.radiusArray;if(m[f]=i.x,m[f+1]=i.y,m[f+2]=i.z,C[f]=y.r,C[f+1]=y.g,C[f+2]=y.b,T[l]=g,(i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var P=new S.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new R.Sphere(P,g))}E.vertices+=1}}}drawSphereImposter(i,s,h,g){var y=i.updateGeoGroup(4),E,l=y.vertices,f=l*3,m=y.vertexArray,C=y.colorArray;for(E=0;E<4;E++)m[f+3*E]=s.x,m[f+3*E+1]=s.y,m[f+3*E+2]=s.z;var T=y.normalArray;for(E=0;E<4;E++)C[f+3*E]=g.r,C[f+3*E+1]=g.g,C[f+3*E+2]=g.b;T[f+0]=-h,T[f+1]=h,T[f+2]=0,T[f+3]=-h,T[f+4]=-h,T[f+5]=0,T[f+6]=h,T[f+7]=-h,T[f+8]=0,T[f+9]=h,T[f+10]=h,T[f+11]=0,y.vertices+=4;var P=y.faceArray,F=y.faceidx;P[F+0]=l,P[F+1]=l+1,P[F+2]=l+2,P[F+3]=l+2,P[F+4]=l+3,P[F+5]=l,y.faceidx+=6}drawAtomImposter(i,s){if(i.style.sphere){var h=i.style.sphere;if(!h.hidden){var g=this.getRadiusFromStyle(i,h),y=(0,D.getColorFromStyle)(i,h);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var E=new S.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new R.Sphere(E,g))}this.drawSphereImposter(s,i,g,y)}}}calculateDashes(i,s,h,g,y,E){var l=Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2)+Math.pow(i.z-s.z,2));if(h=Math.max(h,0),y=Math.max(y,0)+2*h,g=Math.max(g,.001),g+y>l){var f=E&&E.length>0?E[0]:null;return[{from:new S.Vector3(i.x,i.y,i.z),to:new S.Vector3(s.x,s.y,s.z),color:f}]}var m=Math.floor((l-g)/(g+y))+1,C=m*g;y=(l-C)/m;for(var T,P=new S.Vector3(i.x,i.y,i.z),F=new S.Vector3((s.x-i.x)/(l/y),(s.y-i.y)/(l/y),(s.z-i.z)/(l/y)),N=new S.Vector3((s.x-i.x)/(l/g),(s.y-i.y)/(l/g),(s.z-i.z)/(l/g)),B=[],U=0;U<m;U++){T=new S.Vector3(P.x+N.x,P.y+N.y,P.z+N.z);var f=E&&E.length>1&&U>=m/2?E[1]:E?E[0]:null;B.push({from:P,to:T,color:f}),P=new S.Vector3(T.x+F.x,T.y+F.y,T.z+F.z)}return B}calculateTwoColorSegments(i,s,h){var g=[];if(h.length<=1)g.push({from:new S.Vector3(i.x,i.y,i.z),to:new S.Vector3(s.x,s.y,s.z),color:h[0]});else{var y=new S.Vector3((i.x+s.x)/2,(i.y+s.y)/2,(i.z+s.z)/2);g.push({from:new S.Vector3(i.x,i.y,i.z),to:y,color:h[0]}),g.push({from:y,to:new S.Vector3(s.x,s.y,s.z),color:h[1]})}return g}chooseDashedPlusV(i,s,h,g,y){for(var E=new S.Vector3(0,0,0),l=0,f=!1,m=0;m<i.bonds.length;m++)if(i.bonds[m]!==s.index){var C=this.atoms[i.bonds[m]];if(C&&C.bonds&&C.bonds.length>1){f=!0;break}}if(!f){for(var m=0;m<s.bonds.length;m++)if(s.bonds[m]!==i.index){var C=this.atoms[s.bonds[m]];if(C&&C.bonds&&C.bonds.length>1){f=!0;break}}}var T=(B,U)=>{for(var K=0;K<B.bonds.length;K++)if(B.bonds[K]!==U){var H=this.atoms[B.bonds[K]];if(H){var G=!H.bonds||H.bonds.length<=1,$=f&&G?.25:1;E.x+=H.x*$,E.y+=H.y*$,E.z+=H.z*$,l+=$}}};if(T(i,s.index),T(s,i.index),l<1e-8)return!1;E.multiplyScalar(1/l);var P=new S.Vector3().addVectors(h,g).multiplyScalar(.5),F=P.clone().add(y),N=P.clone().sub(y);return F.distanceToSquared(E)<N.distanceToSquared(E)}static drawStickImposter(i,s,h,g,y,E=0,l=0){for(var f=i.updateGeoGroup(4),m=f.vertices,C=m*3,T=f.vertexArray,P=f.colorArray,F=f.radiusArray,N=f.normalArray,B=y.r,U=y.g,K=y.b,H=function(Y){var ie=-Y;return ie==0&&(ie=-1e-4),ie},G=C,$=0;$<4;$++)T[G]=s.x,N[G]=h.x,P[G]=B,G++,T[G]=s.y,N[G]=h.y,P[G]=U,G++,T[G]=s.z,N[G]=h.z,$<2?P[G]=K:P[G]=H(K),G++;f.vertices+=4,F[m]=-g,F[m+1]=g,F[m+2]=-g,F[m+3]=g;var V=f.faceArray,k=f.faceidx;V[k+0]=m,V[k+1]=m+1,V[k+2]=m+2,V[k+3]=m+2,V[k+4]=m+3,V[k+5]=m,f.faceidx+=6}drawBondSticks(i,s,h){var g,y,E,l;if(i.style.stick){var f=i.style.stick;if(!f.hidden){var m=f.radius||this.defaultStickRadius,C=f.doubleBondScaling||.4,T=f.tripleBondScaling||.25,P=((g=f.dashedBondConfig)===null||g===void 0?void 0:g.dashLength)||.1,F=((y=f.dashedBondConfig)===null||y===void 0?void 0:y.gapLength)||.25,N=m,B=f.singleBonds||!1,U=f.dashedBonds||!1,K=0,H=0,G,$,V,k,Y,ie,ne,he,le,xe,fe,pe=(0,D.getColorFromStyle)(i,f),Te,ke,$e;!i.capDrawn&&i.bonds.length<4&&(K=2);var Le=!((E=f.dashedBondConfig)===null||E===void 0)&&E.solidColor?j.CC.color(f.dashedBondConfig.solidColor):null,ue=!((l=f.dashedBondConfig)===null||l===void 0)&&l.dashedColor?j.CC.color(f.dashedBondConfig.dashedColor):null,Me=this,Ge=vt=>{var Pt=h.imposter?b.drawStickImposter:p.GLDraw.drawCylinder;return!U&&vt%1===0?(Dt,ir,Vt,Rt,At,St,Ht=0,Yt=0)=>{if(!St||At===St)Pt(Dt,ir,Vt,Rt,At,Ht,Yt);else for(var rr=Me.calculateTwoColorSegments(ir,Vt,[At,St]),cr=0;cr<rr.length;cr++){var dr=rr[cr],Hr=cr===0?Ht:0,Vi=cr===rr.length-1?Yt:0;Pt(Dt,dr.from,dr.to,Rt,dr.color,Hr,Vi)}}:(Dt,ir,Vt,Rt,At,St,Ht=0,Yt=0)=>{var rr=St?[At,St]:[At],cr=Me.calculateDashes(ir,Vt,Rt,P,F,rr);cr.forEach(dr=>{Pt(Dt,dr.from,dr.to,Rt,dr.color,Ht,Yt)})}};for(V=0;V<i.bonds.length;V++){var Je=i.bondOrder[V],qe=Je===4?1.5:Je,tt=Ge(qe),Ze=i.bonds[V],Ve=s[Ze];if(Te=ke=$e=null,i.index<Ve.index){H=0;var Ye=Ve.style;if(!Ye.stick||Ye.stick.hidden)continue;var Ke=(0,D.getColorFromStyle)(Ve,Ye.stick);if(N=m,k=B,i.bondStyles&&i.bondStyles[V]){if(Y=i.bondStyles[V],Y.iswire)continue;Y.radius&&(N=Y.radius),Y.singleBond&&(k=!0),typeof Y.color1<"u"&&(pe=j.CC.color(Y.color1)),typeof Y.color2<"u"&&(Ke=j.CC.color(Y.color2))}var We=new S.Vector3(i.x,i.y,i.z),nt=new S.Vector3(Ve.x,Ve.y,Ve.z),at=Le||pe,q=Le||Ke,re=ue||pe,se=ue||Ke;if(qe<=1||k||qe>3){qe<1&&(N*=qe),!Ve.capDrawn&&Ve.bonds.length<4&&(H=2);const vt=U||qe%1!==0;if(tt(h,We,nt,N,vt?re:pe,vt?se:Ke,K,H),G=i.clickable||i.hoverable,$=Ve.clickable||Ve.hoverable,G||$){if(Te||(Te=new S.Vector3().addVectors(We,nt).multiplyScalar(.5)),G){var Se=new R.Cylinder(We,Te,N),we=new R.Sphere(We,N);i.intersectionShape.cylinder.push(Se),i.intersectionShape.sphere.push(we)}if($){var ze=new R.Cylinder(nt,Te,N),Be=new R.Sphere(nt,N);Ve.intersectionShape.cylinder.push(ze),Ve.intersectionShape.sphere.push(Be)}}}else if(qe>1){var Z=0,ge=0;N!=m&&(Z=2,ge=2);var Ce=nt.clone(),Ue=null;Ce.sub(We);var ce,Pe,Q,Ne,He,z;Ue=this.getSideBondV(i,Ve,V);var be=!1;if(qe%1!==0&&(be=this.chooseDashedPlusV(i,Ve,We,nt,Ue)),qe>1&&qe<=2){ce=N*C,Pe=ce*(qe-1),Ue.multiplyScalar(ce*1.5),Q=We.clone(),Q.add(Ue),Ne=We.clone(),Ne.sub(Ue),He=Q.clone(),He.add(Ce),z=Ne.clone(),z.add(Ce);var at=Le||pe,q=Le||Ke,re=ue||pe,se=ue||Ke,_e=h.imposter?b.drawStickImposter:p.GLDraw.drawCylinder,ee=(Vt,Rt,At,St,Ht,Yt,rr)=>{if(St!=Ht){var cr=new S.Vector3().addVectors(Vt,Rt).multiplyScalar(.5);_e(h,Vt,cr,At,St,Yt,0),_e(h,cr,Rt,At,Ht,0,rr)}else _e(h,Vt,Rt,At,St,Yt,rr)},me=(Vt,Rt,At,St,Ht,Yt,rr)=>{var cr=St!=Ht?[St,Ht]:[St],dr=Me.calculateDashes(Vt,Rt,At,P,F,cr);dr.forEach(Hr=>{_e(h,Hr.from,Hr.to,At,Hr.color||St,Yt,rr)})};if(qe==2?(ee(Q,He,ce,at,q,Z,ge),ee(Ne,z,ce,at,q,Z,ge)):be?(me(Q,He,Pe,re,se,Z,ge),ee(Ne,z,ce,at,q,Z,ge)):(ee(Q,He,ce,at,q,Z,ge),me(Ne,z,Pe,re,se,Z,ge)),G=i.clickable||i.hoverable,$=Ve.clickable||Ve.hoverable,G||$){Te||(Te=new S.Vector3().addVectors(Q,He).multiplyScalar(.5)),ke||(ke=new S.Vector3().addVectors(Ne,z).multiplyScalar(.5));var Ae=qe==2?ce:be?Pe:ce,ut=qe==2||be?ce:Pe;G&&(ie=new R.Cylinder(Q,Te,Ae),ne=new R.Cylinder(Ne,ke,ut),i.intersectionShape.cylinder.push(ie),i.intersectionShape.cylinder.push(ne)),$&&(le=new R.Cylinder(He,Te,Ae),xe=new R.Cylinder(z,ke,ut),Ve.intersectionShape.cylinder.push(le),Ve.intersectionShape.cylinder.push(xe))}}else if(qe>2&&qe<=3){ce=N*T;var ot=ce*(qe-2);Ue.cross(Ce),Ue.normalize(),Ue.multiplyScalar(ce*3),Q=We.clone(),Q.add(Ue),Ne=We.clone(),Ne.sub(Ue),He=Q.clone(),He.add(Ce),z=Ne.clone(),z.add(Ce);var _e=h.imposter?b.drawStickImposter:p.GLDraw.drawCylinder,rt=(Pt,Dt,ir,Vt,Rt,At,St)=>{if(Vt!=Rt){var Ht=new S.Vector3().addVectors(Pt,Dt).multiplyScalar(.5);_e(h,Pt,Ht,ir,Vt,At,0),_e(h,Ht,Dt,ir,Rt,0,St)}else _e(h,Pt,Dt,ir,Vt,At,St)},yt=(Pt,Dt,ir,Vt,Rt,At,St)=>{var Ht=Vt!=Rt?[Vt,Rt]:[Vt],Yt=Me.calculateDashes(Pt,Dt,ir,P,F,Ht);Yt.forEach(rr=>{_e(h,rr.from,rr.to,ir,rr.color||Vt,At,St)})};if(qe==3?(rt(Q,He,ce,at,q,Z,ge),rt(We,nt,ce,at,q,K,H),rt(Ne,z,ce,at,q,Z,ge)):be?(yt(Q,He,ot,re,se,Z,ge),rt(We,nt,ce,at,q,K,H),rt(Ne,z,ce,at,q,Z,ge)):(rt(Q,He,ce,at,q,Z,ge),rt(We,nt,ce,at,q,K,H),yt(Ne,z,ot,re,se,Z,ge)),G=i.clickable||i.hoverable,$=Ve.clickable||Ve.hoverable,G||$){Te||(Te=new S.Vector3().addVectors(Q,He).multiplyScalar(.5)),ke||(ke=new S.Vector3().addVectors(Ne,z).multiplyScalar(.5)),$e||($e=new S.Vector3().addVectors(We,nt).multiplyScalar(.5));var Ae=qe==3?ce:be?ot:ce,ut=qe==3||be?ce:ot;G&&(ie=new R.Cylinder(Q.clone(),Te.clone(),Ae),ne=new R.Cylinder(Ne.clone(),ke.clone(),ut),he=new R.Cylinder(We.clone(),$e.clone(),ce),i.intersectionShape.cylinder.push(ie),i.intersectionShape.cylinder.push(ne),i.intersectionShape.cylinder.push(he)),$&&(le=new R.Cylinder(He.clone(),Te.clone(),Ae),xe=new R.Cylinder(z.clone(),ke.clone(),ut),fe=new R.Cylinder(nt.clone(),$e.clone(),ce),Ve.intersectionShape.cylinder.push(le),Ve.intersectionShape.cylinder.push(xe),Ve.intersectionShape.cylinder.push(fe))}}}}}var Xt=!1,bt=0,xt=!1;for(V=0;V<i.bonds.length;V++)k=B,i.bondStyles&&i.bondStyles[V]&&(Y=i.bondStyles[V],Y.singleBond&&(k=!0),Y.radius&&Y.radius!=m&&(xt=!0)),(k||i.bondOrder[V]==1)&&bt++;xt?bt>0&&(Xt=!0):bt==0&&(i.bonds.length>0||f.showNonBonded)&&(Xt=!0),Xt&&(N=m,h.imposter?this.drawSphereImposter(h.sphereGeometry,i,N,pe):p.GLDraw.drawSphere(h,i,N,pe))}}}createMolObj(i,s){s=s||{};var h=new d.Object3D,g=[],y={},E={},l=this.drawAtomSphere,f=null,m=null;s.supportsImposters?(l=this.drawAtomImposter,f=new d.Geometry(!0),f.imposter=!0,m=new d.Geometry(!0,!0),m.imposter=!0,m.sphereGeometry=new d.Geometry(!0),m.sphereGeometry.imposter=!0,m.drawnCaps={}):s.supportsAIA?(l=this.drawAtomInstanced,f=new d.Geometry(!1,!0,!0),f.instanced=!0,m=new d.Geometry(!0)):(f=new d.Geometry(!0),m=new d.Geometry(!0));var C,T,P,F,N={},B=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(C=0,P=i.length;C<P;C++){var U=i[C];if(U&&U.style){(U.clickable||U.hoverable)&&U.intersectionShape===void 0&&(U.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),F={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(T in F)U.style[T]?U.style[T].opacity?F[T]=parseFloat(U.style[T].opacity):F[T]=1:F[T]=void 0,N[T]?F[T]!=null&&N[T]!=F[T]&&(console.log("Warning: "+T+" opacity is ambiguous"),N[T]=1):N[T]=F[T];l.call(this,U,f),this.drawAtomClickSphere(U),this.drawAtomCross(U,E),this.drawBondLines(U,i,y),this.drawBondSticks(U,i,m),typeof U.style.cartoon<"u"&&!U.style.cartoon.hidden&&(U.style.cartoon.color==="spectrum"&&typeof U.resi=="number"&&!U.hetflag&&(U.resi<B[0]&&(B[0]=U.resi),U.resi>B[1]&&(B[1]=U.resi)),g.push(U))}}if(g.length>0&&(0,v.drawCartoon)(h,g,B,this.defaultCartoonQuality),f&&f.vertices>0){f.initTypedArrays();var K=null,H=null;f.imposter?K=new d.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):f.instanced?(H=new d.Geometry(!0),p.GLDraw.drawSphere(H,{x:0,y:0,z:0},1,new j.Color(.5,.5,.5)),H.initTypedArrays(),K=new d.InstancedMaterial({sphereMaterial:new d.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:H})):K=new d.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),N.sphere<1&&N.sphere>=0&&(K.transparent=!0,K.opacity=N.sphere),H=new d.Mesh(f,K),h.add(H)}if(m.vertices>0){var G=null,$=null,V=m.sphereGeometry;(!V||typeof V.vertices>"u"||V.vertices==0)&&(V=null),m.initTypedArrays(),V&&V.initTypedArrays();var k={ambient:0,vertexColors:!0,reflectivity:0};m.imposter?(G=new d.StickImposterMaterial(k),$=new d.SphereImposterMaterial(k)):(G=new d.MeshLambertMaterial(k),$=new d.MeshLambertMaterial(k),G.wireframe&&(m.setUpWireframe(),V&&V.setUpWireframe())),N.stick<1&&N.stick>=0&&(G.transparent=!0,G.opacity=N.stick,$.transparent=!0,$.opacity=N.stick);var Y=new d.Mesh(m,G);if(h.add(Y),V){var ie=new d.Mesh(V,$);h.add(ie)}}var ne;for(C in y)if(y.hasOwnProperty(C)){ne=C;var he=new d.LineBasicMaterial({linewidth:ne,vertexColors:!0});N.line<1&&N.line>=0&&(he.transparent=!0,he.opacity=N.line),y[C].initTypedArrays();var le=new d.Line(y[C],he,d.LineStyle.LinePieces);h.add(le)}for(C in E)if(E.hasOwnProperty(C)){ne=C;var xe=new d.LineBasicMaterial({linewidth:ne,vertexColors:!0});N.cross<1&&N.cross>=0&&(xe.transparent=!0,xe.opacity=N.cross),E[C].initTypedArrays();var fe=new d.Line(E[C],xe,d.LineStyle.LinePieces);h.add(fe)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var pe=new d.Object3D,Te;for(Te=0;Te<this.modelData.symmetries.length;Te++){var ke=new d.Object3D;ke=h.clone(),ke.matrix.copy(this.modelData.symmetries[Te]),ke.matrixAutoUpdate=!1,pe.add(ke)}return pe}return h}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(i){this.atoms=i.atoms,this.frames=i.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const i=this.modelData.cryst;this.modelData.cryst.matrix=(0,S.conversionMatrix3)(i.a,i.b,i.c,i.alpha,i.beta,i.gamma)}return this.modelData.cryst}else return null}setCrystData(i,s,h,g,y,E){i=i||1,s=s||1,h=h||1,g=g||90,y=y||90,E=E||90;const l=(0,S.conversionMatrix3)(i,s,h,g,y,E);this.modelData.cryst={a:i,b:s,c:h,alpha:g,beta:y,gamma:E,matrix:l}}setCrystMatrix(i){i=i||new S.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:i}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(i){typeof i>"u"?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=i,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(i,s,h,g){var y=s-i;return y<-h?s+g:y>h?s-g:s}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var i=this.box[0],s=this.box[1],h=this.box[2],g=i*.9,y=s*.9,E=h*.9,l=0;l<this.atomdfs.length;l++)for(var f=this.atomdfs[l],m=1;m<f.length;m++){var C=this.atoms[f[m][0]],T=this.atoms[f[m][1]];C.x=this.adjustCoord(T.x,C.x,g,i),C.y=this.adjustCoord(T.y,C.y,y,s),C.z=this.adjustCoord(T.z,C.z,E,h)}}setFrame(i){var s=this.getNumFrames();let h=this,g=this.viewer;return new Promise(function(y,E){if(s==0&&y(),(i<0||i>=s)&&(i=s-1),h.frames.url!=null){var l=h.frames.url;(0,D.getbin)(l+"/traj/frame/"+i+"/"+h.frames.path,void 0,"POST",void 0).then(function(f){for(var m=new Float32Array(f,44),C=0,T=0;T<h.atoms.length;T++)h.atoms[T].x=m[C++],h.atoms[T].y=m[C++],h.atoms[T].z=m[C++];h.box&&h.atomdfs&&h.adjustCoordinatesToBox(),y()}).catch(E)}else h.atoms=h.frames[i],y();h.molObj=null,h.modelDatas&&i<h.modelDatas.length&&(h.modelData=h.modelDatas[i],h.unitCellObjects&&g&&(g.removeUnitCell(h),g.addUnitCell(h)))})}addFrame(i){this.frames.push(i)}vibrate(i=10,s=1,h=!1,g){var y=0,E=i;let l=this.viewer;h&&(y=-i,E=i),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),y<E&&(this.frames=[]),h&&(this.frames.origIndex=i);for(var f=y;f<E;f++){var m=[],C=this.frames.length;if(f==0&&!g){this.frames.push(this.atoms);continue}for(var T=0;T<this.atoms.length;T++){var P=(0,D.getAtomProperty)(this.atoms[T],"dx"),F=(0,D.getAtomProperty)(this.atoms[T],"dy"),N=(0,D.getAtomProperty)(this.atoms[T],"dz"),B=new S.Vector3(P,F,N),U=new S.Vector3(this.atoms[T].x,this.atoms[T].y,this.atoms[T].z),K=f*s/i;B.multiplyScalar(K),U.add(B);var H={};for(var G in this.atoms[T])H[G]=this.atoms[T][G];if(H.x=U.x,H.y=U.y,H.z=U.z,m.push(H),l&&g){var $=(0,D.extend)({},g),V=new S.Vector3(P,F,N);if(V.multiplyScalar(s),V.add(U),$.start=U,$.end=V,$.frame=C,!$.color){var k=H.style.sphere;k||(k=H.style.stick),k||(k=H.style.line),$.color=(0,D.getColorFromStyle)(H,k)}l.addArrow($)}}this.frames.push(m)}}setAtomDefaults(i){for(let s=0;s<i.length;s++){let h=i[s];h&&(h.style=h.style||(0,D.deepCopy)(b.defaultAtomStyle),h.color=h.color||this.ElementColors[h.elem]||this.defaultColor,h.model=this.id,(h.clickable||h.hoverable)&&(h.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(i,s,h={}){var g=b.parseMolData(i,s,h);this.dontDuplicateAtoms=!h.duplicateAssemblyAtoms;var y=g.modelData;if(y&&(Array.isArray(y)?(this.modelData=y[0],h.frames&&(this.modelDatas=y)):this.modelData=y),g.box?this.box=g.box:this.box=null,this.frames.length==0){for(let l=0;l<g.length;l++)g[l].length!=0&&this.frames.push(g[l]);this.frames[0]&&(this.atoms=this.frames[0])}else if(h.frames)for(let l=0;l<g.length;l++)this.frames.push(g[l]);else for(var E=0;E<g.length;E++)this.addAtoms(g[E]);for(let l=0;l<this.frames.length;l++)this.setAtomDefaults(this.frames[l]);h.vibrate&&h.vibrate.frames&&h.vibrate.amplitude&&this.vibrate(h.vibrate.frames,h.vibrate.amplitude),h.style&&this.setStyle({},h.style)}setDontDuplicateAtoms(i){this.dontDuplicateAtoms=i}setModelData(i){this.modelData=i}propertyMatches(i,s){if(i==s)return!0;if(typeof s=="string"&&typeof i=="number"){var h=s.match(/(-?\d+)\s*-\s*(-?\d+)/);if(h){var g=parseInt(h[1]),y=parseInt(h[2]);if(h&&i>=g&&i<=y)return!0}}return!1}static deepCopyAndCache(i,s){if(typeof i!="object"||i==null||i instanceof b||i.__cache_created)return i;const h={};for(const g in i){const y=i[g];if(Array.isArray(y)){h[g]=[];for(let E=0;E<y.length;E++)h[g].push(b.deepCopyAndCache(y[E],s))}else typeof y=="object"&&g!="properties"&&g!="model"?h[g]=b.deepCopyAndCache(y,s):h[g]=y;if(g=="and"||g=="or"){const E=[];for(const l of h[g]){const f=new Set;for(const m of s.selectedAtoms(l))f.add(m.index);E.push(f)}if(g=="and"){const l=function(m,C){const T=new Set;for(const P of C)m.has(P)&&T.add(P);return T};let f=new Set(E[0]);for(const m of E.splice(1))f=l(f,m);h[g].__cached_results=f}else if(g=="or"){const l=new Set;for(const f of E)for(const m of f)l.add(m);h[g].__cached_results=l}}}return h.__cache_created=!0,h}atomIsSelected(i,s){if(typeof s>"u")return!0;var h=!!s.invert,g=!0;for(var y in s)if(y=="and"||y=="or"||y=="not"){if(y=="not"){if(this.atomIsSelected(i,s[y])){g=!1;break}}else if(s[y].__cached_results===void 0&&(s=b.deepCopyAndCache(s,this)),g=s[y].__cached_results.has(i.index),!g)break}else if(y==="predicate"){if(!s.predicate(i)){g=!1;break}}else if(y=="properties"&&i[y]){for(var E in s.properties)if(!E.startsWith("__cache")){if(typeof i.properties[E]>"u"){g=!1;break}if(i.properties[E]!=s.properties[E]){g=!1;break}}}else if(y=="model"){let C=s.model;if(typeof C=="number"&&C<0&&(C=this.viewer.getNextModelId()+C),Array.isArray(C)){let T=!1;for(let P=0;P<C.length;P++)if(C[P]==this||C[P]==this.id){T=!0;break}if(!T){g=!1;break}}else if(C!=this&&C!=this.id){g=!1;break}}else if(s.hasOwnProperty(y)&&!b.ignoredKeys.has(y)&&!y.startsWith("__cache")){if(typeof i[y]>"u"){g=!1;break}let C=!1;if(y==="bonds"){var l=s[y];if(l!=i.bonds.length){g=!1;break}}else if(Array.isArray(s[y])){var f=s[y],m=i[y];for(let T=0;T<f.length;T++)if(this.propertyMatches(m,f[T])){C=!0;break}if(!C){g=!1;break}}else{let T=s[y];if(!this.propertyMatches(i[y],T)){g=!1;break}}}return h?!g:g}static squaredDistance(i,s){var h=s.x-i.x,g=s.y-i.y,y=s.z-i.z;return h*h+g*g+y*y}expandAtomList(i,s){if(s<=0)return i;for(var h=(0,D.getExtent)(i,void 0),g=[[],[],[]],y=0;y<3;y++)g[0][y]=h[0][y]-s,g[1][y]=h[1][y]+s,g[2][y]=h[2][y];var E=[];for(let C=0;C<this.atoms.length;C++){var l=this.atoms[C].x,f=this.atoms[C].y,m=this.atoms[C].z;l>=g[0][0]&&l<=g[1][0]&&f>=g[0][1]&&f<=g[1][1]&&m>=g[0][2]&&m<=g[1][2]&&(l>=h[0][0]&&l<=h[1][0]&&f>=h[0][1]&&f<=h[1][1]&&m>=h[0][2]&&m<=h[1][2]||E.push(this.atoms[C]))}return E}static getFloat(i){return typeof i=="number"?i:parseFloat(i)}selectedAtoms(i,s){var h=[];i=b.deepCopyAndCache(i||{},this),s||(s=this.atoms);for(var g=s.length,y=0;y<g;y++){var E=s[y];E&&this.atomIsSelected(E,i)&&h.push(E)}if(i.hasOwnProperty("expand")){const H=b.getFloat(i.expand);let G=this.expandAtomList(h,H),$=h.length;const V=H*H;for(let k=0;k<G.length;k++)for(let Y=0;Y<$;Y++){var l=b.squaredDistance(G[k],h[Y]);l<V&&l>0&&h.push(G[k])}}if(i.hasOwnProperty("within")&&i.within.hasOwnProperty("sel")&&i.within.hasOwnProperty("distance")){var f=this.selectedAtoms(i.within.sel,this.atoms),m={};const H=b.getFloat(i.within.distance),G=H*H;for(let $=0;$<f.length;$++)for(let V=0;V<h.length;V++){let k=b.squaredDistance(f[$],h[V]);k<G&&k>0&&(m[V]=1)}var C=[];if(i.within.invert)for(let $=0;$<h.length;$++)m[$]||C.push(h[$]);else for(let $ in m)C.push(h[$]);h=C}if(i.hasOwnProperty("byres")){var T={},P=[],F=[];for(let H=0;H<h.length;H++){let G=h[H];var N=G.chain,B=G.resi;if(T[N]===void 0&&(T[N]={}),G.hasOwnProperty("resi")&&T[N][B]===void 0){for(T[N][B]=!0,F.push(G);F.length>0;)if(G=F.pop(),N=G.chain,B=G.resi,P[G.index]===void 0){P[G.index]=!0;for(var U=0;U<G.bonds.length;U++){var K=this.atoms[G.bonds[U]];P[K.index]===void 0&&K.hasOwnProperty("resi")&&K.chain==N&&K.resi==B&&(F.push(K),h.push(K))}}}}}return h}addAtoms(i){this.molObj=null;var s=this.atoms.length,h=[],g;for(g=0;g<i.length;g++)typeof i[g].index>"u"&&(i[g].index=g),typeof i[g].serial>"u"&&(i[g].serial=g),h[i[g].index]=s+g;for(g=0;g<i.length;g++){var y=i[g],E=h[y.index],l=(0,D.extend)({},y);l.index=E,l.bonds=[],l.bondOrder=[],l.model=this.id,l.style=l.style||(0,D.deepCopy)(b.defaultAtomStyle),typeof l.color>"u"&&(l.color=this.ElementColors[l.elem]||this.defaultColor);for(var f=y.bonds?y.bonds.length:0,m=0;m<f;m++){var C=h[y.bonds[m]];typeof C<"u"&&(l.bonds.push(C),l.bondOrder.push(y.bondOrder?y.bondOrder[m]:1))}this.atoms.push(l)}}assignBonds(){(0,w.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(i){this.molObj=null;var s=[],h;for(h=0;h<i.length;h++)s[i[h].index]=!0;var g=[];for(h=0;h<this.atoms.length;h++){var y=this.atoms[h];s[y.index]||g.push(y)}this.atoms=[],this.addAtoms(g)}setStyle(i,s,h){typeof s>"u"&&typeof h>"u"&&(s=i,i={}),i=i,typeof s=="string"&&(s=(0,D.specStringToObject)(s));var g=!1,y=this,E=function(f){var m=y.selectedAtoms(i,f);for(let C=0;C<f.length;C++)f[C]&&(f[C].capDrawn=!1);for(let C=0;C<m.length;C++){g=!0,(m[C].clickable||m[C].hoverable)&&(m[C].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),h||(m[C].style={});for(let T in s)s.hasOwnProperty(T)&&(m[C].style[T]=m[C].style[T]||{},Object.assign(m[C].style[T],s[T]))}};if(i.frame!==void 0&&i.frame<this.frames.length){let f=i.frame;f<0&&(f=this.frames.length+f),E(this.frames[f])}else{E(this.atoms);for(var l=0;l<this.frames.length;l++)this.frames[l]!==this.atoms&&E(this.frames[l])}g&&(this.molObj=null)}setClickable(i,s,h){if(s=!!s,h=(0,D.makeFunction)(h),h===null){console.log("Callback is not a function");return}var g=this.selectedAtoms(i,this.atoms),y=g.length;for(let E=0;E<y;E++)g[E].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},g[E].clickable=s,h&&(g[E].callback=h);y>0&&(this.molObj=null)}setHoverable(i,s,h,g){if(s=!!s,h=(0,D.makeFunction)(h),g=(0,D.makeFunction)(g),h===null){console.log("Hover_callback is not a function");return}if(g===null){console.log("Unhover_callback is not a function");return}var y=this.selectedAtoms(i,this.atoms),E=y.length;for(let l=0;l<E;l++)y[l].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},y[l].hoverable=s,h&&(y[l].hover_callback=h),g&&(y[l].unhover_callback=g);E>0&&(this.molObj=null)}enableContextMenu(i,s){s=!!s;var h,g=this.selectedAtoms(i,this.atoms),y=g.length;for(h=0;h<y;h++)g[h].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},g[h].contextMenuEnabled=s;y>0&&(this.molObj=null)}setColorByElement(i,s){if(!(this.molObj!==null&&b.sameObj(s,this.lastColors))){this.lastColors=s;var h=this.selectedAtoms(i,h);h.length>0&&(this.molObj=null);for(var g=0;g<h.length;g++){var y=h[g];typeof s[y.elem]<"u"&&(y.color=s[y.elem])}}}setColorByProperty(i,s,h,g){var y,E,l=this.selectedAtoms(i,l);for(this.lastColors=null,l.length>0&&(this.molObj=null),typeof h=="string"&&typeof x.Gradient.builtinGradients[h]<"u"&&(h=new x.Gradient.builtinGradients[h]),h=h,g||(g=h.range()),g||(g=(0,D.getPropertyRange)(l,s)),y=0;y<l.length;y++){E=l[y];var f=(0,D.getAtomProperty)(E,s);f!=null&&(E.color=h.valueToHex(parseFloat(E.properties[s]),g))}}setColorByFunction(i,s){var h=this.selectedAtoms(i,h);if(typeof s=="function"){this.lastColors=null,h.length>0&&(this.molObj=null);for(let g=0;g<h.length;g++){let y=h[g];y.color=s(y)}}}toCDObject(i=!1){var s={a:[],b:[]};i&&(s.s=[]);for(let g=0;g<this.atoms.length;g++){let y={},E=this.atoms[g];if(y.x=E.x,y.y=E.y,y.z=E.z,E.elem!="C"&&(y.l=E.elem),i){for(var h=0;h<s.s.length&&JSON.stringify(E.style)!==JSON.stringify(s.s[h]);)h++;h===s.s.length&&s.s.push(E.style),h!==0&&(y.s=h)}s.a.push(y);for(let l=0;l<E.bonds.length;l++){let f=g,m=E.bonds[l];if(f>=m)continue;let C={b:f,e:m},T=E.bondOrder[l];T!=1&&(C.o=T),s.b.push(C)}}return s}globj(i,s){(this.molObj===null||s.regen)&&(this.molObj=this.createMolObj(this.atoms,s),this.renderedMolObj&&(i.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),i.add(this.renderedMolObj))}exportVRML(){var i=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return i.vrml()}removegl(i){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),i.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(i,s,h){let g=this.selectedAtoms(s),y=this.viewer,E=(0,D.deepCopy)(h);for(let f=0;f<g.length;f++){let m=g[f];var l=null;typeof m[i]<"u"?l=String(m[i]):typeof m.properties[i]<"u"&&(l=String(m.properties[i])),l!=null&&(E.position=m,y.addLabel(l,E))}}addResLabels(i,s,h=!1){let g=this.viewer;var y=[],E=function(f,m){for(var C=f.selectedAtoms(i,C),T={},P=0;P<C.length;P++){var F=C[P],N=F.chain,B=F.resn,U=F.resi,K=B+""+U;T[N]||(T[N]={}),T[N][K]||(T[N][K]=[]),T[N][K].push(F)}var H=(0,D.deepCopy)(s);for(let $ in T)if(T.hasOwnProperty($)){var G=T[$];for(let V in G)if(G.hasOwnProperty(V)){let k=G[V],Y=new S.Vector3(0,0,0);for(let ne=0;ne<k.length;ne++){let he=k[ne];Y.x+=he.x,Y.y+=he.y,Y.z+=he.z}Y.divideScalar(k.length),H.position=Y,H.frame=m;let ie=g.addLabel(V,H,void 0,!0);y.push(ie)}}};if(h){var l=this.getNumFrames();let f=this.atoms;for(let m=0;m<l;m++)this.frames[m]&&(this.atoms=this.frames[m],E(this,m));this.atoms=f}else E(this);return y}setupDFS(){this.atomdfs=[];var i=this,s=new Int8Array(this.atoms.length);s.fill(0);for(var h=function(l,f,m){m.push([l,f]);var C=i.atoms[l];s[l]=1;for(var T=0;T<C.bonds.length;T++){var P=C.bonds[T];i.atoms[P]&&!s[P]&&h(P,l,m)}},g=0;g<this.atoms.length;g++){var y=this.atoms[g];if(y&&!s[g]){var E=[];h(g,-1,E),this.atomdfs.push(E)}}}setCoordinatesFromURL(i,s){this.frames=[];var h=this;return this.box&&this.setupDFS(),i.startsWith("http")||(i="http://"+i),(0,D.get)(i+"/traj/numframes/"+s,function(g){if(!isNaN(parseInt(g)))return h.frames.push(h.atoms),h.frames.numFrames=g,h.frames.url=i,h.frames.path=s,h.setFrame(0)})}setCoordinates(i,s){if(s=s||"",!i)return[];if(/\.gz$/.test(s)){s=s.replace(/\.gz$/,"");try{i=(0,D.inflateString)(i)}catch(T){console.log(T)}}var h={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(h.hasOwnProperty(s)){this.frames=[];for(var g=this.atoms.length,y=b.parseCrd(i,s),E=0;E<y.length;){for(var l=[],f=0;f<g;f++){var m={};for(var C in this.atoms[f])m[C]=this.atoms[f][C];l[f]=m,l[f].x=y[E++],l[f].y=y[E++],l[f].z=y[E++]}this.frames.push(l)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(i){}static parseCrd(i,s){var h=[],g=0;if(s=="pdb")for(var y=i.indexOf(`
ATOM`);y!=-1;){for(;i.slice(y,y+5)==`
ATOM`||i.slice(y,y+7)==`
HETATM`;)h[g++]=parseFloat(i.slice(y+31,y+39)),h[g++]=parseFloat(i.slice(y+39,y+47)),h[g++]=parseFloat(i.slice(y+47,y+55)),y=i.indexOf(`
`,y+54),i.slice(y,y+4)==`
TER`&&(y=i.indexOf(`
`,y+5));y=i.indexOf(`
ATOM`,y)}else if(s=="netcdf"){var E=new L.NetCDFReader(i);h=[].concat.apply([],E.getDataVariable("coordinates"))}else{if(s=="array"||Array.isArray(i))return i.flat(2);{let l=i.indexOf(`
`);s=="inpcrd"&&(l=i.indexOf(`
`,l+1)),i=i.slice(l+1),h=i.match(/\S+/g).map(parseFloat)}}return h}static parseMolData(i,s="",h){if(!i)return[];if(/\.gz$/.test(s)){s=s.replace(/\.gz$/,"");try{s.match(/bcif/i)?i=(0,D.inflateString)(i,!1):i=(0,D.inflateString)(i)}catch(E){console.log(E)}}typeof A.Parsers[s]>"u"&&(s=s.split(".").pop(),typeof A.Parsers[s]>"u"&&(console.log("Unknown format: "+s),i instanceof Uint8Array?s="bcif":i.match(/^@<TRIPOS>MOLECULE/gm)?s="mol2":i.match(/^data_/gm)&&i.match(/^loop_/gm)?s="cif":i.match(/^HETATM/gm)||i.match(/^ATOM/gm)?s="pdb":i.match(/ITEM: TIMESTEP/gm)?s="lammpstrj":i.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?s="sdf":i.match(/^%VERSION\s+VERSION_STAMP/gm)?s="prmtop":s="xyz",console.log("Best guess: "+s)));var g=A.Parsers[s],y=g(i,h);return y}}b.defaultAtomStyle={line:{}},b.defaultlineWidth=1,b.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},b.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])},"./src/GLShape.ts"(o,a,n){n.r(a),n.d(a,{GLShape:()=>L,splitMesh:()=>w});var d=n("./src/WebGL/index.ts"),R=n("./src/WebGL/shapes/index.ts"),S=n("./src/WebGL/math/index.ts"),j=n("./src/colors.ts"),p=n("./src/ProteinSurface4.ts"),v=n("./src/VolumeData.ts"),D=n("./src/GLDraw.ts"),x=n("./src/glcartoon.ts"),A=n("./src/utilities.ts");class L{static finalizeGeo(u){var i=u.updateGeoGroup(0);i.vertices>0&&i.truncateArrayBuffers(!0,!0)}static updateColor(u,i){i=i||j.CC.color(i),u.colorsNeedUpdate=!0;var s,h,g;i.constructor!==Array&&(s=i.r,h=i.g,g=i.b);for(let y in u.geometryGroups){let E=u.geometryGroups[y],l=E.colorArray;for(let f=0,m=E.vertices;f<m;++f){if(i.constructor===Array){let C=i[f];s=C.r,h=C.g,g=C.b}l[f*3]=s,l[f*3+1]=h,l[f*3+2]=g}}}static drawArrow(u,i,s){var h=s.start,g=s.end,y=s.radius,E=s.radiusRatio,l=s.mid,f=s.midpos;if(!(h&&g))return;var m=i.updateGeoGroup(51),C=new S.Vector3(g.x,g.y,g.z).sub(h);if(f){let ce=C.length();f>0?l=f/ce:l=(ce+f)/ce}C.multiplyScalar(l);var T=new S.Vector3(h.x,h.y,h.z).add(C),P=C.clone().negate();let F=new S.Vector3(h.x,h.y,h.z);u.intersectionShape.cylinder.push(new R.Cylinder(F,T.clone(),y)),u.intersectionShape.sphere.push(new R.Sphere(F,y));var N=[];N[0]=C.clone(),Math.abs(N[0].x)>1e-4?N[0].y+=1:N[0].x+=1,N[0].cross(C),N[0].normalize(),N[4]=N[0].clone(),N[4].crossVectors(N[0],C),N[4].normalize(),N[8]=N[0].clone().negate(),N[12]=N[4].clone().negate(),N[2]=N[0].clone().add(N[4]).normalize(),N[6]=N[4].clone().add(N[8]).normalize(),N[10]=N[8].clone().add(N[12]).normalize(),N[14]=N[12].clone().add(N[0]).normalize(),N[1]=N[0].clone().add(N[2]).normalize(),N[3]=N[2].clone().add(N[4]).normalize(),N[5]=N[4].clone().add(N[6]).normalize(),N[7]=N[6].clone().add(N[8]).normalize(),N[9]=N[8].clone().add(N[10]).normalize(),N[11]=N[10].clone().add(N[12]).normalize(),N[13]=N[12].clone().add(N[14]).normalize(),N[15]=N[14].clone().add(N[0]).normalize();var B=m.vertices,U=m.vertexArray,K=m.faceArray,H=m.normalArray,G=m.lineArray,$,V,k;for(V=0,k=N.length;V<k;++V){$=3*(B+3*V);var Y=N[V].clone().multiplyScalar(y).add(h),ie=N[V].clone().multiplyScalar(y).add(T),ne=N[V].clone().multiplyScalar(y*E).add(T);if(U[$]=Y.x,U[$+1]=Y.y,U[$+2]=Y.z,U[$+3]=ie.x,U[$+4]=ie.y,U[$+5]=ie.z,U[$+6]=ne.x,U[$+7]=ne.y,U[$+8]=ne.z,V>0){var he=U[$-3],le=U[$-2],xe=U[$-1],fe=new S.Vector3(he,le,xe),pe=new S.Vector3(g.x,g.y,g.z),Te=T.clone(),ke=new S.Vector3(ne.x,ne.y,ne.z);u.intersectionShape.triangle.push(new R.Triangle(ke,pe,fe)),u.intersectionShape.triangle.push(new R.Triangle(fe.clone(),Te,ke.clone()))}}m.vertices+=48,$=m.vertices*3,U[$]=h.x,U[$+1]=h.y,U[$+2]=h.z,U[$+3]=T.x,U[$+4]=T.y,U[$+5]=T.z,U[$+6]=g.x,U[$+7]=g.y,U[$+8]=g.z,m.vertices+=3;var $e,Le,ue,Me,Ge,Je,qe,tt,Ze,Ve,Ye,Ke,We,nt,at,q,re,se,Se,we=m.vertices-3,ze=m.vertices-2,Be=m.vertices-1,Z=we*3,ge=ze*3,Ce=Be*3;for(V=0,k=N.length-1;V<k;++V){var Ue=B+3*V;$=Ue*3,Le=m.faceidx,ue=m.lineidx,Me=Ue,Ve=Me*3,Ge=Ue+1,Ye=Ge*3,Je=Ue+2,Ke=Je*3,qe=Ue+4,We=qe*3,tt=Ue+5,nt=tt*3,Ze=Ue+3,at=Ze*3,q=re=N[V],se=Se=N[V+1],H[Ve]=q.x,H[Ye]=re.x,H[at]=Se.x,H[Ve+1]=q.y,H[Ye+1]=re.y,H[at+1]=Se.y,H[Ve+2]=q.z,H[Ye+2]=re.z,H[at+2]=Se.z,H[Ye]=re.x,H[We]=se.x,H[at]=Se.x,H[Ye+1]=re.y,H[We+1]=se.y,H[at+1]=Se.y,H[Ye+2]=re.z,H[We+2]=se.z,H[at+2]=Se.z,H[Ke]=re.x,H[nt]=se.x,H[Ke+1]=re.y,H[nt+1]=se.y,H[Ke+2]=re.z,H[nt+2]=se.z,K[Le]=Me,K[Le+1]=Ge,K[Le+2]=Ze,K[Le+3]=Ge,K[Le+4]=qe,K[Le+5]=Ze,K[Le+6]=Me,K[Le+7]=Ze,K[Le+8]=we,K[Le+9]=Je,K[Le+10]=ze,K[Le+11]=tt,K[Le+12]=Je,K[Le+13]=Be,K[Le+14]=tt,G[ue]=Me,G[ue+1]=Ge,G[ue+2]=Me,G[ue+3]=Ze,G[ue+4]=qe,G[ue+5]=Ze,G[ue+6]=Me,G[ue+7]=Ze,G[ue+8]=Je,G[ue+9]=Ge,G[ue+10]=Je,G[ue+11]=tt,G[ue+12]=qe,G[ue+13]=tt,G[ue+14]=Je,G[ue+15]=Be,G[ue+16]=Je,G[ue+17]=tt,G[ue+18]=Be,G[ue+19]=tt,m.faceidx+=15,m.lineidx+=20}$e=[B+45,B+46,B+1,B,B+47,B+2],Le=m.faceidx,ue=m.lineidx,Me=$e[0],Ve=Me*3,Ge=$e[1],Ye=Ge*3,Je=$e[4],Ke=Je*3,qe=$e[2],We=qe*3,tt=$e[5],nt=tt*3,Ze=$e[3],at=Ze*3,q=re=N[15],se=Se=N[0],H[Ve]=q.x,H[Ye]=re.x,H[at]=Se.x,H[Ve+1]=q.y,H[Ye+1]=re.y,H[at+1]=Se.y,H[Ve+2]=q.z,H[Ye+2]=re.z,H[at+2]=Se.z,H[Ye]=re.x,H[We]=se.x,H[at]=Se.x,H[Ye+1]=re.y,H[We+1]=se.y,H[at+1]=Se.y,H[Ye+2]=re.z,H[We+2]=se.z,H[at+2]=Se.z,H[Ke]=re.x,H[nt]=se.x,H[Ke+1]=re.y,H[nt+1]=se.y,H[Ke+2]=re.z,H[nt+2]=se.z,C.normalize(),P.normalize(),H[Z]=P.x,H[ge]=H[Ce]=C.x,H[Z+1]=P.y,H[ge+1]=H[Ce+1]=C.y,H[Z+2]=P.z,H[ge+2]=H[Ce+2]=C.z,K[Le]=Me,K[Le+1]=Ge,K[Le+2]=Ze,K[Le+3]=Ge,K[Le+4]=qe,K[Le+5]=Ze,K[Le+6]=Me,K[Le+7]=Ze,K[Le+8]=we,K[Le+9]=Je,K[Le+10]=ze,K[Le+11]=tt,K[Le+12]=Je,K[Le+13]=Be,K[Le+14]=tt,G[ue]=Me,G[ue+1]=Ge,G[ue+2]=Me,G[ue+3]=Ze,G[ue+4]=qe,G[ue+5]=Ze,G[ue+6]=Me,G[ue+7]=Ze,G[ue+8]=Je,G[ue+9]=Ge,G[ue+10]=Je,G[ue+11]=tt,G[ue+12]=qe,G[ue+13]=tt,G[ue+14]=Je,G[ue+15]=Be,G[ue+16]=Je,G[ue+17]=tt,G[ue+18]=Be,G[ue+19]=tt,m.faceidx+=15,m.lineidx+=20}static updateBoundingFromPoints(u,i,s,h){u.center.set(0,0,0);let g=1/0,y=1/0,E=1/0,l=-1/0,f=-1/0,m=-1/0;u.box&&(g=u.box.min.x,l=u.box.max.x,y=u.box.min.y,f=u.box.max.y,E=u.box.min.z,m=u.box.max.z);for(let F=0,N=h;F<N;F++){var C=s[F*3],T=s[F*3+1],P=s[F*3+2];C<g&&(g=C),T<y&&(y=T),P<E&&(E=P),C>l&&(l=C),T>f&&(f=T),P>m&&(m=P)}u.center.set((l+g)/2,(f+y)/2,(m+E)/2),u.radius=u.center.distanceTo({x:l,y:f,z:m}),u.box={min:{x:g,y,z:E},max:{x:l,y:f,z:m}}}static addCustomGeo(u,i,s,h,g){var y=i.addGeoGroup(),E=s.vertexArr,l=s.normalArr,f=s.faceArr;y.vertices=E.length,y.faceidx=f.length;var m,C,T,P,F,N,B,U,K,H=y.vertexArray,G=y.colorArray;for(h.constructor!==Array&&(U=h.r,K=h.g,P=h.b),N=0,B=y.vertices;N<B;++N)m=N*3,C=E[N],H[m]=C.x,H[m+1]=C.y,H[m+2]=C.z,h.constructor===Array&&(F=h[N],U=F.r,K=F.g,P=F.b),G[m]=U,G[m+1]=K,G[m+2]=P;if(g)for(N=0,B=y.faceidx/3;N<B;++N){m=N*3,T=f[m],P=f[m+1],F=f[m+2];var $=new S.Vector3,V=new S.Vector3,k=new S.Vector3;u.intersectionShape.triangle.push(new R.Triangle($.copy(E[T]),V.copy(E[P]),k.copy(E[F])))}if(g){var Y=new S.Vector3(0,0,0),ie=0;for(let le=0;le<i.geometryGroups.length;le++)Y.add(i.geometryGroups[le].getCentroid()),ie++;Y.divideScalar(ie),L.updateBoundingFromPoints(u.boundingSphere,{centroid:Y},H,y.vertices)}if(y.faceArray=new Uint16Array(f),y.truncateArrayBuffers(!0,!0),l.length<y.vertices)y.setNormals();else{var ne=y.normalArray=new Float32Array(y.vertices*3),he;for(N=0,B=y.vertices;N<B;++N)m=N*3,he=l[N],ne[m]=he.x,ne[m+1]=he.y,ne[m+2]=he.z}y.setLineIndices(),y.lineidx=y.lineArray.length}static updateFromStyle(u,i){typeof i.color<"u"?(u.color=i.color||new j.Color,i.color instanceof j.Color||(u.color=j.CC.color(i.color))):u.color=j.CC.color(0),u.wireframe=!!i.wireframe,u.opacity=i.alpha?(0,S.clamp)(i.alpha,0,1):1,typeof i.opacity<"u"&&(u.opacity=(0,S.clamp)(i.opacity,0,1)),u.side=i.side!==void 0?i.side:d.DoubleSide,u.linewidth=typeof i.linewidth>"u"?1:i.linewidth,u.clickable=!!i.clickable,u.callback=(0,A.makeFunction)(i.callback),u.hoverable=!!i.hoverable,u.hover_callback=(0,A.makeFunction)(i.hover_callback),u.unhover_callback=(0,A.makeFunction)(i.unhover_callback),u.contextMenuEnabled=!!i.contextMenuEnabled,u.hidden=i.hidden,u.frame=i.frame}constructor(u){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=d.DoubleSide,this.stylespec=u||{},this.boundingSphere=new R.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},L.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new d.Geometry(!0),this.linegeo=new d.Geometry(!0)}updateStyle(u){for(var i in u)this.stylespec[i]=u[i];if(L.updateFromStyle(this,this.stylespec),u.voldata&&u.volscheme){(0,A.adjustVolumeStyle)(u);const s=u.volscheme,h=u.voldata,g=j.CC,y=s.range()||[-1,1];this.geo.setColors(function(E,l,f){let m=h.getVal(E,l,f);return g.color(s.valueToHex(m,y))}),delete this.color}}addCustom(u){u.vertexArr=u.vertexArr||[],u.faceArr=u.faceArr||[],u.normalArr=u.normalArr||[],L.drawCustom(this,this.geo,u)}addSphere(u){u.center||(u.center=new S.Vector3(0,0,0)),u.radius=u.radius?(0,S.clamp)(u.radius,0,1/0):1.5,u.color=j.CC.color(u.color),this.intersectionShape.sphere.push(new R.Sphere(u.center,u.radius)),D.GLDraw.drawSphere(this.geo,u.center,u.radius,u.color,u.quality),this.components.push({centroid:new S.Vector3(u.center.x,u.center.y,u.center.z)});var i=this.geo.updateGeoGroup(0);L.updateBoundingFromPoints(this.boundingSphere,this.components,i.vertexArray,i.vertices)}addBox(u){var i=u.dimensions||{w:1,h:1,d:1},s;typeof i.w=="number"?s={x:i.w,y:0,z:0}:s=i.w;var h;typeof i.h=="number"?h={x:0,y:i.h,z:0}:h=i.h;var g;typeof i.d=="number"?g={x:0,y:0,z:i.d}:g=i.d;var y=u.corner;y==null&&(u.center!==void 0?y={x:u.center.x-.5*(s.x+h.x+g.x),y:u.center.y-.5*(s.y+h.y+g.y),z:u.center.z-.5*(s.z+h.z+g.z)}:y={x:0,y:0,z:0});var E=[{x:y.x,y:y.y,z:y.z},{x:y.x+s.x,y:y.y+s.y,z:y.z+s.z},{x:y.x+h.x,y:y.y+h.y,z:y.z+h.z},{x:y.x+s.x+h.x,y:y.y+s.y+h.y,z:y.z+s.z+h.z},{x:y.x+g.x,y:y.y+g.y,z:y.z+g.z},{x:y.x+s.x+g.x,y:y.y+s.y+g.y,z:y.z+s.z+g.z},{x:y.x+h.x+g.x,y:y.y+h.y+g.y,z:y.z+h.z+g.z},{x:y.x+s.x+h.x+g.x,y:y.y+s.y+h.y+g.y,z:y.z+s.z+h.z+g.z}],l=[],f=[];l.splice(l.length,0,E[0],E[1],E[2],E[3]),f.splice(f.length,0,0,2,1,1,2,3);var m=4;l.splice(l.length,0,E[2],E[3],E[6],E[7]),f.splice(f.length,0,m+0,m+2,m+1,m+1,m+2,m+3),m+=4,l.splice(l.length,0,E[4],E[5],E[0],E[1]),f.splice(f.length,0,m+0,m+2,m+1,m+1,m+2,m+3),m+=4,l.splice(l.length,0,E[6],E[7],E[4],E[5]),f.splice(f.length,0,m+0,m+2,m+1,m+1,m+2,m+3),m+=4,l.splice(l.length,0,E[3],E[1],E[7],E[5]),f.splice(f.length,0,m+0,m+2,m+1,m+1,m+2,m+3),m+=4,l.splice(l.length,0,E[2],E[6],E[0],E[4]),f.splice(f.length,0,m+0,m+2,m+1,m+1,m+2,m+3),m+=4;var C=(0,A.extend)({},u);C.vertexArr=l,C.faceArr=f,C.normalArr=[],L.drawCustom(this,this.geo,C);var T=new S.Vector3;this.components.push({centroid:T.addVectors(E[0],E[7]).multiplyScalar(.5)});var P=this.geo.updateGeoGroup(0);L.updateBoundingFromPoints(this.boundingSphere,this.components,P.vertexArray,P.vertices)}addCylinder(u){var i,s;u.start?i=new S.Vector3(u.start.x||0,u.start.y||0,u.start.z||0):i=new S.Vector3(0,0,0),u.end?(s=new S.Vector3(u.end.x,u.end.y||0,u.end.z||0),typeof s.x>"u"&&(s.x=3)):s=new S.Vector3(0,0,0);var h=u.radius||.1,g=j.CC.color(u.color);this.intersectionShape.cylinder.push(new R.Cylinder(i,s,h)),D.GLDraw.drawCylinder(this.geo,i,s,h,g,u.fromCap,u.toCap);var y=new S.Vector3;this.components.push({centroid:y.addVectors(i,s).multiplyScalar(.5)});var E=this.geo.updateGeoGroup(0);L.updateBoundingFromPoints(this.boundingSphere,this.components,E.vertexArray,E.vertices)}addDashedCylinder(u){u.dashLength=u.dashLength||.25,u.gapLength=u.gapLength||.25;var i;u.start?i=new S.Vector3(u.start.x||0,u.start.y||0,u.start.z||0):i=new S.Vector3(0,0,0);var s;u.end?(s=new S.Vector3(u.end.x,u.end.y||0,u.end.z||0),typeof s.x>"u"&&(s.x=3)):s=new S.Vector3(3,0,0);for(var h=u.radius||.1,g=j.CC.color(u.color),y=Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2)+Math.pow(i.z-s.z,2)),E=y/(u.gapLength+u.dashLength),l=new S.Vector3(u.start.x||0,u.start.y||0,u.start.z||0),f=new S.Vector3(u.end.x,u.end.y||0,u.end.z||0),m=new S.Vector3((s.x-i.x)/(y/u.gapLength),(s.y-i.y)/(y/u.gapLength),(s.z-i.z)/(y/u.gapLength)),C=new S.Vector3((s.x-i.x)/(y/u.dashLength),(s.y-i.y)/(y/u.dashLength),(s.z-i.z)/(y/u.dashLength)),T=0;T<E;T++)f=new S.Vector3(l.x+C.x,l.y+C.y,l.z+C.z),this.intersectionShape.cylinder.push(new R.Cylinder(l,f,h)),D.GLDraw.drawCylinder(this.geo,l,f,h,g,u.fromCap,u.toCap),l=new S.Vector3(f.x+m.x,f.y+m.y,f.z+m.z);var P=new S.Vector3;this.components.push({centroid:P.addVectors(i,s).multiplyScalar(.5)});var F=this.geo.updateGeoGroup(0);L.updateBoundingFromPoints(this.boundingSphere,this.components,F.vertexArray,F.vertices)}addCurve(u){u.points=u.points||[],u.smooth=u.smooth||10,typeof u.fromCap>"u"&&(u.fromCap=2),typeof u.toCap>"u"&&(u.toCap=2);var i=(0,x.subdivide_spline)(u.points,u.smooth);if(i.length<3){console.log("Too few points in addCurve");return}var s=u.radius||.1,h=j.CC.color(u.color),g=0,y=i.length-1,E=i[0].distanceTo(i[1]),l=Math.ceil(2*s/E);if(u.toArrow){y-=l;let T={start:i[y],end:i[i.length-1],radius:s,color:h,mid:1e-4};this.addArrow(T)}if(u.fromArrow){g+=l;let T={start:i[g],end:i[0],radius:s,color:h,mid:1e-4};this.addArrow(T)}for(var f=Math.ceil(i.length/2),m={radius:s,color:h,fromCap:2,toCap:2},C=g;C<y;C++)m.start=i[C],m.end=i[C+1],m.fromCap=2,m.toCap=2,C<f?(m.fromCap=2,m.toCap=0):C>f?(m.fromCap=0,m.toCap=2):(m.fromCap=2,m.toCap=2),this.addCylinder(m)}addLine(u){var i,s;u.start?i=new S.Vector3(u.start.x||0,u.start.y||0,u.start.z||0):i=new S.Vector3(0,0,0),u.end?(s=new S.Vector3(u.end.x,u.end.y||0,u.end.z||0),typeof s.x>"u"&&(s.x=3)):s=new S.Vector3(3,0,0);var h=this.geo.updateGeoGroup(2),g=h.vertices,y=g*3,E=h.vertexArray;E[y]=i.x,E[y+1]=i.y,E[y+2]=i.z,E[y+3]=s.x,E[y+4]=s.y,E[y+5]=s.z,h.vertices+=2;var l=h.lineArray,f=h.lineidx;l[f]=g,l[f+1]=g+1,h.lineidx+=2;var m=new S.Vector3;this.components.push({centroid:m.addVectors(i,s).multiplyScalar(.5)}),h=this.geo.updateGeoGroup(0),L.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}addArrow(u){if(u.start?u.start=new S.Vector3(u.start.x||0,u.start.y||0,u.start.z||0):u.start=new S.Vector3(0,0,0),u.dir instanceof S.Vector3&&typeof u.length=="number"){var i=u.dir.clone().multiplyScalar(u.length).add(u.start);u.end=i}else u.end?(u.end=new S.Vector3(u.end.x,u.end.y||0,u.end.z||0),typeof u.end.x>"u"&&(u.end.x=3)):u.end=new S.Vector3(3,0,0);u.radius=u.radius||.1,u.radiusRatio=u.radiusRatio||1.618034,u.mid=0<u.mid&&u.mid<1?u.mid:.618034,L.drawArrow(this,this.geo,u);var s=new S.Vector3;this.components.push({centroid:s.addVectors(u.start,u.end).multiplyScalar(.5)});var h=this.geo.updateGeoGroup(0);L.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}static distance_from(u,i){return Math.sqrt(Math.pow(u.x-i.x,2)+Math.pow(u.y-i.y,2)+Math.pow(u.z-i.z,2))}static inSelectedRegion(u,i,s){for(var h=0;h<i.length;h++)if(L.distance_from(i[h],u)<=s)return!0;return!1}addIsosurface(u,i,s,h){var g=i.isoval!==void 0&&typeof i.isoval=="number"?i.isoval:0,y=!!i.voxel,E=i.smoothness===void 0?1:i.smoothness,l=u.size.x,f=u.size.y,m=u.size.z,C=new Int16Array(l*f*m),T=u.data,P,F;for(P=0,F=C.length;P<F;++P)C[P]=-1;var N=new Uint8Array(l*f*m);for(P=0,F=T.length;P<F;++P){var B=g>=0?T[P]-g:g-T[P];B>0&&(N[P]|=L.ISDONE)}var U=[],K=[];p.MarchingCube.march(N,U,K,{fulltable:!0,voxel:y,unitCube:u.unit,origin:u.origin,matrix:u.matrix,nX:l,nY:f,nZ:m}),!y&&E>0&&p.MarchingCube.laplacianSmooth(E,U,K);var H=[],G=[],$=[];if(i.selectedRegion&&i.coords===void 0&&(i.coords=i.selectedRegion),i.coords===void 0&&i.selection!==void 0&&(h?i.coords=h.selectedAtoms(i.selection):console.log("addIsosurface needs viewer is selection provided.")),i.coords!==void 0){var V=i.coords[0].x,k=i.coords[0].y,Y=i.coords[0].z,ie=i.coords[0].x,ne=i.coords[0].y,he=i.coords[0].z;for(let ue=0;ue<i.coords.length;ue++)i.coords[ue].x>V?V=i.coords[ue].x:i.coords[ue].x<ie&&(ie=i.coords[ue].x),i.coords[ue].y>k?k=i.coords[ue].y:i.coords[ue].y<ne&&(ne=i.coords[ue].y),i.coords[ue].z>Y?Y=i.coords[ue].z:i.coords[ue].z<he&&(he=i.coords[ue].z);var le=2;i.radius!==void 0&&(le=i.radius),i.selectedOffset!==void 0&&(le=i.selectedOffset),i.seldist!==void 0&&(le=i.seldist),ie-=le,V+=le,ne-=le,k+=le,he-=le,Y+=le;for(let ue=0;ue<U.length;ue++)U[ue].x>ie&&U[ue].x<V&&U[ue].y>ne&&U[ue].y<k&&U[ue].z>he&&U[ue].z<Y&&L.inSelectedRegion(U[ue],i.coords,le)?(H.push(G.length),G.push(U[ue])):H.push(-1);for(let ue=0;ue+2<K.length;ue+=3)H[K[ue]]!==-1&&H[K[ue+1]]!==-1&&H[K[ue+2]]!==-1&&($.push(K[ue]-(K[ue]-H[K[ue]])),$.push(K[ue+1]-(K[ue+1]-H[K[ue+1]])),$.push(K[ue+2]-(K[ue+2]-H[K[ue+2]])));U=G,K=$}L.drawCustom(this,this.geo,{vertexArr:U,faceArr:K,normalArr:[],clickable:i.clickable,hoverable:i.hoverable}),this.updateStyle(i);var xe=new S.Vector3(u.origin.x,u.origin.y,u.origin.z),fe=new S.Vector3(u.size.x*u.unit.x,u.size.y*u.unit.y,u.size.z*u.unit.z),pe=new S.Vector3(0,0,0),Te=xe.clone(),ke=xe.clone().add(fe);for(let ue=0;ue<U.length;ue++)pe.add(U[ue]),Te.max(U[ue]),ke.min(U[ue]);pe.divideScalar(U.length);var $e=pe.distanceTo(ke),Le=pe.distanceTo(Te);this.boundingSphere.center=pe,this.boundingSphere.radius=Math.max($e,Le),typeof s=="function"&&s()}addVolumetricData(u,i,s){u=new v.VolumeData(u,i),this.addIsosurface(u,s)}finalize(){return L.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(u){if(this.renderedShapeObj&&(u.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){L.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&L.updateColor(this.geo,this.color),this.shapeObj=new d.Object3D;var i=null;this.side==d.DoubleSide?i=new d.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:d.Coloring.VertexColors}):i=new d.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:d.Coloring.VertexColors});var s=new d.Mesh(this.geo,i);if(this.shapeObj.add(s),this.linegeo&&this.linegeo.vertices>0){var h=new d.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),g=new d.Line(this.linegeo,h,d.LineStyle.LinePieces);this.shapeObj.add(g)}this.renderedShapeObj=this.shapeObj.clone(),u.add(this.renderedShapeObj)}}removegl(u){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),u.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}L.ISDONE=2,L.drawCustom=function(b,u,i){var s=i,h=s.vertexArr,g=s.faceArr;(h.length===0||g.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var y=i.color;typeof y>"u"&&(y=b.color),y=j.CC.color(y);for(var E=w(s),l=0,f=E.length;l<f;l++)L.addCustomGeo(b,u,E[l],E[l].colorArr?E[l].colorArr:y,i.clickable)};function w(b){var u=64e3;if(b.vertexArr.length<u)return[b];var i=[{vertexArr:[],normalArr:[],faceArr:[]}];b.colorArr&&(i.colorArr=[]);var s=[],h=[],g=0,y=b.faceArr;for(let l=0,f=y.length;l<f;l+=3){let m=i[g];for(let C=0;C<3;C++){var E=y[l+C];s[E]!==g&&(s[E]=g,h[E]=m.vertexArr.length,m.vertexArr.push(b.vertexArr[E]),b.normalArr&&b.normalArr[E]&&m.normalArr.push(b.normalArr[E]),b.colorArr&&b.colorArr[E]&&m.colorArr.push(b.colorArr[E])),m.faceArr.push(h[E])}m.vertexArr.length>=u&&(i.push({vertexArr:[],normalArr:[],faceArr:[]}),b.colorArr&&(i.colorArr=[]),g++)}return i}},"./src/GLViewer.ts"(o,a,n){n.r(a),n.d(a,{CONTEXTS_PER_VIEWPORT:()=>u,GLViewer:()=>s,createStereoViewer:()=>y,createViewer:()=>h,createViewerGrid:()=>g});var d=n("./node_modules/upng-js/UPNG.js"),R=n("./src/GLModel.ts"),S=n("./src/GLShape.ts"),j=n("./src/Gradient.ts"),p=n("./src/Label.ts"),v=n("./src/ProteinSurface4.ts"),D=n("./src/VolumeData.ts"),x=n("./src/VolumetricRender.ts"),A=n("./src/WebGL/index.ts"),L=n("./src/WebGL/math/index.ts"),w=n("./src/colors.ts"),b=n("./src/utilities.ts");const u=16;class i extends Array{constructor(l){super(...l)}getSymmetries(){if(this.length==0)return[];let l=this[0];return typeof l.symmetries>"u"&&this.setSymmetries([new L.Matrix4]),l.symmetries}setSymmetries(l){typeof l>"u"&&(l=[new L.Matrix4]);for(let f of this)f.symmetries=l,f.finished=!1}}class s{getWidth(){let l=this.container,f=l.offsetWidth;if(f==0&&l.style.display==="none"){let m=l.style.position,C=l.style.visibility;l.style.display="block",l.style.visibility="hidden",l.style.position="absolute",f=l.offsetWidth,l.style.display="none",l.style.visibility=C,l.style.position=m}return f}getHeight(){let l=this.container,f=l.offsetHeight;if(f==0&&l.style.display==="none"){let m=l.style.position,C=l.style.visibility;l.style.display="block",l.style.visibility="hidden",l.style.position="absolute",f=l.offsetHeight,l.style.display="none",l.style.visibility=C,l.style.position=m}return f}setupRenderer(){let l=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new A.Renderer(l),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new A.Scene,this.scene.fog=new A.Fog(this.bgColor,100,200),this.modelGroup=new A.Object3D,this.rotationGroup=new A.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new L.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var l=new A.Light(16777215);l.position=new L.Vector3(.2,.2,1).normalize(),l.intensity=1,this.scene.add(l)}_handleLostContext(l){const f=function(m){const C=m.getBoundingClientRect();return!(C.right<0||C.bottom<0||C.top>(window.innerHeight||document.documentElement.clientHeight)||C.left>(window.innerWidth||document.documentElement.clientWidth))};if(f(this.container)){let m=0;for(let C of document.getElementsByTagName("canvas"))if(f(C)&&C._3dmol_viewer!=null&&(C._3dmol_viewer.resize(),m+=1,m>=u))break}}initContainer(l){this.container=l,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var l=0;for(let m in this.surfaces)if(this.surfaces.hasOwnProperty(m)){var f=parseInt(m);isNaN(f)||f>l&&(l=f)}return l+1}setSlabAndFog(){let l=this.camera.position.z-this.rotationGroup.position.z;l<1&&(l=1),this.camera.near=l+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=l+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=l*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(l){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!l&&this.linkedViewers.length>0))for(var f=this._viewer.getView(),m=0;m<this.linkedViewers.length;m++){var C=this.linkedViewers[m];C.setView(f,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let l=0,f=this.models.length;l<f;l++){let m=this.models[l];if(m){let C=m.selectedAtoms({clickable:!0}),T=m.selectedAtoms({hoverable:!0}),P=m.selectedAtoms({contextMenuEnabled:!0});for(let F=0;F<T.length;F++)this.hoverables.push(T[F]);for(let F=0;F<C.length;F++)this.clickables.push(C[F]);for(let F=0;F<P.length;F++)this.contextMenuEnabledObjects.push(P[F])}}for(let l=0,f=this.shapes.length;l<f;l++){let m=this.shapes[l];m&&m.clickable&&this.clickables.push(m),m&&m.hoverable&&this.hoverables.push(m),m&&m.contextMenuEnabled&&this.contextMenuEnabledObjects.push(m)}}handleClickSelection(l,f,m){let C=this.targetedObjects(l,f,this.clickables);if(C.length){var T=C[0].clickable;T.callback!==void 0&&(typeof T.callback!="function"&&(T.callback=(0,b.makeFunction)(T.callback)),typeof T.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(T)&&this.userContextMenuHandler||T.callback(T,this._viewer,m,this.container,C)))}}canvasOffset(){let l=this.glDOM,f=l.getBoundingClientRect(),m=l.ownerDocument,C=m.documentElement,T=m.defaultView;return{top:f.top+T.pageYOffset-C.clientTop,left:f.left+T.pageXOffset-C.clientLeft}}setHover(l,f,m){this.current_hover!=l&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,b.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,f,this.container,m)),this.current_hover=l,l&&l.hover_callback!==void 0&&(typeof l.hover_callback!="function"&&(l.hover_callback=(0,b.makeFunction)(l.hover_callback)),typeof l.hover_callback=="function"&&l.hover_callback(l,this._viewer,f,this.container,m)))}handleHoverSelection(l,f,m){if(this.hoverables.length==0)return;let C=this.targetedObjects(l,f,this.hoverables);if(C.length){var T=C[0].clickable;this.setHover(T,m,C),this.current_hover=T}else this.setHover(null)}handleHoverContinue(l,f){let m=this.targetedObjects(l,f,this.hoverables);(m.length==0||m[0]===void 0)&&this.setHover(null),m[0]!==void 0&&m[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(l,{allowTolerance:f=l.targetTouches,tolerance:m=5}={}){const C=this.getX(l),T=this.getY(l);if(f){const P=Math.abs(C-this.mouseStartX),F=Math.abs(T-this.mouseStartY);return P<=m&&F<=m}else return C===this.mouseStartX&&T===this.mouseStartY}calcTouchDistance(l){var f=l.targetTouches[0].pageX-l.targetTouches[1].pageX,m=l.targetTouches[0].pageY-l.targetTouches[1].pageY;return Math.hypot(f,m)}getX(l){var f=l.pageX;return f==null&&(f=l.pageX),l.targetTouches&&l.targetTouches[0]?f=l.targetTouches[0].pageX:l.changedTouches&&l.changedTouches[0]&&(f=l.changedTouches[0].pageX),f}getY(l){var f=l.pageY;return f==null&&(f=l.pageY),l.targetTouches&&l.targetTouches[0]?f=l.targetTouches[0].pageY:l.changedTouches&&l.changedTouches[0]&&(f=l.changedTouches[0].pageY),f}isInViewer(l,f){if(this.viewers!=null){var m=this.WIDTH/this.cols,C=this.HEIGHT/this.rows,T=this.canvasOffset(),P=l-T.left,F=f-T.top,N=this.rows-Math.floor(F/C)-1,B=Math.floor(P/m);if(N!=this.row||B!=this.col)return!1}return!0}adjustZoomToLimits(l){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let f=this.CAMERA_Z-this.config.lowerZoomLimit;l>f&&(l=f)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let f=this.CAMERA_Z-this.config.upperZoomLimit;l<f&&(l=f)}return l>this.CAMERA_Z-1&&(l=this.CAMERA_Z-1),l}static slerp(l,f,m){if(m==1)return f.clone();if(m==0)return l.clone();let C=l.x*f.x+l.y*f.y+l.z*f.z+l.w*f.w;if(C>.9995){let K=new L.Quaternion(l.x+m*(f.x-l.x),l.y+m*(f.y-l.y),l.z+m*(f.z-l.z),l.w+m*(f.w-l.w));return K.normalize(),K}C<0&&(f=f.clone().multiplyScalar(-1),C=-C),C>1?C=1:C<-1&&(C=-1);var T=Math.acos(C),P=T*m,F=f.clone();F.sub(l.clone().multiplyScalar(C)),F.normalize();var N=Math.cos(P),B=Math.sin(P),U=new L.Quaternion(l.x*N+F.x*B,l.y*N+F.y*B,l.z*N+F.z*B,l.w*N+F.w*B);return U.normalize(),U}constructor(l,f={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new L.Quaternion(0,0,0,1),this.dq=new L.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=f,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=w.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=w.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=l,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new A.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new L.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new L.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new A.Raycaster(new L.Vector3(0,0,0),new L.Vector3(0,0,0)),this.projector=new A.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=w.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let m=(C,T)=>{C.forEach(P=>{P.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(m),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(m){console.log("error with glviewer callback: "+m)}}targetedObjects(l,f,m){var C={x:l,y:f,z:-1};return Array.isArray(m)||(m=this.selectedAtoms(m)),m.length==0?[]:(this.raycaster.setFromCamera(C,this.camera),this.raycaster.intersectObjects(this.modelGroup,m))}modelToScreen(l){let f=!1;Array.isArray(l)||(l=[l],f=!0);let m=this.renderer.getXRatio(),C=this.renderer.getYRatio(),T=this.col,P=this.row,F=T*(this.WIDTH/m),N=(C-P-1)*(this.HEIGHT/C),B=[],U=this.canvasOffset();return l.forEach(K=>{let H=new L.Vector3(K.x,K.y,K.z);H.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(H,this.camera);let G=this.WIDTH/m*(H.x+1)/2+U.left+F,$=-(this.HEIGHT/C)*(H.y-1)/2+U.top+N;B.push({x:G,y:$})}),f&&(B=B[0]),B}screenOffsetToModel(l,f,m){var C=l/this.WIDTH,T=f/this.HEIGHT,P=m===void 0?this.rotationGroup.position.z:m,F=this.rotationGroup.quaternion,N=new L.Vector3(0,0,P);return this.projector.projectVector(N,this.camera),N.x+=C*2,N.y-=T*2,this.projector.unprojectVector(N,this.camera),N.z=0,N.applyQuaternion(F),N}screenToModelDistance(l,f){let m=this.canvasOffset(),C=new L.Vector3(f.x,f.y,f.z);C.applyMatrix4(this.modelGroup.matrixWorld);let T=C.clone();this.projector.projectVector(C,this.camera);let P=new L.Vector3((l.x-m.left)*2/this.WIDTH-1,(l.y-m.top)*2/-this.HEIGHT+1,C.z);return this.projector.unprojectVector(P,this.camera),P.distanceTo(T)}setViewChangeCallback(l){(typeof l=="function"||l==null)&&(this.viewChangeCallback=l)}setStateChangeCallback(l){(typeof l=="function"||l==null)&&(this.stateChangeCallback=l)}getConfig(){return this.config}setConfig(l){this.config=l,l.ambientOcclusion&&this.renderer.enableAmbientOcclusion(l.ambientOcclusion)}getInternalState(){var l={models:[],surfaces:[],shapes:[],labels:[]};for(let f=0;f<this.models.length;f++)this.models[f]&&(l.models[f]=this.models[f].getInternalState());return l}setInternalState(l){this.clear();var f=l.models;for(let m=0;m<f.length;m++)f[m]&&(this.models[m]=new R.GLModel(m,void 0,this),this.models[m].setInternalState(f[m]));this.render()}setZoomLimits(l,f){typeof l<"u"&&(this.config.lowerZoomLimit=l),f&&(this.config.upperZoomLimit=f),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(l){l.fov!==void 0&&(this.fov=l.fov,this.camera.fov=this.fov),l.z!==void 0&&(this.CAMERA_Z=l.z,this.camera.z=this.CAMERA_Z),l.orthographic!==void 0&&(this.camera.ortho=l.orthographic),this.setSlabAndFog()}_handleMouseDown(l){if(l.preventDefault(),!this.scene)return;var f=this.getX(l),m=this.getY(l);if(f===void 0)return;this.isDragging=!0,this.mouseButton=l.which,this.mouseStartX=f,this.mouseStartY=m,this.touchHold=!0,this.touchDistanceStart=0,l.targetTouches&&l.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(l)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let C=this;l.targetTouches&&l.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(C.touchHold==!0){C.glDOM=C.renderer.domElement;const T=l.targetTouches[0],P=new PointerEvent("contextmenu",Object.assign(Object.assign({},l),{pageX:T.pageX,pageY:T.pageY,screenX:T.screenX,screenY:T.screenY,clientX:T.clientX,clientY:T.clientY}));C.glDOM.dispatchEvent(P)}},this.longTouchDuration))}_handleMouseUp(l){if(this.touchHold=!1,this.isDragging&&this.scene){var f=this.getX(l),m=this.getY(l);if(this.closeEnoughForClick(l)&&this.isInViewer(f,m)){let C=this.mouseXY(f,m);this.handleClickSelection(C.x,C.y,l)}}this.isDragging=!1}_handleMouseScroll(l){if(l.preventDefault(),!!this.scene){var f=this.getX(l),m=this.getY(l);if(f!==void 0&&!(!this.control_all&&!this.isInViewer(f,m))){var C=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,T=1;if(l.ctrlKey&&(T=-1),l.detail)this.rotationGroup.position.z+=T*C*l.detail/10;else if(l.wheelDelta){let P=l.wheelDelta*600/(l.wheelDelta+600);this.rotationGroup.position.z-=T*C*P/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(l){let f=this;return l=l||1,new Promise(function(m){let C=0,T=f.viewChangeCallback,P=[],F=[],N=Date.now();f.viewChangeCallback=function(){F.push(Date.now()-N),N=Date.now(),P.push(new Promise(B=>{f.getCanvas().toBlob(function(U){U.arrayBuffer().then(B)},"image/png")})),C+=1,C==l&&(f.viewChangeCallback=T,Promise.all(P).then(B=>{let U=[];for(let k=0;k<B.length;k++){let Y=(0,d.decode)(B[k]);U.push((0,d.toRGBA8)(Y)[0])}let K=f.getCanvas().width,H=f.getCanvas().height,G=(0,d.encode)(U,K,H,0,F),$=new Blob([G],{type:"image/png"}),V=new FileReader;V.onload=function(k){m(k.target.result)},V.readAsDataURL($)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(l){this.hoverDuration=l}mouseXY(l,f){let m=this.canvasOffset(),C=this.renderer.getXRatio(),T=this.renderer.getYRatio(),P=this.col,F=this.row,N=P*(this.WIDTH/C),B=(T-F-1)*(this.HEIGHT/T),U=(l-m.left-N)/(this.WIDTH/C)*2-1,K=-((f-m.top-B)/(this.HEIGHT/T))*2+1;return{x:U,y:K}}_handleMouseMove(l){clearTimeout(this.hoverTimeout),l.preventDefault();let f=this.getX(l),m=this.getY(l);if(f===void 0)return;let C=this.renderer.getXRatio(),T=this.renderer.getYRatio(),P=this.mouseXY(f,m),F=this;this.current_hover!==null&&this.handleHoverContinue(P.x,P.y);var N=0;if(!(!this.control_all&&!this.isInViewer(f,m))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){F.handleHoverSelection(P.x,P.y,l)},this.hoverDuration)),!!this.isDragging)){l.targetTouches&&(l.targetTouches.length>1||l.targetTouches.length===1&&!this.closeEnoughForClick(l))&&clearTimeout(this.longTouchTimeout);var B=(f-this.mouseStartX)/this.WIDTH,U=(m-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&l.targetTouches&&l.targetTouches.length==2){var K=this.calcTouchDistance(l);N=2,U=(K-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else l.targetTouches&&l.targetTouches.length==3&&(N=1);B*=C,U*=T;var H=Math.hypot(B,U),G;if(N==3||this.mouseButton==3&&l.ctrlKey)this.slabNear=this.cslabNear+B*100,this.slabFar=this.cslabFar-U*100;else if(N==2||this.mouseButton==3||l.shiftKey)G=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,G<80&&(G=80),this.rotationGroup.position.z=this.cz+U*G,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(N==1||this.mouseButton==2||l.ctrlKey){var $=this.screenOffsetToModel(C*(f-this.mouseStartX),T*(m-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,$)}else if((N===0||this.mouseButton==1)&&H!==0){var V=Math.sin(H*Math.PI)/H;this.dq.x=Math.cos(H*Math.PI),this.dq.y=0,this.dq.z=V*B,this.dq.w=-V*U,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(l){if(l.preventDefault(),this.closeEnoughForClick(l)){var C=this.mouseStartX,T=this.mouseStartY,m=this.canvasOffset();let P=this.mouseXY(C,T),F=P.x,N=P.y,B=this.targetedObjects(F,N,this.contextMenuEnabledObjects);var f=null;B.length&&(f=B[0].clickable);var m=this.canvasOffset(),C=this.mouseStartX-m.left,T=this.mouseStartY-m.top;this.userContextMenuHandler&&(this.userContextMenuHandler(f,C,T,B,l),this.isDragging=!1)}}setContainer(l){let f=(0,b.getElement)(l)||this.container;return this.initContainer(f),this}setBackgroundColor(l,f){(typeof f>"u"||f<0||f>1)&&(f=1);var m=w.CC.color(l);return this.scene.fog.color=m,this.bgColor=m.getHex(),this.renderer.setClearColorHex(m.getHex(),f),this.show(),this}setProjection(l){this.camera.ortho=l==="orthographic",this.setSlabAndFog()}setViewStyle(l){if(l=l||{},l.style=l.style||"",l.style.includes("outline")?this.renderer.enableOutline(l):this.renderer.disableOutline(),l.style.includes("ambientOcclusion")){var f={};l.strength&&(f.strength=l.strength),l.radius&&(f.radius=l.radius),this.renderer.enableAmbientOcclusion(f)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(l){return this.WIDTH=l||this.WIDTH,this.updateSize(),this}setHeight(l){return this.HEIGHT=l||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let l=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let f=!1,m=this.container.querySelector("canvas");m&&m!=this.renderer.getCanvas()?this.config.canvas=m:(m.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,f=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),l=!0,f&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),l){let f=this.renderer.supportedExtensions();if(f.regen=!0,this.viewers)for(let m=0,C=this.viewers.length;m<C;m++)for(let T=0,P=this.viewers[m].length;T<P;T++)this.viewers[m][T].render(null,f);this._viewer.render(null,f)}else this.WIDTH>0&&this.HEIGHT>0&&this.show();return this}getModel(l){return l===void 0?this.models.length==0?null:this.models[this.models.length-1]:l instanceof R.GLModel?l:l in this.models?this.models[l]:this.models.length==0?null:this.models[this.models.length-1]}spin(l,f=1,m=!1){if(clearInterval(this.spinInterval),typeof l>"u"&&(l="y"),typeof l=="boolean")if(l)l="y";else return;Array.isArray(l)&&(l={x:l[0],y:l[1],z:l[2]});var C=this;this.spinInterval=setInterval(function(){!C.getCanvas().isConnected&&C.renderer.isLost()&&clearInterval(C.spinInterval),(!m||C.container.checkVisibility&&C.container.checkVisibility())&&C.rotate(1*f,l)},25)}animateMotion(l,f,m,C,T,P){var F=20,N=Math.ceil(l/F);N<1&&(N=1),this.incAnim();var B={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(f){let H=new Array(N);for(let k=0;k<N;k++){let Y=(k+1)/N,ie={mpos:B.mpos,rz:B.rz,rot:B.rot};ie.mpos=m.clone().sub(B.mpos).multiplyScalar(Y).add(B.mpos),ie.rz=B.rz+Y*(C-B.rz),ie.rot=s.slerp(B.rot,T,Y),ie.cam=P.clone().sub(B.cam).multiplyScalar(Y).add(B.cam),H[k]=ie}let G=0,$=this,V=function(){var k=H[G];G+=1,$.modelGroup.position=k.mpos,$.rotationGroup.position.z=k.rz,$.rotationGroup.quaternion=k.rot,$.camera.lookAt(k.cam),G<H.length?setTimeout(V,F):$.decAnim(),$.show()};setTimeout(V,F)}else{var U={};let H=1/N;if(m&&(U.mpos=m.clone().sub(B.mpos).multiplyScalar(H)),typeof C<"u"&&C!=null&&(U.rz=H*(C-B.rz)),T){var K=s.slerp(B.rot,T,H);U.rot=B.rot.clone().inverse().multiply(K)}P&&(U.cam=P.clone().sub(B.cam).multiplyScalar(H));let G=0,$=this,V=function(){G+=1,U.mpos&&$.modelGroup.position.add(U.mpos),U.rz&&($.rotationGroup.position.z+=U.rz),U.rot&&$.rotationGroup.quaternion.multiply(U.rot),U.cam&&($.lookingAt.add(U.cam),$.camera.lookAt($.lookingAt)),G<N?setTimeout(V,F):$.decAnim(),$.show()};setTimeout(V,F)}}rotate(l,f="y",m=0,C=!1){if(f=="x"?f={x:1,y:0,z:0}:f=="y"?f={x:0,y:1,z:0}:f=="z"&&(f={x:0,y:0,z:1}),f=="vx"?f={vx:1,vy:0,vz:0}:f=="vy"?f={vx:0,vy:1,vz:0}:f=="vz"&&(f={vx:0,vy:0,vz:1}),typeof f.vx<"u"){var T=new L.Vector3(f.vx,f.vy,f.vz);T.applyQuaternion(this.rotationGroup.quaternion),f={x:T.x,y:T.y,z:T.z}}var P=function(U){var K=Math.sin(U/2),H=Math.cos(U/2),G=0,$=0,V=0;return G=f.x*K,$=f.y*K,V=f.z*K,new L.Quaternion(G,$,V,H).normalize()},F=Math.PI*l/180,N=P(F);if(m){var B=new L.Quaternion().copy(this.rotationGroup.quaternion).multiply(N);this.animateMotion(m,C,this.modelGroup.position,this.rotationGroup.position.z,B,this.lookingAt)}else this.rotationGroup.quaternion.multiply(N),this.show();return this}surfacesFinished(){for(var l in this.surfaces)if(!this.surfaces[l][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var l=this.modelGroup.position,f=this.rotationGroup.quaternion;return[l.x,l.y,l.z,this.rotationGroup.position.z,f.x,f.y,f.z,f.w]}setView(l,f){return l===void 0||!(l instanceof Array||l.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=l[0],this.modelGroup.position.y=l[1],this.modelGroup.position.z=l[2],this.rotationGroup.position.z=l[3],this.rotationGroup.quaternion.x=l[4],this.rotationGroup.quaternion.y=l[5],this.rotationGroup.quaternion.z=l[6],this.rotationGroup.quaternion.w=l[7],typeof l[8]<"u"&&(this.rotationGroup.position.x=l[8],this.rotationGroup.position.y=l[9]),this.show(f),this)}render(l,f){this.renderer.setViewport(),this.updateClickables();var m=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var C,T;for(f||(f=this.renderer.supportedExtensions()),C=0;C<this.models.length;C++)this.models[C]&&this.models[C].globj(this.modelGroup,f);for(C=0;C<this.shapes.length;C++)this.shapes[C]&&(typeof this.shapes[C].frame>"u"||this.viewer_frame<0||this.shapes[C].frame<0||this.shapes[C].frame==this.viewer_frame?this.shapes[C].globj(this.modelGroup,f):this.shapes[C].removegl(this.modelGroup));for(C=0;C<this.labels.length;C++)f.regen&&(this.labels[C].dispose(),this.modelGroup.remove(this.labels[C].sprite),this.labels[C].setContext(),this.modelGroup.add(this.labels[C].sprite)),this.labels[C]&&typeof this.labels[C].frame<"u"&&this.labels[C].frame>=0&&(this.modelGroup.remove(this.labels[C].sprite),(this.viewer_frame<0||this.labels[C].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[C].sprite));for(C in this.surfaces)if(this.surfaces.hasOwnProperty(C)){var P=this.surfaces[C];for(T=0;T<P.length;T++)if(P.hasOwnProperty(T)){var F=P[T].geo;if(!P[T].finished||f.regen){F.verticesNeedUpdate=!0,F.elementsNeedUpdate=!0,F.normalsNeedUpdate=!0,F.colorsNeedUpdate=!0,F.buffersNeedUpdate=!0,P[T].mat.needsUpdate=!0,P[T].done&&(P[T].finished=!0),P[T].lastGL&&this.modelGroup.remove(P[T].lastGL);var N=null;if(P[T].mat instanceof A.LineBasicMaterial?N=new A.Line(F,P[T].mat):("wireframe"in P.style&&P.style.wireframe&&F.setUpWireframe(),N=new A.Mesh(F,P[T].mat)),P[T].mat.transparent&&P[T].mat.opacity==0?N.visible=!1:N.visible=!0,P[T].symmetries.length>1||P[T].symmetries.length==1&&!P[T].symmetries[0].isIdentity()){var B,U=new A.Object3D;for(B=0;B<P[T].symmetries.length;B++){var K=N.clone();K.matrix=P[T].symmetries[B],K.matrixAutoUpdate=!1,U.add(K)}P[T].lastGL=U,this.modelGroup.add(U)}else P[T].lastGL=N,this.modelGroup.add(N)}}}return this.setView(m),typeof l=="function"&&l(this),this}getModelList(l){let f=[];if(typeof l>"u"||typeof l.model>"u")for(let C=0;C<this.models.length;C++)this.models[C]&&f.push(this.models[C]);else{let C=l.model;Array.isArray(C)||(C=[C]);for(let T=0;T<C.length;T++)if(typeof C[T]=="number"){var m=C[T];m<0&&(m+=this.models.length),f.push(this.models[m])}else f.push(C[T])}return f}getAtomsFromSel(l){var f=[];typeof l>"u"&&(l={});var m=this.getModelList(l);for(let C=0;C<m.length;C++)f=f.concat(m[C].selectedAtoms(l));return f}atomIsSelected(l,f){typeof f>"u"&&(f={});for(var m=this.getModelList(f),C=0;C<m.length;C++)if(m[C].atomIsSelected(l,f))return!0;return!1}selectedAtoms(l){return this.getAtomsFromSel(l)}getUniqueValues(l,f){typeof f>"u"&&(f={});var m=this.getAtomsFromSel(f),C={};for(var T in m)if(m[T].hasOwnProperty(l)){var P=m[T][l];C[P]=!0}return Object.keys(C)}pdbData(l){for(var f=this.getAtomsFromSel(l),m="",C=0,T=f.length;C<T;++C)m+=f[C].pdbline+`
`;return m}zoom(l=2,f=0,m=!1){var C=(this.CAMERA_Z-this.rotationGroup.position.z)/l,T=this.CAMERA_Z-C;return f>0?this.animateMotion(f,m,this.modelGroup.position,this.adjustZoomToLimits(T),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(T),this.show()),this}translate(l,f,m=0,C=!1){var T=l/this.WIDTH,P=f/this.HEIGHT,F=new L.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(F,this.camera),F.x-=T,F.y-=P,this.projector.unprojectVector(F,this.camera),F.z=0;var N=this.lookingAt.clone().add(F);return m>0?this.animateMotion(m,C,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,N):(this.lookingAt=N,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(l,f,m=0,C=!1){var T=this.screenOffsetToModel(l,f),P=this.modelGroup.position.clone().add(T);return m>0?this.animateMotion(m,C,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=P,this.show()),this}fitSlab(l){l=l||{};var f=this.getAtomsFromSel(l),m=(0,b.getExtent)(f),C=m[1][0]-m[0][0],T=m[1][1]-m[0][1],P=m[1][2]-m[0][2],F=Math.hypot(C,T,P);return F<5&&(F=5),this.slabNear=-F/1.9,this.slabFar=F/2,this}center(l={},f=0,m=!1){var C,T,P=this.getAtomsFromSel(l),F=(0,b.getExtent)(P);(0,b.isEmptyObject)(l)?(this.shapes.forEach(Y=>{if(Y&&Y.boundingSphere&&Y.boundingSphere.center){var ie=Y.boundingSphere.center,ne=Y.boundingSphere.radius;ne>0?(P.push(new L.Vector3(ie.x+ne,ie.y,ie.z)),P.push(new L.Vector3(ie.x-ne,ie.y,ie.z)),P.push(new L.Vector3(ie.x,ie.y+ne,ie.z)),P.push(new L.Vector3(ie.x,ie.y-ne,ie.z)),P.push(new L.Vector3(ie.x,ie.y,ie.z+ne)),P.push(new L.Vector3(ie.x,ie.y,ie.z-ne))):P.push(ie)}}),F=(0,b.getExtent)(P),C=P,T=F):(C=this.getAtomsFromSel({}),T=(0,b.getExtent)(C));var N=new L.Vector3(F[2][0],F[2][1],F[2][2]),B=T[1][0]-T[0][0],U=T[1][1]-T[0][1],K=T[1][2]-T[0][2],H=Math.hypot(B,U,K);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,B=F[1][0]-F[0][0],U=F[1][1]-F[0][1],K=F[1][2]-F[0][2],H=Math.hypot(B,U,K),H<5&&(H=5);for(var G=25,$=0;$<P.length;$++)if(P[$]){var V=N.distanceToSquared(P[$]);V>G&&(G=V)}H=Math.sqrt(G)*2;var k=N.clone().multiplyScalar(-1);return f>0?this.animateMotion(f,m,k,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=k,this.show()),this}zoomTo(l={},f=0,m=!1){let C=this.getAtomsFromSel(l),T=(0,b.getExtent)(C),P=T;if((0,b.isEmptyObject)(l)){let ie=C&&C.length;if(this.shapes.forEach(ne=>{if(ne&&ne.boundingSphere){if(ne.boundingSphere.box){let xe=ne.boundingSphere.box;C.push(new L.Vector3(xe.min.x,xe.min.y,xe.min.z)),C.push(new L.Vector3(xe.max.x,xe.max.y,xe.max.z))}else if(ne.boundingSphere.center){var he=ne.boundingSphere.center,le=ne.boundingSphere.radius;le>0?(C.push(new L.Vector3(he.x+le,he.y,he.z)),C.push(new L.Vector3(he.x-le,he.y,he.z)),C.push(new L.Vector3(he.x,he.y+le,he.z)),C.push(new L.Vector3(he.x,he.y-le,he.z)),C.push(new L.Vector3(he.x,he.y,he.z+le)),C.push(new L.Vector3(he.x,he.y,he.z-le))):C.push(he)}}}),P=(0,b.getExtent)(C),!ie)for(let ne=0;ne<3;ne++)T[2][ne]=(P[0][ne]+P[1][ne])/2}else{let ie=this.getAtomsFromSel({});P=(0,b.getExtent)(ie)}var F=new L.Vector3(T[2][0],T[2][1],T[2][2]),N=P[1][0]-P[0][0],B=P[1][1]-P[0][1],U=P[1][2]-P[0][2],K=Math.hypot(N,B,U);K<5&&(K=5),this.slabNear=-K/1.9,this.slabFar=K/2,Object.keys(l).length===0&&(this.slabNear=Math.min(-K*2,-50),this.slabFar=Math.max(K*2,50));var H=this.config.minimumZoomToDistance||5;N=T[1][0]-T[0][0],B=T[1][1]-T[0][1],U=T[1][2]-T[0][2],K=Math.hypot(N,B,U),K<H&&(K=H);for(var G=H*H,$=0;$<C.length;$++)if(C[$]){var V=F.distanceToSquared(C[$]);V>G&&(G=V)}K=Math.sqrt(G)*2;var k=F.clone().multiplyScalar(-1),Y=-(K*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return Y=this.adjustZoomToLimits(Y),f>0?this.animateMotion(f,m,k,Y,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=k,this.rotationGroup.position.z=Y,this.show()),this}setSlab(l,f){this.slabNear=l,this.slabFar=f}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(l,f={},m,C=!1){if(m){var T=(0,b.getExtent)(this.getAtomsFromSel(m));f.position={x:T[2][0],y:T[2][1],z:T[2][2]}}var P=new p.Label(l,f);return P.setContext(),this.modelGroup.add(P.sprite),this.labels.push(P),C||this.show(),P}addResLabels(l,f,m=!1){let C=this.labels.length;return this.applyToModels("addResLabels",l,f,m),this.show(),this.labels.slice(C)}addPropertyLabels(l,f,m){return this.applyToModels("addPropertyLabels",l,f,m),this.show(),this}removeLabel(l){for(var f=0;f<this.labels.length;f++)if(this.labels[f]==l){this.labels.splice(f,1),l.dispose(),this.modelGroup.remove(l.sprite);break}return this.show(),this}removeAllLabels(){for(var l=0;l<this.labels.length;l++)this.labels[l]&&this.labels[l].sprite&&this.modelGroup.remove(this.labels[l].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var l=0;l<this.labels.length;l++)this.labels[l]&&this.labels[l].hide();return this.show(),this}showAllLabels(){for(var l=0;l<this.labels.length;l++)this.labels[l]&&this.labels[l].show();return this.show(),this}setLabelStyle(l,f){return this.modelGroup.remove(l.sprite),l.dispose(),l.stylespec=f,l.setContext(),this.modelGroup.add(l.sprite),this.show(),l}setLabelText(l,f){return this.modelGroup.remove(l.sprite),l.dispose(),l.text=f,l.setContext(),this.modelGroup.add(l.sprite),this.show(),l}addShape(l){l=l||{};var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,this.shapes.push(f),f}removeShape(l){if(!l)return this;for(l.removegl(this.modelGroup),delete this.shapes[l.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var l=0;l<this.shapes.length;l++){var f=this.shapes[l];f&&f.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(l){if(l.hasOwnProperty("x")&&l.hasOwnProperty("y")&&l.hasOwnProperty("z"))return l;var f=this.getAtomsFromSel(l);if(f.length==0)return{x:0,y:0,z:0};var m=(0,b.getExtent)(f);return{x:m[0][0]+(m[1][0]-m[0][0])/2,y:m[0][1]+(m[1][1]-m[0][1])/2,z:m[0][2]+(m[1][2]-m[0][2])/2}}addSphere(l){l=l||{},l.center=this.getSelectionCenter(l.center);var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,f.addSphere(l),this.shapes.push(f),f.finalize(),f}addBox(l={}){l.corner!=null&&(l.corner=this.getSelectionCenter(l.corner)),l.center!=null&&(l.center=this.getSelectionCenter(l.center));var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,f.addBox(l),this.shapes.push(f),f.finalize(),f}addArrow(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end);var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,f.addArrow(l),this.shapes.push(f),f.finalize(),f}addCylinder(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end);var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,l.dashed?f.addDashedCylinder(l):f.addCylinder(l),this.shapes.push(f),f.finalize(),f}addCurve(l={}){var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,f.addCurve(l),this.shapes.push(f),f.finalize(),f}addLine(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end),l.wireframe=!0;var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,l.dashed?f=this.addLineDashed(l,f):f.addLine(l),this.shapes.push(f),f.finalize(),f}addUnitCell(l,f){l=this.getModel(l),f=f||{alabel:"a",blabel:"b",clabel:"c"},f.box=f.box||{},f.astyle=f.astyle||{color:"red",radius:.1,midpos:-1},f.bstyle=f.bstyle||{color:"green",radius:.1,midpos:-1},f.cstyle=f.cstyle||{color:"blue",radius:.1,midpos:-1},f.alabelstyle=f.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},f.blabelstyle=f.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},f.clabelstyle=f.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},l.unitCellObjects&&this.removeUnitCell(l),l.unitCellObjects={shapes:[],labels:[]};var m=l.getCrystData(),C=null;if(m){if(m.matrix)C=m.matrix;else{var T=m.a,P=m.b,F=m.c,N=m.alpha,B=m.beta,U=m.gamma;N=N*Math.PI/180,B=B*Math.PI/180,U=U*Math.PI/180;var K,H,G;K=Math.cos(B),H=(Math.cos(N)-Math.cos(B)*Math.cos(U))/Math.sin(U),G=Math.sqrt(Math.max(0,1-K*K-H*H)),C=new L.Matrix3(T,P*Math.cos(U),F*K,0,P*Math.sin(U),F*H,0,0,F*G)}var $=[new L.Vector3(0,0,0),new L.Vector3(1,0,0),new L.Vector3(0,1,0),new L.Vector3(0,0,1),new L.Vector3(1,1,0),new L.Vector3(0,1,1),new L.Vector3(1,0,1),new L.Vector3(1,1,1)];if(m.matrix4)for(let k=0;k<$.length;k++)m.size&&$[k].multiplyVectors($[k],m.size),$[k]=$[k].applyMatrix4(m.matrix4);else for(let k=0;k<$.length;k++)$[k]=$[k].applyMatrix3(C);if(f.box&&!f.box.hidden){f.box.wireframe=!0;var V=new S.GLShape(f.box);V.shapePosition=this.shapes.length,V.addLine({start:$[0],end:$[1]}),V.addLine({start:$[0],end:$[2]}),V.addLine({start:$[1],end:$[4]}),V.addLine({start:$[2],end:$[4]}),V.addLine({start:$[0],end:$[3]}),V.addLine({start:$[3],end:$[5]}),V.addLine({start:$[2],end:$[5]}),V.addLine({start:$[1],end:$[6]}),V.addLine({start:$[4],end:$[7]}),V.addLine({start:$[6],end:$[7]}),V.addLine({start:$[3],end:$[6]}),V.addLine({start:$[5],end:$[7]}),this.shapes.push(V),l.unitCellObjects.shapes.push(V),V.finalize()}if(!f.astyle.hidden){f.astyle.start=$[0],f.astyle.end=$[1];let k=this.addArrow(f.astyle);l.unitCellObjects.shapes.push(k)}if(!f.bstyle.hidden){f.bstyle.start=$[0],f.bstyle.end=$[2];let k=this.addArrow(f.bstyle);l.unitCellObjects.shapes.push(k)}if(!f.cstyle.hidden){f.cstyle.start=$[0],f.cstyle.end=$[3];let k=this.addArrow(f.cstyle);l.unitCellObjects.shapes.push(k)}if(f.alabel){f.alabelstyle.position=$[1];let k=this.addLabel(f.alabel,f.alabelstyle);l.unitCellObjects.labels.push(k)}if(f.blabel){f.blabelstyle.position=$[2];let k=this.addLabel(f.blabel,f.blabelstyle);l.unitCellObjects.labels.push(k)}if(f.clabel){f.clabelstyle.position=$[3];let k=this.addLabel(f.clabel,f.clabelstyle);l.unitCellObjects.labels.push(k)}}}removeUnitCell(l){if(l=this.getModel(l),l.unitCellObjects){let f=this;l.unitCellObjects.shapes.forEach(function(m){f.removeShape(m)}),l.unitCellObjects.labels.forEach(function(m){f.removeLabel(m)})}delete l.unitCellObjects}replicateUnitCell(l=3,f=l,m=f,C,T,P){C=this.getModel(C);let F=C.getCrystData();if(F){const N=C.selectedAtoms({}),B=F.matrix;let U=function(H){return H%2==0?-H/2:Math.ceil(H/2)};l<=1&&f<=1&&m<=1&&(P=!0,l=f=m=3);let K=function(H,G,$){return!1};if(P){const H=new L.Matrix3().getInverse3(B);K=function(G,$,V){let k=new L.Vector3(G,$,V).applyMatrix3(H);return!(k.x>-1e-4&&k.x<1.0001&&k.y>-1e-4&&k.y<1.0001&&k.z>-1e-4&&k.z<1.0001)}}for(let H=0;H<l;H++)for(let G=0;G<f;G++)for(let $=0;$<m;$++){if(H==0&&G==0&&$==0)continue;let V=new L.Vector3(U(H),U(G),U($));V.applyMatrix3(B);let k=[];for(let Y=0;Y<N.length;Y++){let ie=N[Y].x+V.x,ne=N[Y].y+V.y,he=N[Y].z+V.z;if(K(ie,ne,he))continue;let le={};for(let xe in N[Y])le[xe]=N[Y][xe];le.x=ie,le.y=ne,le.z=he,k.push(le)}C.addAtoms(k)}T&&C.assignBonds()}}addLineDashed(l,f){l.dashLength=l.dashLength||.5,l.gapLength=l.gapLength||.5;var m;l.start?m=new L.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):m=new L.Vector3(0,0,0);var C;l.end?C=new L.Vector3(l.end.x,l.end.y||0,l.end.z||0):C=new L.Vector3(0,0,0);var T=new L.Vector3,P=new L.Vector3,F=new L.Vector3,N,B,U,K=m.clone(),H=0;for(T.subVectors(C,m),N=T.length(),T.normalize(),P=T.clone(),F=T.clone(),P.multiplyScalar(l.dashLength),F.multiplyScalar(l.gapLength),B=P.length(),U=F.length();H<N;){if(H+B>N){l.start=m,l.end=C,f.addLine(l);break}K.addVectors(m,P),l.start=m,l.end=K,f.addLine(l),m=K.clone(),H+=B,K.addVectors(m,F),m=K.clone(),H+=U}return f.finalize(),f}addCustom(l){l=l||{};var f=new S.GLShape(l);return f.shapePosition=this.shapes.length,f.addCustom(l),this.shapes.push(f),f.finalize(),f}addVolumetricData(l,f,m={}){var C=new D.VolumeData(l,f);return m.hasOwnProperty("transferfn")?this.addVolumetricRender(C,m):this.addIsosurface(C,m)}addIsosurface(l,f={},m){var C=new S.GLShape(f);return C.shapePosition=this.shapes.length,C.addIsosurface(l,f,m,this),this.shapes.push(C),C}addVolumetricRender(l,f){f=f||{};var m=new x.GLVolumetricRender(l,f,this);return m.shapePosition=this.shapes.length,this.shapes.push(m),m}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(l){if(l){this.scene.fog=new A.Fog(this.bgColor,100,200),this.config.disableFog=!1;const f=l;f.fogStart==null?this.fogStart=.4:this.fogStart=f.fogStart,f.fogEnd==null?this.fogEnd=1:this.fogEnd=f.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(l){this.viewer_frame=l;let f=this;return new Promise(function(m){var C=f.models.map(function(T){return T.setFrame(l)});Promise.all(C).then(function(){m()})})}getFrame(){return this.viewer_frame}getNumFrames(){var l=0;for(let f=0;f<this.models.length;f++)this.models[f].getNumFrames()>l&&(l=this.models[f].getNumFrames());for(let f=0;f<this.shapes.length;f++)this.shapes[f].frame&&this.shapes[f].frame>=l&&(l=this.shapes[f].frame+1);for(let f=0;f<this.labels.length;f++)this.labels[f].frame&&this.labels[f].frame>=l&&(l=this.labels[f].frame+1);return l}getNextModelId(){return this.models.length}animate(l){this.incAnim();var f=100,m="forward",C=1/0;l=l||{},l.interval&&(f=l.interval),l.loop&&(m=l.loop),l.reps&&(C=l.reps);var T=this.getNumFrames(),P=this,F=0;l.startFrame&&(F=l.startFrame%T);var N=1;l.step&&(N=l.step,C/=N);var B=0,U=T*C,K=new Date,H,G,$=function(V){K=new Date,V=="forward"?P.setFrame(F).then(function(){F=(F+N)%T,H()}):V=="backward"?P.setFrame(T-1-F).then(function(){F=(F+N)%T,H()}):P.setFrame(F).then(function(){F+=N,N*=F%(T-1)==0?-1:1,H()})};return H=function(){if(P.render(),!P.getCanvas().isConnected)P.stopAnimate();else if(++B>=U||!P.isAnimated())G.cancel(),P.animationTimers.delete(G),P.decAnim();else{var V=f-(new Date().getTime()-K.getTime());V=V>0?V:0,G.cancel(),P.animationTimers.delete(G),G=new b.PausableTimer($,V,m),P.animationTimers.add(G)}},G=new b.PausableTimer($,0,m),this.animationTimers.add(G),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(l){l.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(l){l.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(l){l.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(l){return l&&!l.defaultcolors?(l.defaultcolors=this.defaultcolors,l.cartoonQuality=l.cartoonQuality||this.config.cartoonQuality):typeof l>"u"&&(l={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),l}addModel(l,f="",m){m=this.getModelOpt(m);var C=new R.GLModel(this.models.length,m,this);return C.addMolData(l,f,m),this.models.push(C),C}addModels(l,f,m){m=this.getModelOpt(m),m.multimodel=!0,m.frames=!0;for(var C=R.GLModel.parseMolData(l,f,m),T=0;T<C.length;T++){var P=new R.GLModel(this.models.length,m,this);P.setAtomDefaults(C[T]),P.addFrame(C[T]),P.setFrame(0),C.modelData&&P.setModelData(C.modelData[T]),P.setDontDuplicateAtoms(!m.duplicateAssemblyAtoms),this.models.push(P)}return this.models}addModelsAsFrames(l,f,m){m=this.getModelOpt(m),m.multimodel=!0,m.frames=!0;var C=new R.GLModel(this.models.length,m,this);return C.addMolData(l,f,m),this.models.push(C),C}addAsOneMolecule(l,f,m){m=this.getModelOpt(m),m.multimodel=!0,m.onemol=!0;var C=new R.GLModel(this.models.length,m,this);return C.addMolData(l,f,m),this.models.push(C),C}removeModel(l){if(l=this.getModel(l),!!l){for(l.removegl(this.modelGroup),delete this.models[l.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var l=0;l<this.models.length;l++){var f=this.models[l];f&&f.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(l,f){var m={};return f===void 0?m.m=this.models.map(function(C){return C.toCDObject(l)}):m.m=[this.models[f].toCDObject()],JSON.stringify(m)}exportVRML(){var l=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new A.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var f=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=l,f}createModelFrom(l,f=!1){for(var m=new R.GLModel(this.models.length,this.defaultcolors,this),C=0;C<this.models.length;C++)if(this.models[C]){var T=this.models[C].selectedAtoms(l);m.addAtoms(T),f&&this.models[C].removeAtoms(T)}return this.models.push(m),m}applyToModels(l,f,m,C,T,P,F){for(var N=this.getModelList(f),B=0;B<N.length;B++)N[B][l](f,m,C,T,P,F)}setStyle(l,f){return typeof f>"u"&&(f=l,l={}),this.applyToModels("setStyle",l,f,!1),this}addStyle(l,f){return typeof f>"u"&&(f=l,l={}),this.applyToModels("setStyle",l,f,!0),this}setClickable(l,f,m){return this.applyToModels("setClickable",l,f,m),this}setHoverable(l,f,m,C){return this.applyToModels("setHoverable",l,f,m,C),this}enableContextMenu(l,f){return this.applyToModels("enableContextMenu",l,f),this}vibrate(l,f,m,C){return this.applyToModels("vibrate",l,f,m,C),this}setColorByProperty(l,f,m,C){return this.applyToModels("setColorByProperty",l,f,m,C),this}setColorByElement(l,f){return this.applyToModels("setColorByElement",l,f),this}static getAtomsWithin(l,f){var m=[];for(let T=0;T<l.length;T++){var C=l[T];typeof C>"u"||C.x<f[0][0]||C.x>f[1][0]||C.y<f[0][1]||C.y>f[1][1]||C.z<f[0][2]||C.z>f[1][2]||m.push(C)}return m}static volume(l){var f=l[1][0]-l[0][0],m=l[1][1]-l[0][1],C=l[1][2]-l[0][2];return f*m*C}carveUpExtent(l,f,m){let C=[],T={};for(let K=0,H=f.length;K<H;K++)T[f[K].index]=K;let P=function(K){let H=[];for(let G=0,$=K.length;G<$;G++)K[G].index in T&&H.push(T[K[G].index]);return H},F=function(K){let H=[];return H[0]=[K[0][0],K[0][1],K[0][2]],H[1]=[K[1][0],K[1][1],K[1][2]],H},N=function(K){if(s.volume(K)<s.maxVolume)return[K];var H=K[1][0]-K[0][0],G=K[1][1]-K[0][1],$=K[1][2]-K[0][2],V;H>G&&H>$?V=0:G>H&&G>$?V=1:V=2;var k=F(K),Y=F(K),ie=(K[1][V]-K[0][V])/2+K[0][V];k[1][V]=ie,Y[0][V]=ie;var ne=N(k),he=N(Y);return ne.concat(he)},B=N(l),U=6;for(let K=0,H=B.length;K<H;K++){let G=F(B[K]);G[0][0]-=U,G[0][1]-=U,G[0][2]-=U,G[1][0]+=U,G[1][1]+=U,G[1][2]+=U;let $=s.getAtomsWithin(f,G),V=s.getAtomsWithin(m,B[K]);C.push({extent:B[K],atoms:P($),toshow:P(V)})}return C}static generateSurfaceMesh(l,f,m){var C=new A.Geometry(!0),T=C.updateGeoGroup(0),P=[];for(let ue=0,Me=l.length;ue<Me;ue++){var F=l[ue];F&&(typeof F.surfaceColor<"u"?P[ue]=F.surfaceColor:F.color&&(P[ue]=w.CC.color(F.color)))}var N=T.vertexArray,B=f.vertices;for(let ue=0,Me=B.length;ue<Me;ue++){let Ge=T.vertices*3;N[Ge]=B[ue].x,N[Ge+1]=B[ue].y,N[Ge+2]=B[ue].z,T.vertices++}var U=T.colorArray;let K=T.atomArray;if(m.voldata&&m.volscheme){var H=m.volscheme,G=m.voldata,$=H.range()||[-1,1];for(let ue=0,Me=B.length;ue<Me;ue++){let Ge=B[ue].atomid,Je=G.getVal(B[ue].x,B[ue].y,B[ue].z),qe=w.CC.color(H.valueToHex(Je,$)),tt=ue*3;U[tt]=qe.r,U[tt+1]=qe.g,U[tt+2]=qe.b,K[ue]=l[Ge]}}else if(P.length>0)for(let ue=0,Me=B.length;ue<Me;ue++){let Ge=B[ue].atomid,Je=ue*3;U[Je]=P[Ge].r,U[Je+1]=P[Ge].g,U[Je+2]=P[Ge].b,K[ue]=l[Ge]}var V=f.faces;T.faceidx=V.length,C.initTypedArrays();var k=T.vertexArray,Y=T.normalArray,ie,ne,he,le;for(let ue=0,Me=V.length;ue<Me;ue+=3){var xe=V[ue],fe=V[ue+1],pe=V[ue+2],Te=xe*3,ke=fe*3,$e=pe*3;ie=new L.Vector3(k[Te],k[Te+1],k[Te+2]),ne=new L.Vector3(k[ke],k[ke+1],k[ke+2]),he=new L.Vector3(k[$e],k[$e+1],k[$e+2]),he.subVectors(he,ne),ie.subVectors(ie,ne),he.cross(ie),le=he,le.normalize(),Y[Te]+=le.x,Y[ke]+=le.x,Y[$e]+=le.x,Y[Te+1]+=le.y,Y[ke+1]+=le.y,Y[$e+1]+=le.y,Y[Te+2]+=le.z,Y[ke+2]+=le.z,Y[$e+2]+=le.z}T.faceArray=new Uint16Array(V);var Le=new A.Mesh(C,m);return Le}static generateMeshSyncHelper(l,f,m,C,T,P){var F=new v.ProteinSurface;return F.initparm(f,l!==1,P),F.fillvoxels(T,m),F.buildboundary(),(l==v.SurfaceType.SES||l==v.SurfaceType.MS)&&(F.fastdistancemap(),F.boundingatom(!1),F.fillvoxelswaals(T,m)),F.marchingcube(l),F.getFacesAndVertices(C)}static getMatWithStyle(l){let f=null;l.onesided?f=new A.MeshLambertMaterial:f=new A.MeshDoubleLambertMaterial,f.vertexColors=A.Coloring.VertexColors;for(var m in l)m==="color"||m==="map"||l.hasOwnProperty(m)&&(f[m]=l[m]);return l.opacity!==void 0&&(l.opacity===1?f.transparent=!1:f.transparent=!0),l.wireframe!==void 0&&(f.wireframe=l.wireframe),f}addMesh(l){let f={geo:l.geometry,mat:l.material,done:!0,finished:!1};var m=this.nextSurfID();return this.surfaces[m]=new i([f]),m}static shallowCopy(l){var f=[];let m=l.length;for(let C=0;C<m;C++)f[C]=(0,b.extend)({},l[C]);return f}addSurface(l,f={},m={},C,T,P){let F=this.nextSurfID(),N=null,B=this,U=v.SurfaceType.VDW;typeof l=="string"?s.surfaceTypeMap[l.toUpperCase()]!==void 0?U=s.surfaceTypeMap[l]:console.log("Surface type : "+l+" is not recognized"):typeof l=="number"&&(U=l);var K=null,H=null,G=s.shallowCopy(this.getAtomsFromSel(m));C?K=s.shallowCopy(this.getAtomsFromSel(C)):K=G,(0,b.adjustVolumeStyle)(f);var $=!1,V;for(V=0;V<this.models.length;V++)if(this.models[V]){var k=this.models[V].getSymmetries();if(k.length>1||k.length==1&&!k[0].isIdentity()){$=!0;break}}var Y=function(pe,Te,ke){T?H=s.shallowCopy(B.getAtomsFromSel(T)):H=ke;var $e,Le=(0,b.getExtent)(ke,!0);if(f.map&&f.map.prop){var ue=f.map.prop;let nt=(0,j.getGradient)(f.map.scheme||f.map.gradient||new j.Gradient.RWB),at=nt.range();at||(at=(0,b.getPropertyRange)(ke,ue)),f.colorscheme={prop:ue,gradient:nt}}for(let nt=0,at=Te.length;nt<at;nt++)$e=Te[nt],$e.surfaceColor=(0,b.getColorFromStyle)($e,f);var Me=s.volume(Le),Ge=B.carveUpExtent(Le,Te,ke);if(H&&H.length&&H.length>0){var Je=(0,b.getExtent)(H,!0),qe=function(nt,at){var q=function(Se,we){var ze=Se.extent,Be=ze[1][0]-ze[0][0],Z=ze[1][1]-ze[0][1],ge=ze[1][2]-ze[0][2],Ce=Be-we[2][0];Ce*=Ce;var Ue=Z-we[2][1];Ue*=Ue;var ce=ge-we[2][2];return ce*=ce,Ce+Ue+ce},re=q(nt,Je),se=q(at,Je);return re-se};Ge.sort(qe)}var tt=[];for(let nt=0,at=Te.length;nt<at;nt++)$e=Te[nt],tt[nt]={x:$e.x,y:$e.y,z:$e.z,serial:nt,elem:$e.elem};var Ze=!!v.syncSurface;if((typeof $3Dmol>"u"||typeof $3Dmol.SurfaceWorker>"u")&&(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),Ze=!0),Ze){var Ve=function(at){return new Promise(function(q){for(var re=s.generateMeshSyncHelper(U,Ge[at].extent,Ge[at].atoms,Ge[at].toshow,tt,Me),se=(0,S.splitMesh)({vertexArr:re.vertices,faceArr:re.faces}),Se=0,we=se.length;Se<we;Se++){re={vertices:se[Se].vertexArr,faces:se[Se].faceArr};var ze=s.generateSurfaceMesh(Te,re,N);(0,b.mergeGeos)(pe.geo,ze)}B.render(),q()})},Ye=[];for(let nt=0;nt<Ge.length;nt++)Ye.push(Ve(nt));return Promise.all(Ye).then(function(){return pe.done=!0,B.render(),Promise.resolve(F)})}else{var Ke=[];U<0&&(U=0);for(let nt=0,at=s.numWorkers;nt<at;nt++){var We=new Worker($3Dmol.SurfaceWorker);Ke.push(We),We.postMessage({type:-1,atoms:tt,volume:Me})}return new Promise(function(nt,at){var q=0,re=function(){!Ke||!Ke.length||Ke.forEach(function(ze){ze&&ze.terminate&&ze.terminate()})},se=function(ze){for(var Be=(0,S.splitMesh)({vertexArr:ze.data.vertices,faceArr:ze.data.faces}),Z=0,ge=Be.length;Z<ge;Z++){var Ce={vertices:Be[Z].vertexArr,faces:Be[Z].faceArr},Ue=s.generateSurfaceMesh(Te,Ce,N);(0,b.mergeGeos)(pe.geo,Ue)}B.render(),q++,q==Ge.length&&(pe.done=!0,re(),nt(F))},Se=function(ze){re(),console.log(ze.message+" ("+ze.filename+":"+ze.lineno+")"),at(ze)};for(let ze=0;ze<Ge.length;ze++){var we=Ke[ze%Ke.length];we.onmessage=se,we.onerror=Se,we.postMessage({type:U,expandedExtent:Ge[ze].extent,extendedAtoms:Ge[ze].atoms,atomsToShow:Ge[ze].toshow})}})}};f=f||{},N=s.getMatWithStyle(f);let ie=new i([]);ie.style=f,ie.atomsel=m,ie.allsel=C,ie.focus=T;var ne=null;if($){var he={},le={};for(V=0;V<this.models.length;V++)he[V]=[],le[V]=[];for(V=0;V<K.length;V++)he[K[V].model].push(K[V]);for(V=0;V<G.length;V++)le[G[V].model].push(G[V]);var xe=[];for(V=0;V<this.models.length;V++)le[V].length>0&&(ie.push({geo:new A.Geometry(!0),mat:N,done:!1,finished:!1,symmetries:this.models[V].getSymmetries()}),xe.push(Y(ie[ie.length-1],he[V],le[V])));ne=Promise.all(xe)}else ie.push({geo:new A.Geometry(!0),mat:N,done:!1,finished:!1,symmetries:[new L.Matrix4]}),ne=Y(ie[ie.length-1],K,G);return this.surfaces[F]=ie,ne.surfid=F,P&&typeof P=="function"?(ne.then(function(fe){P(fe)}),F):ne}setSurfaceMaterialStyle(l,f){if((0,b.adjustVolumeStyle)(f),this.surfaces[l]){var m=this.surfaces[l];for(let T=0;T<m.length;T++){var C=m[T].mat=s.getMatWithStyle(f);if(m[T].mat.side=A.FrontSide,f.wireframe&&m[T].geo.setUpWireframe(),f.color){m[T].mat.color=w.CC.color(f.color),m[T].geo.colorsNeedUpdate=!0;const P=w.CC.color(f.color);m[T].geo.setColor(P)}else if(C.voldata&&C.volscheme){const P=C.volscheme,F=C.voldata,N=w.CC,B=P.range()||[-1,1];m[T].geo.setColors(function(U,K,H){let G=F.getVal(U,K,H);return N.color(P.valueToHex(G,B))})}else{m[T].geo.colorsNeedUpdate=!0;for(let P of m[T].geo.geometryGroups)for(let F=0;F<P.vertices;F++){let N=(0,b.getColorFromStyle)(P.atomArray[F],f),B=3*F;P.colorArray[B]=N.r,P.colorArray[B+1]=N.g,P.colorArray[B+2]=N.b}}m[T].finished=!1}}return this}getSurface(l){return this.surfaces[l]}removeSurface(l){for(var f=this.surfaces[l],m=0;m<f.length;m++)f[m]&&f[m].lastGL&&(f[m].geo!==void 0&&f[m].geo.dispose(),f[m].mat!==void 0&&f[m].mat.dispose(),this.modelGroup.remove(f[m].lastGL));return delete this.surfaces[l],this.show(),this}removeAllSurfaces(){for(var l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){for(var f=this.surfaces[l],m=0;m<f.length;m++)f[m]&&f[m].lastGL&&(f[m].geo!==void 0&&f[m].geo.dispose(),f[m].mat!==void 0&&f[m].mat.dispose(),this.modelGroup.remove(f[m].lastGL));delete this.surfaces[l]}return this.show(),this}jmolMoveTo(){var l=this.modelGroup.position,f="center { "+-l.x+" "+-l.y+" "+-l.z+" }; ",m=this.rotationGroup.quaternion;return f+="moveto .5 quaternion { "+m.x+" "+m.y+" "+m.z+" "+m.w+" };",f}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(l,f){f=f||{};var m=this.getAtomsFromSel(f);if(typeof l=="function")for(let P=0,F=m.length;P<F;P++){let N=m[P];l(N)}else for(let P=0,F=m.length;P<F;P++){var C=m[P];for(let N=0,B=l.length;N<B;N++){let U=l[N];if(U.props)for(var T in U.props)U.props.hasOwnProperty(T)&&this.atomIsSelected(C,U)&&(C.properties||(C.properties={}),C.properties[T]=U.props[T])}}return this}linkViewer(l){return this.linkedViewers.push(l),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(l){this.rotationGroup.position.z=this.CAMERA_Z-l}setAutoEyeSeparation(l,f){var m=this.getPerceivedDistance();return f||(f=5),l||this.camera.position.x>0?this.camera.position.x=m*Math.tan(Math.PI/180*f):this.camera.position.x=-m*Math.tan(Math.PI/180*f),this.camera.lookAt(new L.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(l){this.config.cartoonQuality=l}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:v.SurfaceType.VDW,MS:v.SurfaceType.MS,SAS:v.SurfaceType.SAS,SES:v.SurfaceType.SES};function h(E,l){if(E=(0,b.getElement)(E),!!E){l=l||{};try{var f=new s(E,l);return f}catch(m){throw"error creating viewer: "+m}}}function g(E,l={},f={}){if(E=(0,b.getElement)(E),!!E){var m=[],C=document.createElement("canvas");f.rows=l.rows,f.cols=l.cols,f.control_all=l.control_all!=null?l.control_all:!1,E.appendChild(C);try{for(var T=0;T<l.rows;T++){for(var P=[],F=0;F<l.cols;F++){f.row=T,f.col=F,f.canvas=C,f.viewers=m,f.control_all=l.control_all;var N=h(E,(0,b.extend)({},f));P.push(N)}m.unshift(P)}}catch(B){throw"error creating viewer grid: "+B}return m}}function y(E){var l=this;if(E=(0,b.getElement)(E),!!E){var f=g(E,{rows:1,cols:2,control_all:!0});this.glviewer1=f[0][0],this.glviewer2=f[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var m=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(T){return typeof l.glviewer1[T]=="function"}),C=0;C<m.length;C++)this[m[C]]=(function(T){return function(){var P=this.glviewer1[T].apply(this.glviewer1,arguments),F=this.glviewer2[T].apply(this.glviewer2,arguments);return[P,F]}})(m[C]);this.setCoordinates=function(T,P,F){for(var N=0;N<T.length;N++)T[N].setCoordinates(P,F)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(T){this.glviewer1.render(),this.glviewer2.render(),T&&T(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}},"./src/Gradient.ts"(o,a,n){n.r(a),n.d(a,{CustomLinear:()=>x,Gradient:()=>L,GradientType:()=>R,ROYGB:()=>v,RWB:()=>p,Sinebow:()=>D,builtinGradients:()=>A,getGradient:()=>j,normalizeValue:()=>S});var d=n("./src/colors.ts");class R{}function S(w,b,u){return b>=w?(u<w&&(u=w),u>b&&(u=b),{lo:w,hi:b,val:u}):(u>w&&(u=w),u<b&&(u=b),u=w-u+b,{lo:b,hi:w,val:u})}function j(w){if(w instanceof R)return w;if(w.gradient!==void 0&&A[w.gradient]){let b=w.min===void 0?-1:w.min,u=w.max===void 0?1:w.max;return w.mid===void 0?w.colors===void 0?new A[w.gradient](b,u):new A[w.gradient](b,u,w.colors):new A[w.gradient](b,u,w.mid)}else if(typeof w.gradient=="string"&&w.gradient.startsWith("linear_")){let b=w.gradient.split("_");b.shift();let u=w.min===void 0?-1:w.min,i=w.max===void 0?1:w.max;return new x(u,i,b)}return w}class p extends R{constructor(b,u,i){super(),this.gradient="RWB",this.mult=1,this.mid=i,this.min=b,this.max=u,typeof u>"u"&&Array.isArray(b)&&b.length>=2?(this.max=b[1],this.min=b[0]):b&&u&&!Array.isArray(b)&&(this.min=b,this.max=u)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(b,u){var i,s;if(b=this.mult*b,u?(i=u[0],s=u[1]):(i=this.min,s=this.max),b===void 0)return 16777215;var h=S(i,s,b);i=h.lo,s=h.hi,b=h.val;var g=(s+i)/2;u&&typeof u[2]<"u"?g=u[2]:typeof this.mid<"u"?g=this.mid:g=(i+s)/2;var y,E;return b<g?(y=Math.floor(255*Math.sqrt((b-i)/(g-i))),E=16711680+256*y+y,E):b>g?(y=Math.floor(255*Math.sqrt(1-(b-g)/(s-g))),E=65536*y+256*y+255,E):16777215}}class v extends R{constructor(b,u){super(),this.gradient="ROYGB",this.mult=1,this.min=b,this.max=u,typeof u>"u"&&Array.isArray(b)&&b.length>=2?(this.max=b[1],this.min=b[0]):b&&u&&!Array.isArray(b)&&(this.min=b,this.max=u)}valueToHex(b,u){var i,s;if(b=this.mult*b,u?(i=u[0],s=u[1]):(i=this.min,s=this.max),typeof b>"u")return 16777215;var h=S(i,s,b);i=h.lo,s=h.hi,b=h.val;var g=(i+s)/2,y=(i+g)/2,E=(g+s)/2,l,f;return b<y?(l=Math.floor(255*Math.sqrt((b-i)/(y-i))),f=16711680+256*l+0,f):b<g?(l=Math.floor(255*Math.sqrt(1-(b-y)/(g-y))),f=65536*l+65280+0,f):b<E?(l=Math.floor(255*Math.sqrt((b-g)/(E-g))),f=65280+1*l,f):(l=Math.floor(255*Math.sqrt(1-(b-E)/(s-E))),f=0+256*l+255,f)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class D extends R{constructor(b,u){super(),this.gradient="Sinebow",this.mult=1,this.min=b,this.max=u,typeof u>"u"&&Array.isArray(b)&&b.length>=2&&(this.max=b[1],this.min=b[0]),u<b&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(b,u){var i,s;if(b=this.mult*b,u?(i=u[0],s=u[1]):(i=this.min,s=this.max),typeof b>"u")return 16777215;var h=L.normalizeValue(i,s,b);i=h.lo,s=h.hi,b=h.val;var g=(b-i)/(s-i),y=5*g/6+.5,E=Math.sin(Math.PI*y);E*=E*255;var l=Math.sin(Math.PI*(y+1/3));l*=l*255;var f=Math.sin(Math.PI*(y+2/3));return f*=f*255,65536*Math.floor(E)+256*Math.floor(f)+1*Math.floor(l)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class x extends R{constructor(b,u,i){super(),this.gradient="linear",this.colors=new Array;var s;if(Array.isArray(b)&&b.length>=2?(this.max=b[1],this.min=b[0],s=u):(this.min=b,this.max=u,s=i),s)for(let h of s)this.colors.push(d.CC.color(h));else this.colors.push(d.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(b,u){var i,s;if(u?(i=u[0],s=u[1]):(i=this.min,s=this.max),b===void 0)return 16777215;var h=S(i,s,b);i=h.lo,s=h.hi,b=h.val;let g=this.colors.length,y=(s-i)/g,E=Math.min(Math.floor((b-i)/y),g-1),l=Math.min(E+1,g-1),f=(b-i-E*y)/y,m=this.colors[E],C=this.colors[l];return new d.Color(m.r+f*(C.r-m.r),m.g+f*(C.g-m.g),m.b+f*(C.b-m.b)).getHex()}}const A={rwb:p,RWB:p,roygb:v,ROYGB:v,sinebow:D,linear:x};class L extends R{valueToHex(b,u){return 0}range(){return null}}L.RWB=p,L.ROYGB=v,L.Sinebow=D,L.CustomLinear=x,L.builtinGradients=A,L.normalizeValue=S,L.getGradient=j},"./src/Label.ts"(o,a,n){n.r(a),n.d(a,{Label:()=>D,LabelCount:()=>j});var d=n("./src/WebGL/index.ts"),R=n("./src/Gradient.ts"),S=n("./src/colors.ts");let j=0;function p(x,A,L,w,b,u,i){x.beginPath(),x.moveTo(A+u,L),x.lineTo(A+w-u,L),x.quadraticCurveTo(A+w,L,A+w,L+u),x.lineTo(A+w,L+b-u),x.quadraticCurveTo(A+w,L+b,A+w-u,L+b),x.lineTo(A+u,L+b),x.quadraticCurveTo(A,L+b,A,L+b-u),x.lineTo(A,L+u),x.quadraticCurveTo(A,L,A+u,L),x.closePath(),x.fill(),i&&x.stroke()}function v(x,A,L){var w=L;return typeof x<"u"&&(x instanceof S.Color?w=x.scaled():(w=S.CC.color(x),typeof w.scaled<"u"&&(w=w.scaled()))),typeof A<"u"&&(w.a=parseFloat(A)),w}class D{constructor(A,L){this.id=j++,this.stylespec=L||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new d.Sprite,this.text=A,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var A=this.stylespec,L=typeof A.useScreen>"u"?!1:A.useScreen,w=A.showBackground;(w==="0"||w==="false")&&(w=!1),typeof w>"u"&&(w=!0);var b=A.font?A.font:"sans-serif",u=parseInt(A.fontSize)?parseInt(A.fontSize):18,i=v(A.fontColor,A.fontOpacity,{r:255,g:255,b:255,a:1}),s=A.padding?A.padding:4,h=A.borderThickness?A.borderThickness:0,g=v(A.backgroundColor,A.backgroundOpacity,{r:0,g:0,b:0,a:1}),y=v(A.borderColor,A.borderOpacity,g),E=A.position?A.position:{x:-10,y:1,z:1},l=A.inFront!==void 0?A.inFront:!0;(l==="false"||l==="0")&&(l=!1);var f=A.alignment||d.SpriteAlignment.topLeft;typeof f=="string"&&f in d.SpriteAlignment&&(f=d.SpriteAlignment[f]);var m="";A.bold&&(m="bold "),this.context.font=m+u+"px  "+b;var C=this.context.measureText(this.text),T=C.width;w||(h=0);var P=T+2.5*h+2*s,F=u*1.25+2*h+2*s;if(A.backgroundImage){var N=A.backgroundImage,B=A.backgroundWidth?A.backgroundWidth:N.width,U=A.backgroundHeight?A.backgroundHeight:N.height;B>P&&(P=B),U>F&&(F=U)}if(this.canvas.width=P,this.canvas.height=F,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),m="",A.bold&&(m="bold "),this.context.font=m+u+"px  "+b,this.context.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")",this.context.strokeStyle="rgba("+y.r+","+y.g+","+y.b+","+y.a+")",A.backgroundGradient){let H=this.context.createLinearGradient(0,F/2,P,F/2),G=R.Gradient.getGradient(A.backgroundGradient),$=G.range(),V=-1,k=1;$&&(V=$[0],k=$[1]);let Y=k-V;for(let ie=0;ie<1.01;ie+=.1){let ne=v(G.valueToHex(V+Y*ie)),he="rgba("+ne.r+","+ne.g+","+ne.b+","+ne.a+")";H.addColorStop(ie,he)}this.context.fillStyle=H}this.context.lineWidth=h,w&&p(this.context,h,h,P-2*h,F-2*h,6,h>0),A.backgroundImage&&this.context.drawImage(N,0,0,P,F),this.context.fillStyle="rgba("+i.r+","+i.g+","+i.b+","+i.a+")",this.context.fillText(this.text,h+s,u+h+s,T);var K=new d.Texture(this.canvas);K.needsUpdate=!0,this.sprite.material=new d.SpriteMaterial({map:K,useScreenCoordinates:L,alignment:f,depthTest:!l,screenOffset:A.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(E.x,E.y,E.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}},"./src/ProteinSurface4.ts"(o,a,n){n.r(a),n.d(a,{MarchingCube:()=>v,MarchingCubeInitializer:()=>p,PointGrid:()=>D,ProteinSurface:()=>x,SurfaceType:()=>R,setSyncSurface:()=>j,syncSurface:()=>S});var d=n("./src/WebGL/math/index.ts"),R;(function(A){A[A.VDW=1]="VDW",A[A.MS=2]="MS",A[A.SAS=3]="SAS",A[A.SES=4]="SES"})(R||(R={}));var S=!1;function j(A){S=A}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(S=!0);class p{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(L,w,b,u){let i=!!u.fulltable,s=u.hasOwnProperty("origin")&&u.origin.hasOwnProperty("x")?u.origin:{x:0,y:0,z:0},h=!!u.voxel,g=u.matrix,y=u.nX||0,E=u.nY||0,l=u.nZ||0,f=u.scale||1,m=null;u.unitCube?m=u.unitCube:m={x:f,y:f,z:f};let C=new Int32Array(y*E*l),T,P;for(T=0,P=C.length;T<P;++T)C[T]=-1;let F=function(K,H,G,$,V,k){let Y={x:0,y:0,z:0},ie=!!($&1<<V),ne=!!($&1<<k),he=V;if(!ie&&ne&&(he=k),he&1&&G++,he&2&&H++,he&4&&K++,g){let xe=new d.Vector3(K,H,G);xe=xe.applyMatrix4(g),Y={x:xe.x,y:xe.y,z:xe.z}}else Y.x=s.x+m.x*K,Y.y=s.y+m.y*H,Y.z=s.z+m.z*G;let le=(E*K+H)*l+G;return h?(w.push(Y),w.length-1):(C[le]<0&&(C[le]=w.length,w.push(Y)),C[le])},N=new Int32Array(12),B=i?this.edgeTable2:this.edgeTable,U=i?this.triTable2:this.triTable;for(T=0;T<y-1;++T)for(let K=0;K<E-1;++K)for(let H=0;H<l-1;++H){let G=0;for(let k=0;k<8;++k){let Y=(E*(T+((k&4)>>2))+K+((k&2)>>1))*l+H+(k&1),ie=!!(L[Y]&this.ISDONE);G|=ie<<k}if(G===0||G===255)continue;let $=B[G];if($===0)continue;let V=U[G];$&1&&(N[0]=F(T,K,H,G,0,1)),$&2&&(N[1]=F(T,K,H,G,1,3)),$&4&&(N[2]=F(T,K,H,G,3,2)),$&8&&(N[3]=F(T,K,H,G,2,0)),$&16&&(N[4]=F(T,K,H,G,4,5)),$&32&&(N[5]=F(T,K,H,G,5,7)),$&64&&(N[6]=F(T,K,H,G,7,6)),$&128&&(N[7]=F(T,K,H,G,6,4)),$&256&&(N[8]=F(T,K,H,G,0,4)),$&512&&(N[9]=F(T,K,H,G,1,5)),$&1024&&(N[10]=F(T,K,H,G,3,7)),$&2048&&(N[11]=F(T,K,H,G,2,6));for(let k=0;k<V.length;k+=3){let Y=N[V[k]],ie=N[V[k+1]],ne=N[V[k+2]];h&&k>=3&&(w.push(w[Y]),Y=w.length-1,w.push(w[ie]),ie=w.length-1,w.push(w[ne]),ne=w.length-1),b.push(Y),b.push(ie),b.push(ne)}}}laplacianSmooth(L,w,b){let u=new Array(w.length),i,s,h,g,y;for(i=0,s=w.length;i<s;i++)u[i]={x:0,y:0,z:0};let E=new Array(20),l;for(i=0;i<20;i++)E[i]=new Array(w.length);for(i=0,s=w.length;i<s;i++)E[0][i]=0;for(i=0,s=b.length/3;i<s;i++){let C=i*3,T=i*3+1,P=i*3+2;for(l=!0,h=0,g=E[0][b[C]];h<g;h++)if(b[T]==E[h+1][b[C]]){l=!1;break}for(l&&(E[0][b[C]]++,E[E[0][b[C]]][b[C]]=b[T]),l=!0,h=0,g=E[0][b[C]];h<g;h++)if(b[P]==E[h+1][b[C]]){l=!1;break}for(l&&(E[0][b[C]]++,E[E[0][b[C]]][b[C]]=b[P]),l=!0,h=0,g=E[0][b[T]];h<g;h++)if(b[C]==E[h+1][b[T]]){l=!1;break}for(l&&(E[0][b[T]]++,E[E[0][b[T]]][b[T]]=b[C]),l=!0,h=0,g=E[0][b[T]];h<g;h++)if(b[P]==E[h+1][b[T]]){l=!1;break}for(l&&(E[0][b[T]]++,E[E[0][b[T]]][b[T]]=b[P]),l=!0,h=0;h<E[0][b[P]];h++)if(b[C]==E[h+1][b[P]]){l=!1;break}for(l&&(E[0][b[P]]++,E[E[0][b[P]]][b[P]]=b[C]),l=!0,h=0,g=E[0][b[P]];h<g;h++)if(b[T]==E[h+1][b[P]]){l=!1;break}l&&(E[0][b[P]]++,E[E[0][b[P]]][b[P]]=b[T])}let f=1,m=.5;for(y=0;y<L;y++){for(i=0,s=w.length;i<s;i++)if(E[0][i]<3)u[i].x=w[i].x,u[i].y=w[i].y,u[i].z=w[i].z;else if(E[0][i]==3||E[0][i]==4){for(u[i].x=0,u[i].y=0,u[i].z=0,h=0,g=E[0][i];h<g;h++)u[i].x+=w[E[h+1][i]].x,u[i].y+=w[E[h+1][i]].y,u[i].z+=w[E[h+1][i]].z;u[i].x+=m*w[i].x,u[i].y+=m*w[i].y,u[i].z+=m*w[i].z,u[i].x/=m+E[0][i],u[i].y/=m+E[0][i],u[i].z/=m+E[0][i]}else{for(u[i].x=0,u[i].y=0,u[i].z=0,h=0,g=E[0][i];h<g;h++)u[i].x+=w[E[h+1][i]].x,u[i].y+=w[E[h+1][i]].y,u[i].z+=w[E[h+1][i]].z;u[i].x+=f*w[i].x,u[i].y+=f*w[i].y,u[i].z+=f*w[i].z,u[i].x/=f+E[0][i],u[i].y/=f+E[0][i],u[i].z/=f+E[0][i]}for(i=0,s=w.length;i<s;i++)w[i].x=u[i].x,w[i].y=u[i].y,w[i].z=u[i].z}}}let v=new p;class D{constructor(L,w,b){this.data=new Int32Array(L*w*b*3),this.width=w,this.height=b}set(L,w,b,u){let i=((L*this.width+w)*this.height+b)*3;this.data[i]=u.ix,this.data[i+1]=u.iy,this.data[i+2]=u.iz}get(L,w,b){let u=((L*this.width+w)*this.height+b)*3;return{ix:this.data[u],iy:this.data[u+1],iz:this.data[u+2]}}}class x{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],x.MarchingCube||(x.MarchingCube=new p)}getVDWIndex(L){return!L.elem||typeof this.vdwRadii[L.elem]>"u"?"X":L.elem}getFacesAndVertices(L){let w={};for(let i=0,s=L.length;i<s;i++)w[L[i]]=!0;let b=this.verts;for(let i=0,s=b.length;i<s;i++)b[i].x=b[i].x/this.scaleFactor-this.ptranx,b[i].y=b[i].y/this.scaleFactor-this.ptrany,b[i].z=b[i].z/this.scaleFactor-this.ptranz;let u=[];for(let i=0,s=this.faces.length;i<s;i+=3){let h=this.faces[i],g=this.faces[i+1],y=this.faces[i+2],E=b[h].atomid,l=b[g].atomid,f=b[y].atomid,m=E;l<m&&(m=l),f<m&&(m=f),w[m]&&h!==g&&g!==y&&h!==y&&(u.push(h),u.push(g),u.push(y))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:b,faces:u}}initparm(L,w,b){b>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let u=1/this.scaleFactor*5.5;this.pminx=L[0][0],this.pmaxx=L[1][0],this.pminy=L[0][1],this.pmaxy=L[1][1],this.pminz=L[0][2],this.pmaxz=L[1][2],w?(this.pminx-=this.probeRadius+u,this.pminy-=this.probeRadius+u,this.pminz-=this.probeRadius+u,this.pmaxx+=this.probeRadius+u,this.pmaxy+=this.probeRadius+u,this.pmaxz+=this.probeRadius+u):(this.pminx-=u,this.pminy-=u,this.pminz-=u,this.pmaxx+=u,this.pmaxy+=u,this.pmaxz+=u),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(w),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(L){let w={};for(const b in this.vdwRadii){let u=this.vdwRadii[b];L?w[b]=(u+this.probeRadius)*this.scaleFactor+.5:w[b]=u*this.scaleFactor+.5;let i=w[b]*w[b];this.widxz[b]=Math.floor(w[b])+1,this.depty[b]=new Int32Array(this.widxz[b]*this.widxz[b]);let s=0;for(let h=0;h<this.widxz[b];h++)for(let g=0;g<this.widxz[b];g++){let y=h*h+g*g;if(y>i)this.depty[b][s]=-1;else{let E=Math.sqrt(i-y);this.depty[b][s]=Math.floor(E)}s++}}}fillvoxels(L,w){for(let b=0,u=this.vpBits.length;b<u;b++)this.vpBits[b]=0,this.vpDistance[b]=-1,this.vpAtomID[b]=-1;for(let b in w){let u=L[w[b]];u!==void 0&&this.fillAtom(u,L)}for(let b=0,u=this.vpBits.length;b<u;b++)this.vpBits[b]&this.INOUT&&(this.vpBits[b]|=this.ISDONE)}fillAtom(L,w){let b=Math.floor(.5+this.scaleFactor*(L.x+this.ptranx)),u=Math.floor(.5+this.scaleFactor*(L.y+this.ptrany)),i=Math.floor(.5+this.scaleFactor*(L.z+this.ptranz)),s=this.getVDWIndex(L),h=0,g=this.pWidth*this.pHeight;for(let y=0,E=this.widxz[s];y<E;y++)for(let l=0;l<E;l++){if(this.depty[s][h]!=-1){for(let f=-1;f<2;f++)for(let m=-1;m<2;m++)for(let C=-1;C<2;C++)if(f!==0&&m!==0&&C!==0){let T=f*y,P=C*l;for(let F=0;F<=this.depty[s][h];F++){let N=F*m,B=b+T,U=u+N,K=i+P;if(B<0||U<0||K<0||B>=this.pLength||U>=this.pWidth||K>=this.pHeight)continue;let H=B*g+U*this.pHeight+K;if(!(this.vpBits[H]&this.INOUT))this.vpBits[H]|=this.INOUT,this.vpAtomID[H]=L.serial;else{let G=w[this.vpAtomID[H]];if(G.serial!=L.serial){let $=b+T-Math.floor(.5+this.scaleFactor*(G.x+this.ptranx)),V=u+N-Math.floor(.5+this.scaleFactor*(G.y+this.ptrany)),k=i+P-Math.floor(.5+this.scaleFactor*(G.z+this.ptranz));T*T+N*N+P*P<$*$+V*V+k*k&&(this.vpAtomID[H]=L.serial)}}}}}h++}}fillvoxelswaals(L,w){for(let b=0,u=this.vpBits.length;b<u;b++)this.vpBits[b]&=~this.ISDONE;for(let b in w){let u=L[w[b]];u!==void 0&&this.fillAtomWaals(u,L)}}fillAtomWaals(L,w){let b=0,u=Math.floor(.5+this.scaleFactor*(L.x+this.ptranx)),i=Math.floor(.5+this.scaleFactor*(L.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(L.z+this.ptranz)),h=this.getVDWIndex(L),g=this.pWidth*this.pHeight;for(let y=0,E=this.widxz[h];y<E;y++)for(let l=0;l<E;l++){if(this.depty[h][b]!=-1){for(let f=-1;f<2;f++)for(let m=-1;m<2;m++)for(let C=-1;C<2;C++)if(f!==0&&m!==0&&C!==0){let T=f*y,P=C*l;for(let F=0;F<=this.depty[h][b];F++){let N=F*m,B=u+T,U=i+N,K=s+P;if(B<0||U<0||K<0||B>=this.pLength||U>=this.pWidth||K>=this.pHeight)continue;let H=B*g+U*this.pHeight+K;if(!(this.vpBits[H]&this.ISDONE))this.vpBits[H]|=this.ISDONE,this.vpAtomID[H]=L.serial;else{let G=w[this.vpAtomID[H]];if(G.serial!=L.serial){let $=u+T-Math.floor(.5+this.scaleFactor*(G.x+this.ptranx)),V=i+N-Math.floor(.5+this.scaleFactor*(G.y+this.ptrany)),k=s+P-Math.floor(.5+this.scaleFactor*(G.z+this.ptranz));T*T+N*N+P*P<$*$+V*V+k*k&&(this.vpAtomID[H]=L.serial)}}}}}b++}}buildboundary(){let L=this.pWidth*this.pHeight;for(let w=0;w<this.pLength;w++)for(let b=0;b<this.pHeight;b++)for(let u=0;u<this.pWidth;u++){let i=w*L+u*this.pHeight+b;if(this.vpBits[i]&this.INOUT){let s=0;for(;s<26;){let h=w+this.nb[s][0],g=b+this.nb[s][2],y=u+this.nb[s][1];if(h>-1&&h<this.pLength&&y>-1&&y<this.pWidth&&g>-1&&g<this.pHeight&&!(this.vpBits[h*L+y*this.pHeight+g]&this.INOUT)){this.vpBits[i]|=this.ISBOUND;break}else s++}}}}fastdistancemap(){let L=new D(this.pLength,this.pWidth,this.pHeight),w=this.pWidth*this.pHeight,b=this.cutRadius*this.cutRadius,u=[],i=[],s;for(let y=0;y<this.pLength;y++)for(let E=0;E<this.pWidth;E++)for(let l=0;l<this.pHeight;l++)if(s=y*w+E*this.pHeight+l,this.vpBits[s]&=~this.ISDONE,this.vpBits[s]&this.INOUT&&this.vpBits[s]&this.ISBOUND){let f={ix:y,iy:E,iz:l};L.set(y,E,l,f),u.push(f),this.vpDistance[s]=0,this.vpBits[s]|=this.ISDONE,this.vpBits[s]&=~this.ISBOUND}do{i=this.fastoneshell(u,L),u=[];for(let y=0,E=i.length;y<E;y++)s=w*i[y].ix+this.pHeight*i[y].iy+i[y].iz,this.vpBits[s]&=~this.ISBOUND,this.vpDistance[s]<=1.0404*b&&u.push({ix:i[y].ix,iy:i[y].iy,iz:i[y].iz})}while(u.length!==0);u=[],i=[],L=null;let h=this.scaleFactor-.5;h<0&&(h=0);let g=b-.5/(.1+h);for(let y=0;y<this.pLength;y++)for(let E=0;E<this.pWidth;E++)for(let l=0;l<this.pHeight;l++)s=y*w+E*this.pHeight+l,this.vpBits[s]&=~this.ISBOUND,this.vpBits[s]&this.INOUT&&(!(this.vpBits[s]&this.ISDONE)||this.vpBits[s]&this.ISDONE&&this.vpDistance[s]>=g)&&(this.vpBits[s]|=this.ISBOUND)}fastoneshell(L,w){let b,u,i,s,h,g,y,E,l,f=[];if(L.length===0)return f;let m={ix:-1,iy:-1,iz:-1},C=this.pWidth*this.pHeight;for(let T=0,P=L.length;T<P;T++){b=L[T].ix,u=L[T].iy,i=L[T].iz,E=w.get(b,u,i);for(let F=0;F<6;F++)m.ix=b+this.nb[F][0],m.iy=u+this.nb[F][1],m.iz=i+this.nb[F][2],m.ix<this.pLength&&m.ix>-1&&m.iy<this.pWidth&&m.iy>-1&&m.iz<this.pHeight&&m.iz>-1&&(l=m.ix*C+this.pHeight*m.iy+m.iz,this.vpBits[l]&this.INOUT&&!(this.vpBits[l]&this.ISDONE)?(w.set(m.ix,m.iy,i+this.nb[F][2],E),s=m.ix-E.ix,h=m.iy-E.iy,g=m.iz-E.iz,y=s*s+h*h+g*g,this.vpDistance[l]=y,this.vpBits[l]|=this.ISDONE,this.vpBits[l]|=this.ISBOUND,f.push({ix:m.ix,iy:m.iy,iz:m.iz})):this.vpBits[l]&this.INOUT&&this.vpBits[l]&this.ISDONE&&(s=m.ix-E.ix,h=m.iy-E.iy,g=m.iz-E.iz,y=s*s+h*h+g*g,y<this.vpDistance[l]&&(w.set(m.ix,m.iy,m.iz,E),this.vpDistance[l]=y,this.vpBits[l]&this.ISBOUND||(this.vpBits[l]|=this.ISBOUND,f.push({ix:m.ix,iy:m.iy,iz:m.iz})))))}for(let T=0,P=L.length;T<P;T++){b=L[T].ix,u=L[T].iy,i=L[T].iz,E=w.get(b,u,i);for(let F=6;F<18;F++)m.ix=b+this.nb[F][0],m.iy=u+this.nb[F][1],m.iz=i+this.nb[F][2],m.ix<this.pLength&&m.ix>-1&&m.iy<this.pWidth&&m.iy>-1&&m.iz<this.pHeight&&m.iz>-1&&(l=m.ix*C+this.pHeight*m.iy+m.iz,this.vpBits[l]&this.INOUT&&!(this.vpBits[l]&this.ISDONE)?(w.set(m.ix,m.iy,i+this.nb[F][2],E),s=m.ix-E.ix,h=m.iy-E.iy,g=m.iz-E.iz,y=s*s+h*h+g*g,this.vpDistance[l]=y,this.vpBits[l]|=this.ISDONE,this.vpBits[l]|=this.ISBOUND,f.push({ix:m.ix,iy:m.iy,iz:m.iz})):this.vpBits[l]&this.INOUT&&this.vpBits[l]&this.ISDONE&&(s=m.ix-E.ix,h=m.iy-E.iy,g=m.iz-E.iz,y=s*s+h*h+g*g,y<this.vpDistance[l]&&(w.set(m.ix,m.iy,m.iz,E),this.vpDistance[l]=y,this.vpBits[l]&this.ISBOUND||(this.vpBits[l]|=this.ISBOUND,f.push({ix:m.ix,iy:m.iy,iz:m.iz})))))}for(let T=0,P=L.length;T<P;T++){b=L[T].ix,u=L[T].iy,i=L[T].iz,E=w.get(b,u,i);for(let F=18;F<26;F++)m.ix=b+this.nb[F][0],m.iy=u+this.nb[F][1],m.iz=i+this.nb[F][2],m.ix<this.pLength&&m.ix>-1&&m.iy<this.pWidth&&m.iy>-1&&m.iz<this.pHeight&&m.iz>-1&&(l=m.ix*C+this.pHeight*m.iy+m.iz,this.vpBits[l]&this.INOUT&&!(this.vpBits[l]&this.ISDONE)?(w.set(m.ix,m.iy,i+this.nb[F][2],E),s=m.ix-E.ix,h=m.iy-E.iy,g=m.iz-E.iz,y=s*s+h*h+g*g,this.vpDistance[l]=y,this.vpBits[l]|=this.ISDONE,this.vpBits[l]|=this.ISBOUND,f.push({ix:m.ix,iy:m.iy,iz:m.iz})):this.vpBits[l]&this.INOUT&&this.vpBits[l]&this.ISDONE&&(s=m.ix-E.ix,h=m.iy-E.iy,g=m.iz-E.iz,y=s*s+h*h+g*g,y<this.vpDistance[l]&&(w.set(m.ix,m.iy,m.iz,E),this.vpDistance[l]=y,this.vpBits[l]&this.ISBOUND||(this.vpBits[l]|=this.ISBOUND,f.push({ix:m.ix,iy:m.iy,iz:m.iz})))))}return f}marchingcubeinit(L){for(let w=0,b=this.vpBits.length;w<b;w++)L==1?this.vpBits[w]&=~this.ISBOUND:L==4?(this.vpBits[w]&=~this.ISDONE,this.vpBits[w]&this.ISBOUND&&(this.vpBits[w]|=this.ISDONE),this.vpBits[w]&=~this.ISBOUND):L==2?this.vpBits[w]&this.ISBOUND&&this.vpBits[w]&this.ISDONE?this.vpBits[w]&=~this.ISBOUND:this.vpBits[w]&this.ISBOUND&&!(this.vpBits[w]&this.ISDONE)&&(this.vpBits[w]|=this.ISDONE):L==3&&(this.vpBits[w]&=~this.ISBOUND)}marchingcube(L){this.marchingcubeinit(L),this.verts=[],this.faces=[],x.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let w=this.pWidth*this.pHeight;for(let b=0,u=this.verts.length;b<u;b++)this.verts[b].atomid=this.vpAtomID[this.verts[b].x*w+this.pHeight*this.verts[b].y+this.verts[b].z];x.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}x.MarchingCube=new p},"./src/SurfaceWorker.js"(){$3Dmol.workerString=(function(){self.onmessage=function(o){var a=o.data,n=a.type;if(n<0)self.atomData=a.atoms,self.volume=a.volume,self.ps=new ProteinSurface;else{var d=self.ps;d.initparm(a.expandedExtent,n!=1,self.volume),d.fillvoxels(self.atomData,a.extendedAtoms),d.buildboundary(),(n===4||n===2)&&(d.fastdistancemap(),d.boundingatom(!1),d.fillvoxelswaals(self.atomData,a.extendedAtoms)),d.marchingcube(n);var R=d.getFacesAndVertices(a.atomsToShow);self.postMessage(R)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},"./src/VolumeData.ts"(o,a,n){n.r(a),n.d(a,{VolumeData:()=>v});var d=n("./src/utilities.ts"),R=n("./src/WebGL/math/index.ts"),S=n("./src/parsers/VASP.ts"),j=n("./src/parsers/CUBE.ts"),p=n("./node_modules/pako/dist/pako.esm.mjs");class v{constructor(x,A,L){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(s){var h=s/(this.size.y*this.size.z),g=s%(this.size.y*this.size.z),y=s%this.size.z;return h*=this.unit.x,g*=this.unit.y,y*=this.unit.z,h+=this.origin.x,g+=this.origin.y,y+=this.origin.z,{x:h,y:g,z:y}},this.vasp=function(s){var h=s.replace(/^\s+/,"").split(/[\n\r]/),g=(0,S.VASP)(s)[0],y=g.length;if(y==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var E=1.889725992,l=.036749309,f=parseFloat(h[1]),m;m=h[2].replace(/^\s+/,"").split(/\s+/);var C=new R.Vector3(parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])).multiplyScalar(f*E);m=h[3].replace(/^\s+/,"").split(/\s+/);var T=new R.Vector3(parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])).multiplyScalar(f*E);m=h[4].replace(/^\s+/,"").split(/\s+/);var P=new R.Vector3(parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])).multiplyScalar(f*E),F=C.x*(T.y*P.z-P.y*T.z)-T.x*(C.y*P.z-P.y*C.z)+P.x*(C.y*T.z-T.y*C.z);F=Math.abs(F)/Math.pow(E,3);var N=1/F;h.splice(0,8+y+1);var B=h[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),U=Math.abs(parseFloat(B[0])),K=Math.abs(parseFloat(B[1])),H=Math.abs(parseFloat(B[2])),G=this.origin=new R.Vector3(0,0,0);this.size={x:U,y:K,z:H},this.unit=new R.Vector3(C.x,T.y,P.z),C=C.multiplyScalar(1/(E*U)),T=T.multiplyScalar(1/(E*K)),P=P.multiplyScalar(1/(E*H)),(C.y!=0||C.z!=0||T.x!=0||T.z!=0||P.x!=0||P.y!=0)&&(this.matrix=new R.Matrix4(C.x,T.x,P.x,0,C.y,T.y,P.y,0,C.z,T.z,P.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new R.Matrix4().makeTranslation(G.x,G.y,G.z)),this.origin=new R.Vector3(0,0,0),this.unit=new R.Vector3(1,1,1)),h.splice(0,1);var $=h.join(" ");$=$.replace(/^\s+/,"");var V=$.split(/[\s\r]+/);V.splice(U*K*H+1);for(var k=Float32Array.from(V,parseFloat),Y=0;Y<k.length;Y++)k[Y]=k[Y]*N*l;this.data=k},this.dx=function(s){var h=s.split(/[\n\r]+/),g,y=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,E=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,l=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,f=/data follows/,m=0;for(m=0;m<h.length;m++){var C=h[m];if(g=y.exec(C)){var T=parseInt(g[1]),P=parseInt(g[2]),F=parseInt(g[3]);this.size={x:T,y:P,z:F}}else if(g=l.exec(C)){var N=parseFloat(g[1]);if((parseFloat(g[2])!=0||parseFloat(g[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),m+=1,C=h[m],g=l.exec(C),g==null){console.error("Parse error in dx delta matrix");return}var B=parseFloat(g[2]);if((parseFloat(g[1])!=0||parseFloat(g[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),m+=1,C=h[m],g=l.exec(C),g==null){console.error("Parse error in dx delta matrix");return}var U=parseFloat(g[3]);(parseFloat(g[1])!=0||parseFloat(g[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new R.Vector3(N,B,U)}else if(g=E.exec(C)){var K=parseFloat(g[1]),H=parseFloat(g[2]),G=parseFloat(g[3]);this.origin=new R.Vector3(K,H,G)}else if(g=f.exec(C))break}if(m+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var $=h.splice(m).join(" "),V=$.split(/[\s\r]+/);this.data=Float32Array.from(V,parseFloat)},A=A.toLowerCase(),/\.gz$/.test(A)){A=A.replace(/\.gz$/,"");try{this[A]&&this.isbinary.has(A)?(typeof x=="string"&&(x=(0,d.base64ToArray)(x)),x=(0,p.inflate)(x)):x=new TextDecoder("utf-8").decode((0,p.inflate)(x))}catch(s){console.error(s)}}if(this[A]&&(this.isbinary.has(A)&&typeof x=="string"&&(x=(0,d.base64ToArray)(x)),this[A](x)),L){if(L.negate)for(let s=0,h=this.data.length;s<h;s++)this.data[s]=-this.data[s];if(L.normalize){var w=0;for(let s=0,h=this.data.length;s<h;s++)w+=this.data[s];var b=w/this.data.length;w=0;for(let s=0,h=this.data.length;s<h;s++){var u=this.data[s]-b;w+=u*u}var i=w/this.data.length;for(let s=0,h=this.data.length;s<h;s++)this.data[s]=(this.data[s]-b)/i}}}getIndex(x,A,L){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new R.Matrix4().getInverse(this.matrix));var w=new R.Vector3(x,A,L);w=w.applyMatrix4(this.inversematrix),x=w.x,A=w.y,L=w.z}else x-=this.origin.x,A-=this.origin.y,L-=this.origin.z,x/=this.unit.x,A/=this.unit.y,L/=this.unit.z;return x=Math.round(x),A=Math.round(A),L=Math.round(L),x<0||x>=this.size.x||A<0||A>=this.size.y||L<0||L>=this.size.z?-1:x*this.size.y*this.size.z+A*this.size.z+L}getVal(x,A,L){let w=this.getIndex(x,A,L);return w<0?0:this.data[w]}cube(x){var A=x.split(/\r?\n/);if(!(A.length<6)){var L=(0,j.CUBE)(x,{}).modelData[0].cryst,w=A[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),b=parseFloat(w[0]),u=Math.abs(b);this.origin=L.origin,this.size=L.size,this.unit=L.unit,this.matrix=L.matrix4;var i=6;b<0&&i++;var s=A.splice(u+i).join(" ");s=s.replace(/^\s+/,"");var h=s.split(/[\s\r]+/);this.data=Float32Array.from(h,parseFloat)}}ccp4(x){var A={};x=new Int8Array(x);var L=new Int32Array(x.buffer,0,56),w=new Float32Array(x.buffer,0,56),b=new DataView(x.buffer);if(A.MAP=String.fromCharCode(b.getUint8(208),b.getUint8(209),b.getUint8(210),b.getUint8(211)),A.MACHST=[b.getUint8(212),b.getUint8(213)],A.MACHST[0]===17&&A.MACHST[1]===17)for(var u=x.byteLength,i=0;i<u;i+=4)b.setFloat32(i,b.getFloat32(i),!0);A.NX=L[0],A.NY=L[1],A.NZ=L[2],A.MODE=L[3],A.NXSTART=L[4],A.NYSTART=L[5],A.NZSTART=L[6],A.MX=L[7],A.MY=L[8],A.MZ=L[9],A.xlen=w[10],A.ylen=w[11],A.zlen=w[12],A.alpha=w[13],A.beta=w[14],A.gamma=w[15],A.MAPC=L[16],A.MAPR=L[17],A.MAPS=L[18],A.DMIN=w[19],A.DMAX=w[20],A.DMEAN=w[21],A.ISPG=L[22],A.NSYMBT=L[23],A.LSKFLG=L[24],A.originX=w[49],A.originY=w[50],A.originZ=w[51],A.ARMS=w[54];var s=A,h=[s.xlen,0,0],g=[s.ylen*Math.cos(Math.PI/180*s.gamma),s.ylen*Math.sin(Math.PI/180*s.gamma),0],y=[s.zlen*Math.cos(Math.PI/180*s.beta),s.zlen*(Math.cos(Math.PI/180*s.alpha)-Math.cos(Math.PI/180*s.gamma)*Math.cos(Math.PI/180*s.beta))/Math.sin(Math.PI/180*s.gamma),0];y[2]=Math.sqrt(s.zlen*s.zlen*Math.sin(Math.PI/180*s.beta)*Math.sin(Math.PI/180*s.beta)-y[1]*y[1]);var E=[0,h,g,y],l=[0,s.MX,s.MY,s.MZ],f=[0,s.MAPC,s.MAPR,s.MAPS];this.matrix=new R.Matrix4,this.matrix.set(E[f[1]][0]/l[f[1]],E[f[2]][0]/l[f[2]],E[f[3]][0]/l[f[3]],0,E[f[1]][1]/l[f[1]],E[f[2]][1]/l[f[2]],E[f[3]][1]/l[f[3]],0,E[f[1]][2]/l[f[1]],E[f[2]][2]/l[f[2]],E[f[3]][2]/l[f[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new R.Matrix4().makeTranslation(s.NXSTART+s.originX,s.NYSTART+s.originY,s.NZSTART+s.originZ)),this.origin=new R.Vector3(0,0,0),this.unit=new R.Vector3(1,1,1),this.size={x:A.NX,y:A.NY,z:A.NZ},this.dimensionorder=[A.MAPC,A.MAPR,A.MAPS];var m=new Float32Array(x.buffer,1024+A.NSYMBT),C=A.NX,T=A.NY,P=A.NZ;this.data=new Float32Array(C*T*P);for(let F=0;F<C;F++)for(let N=0;N<T;N++)for(let B=0;B<P;B++)this.data[(F*T+N)*P+B]=m[(B*T+N)*C+F]}}},"./src/VolumetricRender.ts"(o,a,n){n.r(a),n.d(a,{GLVolumetricRender:()=>v});var d=n("./src/WebGL/shapes/index.ts"),R=n("./src/WebGL/math/index.ts"),S=n("./src/WebGL/index.ts"),j=n("./src/colors.ts"),p=n("./src/GLShape.ts");class v{static interpolateArray(x,A){function L(y,E,l){return y+(E-y)*l}var w=[],b=(x.length-1)/(A-1);w[0]=x[0];for(var u=1;u<A-1;u++){var i=u*b,s=Math.floor(i),h=Math.ceil(i),g=i-s;w[u]=L(x[s],x[h],g)}return w[A-1]=x[x.length-1],w}constructor(x,A,L){this.hidden=!1,this.boundingSphere=new d.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,A=A||{};var w=Object.assign([],A.transferfn);this.subsamples=A.subsamples||5;let b=256;w.forEach(function(T){T.value=parseFloat(T.value)}),w.sort(function(T,P){return T.value-P.value}),this.min=w[0].value,w.length==0&&w.push(w[0]),this.max=w[w.length-1].value;var u,i,s,h,g,y,E,l,f,m;for(let T=0;T<w.length-1;T++)if(s=j.CC.color(w[T].color),h=j.CC.color(w[T+1].color),f=w[T].opacity,m=w[T+1].opacity,u=Math.floor((w[T].value-this.min)*b/(this.max-this.min)),i=Math.floor((w[T+1].value-this.min)*b/(this.max-this.min)),u!=i){g=v.interpolateArray([s.r*255,h.r*255],i-u),y=v.interpolateArray([s.g*255,h.g*255],i-u),E=v.interpolateArray([s.b*255,h.b*255],i-u),l=v.interpolateArray([f*255,m*255],i-u);for(let P=0;P<g.length;P++)this.transferfunctionbuffer.push(g[P]),this.transferfunctionbuffer.push(y[P]),this.transferfunctionbuffer.push(E[P]),this.transferfunctionbuffer.push(l[P])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),x.matrix){let T=new R.Vector3(0,0,0),P=new R.Vector3(x.size.x,x.size.y,x.size.z),F=new R.Vector3(1,1,1);T.applyMatrix4(x.matrix),P.applyMatrix4(x.matrix),F.applyMatrix4(x.matrix).sub(T),this.extent=[[T.x,T.y,T.z],[P.x,P.y,P.z]];for(let K=1;K<7;K++)P.x=K&1?x.size.x:0,P.y=K&2?x.size.y:0,P.z=K&4?x.size.z:0,P.applyMatrix4(x.matrix),this.extent[0][0]=Math.min(this.extent[0][0],P.x),this.extent[0][1]=Math.min(this.extent[0][1],P.y),this.extent[0][2]=Math.min(this.extent[0][2],P.z),this.extent[1][0]=Math.max(this.extent[1][0],P.x),this.extent[1][1]=Math.max(this.extent[1][1],P.y),this.extent[1][2]=Math.max(this.extent[1][2],P.z);let N=P.x-T.x,B=P.y-T.y,U=P.z-T.z;this.maxdepth=Math.sqrt(N*N+B*B+U*U),this.minunit=Math.min(Math.min(F.x,F.y),F.z),this.texmatrix=new R.Matrix4().identity().scale({x:x.size.x,y:x.size.y,z:x.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(x.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new R.Matrix4().identity();let T=x.unit.x*x.size.x,P=x.unit.y*x.size.y,F=x.unit.z*x.size.z;this.texmatrix.makeTranslation(-x.origin.x/T,-x.origin.y/P,-x.origin.z/F),this.texmatrix.scale({x:1/T,y:1/P,z:1/F}),this.minunit=Math.min(Math.min(x.unit.x,x.unit.y),x.unit.z),this.extent=[[x.origin.x,x.origin.y,x.origin.z],[x.origin.x+T,x.origin.y+P,x.origin.z+F]],this.maxdepth=Math.sqrt(T*T+P*P+F*F)}var C=new p.GLShape({});if(C.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=C.finalize(),this.boundingSphere.center=new R.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,A.coords===void 0&&A.selection!==void 0&&(L?A.coords=L.selectedAtoms(A.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),A.coords!==void 0&&A.seldist!==void 0){let T=new Uint8Array(x.data.length),P=A.seldist,F=P*P;for(let N=0,B=A.coords.length;N<B;N++){let U=A.coords[N],K=U.x-P,H=U.y-P,G=U.z-P,$=U.x+P,V=U.y+P,k=U.z+P;if(x.getIndex(K,H,G)>=0||x.getIndex($,V,k)>=0)for(let Y=K;Y<$;Y+=this.minunit)for(let ie=H;ie<V;ie+=this.minunit)for(let ne=G;ne<k;ne+=this.minunit){let he=x.getIndex(Y,ie,ne);he>=0&&!T[he]&&(Y-U.x)*(Y-U.x)+(ie-U.y)*(ie-U.y)+(ne-U.z)*(ne-U.z)<F&&(T[he]=1)}}for(let N=0,B=x.data.length;N<B;N++)T[N]==0&&(x.data[N]=1/0)}this.data=x}globj(x){if(this.renderedShapeObj&&(x.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new S.Object3D;var A=null,L=new S.Texture(this.data,!0),w=new S.Texture(this.transferfunctionbuffer,!1);L.needsUpdate=!0,w.needsUpdate=!0,w.flipY=!1,A=new S.VolumetricMaterial({transferfn:w,transfermin:this.min,transfermax:this.max,map:L,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var b=new S.Mesh(this.geo,A);this.shapeObj.add(b),this.renderedShapeObj=this.shapeObj.clone(),x.add(this.renderedShapeObj)}}removegl(x){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),x.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}},"./src/WebGL/Camera.ts"(o,a,n){n.r(a),n.d(a,{Camera:()=>S});var d=n("./src/WebGL/core/index.ts"),R=n("./src/WebGL/math/index.ts");class S extends d.Object3D{constructor(p=50,v=1,D=.1,x=2e3,A=!1){super(),this.projectionMatrix=new R.Matrix4,this.projectionMatrixInverse=new R.Matrix4,this.matrixWorldInverse=new R.Matrix4,this.fov=p,this.aspect=v,this.near=D,this.far=x;var L=this.position.z;this.right=L*Math.tan(Math.PI/180*p),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!A,this.updateProjectionMatrix()}lookAt(p){this.matrix.lookAt(this.position,p,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof R.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}},"./src/WebGL/Fog.ts"(o,a,n){n.r(a),n.d(a,{Fog:()=>R});var d=n("./src/colors.ts");class R{constructor(j,p=1,v=1e3){this.name="",this.color=new d.Color(j),this.near=p,this.far=v}clone(){return new R(this.color.getHex(),this.near,this.far)}}},"./src/WebGL/Renderer.ts"(o,a,n){n.r(a),n.d(a,{Renderer:()=>u});var d=n("./src/WebGL/Camera.ts"),R=n("./src/WebGL/constants/Sides.ts"),S=n("./src/WebGL/constants/TextureConstants.ts"),j=n("./src/WebGL/core/index.ts"),p=n("./src/colors.ts"),v=n("./src/WebGL/materials/index.ts"),D=n("./src/WebGL/math/index.ts"),x=n("./src/WebGL/objects/index.ts"),A=n("./src/WebGL/shaders/index.ts"),L=n("./src/WebGL/SpritePlugin.ts"),w=null,b=null;class u{constructor(s){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new D.Vector3,this._worldInverse=new D.Matrix4,this._projInverse=new D.Matrix4,this._textureMatrix=new D.Matrix4,this._fullProjModelMatrix=new D.Matrix4,this._fullProjModelMatrixInv=new D.Matrix4,this._direction=new D.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new L.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,s=s||{},this.row=s.row,this.col=s.col,this.rows=s.rows,this.cols=s.cols,this._canvas=s.canvas!==void 0?s.canvas:document.createElement("canvas"),this._precision=s.precision!==void 0?s.precision:"highp",this._alpha=s.alpha!==void 0?s.alpha:!0,this._premultipliedAlpha=s.premultipliedAlpha!==void 0?s.premultipliedAlpha:!0,this._antialias=s.antialias!==void 0?s.antialias:!1,this._upscale=s.upscale!==void 0?s.upscale:this._antialias,this._preserveDrawingBuffer=s.preserveDrawingBuffer!==void 0?s.preserveDrawingBuffer:!1,this._clearColor=s.clearColor!==void 0?new p.Color(s.clearColor):new p.Color(0),this._clearAlpha=s.clearAlpha!==void 0?s.clearAlpha:0,this._outlineMaterial=new v.MeshOutlineMaterial(s.outline),this._outlineSphereImposterMaterial=new v.SphereImposterOutlineMaterial(s.outline),this._outlineStickImposterMaterial=new v.StickImposterOutlineMaterial(s.outline),this._outlineEnabled=!!s.outline,this._AOEnabled=!!s.ambientOcclusion,s.ambientOcclusion&&typeof s.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(s.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),s.ambientOcclusion&&typeof s.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(s.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=s.id,!(s.containerWidth==0||s.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(s,h){this._clearColor.setHex(s),this._clearAlpha=h,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(s){this._outlineMaterial=new v.MeshOutlineMaterial(s),this._outlineSphereImposterMaterial=new v.SphereImposterOutlineMaterial(s),this._outlineStickImposterMaterial=new v.StickImposterOutlineMaterial(s),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(s){s&&(s.strength&&(this._AOstrength=s.strength),s.scale&&(this._AOradius=s.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&!this.isLost()){var s=this._gl.drawingBufferWidth/this.cols,h=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=s,this._viewportHeight=h,this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(s*this.col,h*this.row,s,h),this._gl.viewport(s*this.col,h*this.row,s,h)}}setSize(s,h){this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=s*this.devicePixelRatio,this._canvas.height=h*this.devicePixelRatio,this._canvas.style.width=s+"px",this._canvas.style.height=h+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null?(this.isLost()||(this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows),this.setViewport()):(this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight)),this.initFrameBuffer()}clear(s,h,g){var y=0;(s===void 0||s)&&(y|=this._gl.COLOR_BUFFER_BIT),(h===void 0||h)&&(y|=this._gl.DEPTH_BUFFER_BIT),(g===void 0||g)&&(y|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(y)}setMaterialFaces(s,h){var g=s.side===R.DoubleSide,y=s.side===R.BackSide;s.imposter||(y=h?!y:y),this._oldDoubleSided!==g&&(g?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=g),this._oldFlipSided!==y&&(y?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=y),this._gl.cullFace(this._gl.BACK)}setDepthTest(s){this._oldDepthTest!==s&&(s?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=s)}setDepthWrite(s){this._oldDepthWrite!==s&&(this._gl.depthMask(s),this._oldDepthWrite=s)}setBlending(s){s?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(s,h,g,y){s.addEventListener("dispose",this.onMaterialDispose.bind(this));var E,l;if(l=s.shaderID,l){var f=A.ShaderLib[l];s.vertexShader=f.vertexShader,s.fragmentShader=f.fragmentShader,s.uniforms=A.ShaderUtils.clone(f.uniforms),s.shaded&&s.makeShaded(this.SHADE_TEXTURE)}E={wireframe:s.wireframe,fragdepth:s.imposter,volumetric:s.volumetric,shaded:s.shaded},s.program=this.buildProgram(s.fragmentShader,s.vertexShader,s.uniforms,E)}renderBuffer(s,h,g,y,E,l){if(y.visible){var f,m;if(f=this.setProgram(s,h,g,y,l,this),!!f){m=f.attributes;var C=!1,T=y.wireframe?1:0,P=E.id*16777215+f.id*2+T;P!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=P,C=!0),C&&(this.disableAttributes(),m.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this.enableAttribute(m.position),this._gl.vertexAttribPointer(m.position,3,this._gl.FLOAT,!1,0,0)),m.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglColorBuffer),this.enableAttribute(m.color),this._gl.vertexAttribPointer(m.color,3,this._gl.FLOAT,!1,0,0)),m.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this.enableAttribute(m.normal),this._gl.vertexAttribPointer(m.normal,3,this._gl.FLOAT,!1,0,0)),m.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglOffsetBuffer),this.enableAttribute(m.offset),this._gl.vertexAttribPointer(m.offset,3,this._gl.FLOAT,!1,0,0)),m.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglRadiusBuffer),this.enableAttribute(m.radius),this._gl.vertexAttribPointer(m.radius,1,this._gl.FLOAT,!1,0,0)));var F,N;if(l instanceof x.Mesh){if(y.shaderID==="instanced"){var B=y.sphere.geometryGroups[0];C&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,B.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,B.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,B.faceArray,this._gl.STATIC_DRAW)),F=B.faceidx,this._extInstanced.vertexAttribDivisorANGLE(m.offset,1),this._extInstanced.vertexAttribDivisorANGLE(m.radius,1),this._extInstanced.vertexAttribDivisorANGLE(m.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,F,this._gl.UNSIGNED_SHORT,0,E.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(m.offset,0),this._extInstanced.vertexAttribDivisorANGLE(m.radius,0),this._extInstanced.vertexAttribDivisorANGLE(m.color,0)}else y.wireframe?(N=E.lineidx,this.setLineWidth(y.wireframeLinewidth),C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,N,this._gl.UNSIGNED_SHORT,0)):(F=E.faceidx,C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,F,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=F,this.info.render.faces+=F/3}else l instanceof x.Line&&(N=E.vertices,this.setLineWidth(y.linewidth),this._gl.drawArrays(this._gl.LINES,0,N),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(s,h,g){let y=s.__lights,E=s.fog,l=[];for(let C=0,T=s.__webglObjects.length;C<T;C++){let P=s.__webglObjects[C];P.render&&P[g]&&l.push(P)}if(l.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(s.__webglObjects,!0,g+"Depth",h,y,E,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let f=this._AOshader.uniforms;this._gl.uniform1f(f.total_strength,this._AOstrength),this._gl.uniform1f(f.radius,this._AOradius),this._fullProjModelMatrix=new D.Matrix4,this._fullProjModelMatrixInv=new D.Matrix4;let m=l[0].object;this._fullProjModelMatrix.multiplyMatrices(h.projectionMatrix,m._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(f.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(f.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(s,h){if(!(h instanceof d.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var g,y,E,l,f,m=s.__lights,C=s.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&s.updateMatrixWorld(),h.parent===void 0&&h.updateMatrixWorld(),h.matrixWorldInverse.getInverse(h.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(s),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),f=s.__webglObjects;let T=!1,P=this._AOEnabled;for(g=0,y=f.length;g<y;g++)E=f[g],l=E.object,E.render=!1,l.visible&&(this.setupMatrices(l,h),this.unrollBufferMaterial(E),E.render=!0,E.volumetric&&(T=!0),E.hasAO&&(P=!0));if(this.setBlending(!1),P&&this.setShading(s,h,"opaque"),this.renderObjects(s.__webglObjects,!0,"opaque",h,m,C,!1),P&&this.clearShading(),this.renderSprites(s,h,!1),this.renderObjects(s.__webglObjects,!0,"transparentDepth",h,m,C,!0),this.renderObjects(s.__webglObjects,!1,"transparent",h,m,C,!0),T&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(s.__webglObjects,!1,"volumetric",h,m,C,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(s,h,!0),this._bitmap){const F=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(F),F.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let s=this._viewportWidth,h=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,s,h),this._gl.viewport(0,0,s,h),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,s,h,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,s,h,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,s,h,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,s,h,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let s=this._viewportWidth,h=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,s,h),this._gl.viewport(0,0,s,h),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var g=this._antialias?A.ShaderLib.screenaa:A.ShaderLib.screen;this._screenshader=this.buildProgram(g.fragmentShader,g.vertexShader,g.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var y=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(y),this._gl.STATIC_DRAW);let E=A.ShaderLib.ssao;this._AOshader=this.buildProgram(E.fragmentShader,E.vertexShader,E.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let l=A.ShaderLib.blur;this._blurshader=this.buildProgram(l.fragmentShader,l.vertexShader,l.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(s){if(s.__webglObjects||(s.__webglObjects=[],s.__webglObjectsImmediate=[],s.__webglSprites=[],s.__webglFlares=[]),s.__objectsAdded.length){for(;s.__objectsAdded.length;)this.addObject(s.__objectsAdded[0],s),s.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;s.__objectsRemoved.length;)this.removeObject(s.__objectsRemoved[0],s),s.__objectsRemoved.splice(0,1);for(var h=0,g=s.__webglObjects.length;h<g;h++)this.updateObject(s.__webglObjects[h].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(s,h){(s==null||h==null)&&(s=this._canvas.width,h=this._canvas.height);var g=s/h;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var y=s/this.cols,E=h/this.rows;g=y/E}return g}setTexture(s,h,g){if(s.needsUpdate){s.__webglInit||(s.__webglInit=!0,s.addEventListener("dispose",this.onTextureDispose.bind(this)),s.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+h);var y=g?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(y,s.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,s.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,s.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,s.unpackAlignment);var E=this.paramToGL(s.format),l=this.paramToGL(s.type);if(g)this.setTextureParameters(this._gl.TEXTURE_3D,s),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,s.image.size.z,s.image.size.y,s.image.size.x,0,this._gl.RED,this._gl.FLOAT,s.image.data);else{var f=s.image,m=f.width,C=f.height;typeof m>"u"&&(m=f.length,E==this._gl.RGBA&&(m/=4),C=1),this.setTextureParameters(this._gl.TEXTURE_2D,s),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,E,l,s.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,m,C,0,E,l,s.image)}s.needsUpdate=!1,s.onUpdate&&s.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+h),g?this._gl.bindTexture(this._gl.TEXTURE_3D,s.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,s.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(s){this._enabledAttributes[s]||(this._gl.enableVertexAttribArray(s),this._enabledAttributes[s]=!0)}disableAttributes(){for(let s in this._enabledAttributes)this._enabledAttributes[s]&&(this._gl.disableVertexAttribArray(s),this._enabledAttributes[s]=!1)}setPolygonOffset(s,h,g){this._oldPolygonOffset!==s&&(s?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(s){s!==this._oldLineWidth&&(this._gl.lineWidth(s),this._oldLineWidth=s)}deallocateGeometry(s){if(s.__webglInit=void 0,s.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(s.__webglVertexBuffer),s.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(s.__webglColorBuffer),s.geometryGroups!==void 0)for(var h=0,g=s.groups;h<g;h++){var y=s.geometryGroups[h];y.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(y.__webglVertexBuffer),y.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(y.__webglColorBuffer),y.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(y.__webglNormalBuffer),y.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(y.__webglFaceBuffer),y.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(y.__webglLineBuffer)}}deallocateMaterial(s){var h=s.program;if(h!==void 0){s.program=void 0;var g,y,E,l=!1;for(g=0,y=this._programs.length;g<y;g++)if(E=this._programs[g],E.program===h){E.usedTimes--,E.usedTimes===0&&(l=!0);break}if(l===!0){var f=[];for(g=0,y=this._programs.length;g<y;g++)E=this._programs[g],E.program!==h&&f.push(E);this._programs=f,this._gl.deleteProgram(h),this.info.memory.programs--}}}deallocateTexture(s){if(s.image&&s.image.__webglTextureCube)this._gl.deleteTexture(s.image.__webglTextureCube);else{if(!s.__webglInit)return;s.__webglInit=!1,this._gl.deleteTexture(s.__webglTexture)}}onGeometryDispose(s){var h=s.target;h.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(h),this.info.memory.geometries--}onTextureDispose(s){var h=s.target;h.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(h),this.info.memory.textures--}onMaterialDispose(s){var h=s.target;h.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(h)}getShader(s,h){var g;return!this.isWebGL1()&&!h.startsWith("#version")&&(h=h.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),s=="fragment"?h=h.replace(/varying/g,"in"):h=h.replace(/varying/g,"out"),h=h.replace(/attribute/g,"in"),h=h.replace(/texture2D/g,"texture"),h=h.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),h=h.replace(/gl_FragColor/g,"glFragColor"),h=`#version 300 es
`+h),s==="fragment"?g=this._gl.createShader(this._gl.FRAGMENT_SHADER):s==="vertex"&&(g=this._gl.createShader(this._gl.VERTEX_SHADER)),g==null?null:(this._gl.shaderSource(g,h),this._gl.compileShader(g),this._gl.getShaderParameter(g,this._gl.COMPILE_STATUS)?g:(console.error(this._gl.getShaderInfoLog(g)),console.error("could not initialize shader"),null))}buildProgram(s,h,g,y){var E,l,f,m,C=[];C.push(s),C.push(h);for(E in y)C.push(E),C.push(y[E]);for(m=C.join(),E=0,l=this._programs.length;E<l;E++){var T=this._programs[E];if(T.code===m)return T.usedTimes++,T.program}if(this.isWebGL1()&&y.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(f=this._gl.createProgram(),f==null)return null;var P=this._precision,F="precision "+P+" float;",N=[y.volumetric?"#version 300 es":"",F].join(`
`),B=[y.volumetric?"#version 300 es":"",y.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",y.shaded?"#define SHADED 1":"",y.wireframe?"#define WIREFRAME 1":"",F].join(`
`),U=this.getShader("fragment",B+s),K=this.getShader("vertex",N+h);K!=null&&this._gl.attachShader(f,K),U!=null&&this._gl.attachShader(f,U),this._gl.linkProgram(f),this._gl.getProgramParameter(f,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),f.uniforms={},f.attributes={};var H,G,$;H=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"];for(G in g)H.push(G);for($=0;$<H.length;$++){var V=H[$];f.uniforms[V]=this._gl.getUniformLocation(f,V)}for(H=["position","normal","color","lineDistance","offset","radius"],$=0;$<H.length;$++){var k=H[$];f.attributes[k]=this._gl.getAttribLocation(f,k)}return f.id=this._programs_counter++,this._programs.push({program:f,code:m,usedTimes:1}),this.info.memory.programs=this._programs.length,f}setProgram(s,h,g,y,E,l){if(y.needsUpdate&&(y.program&&this.deallocateMaterial(y),this.initMaterial(y,h,g,E),y.needsUpdate=!1),y.program==null)return null;var f=!1,m=y.program,C=m.uniforms,T=y.uniforms;if(m!=this._currentProgram&&(this._gl.useProgram(m),this._currentProgram=m,f=!0),y.id!=this._currentMaterialId&&(this._currentMaterialId=y.id,f=!0),s!=this._currentCamera&&(this._currentCamera=s,f=!0),C.projectionMatrix&&this._gl.uniformMatrix4fv(C.projectionMatrix,!1,s.projectionMatrix.elements),C.modelViewMatrix&&this._gl.uniformMatrix4fv(C.modelViewMatrix,!1,E._modelViewMatrix.elements),C.normalMatrix&&this._gl.uniformMatrix3fv(C.normalMatrix,!1,E._normalMatrix.elements),C.projinv&&(this._projInverse.getInverse(s.projectionMatrix),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements)),C.viewMatrix&&this._gl.uniformMatrix4fv(C.viewMatrix,!1,s.matrixWorldInverse.elements),C.vWidth&&this._gl.uniform1f(C.vWidth,this._viewportWidth),C.vHeight&&this._gl.uniform1f(C.vHeight,this._viewportHeight),f){if(T.fogColor.value=g.color,T.fogNear.value=g.near,T.fogFar.value=g.far,y.shaderID.startsWith("lambert")||y.shaderID==="instanced"||y.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(m,h),this._lightsNeedUpdate=!1),T.directionalLightColor.value=this._lights.directional.colors,T.directionalLightDirection.value=this._lights.directional.positions;else if(y.shaderID.endsWith("outline"))T.outlineColor.value=y.outlineColor,T.outlineWidth.value=y.outlineWidth,T.outlinePushback.value=y.outlinePushback,T.outlineMaxPixels.value=y.outlineMaxPixels*this.devicePixelRatio;else if(y.shaderID==="volumetric"){E._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(E._modelViewMatrix),this._projInverse.getInverse(s.projectionMatrix),this._textureMatrix.multiplyMatrices(E.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(C.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements);let P=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);T.step.value=E.material.unit*P,T.maxdepth.value=E.material.maxdepth*P,T.transfermax.value=E.material.transfermax,T.transfermin.value=E.material.transfermin,T.subsamples.value=E.material.subsamples,l.setTexture(E.material.transferfn,4,!1),l.setTexture(E.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}T.opacity.value=y.opacity,this.loadMaterialUniforms(C,T)}return T.shading&&(T.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),m}loadMaterialUniforms(s,h){var g,y,E,l;for(g in h)s[g]&&(y=h[g].type,E=h[g].value,l=s[g],y==="f"?this._gl.uniform1f(l,E):y==="i"?this._gl.uniform1i(l,E):y==="fv"?this._gl.uniform3fv(l,E):y==="c"?this._gl.uniform3f(l,E.r,E.g,E.b):y==="f4"&&this._gl.uniform4f(l,E[0],E[1],E[2],E[3]))}addObject(s,h){var g,y,E,l;if(!s.__webglInit&&(s.__webglInit=!0,s._modelViewMatrix=new D.Matrix4,s._normalMatrix=new D.Matrix3,s.geometry!==void 0&&s.geometry.__webglInit===void 0&&(s.geometry.__webglInit=!0,s.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),s instanceof x.Mesh||s instanceof x.Line))for(E=s.geometry,g=0,y=E.geometryGroups.length;g<y;g++)l=E.geometryGroups[g],l.id=this._geometryGroupCounter++,l.__webglVertexBuffer||(s instanceof x.Mesh?(this.createMeshBuffers(l),E.elementsNeedUpdate=!0,E.normalsNeedUpdate=!0):s instanceof x.Line&&this.createLineBuffers(l),E.verticesNeedUpdate=!0,E.colorsNeedUpdate=!0);if(!s.__webglActive){if(s instanceof x.Mesh||s instanceof x.Line)for(E=s.geometry,g=0,y=E.geometryGroups.length;g<y;g++)l=E.geometryGroups[g],this.addBuffer(h.__webglObjects,l,s);else s instanceof x.Sprite&&h.__webglSprites.push(s);s.__webglActive=!0}}updateObject(s){var h=s.geometry,g;if(s instanceof x.Mesh||s instanceof x.Line){for(var y=0,E=h.geometryGroups.length;y<E;y++)g=h.geometryGroups[y],(h.verticesNeedUpdate||h.elementsNeedUpdate||h.colorsNeedUpdate||h.normalsNeedUpdate)&&this.setBuffers(g,this._gl.STATIC_DRAW);h.verticesNeedUpdate=!1,h.elementsNeedUpdate=!1,h.normalsNeedUpdate=!1,h.colorsNeedUpdate=!1,h.buffersNeedUpdate=!1}}removeObject(s,h){s instanceof x.Mesh||s instanceof x.Line?this.removeInstances(h.__webglObjects,s):s instanceof x.Sprite&&this.removeInstancesDirect(h.__webglSprites,s),s.__webglActive=!1}removeInstances(s,h){for(var g=s.length-1;g>=0;--g)s[g].object===h&&s.splice(g,1)}removeInstancesDirect(s,h){for(var g=s.length-1;g>=0;--g)s[g]===h&&s.splice(g,1)}unrollBufferMaterial(s){var h=s.object,g=h.material;if(g.volumetric)s.opaque=null,s.transparent=null,s.volumetric=g;else if(g.transparent){if(s.opaque=null,s.volumetric=null,s.transparent=g,!g.wireframe){let y=g.clone();y.opacity=0,s.transparentDepth=y}}else{if(s.opaque=g,s.transparent=null,s.volumetric=null,!g.wireframe){let y=g.clone();y.opacity=0,s.opaqueDepth=y}g.hasAO&&(s.hasAO=!0),(this._AOEnabled||s.hasAO)&&(s.opaqueShaded=g.clone(),s.opaqueShaded.shaded=!0)}}setBuffers(s,h){var g=s.vertexArray,y=s.colorArray;if(s.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,g,h)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,g,h)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,h),s.normalArray&&s.__webglNormalBuffer!==void 0){var E=s.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,E,h)}if(s.radiusArray&&s.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,s.radiusArray,h)),s.faceArray&&s.__webglFaceBuffer!==void 0){var l=s.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,s.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,l,h)}if(s.lineArray&&s.__webglLineBuffer!==void 0){var f=s.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,s.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,f,h)}}createMeshBuffers(s){s.radiusArray&&(s.__webglRadiusBuffer=this._gl.createBuffer()),s.useOffset&&(s.__webglOffsetBuffer=this._gl.createBuffer()),s.__webglVertexBuffer=this._gl.createBuffer(),s.__webglNormalBuffer=this._gl.createBuffer(),s.__webglColorBuffer=this._gl.createBuffer(),s.__webglFaceBuffer=this._gl.createBuffer(),s.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(s){s.__webglVertexBuffer=this._gl.createBuffer(),s.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(s,h,g){s.push({buffer:h,object:g,opaque:null,transparent:null})}setupMatrices(s,h){s._modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,s.matrixWorld),s._normalMatrix.getInverse(s._modelViewMatrix),s._normalMatrix.transpose()}filterFallback(s){return this._gl.LINEAR}setTextureParameters(s,h){s==this._gl.TEXTURE_2D?(this._gl.texParameteri(s,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(s,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(s,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(h.magFilter)),this._gl.texParameteri(s,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(h.minFilter))):(this._gl.texParameteri(s,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(s,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(s,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(s,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(s,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(s,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(s,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(s){return s===S.UnsignedByteType?this._gl.UNSIGNED_BYTE:s===S.RGBAFormat?this._gl.RGBA:s===S.NearestFilter?this._gl.NEAREST:0}setupLights(s,h){var g,y,E,l=0,f=0,m=0,C,T,P=this._lights,F=P.directional.colors,N=P.directional.positions,B=0,U=0;for(g=0,y=h.length;g<y;g++)if(E=h[g],C=E.color,T=E.intensity,E instanceof j.Light){if(this._direction.getPositionFromMatrix(E.matrixWorld),this._vector3.getPositionFromMatrix(E.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;N[U]=this._direction.x,N[U+1]=this._direction.y,N[U+2]=this._direction.z,F[U]=C.r*T,F[U+1]=C.g*T,F[U+2]=C.b*T,U+=3,B++}P.ambient[0]=l,P.ambient[1]=f,P.ambient[2]=m,P.directional.length=B}initGL(){try{if(OffscreenCanvas&&!(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null))(b==null||b.isContextLost())&&(w=new OffscreenCanvas(this._canvas.width,this._canvas.height),b=w.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=w,this._gl=b,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});else if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var s=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(s[6])}catch(h){console.error(h)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(s,h,g,y,E,l,f){var m,C,T,P,F,N,B;h?(F=s.length-1,N=-1,B=-1):(F=0,N=s.length,B=1);for(var U=F;U!==N;U+=B)if(m=s[U],m.render){if(C=m.object,T=m.buffer,P=m[g],(m.hasAO||this._AOEnabled)&&m[g+"Shaded"]&&(P=m[g+"Shaded"]),!P)continue;this.setBlending(f),this.setDepthTest(P.depthTest),this.setDepthWrite(P.depthWrite),this.setPolygonOffset(P.polygonOffset,P.polygonOffsetFactor,P.polygonOffsetUnits);var K=C._modelViewMatrix.isReflected();if(this.setMaterialFaces(P,K),this.renderBuffer(y,E,l,P,T,C),(this._outlineEnabled||P.outline)&&!P.wireframe&&P.shaderID!=="basic"&&P.opacity!==0){let H=this._outlineMaterial;P.shaderID=="sphereimposter"?H=this._outlineSphereImposterMaterial:P.shaderID=="stickimposter"&&(H=this._outlineStickImposterMaterial),this.renderBuffer(y,E,l,H,T,C)}}}renderSprites(s,h,g){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(s,h,this._currentWidth,this._currentHeight,g),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},"./src/WebGL/SpritePlugin.ts"(o,a,n){n.r(a),n.d(a,{SpritePlugin:()=>R});var d=n("./src/WebGL/shaders/index.ts");class R{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(p){this.gl=p.context,this.renderer=p,this.precision=p.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var v=0;this.sprite.vertices[v++]=-1,this.sprite.vertices[v++]=-1,this.sprite.vertices[v++]=0,this.sprite.vertices[v++]=0,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=-1,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=0,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=-1,this.sprite.vertices[v++]=1,this.sprite.vertices[v++]=0,this.sprite.vertices[v++]=1,v=0,this.sprite.faces[v++]=0,this.sprite.faces[v++]=1,this.sprite.faces[v++]=2,this.sprite.faces[v++]=0,this.sprite.faces[v++]=2,this.sprite.faces[v++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(d.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const D={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),D.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),D.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),D.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),D.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),D.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),D.color=this.gl.getUniformLocation(this.sprite.program,"color"),D.map=this.gl.getUniformLocation(this.sprite.program,"map"),D.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),D.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),D.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),D.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),D.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),D.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),D.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),D.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),D.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=D}render(p,v,D,x,A){var L,w,b,u,i,s,h,g,y,E;if(!this.gl)throw new Error("WebGLRenderer not initialized");let l=[];(L=p?.__webglSprites)===null||L===void 0||L.forEach(V=>{(A&&V.material.depthTest==!1||!A&&V.material.depthTest)&&l.push(V)});let f=l.length;if(!f)return;const m=this.sprite.attributes,C=this.sprite.uniforms;if(!C)throw new Error("Uniforms not defined");var T=D*.5,P=x*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(m.position),this.gl.enableVertexAttribArray(m.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(m.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(m.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(C.projectionMatrix,!1,v.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(C.map,0);var F=p.fog;F?(this.gl.uniform3f(C.fogColor,F.color.r,F.color.g,F.color.b),this.gl.uniform1f(C.fogNear,F.near),this.gl.uniform1f(C.fogFar,F.far)):(this.gl.uniform1f(C.fogNear,0),this.gl.uniform1f(C.fogFar,0));var N;let B,U,K,H=[];for(N=0;N<f;N++)B=l[N],U=B.material,U&&(U.depthTest==!1&&!A||!B.visible||U.opacity===0||(U.useScreenCoordinates?B.z=-B.position.z:(B._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,B.matrixWorld),B.z=-B._modelViewMatrix.elements[14])));for(l.sort(S),N=0;N<f;N++)if(B=l[N],U=B.material,!!U&&!(!B.visible||U.opacity===0)&&U.map&&U.map.image&&U.map.image.width){this.gl.uniform1f(C?.alphaTest||null,U.alphaTest);var G=U.map.image.width,$=U.map.image.height;H[0]=G*this.renderer.devicePixelRatio/D,H[1]=$*this.renderer.devicePixelRatio/x,U.useScreenCoordinates===!0?(this.gl.uniform1i(C.useScreenCoordinates,1),this.gl.uniform3f(C.screenPosition,(B.position.x*this.renderer.devicePixelRatio-T)/T,(P-B.position.y*this.renderer.devicePixelRatio)/P,Math.max(0,Math.min(1,B.position.z)))):(this.gl.uniform1i(C.useScreenCoordinates,0),this.gl.uniformMatrix4fv(C.modelViewMatrix,!1,B._modelViewMatrix.elements)),K=1/(U.scaleByViewport?x:1),H[0]*=K*B.scale.x,H[1]*=K*B.scale.y;let V=(w=U?.alignment)===null||w===void 0?void 0:w.x,k=(b=U?.alignment)===null||b===void 0?void 0:b.y;U.screenOffset&&(V=(V||0)+2*U.screenOffset.x/G,k=(k||0)+2*U.screenOffset.y/$),this.gl.uniform2f(C.uvScale,((u=U?.uvScale)===null||u===void 0?void 0:u.x)||1,((i=U?.uvScale)===null||i===void 0?void 0:i.y)||1),this.gl.uniform2f(C.uvOffset,((s=U?.uvOffset)===null||s===void 0?void 0:s.x)||0,((h=U?.uvOffset)===null||h===void 0?void 0:h.y)||0),this.gl.uniform2f(C.alignment,V||0,k||0),this.gl.uniform1f(C.opacity,U.opacity),this.gl.uniform3f(C.color,((g=U?.color)===null||g===void 0?void 0:g.r)||0,((y=U?.color)===null||y===void 0?void 0:y.g)||0,((E=U?.color)===null||E===void 0?void 0:E.b)||0),this.gl.uniform1f(C.rotation,B.rotation),this.gl.uniform2fv(C.scale,H),this.renderer.setDepthTest(U.depthTest),this.renderer.setDepthWrite(U.depthWrite),this.renderer.setTexture(U.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(p,v){if(!this.gl)throw new Error("WebGL Rendering context not found");var D=this.gl.createProgram();if(!D)throw new Error("Error creating webgl program");var x=this.gl.createShader(this.gl.FRAGMENT_SHADER),A=this.gl.createShader(this.gl.VERTEX_SHADER);if(!x)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!A)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var L="precision "+v+` float;
`;if(this.gl.shaderSource(x,L+p.fragmentShader),this.gl.shaderSource(A,L+p.vertexShader),this.gl.compileShader(x),this.gl.compileShader(A),!this.gl.getShaderParameter(x,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(A,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(x)} 
      ${this.gl.getShaderInfoLog(A)}`);return this.gl.attachShader(D,x),this.gl.attachShader(D,A),this.gl.linkProgram(D),this.gl.getProgramParameter(D,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),D}}function S(j,p){return j.z!==p.z?p.z-j.z:p.id-j.id}},"./src/WebGL/constants/Coloring.ts"(o,a,n){n.r(a),n.d(a,{Coloring:()=>d});var d;(function(R){R[R.NoColors=0]="NoColors",R[R.FaceColors=1]="FaceColors",R[R.VertexColors=2]="VertexColors"})(d||(d={}))},"./src/WebGL/constants/Shading.ts"(o,a,n){n.r(a),n.d(a,{Shading:()=>d});var d;(function(R){R[R.NoShading=0]="NoShading",R[R.FlatShading=1]="FlatShading",R[R.SmoothShading=2]="SmoothShading"})(d||(d={}))},"./src/WebGL/constants/Sides.ts"(o,a,n){n.r(a),n.d(a,{BackSide:()=>R,DoubleSide:()=>S,FrontSide:()=>d});const d=0,R=1,S=2},"./src/WebGL/constants/SpriteAlignment.ts"(o,a,n){n.r(a),n.d(a,{SpriteAlignment:()=>R});var d=n("./src/WebGL/math/index.ts");const R={topLeft:new d.Vector2(1,-1),topCenter:new d.Vector2(0,-1),topRight:new d.Vector2(-1,-1),centerLeft:new d.Vector2(1,0),center:new d.Vector2(0,0),centerRight:new d.Vector2(-1,0),bottomLeft:new d.Vector2(1,1),bottomCenter:new d.Vector2(0,1),bottomRight:new d.Vector2(-1,1)}},"./src/WebGL/constants/TextureConstants.ts"(o,a,n){n.r(a),n.d(a,{ClampToEdgeWrapping:()=>d,FloatType:()=>v,LinearFilter:()=>R,LinearMipMapLinearFilter:()=>j,NearestFilter:()=>S,R32Format:()=>A,RFormat:()=>x,RGBAFormat:()=>D,UnsignedByteType:()=>p});const d=1001,R=1006,S=1007,j=1008,p=1009,v=1010,D=1021,x=1022,A=1023},"./src/WebGL/constants/TextureOperations.ts"(o,a,n){n.r(a),n.d(a,{TextureOperations:()=>d});var d;(function(R){R[R.MultiplyOperation=0]="MultiplyOperation",R[R.MixOperation=1]="MixOperation",R[R.AddOperation=2]="AddOperation"})(d||(d={}))},"./src/WebGL/constants/index.ts"(o,a,n){n.r(a),n.d(a,{BackSide:()=>R.BackSide,ClampToEdgeWrapping:()=>p.ClampToEdgeWrapping,Coloring:()=>d.Coloring,DoubleSide:()=>R.DoubleSide,FloatType:()=>p.FloatType,FrontSide:()=>R.FrontSide,LinearFilter:()=>p.LinearFilter,LinearMipMapLinearFilter:()=>p.LinearMipMapLinearFilter,NearestFilter:()=>p.NearestFilter,R32Format:()=>p.R32Format,RFormat:()=>p.RFormat,RGBAFormat:()=>p.RGBAFormat,Shading:()=>S.Shading,SpriteAlignment:()=>j.SpriteAlignment,TextureOperations:()=>v.TextureOperations,UnsignedByteType:()=>p.UnsignedByteType});var d=n("./src/WebGL/constants/Coloring.ts"),R=n("./src/WebGL/constants/Sides.ts"),S=n("./src/WebGL/constants/Shading.ts"),j=n("./src/WebGL/constants/SpriteAlignment.ts"),p=n("./src/WebGL/constants/TextureConstants.ts"),v=n("./src/WebGL/constants/TextureOperations.ts")},"./src/WebGL/core/EventDispatcher.ts"(o,a,n){n.r(a),n.d(a,{EventDispatcher:()=>d});class d{constructor(){this.listeners={}}dispatchEvent(S){var j=this.listeners[S.type];if(j!==void 0){S.target=this;for(var p=0,v=j.length;p<v;p++)j[p].call(this,S)}}removeEventListener(S,j){if(!j)this.listeners[S]=[];else{var p=this.listeners[S].indexOf(j);p!==-1&&this.listeners[S].splice(p,1)}}addEventListener(S,j){this.listeners[S]===void 0&&(this.listeners[S]=[]),this.listeners[S].indexOf(j)===-1&&this.listeners[S].push(j)}}},"./src/WebGL/core/Geometry.ts"(o,a,n){n.r(a),n.d(a,{Geometry:()=>D,GeometryGroup:()=>v,GeometryIDCount:()=>x});var d=n("./src/WebGL/materials/LineBasicMaterial.ts"),R=n("./src/WebGL/core/EventDispatcher.ts"),S=n("./src/WebGL/math/index.ts"),j=n("./src/colors.ts");const p=65535;class v{constructor(L=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=L}setColor(L){var w=this.vertexArray,b=this.colorArray;if(!w)throw new Error("vertex array not initialized");if(!b)throw new Error("color array not initialized");let u=j.CC.color(L);for(var i=0;i<w.length;i+=3)b[i]=u.r,b[i+1]=u.g,b[i+2]=u.b}setColors(L){var w=this.vertexArray,b=this.colorArray;if(!w)throw new Error("vertex array not initialized");if(!b)throw new Error("color array not initialized");if(w.length!=b.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var u=0;u<w.length;u+=3){var i=L(w[u],w[u+1],w[u+2]);i instanceof j.Color||(i=j.CC.color(i)),b[u]=i.r,b[u+1]=i.g,b[u+2]=i.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var L=new S.Vector3,w,b,u,i,s=0;s<this.vertices;++s)w=s*3,b=this.vertexArray[w],u=this.vertexArray[w+1],i=this.vertexArray[w+2],L.x+=b,L.y+=u,L.z+=i;return L.divideScalar(this.vertices),L}setNormals(){var L=this.faceArray,w=this.vertexArray,b=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!L)throw new Error("face array not initialized");if(!w)throw new Error("vertex array not initialized");if(!b)throw new Error("normal array not initialized");for(var u,i,s,h,g,y,E,l=0;l<L.length/3;++l)u=L[l*3]*3,i=L[l*3+1]*3,s=L[l*3+2]*3,h=new S.Vector3(w[u],w[u+1],w[u+2]),g=new S.Vector3(w[i],w[i+1],w[i+2]),y=new S.Vector3(w[s],w[s+1],w[s+2]),h.subVectors(h,g),y.subVectors(y,g),y.cross(h),E=y,E.normalize(),b[u]+=E.x,b[i]+=E.x,b[s]+=E.x,b[u+1]+=E.y,b[i+1]+=E.y,b[s+1]+=E.y,b[u+2]+=E.z,b[i+2]+=E.z,b[s+2]+=E.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var L=this.faceArray,w=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!L)throw new Error("face array not initialized");for(var b=0;b<this.faceidx/3;++b){var u=b*3,i=u*2,s=L[u],h=L[u+1],g=L[u+2];w[i]=s,w[i+1]=h,w[i+2]=s,w[i+3]=g,w[i+4]=h,w[i+5]=g}}}vrml(L,w){var b,u,i,s,h,g,y,E,l,f,m,C,T,P,F,N,B,U,K="";if(K+=L+`Shape {
`+L+` appearance Appearance {
`+L+`  material Material {
`+L+"   diffuseColor "+((b=w?.color)===null||b===void 0?void 0:b.r)+" "+((u=w?.color)===null||u===void 0?void 0:u.g)+" "+((i=w?.color)===null||i===void 0?void 0:i.b)+`
`,w.wireframe&&this.colorArray){let G=this.colorArray;K+=L+"    emissiveColor "+G[0]+" "+G[1]+" "+G[2]+`
`}w?.transparent&&(K+=L+"   transparency "+(1-w.opacity)+`
`),K+=L+`  }
`,K+=L+` }
`;var H=L;if(L+=" ",w instanceof d.LineBasicMaterial||w.wireframe){K+=L+`geometry IndexedLineSet {
`+L+` colorPerVertex TRUE
`+L+` coord Coordinate {
`+L+`  point [
`;let G,$,V;for(let k=0;k<this.vertices;++k){let Y=k*3;G=(s=this.vertexArray)===null||s===void 0?void 0:s[Y],$=(h=this.vertexArray)===null||h===void 0?void 0:h[Y+1],V=(g=this.vertexArray)===null||g===void 0?void 0:g[Y+2],K+=L+"   "+G+" "+$+" "+V+`,
`}if(K+=L+`  ]
`,K+=L+` }
`,this.colorArray&&!w.wireframe){K+=L+` color Color {
`+L+`  color [
`;for(let k=0;k<this.vertices;++k){let Y=k*3;G=this.colorArray[Y],$=this.colorArray[Y+1],V=this.colorArray[Y+2],K+=L+"   "+G+" "+$+" "+V+`,
`}K+=L+`  ]
`,K+=L+` }
`}if(K+=L+` coordIndex [
`,w.wireframe&&this.faceArray)for(let k=0;k<this.faceidx;k+=3)G=(y=this.faceArray)===null||y===void 0?void 0:y[k],$=(E=this.faceArray)===null||E===void 0?void 0:E[k+1],V=(l=this.faceArray)===null||l===void 0?void 0:l[k+2],K+=L+"  "+G+", "+$+", "+V+`, -1,
`;else for(let k=0;k<this.vertices-1;k+=2)K+=L+"  "+k+", "+(k+1)+`, -1,
`;K+=L+` ]
`,K+=L+`}
`}else{K+=L+`geometry IndexedFaceSet {
`+L+` colorPerVertex TRUE
`+L+` normalPerVertex TRUE
`+L+` solid FALSE
`,K+=L+` coord Coordinate {
`+L+`  point [
`;let G,$,V;for(let k=0;k<this.vertices;++k){let Y=k*3;G=(f=this.vertexArray)===null||f===void 0?void 0:f[Y],$=(m=this.vertexArray)===null||m===void 0?void 0:m[Y+1],V=(C=this.vertexArray)===null||C===void 0?void 0:C[Y+2],K+=L+"   "+G+" "+$+" "+V+`,
`}K+=L+`  ]
`,K+=L+` }
`,K+=L+` normal Normal {
`+L+`  vector [
`;for(let k=0;k<this.vertices;++k){let Y=k*3;G=(T=this.normalArray)===null||T===void 0?void 0:T[Y],$=(P=this.normalArray)===null||P===void 0?void 0:P[Y+1],V=(F=this.normalArray)===null||F===void 0?void 0:F[Y+2],K+=L+"   "+G+" "+$+" "+V+`,
`}if(K+=L+`  ]
`,K+=L+` }
`,this.colorArray){K+=L+` color Color {
`+L+`  color [
`;for(let k=0;k<this.vertices;++k){let Y=k*3;G=this.colorArray[Y],$=this.colorArray[Y+1],V=this.colorArray[Y+2],K+=L+"   "+G+" "+$+" "+V+`,
`}K+=L+`  ]
`,K+=L+` }
`}K+=L+` coordIndex [
`;for(let k=0;k<this.faceidx;k+=3)G=(N=this.faceArray)===null||N===void 0?void 0:N[k],$=(B=this.faceArray)===null||B===void 0?void 0:B[k+1],V=(U=this.faceArray)===null||U===void 0?void 0:U[k+2],K+=L+"  "+G+", "+$+", "+V+`, -1,
`;K+=L+` ]
`,K+=L+`}
`}return K+=H+"}",K}truncateArrayBuffers(L=!0,w=!1){var b=this.vertexArray,u=this.colorArray,i=this.normalArray,s=this.faceArray,h=this.lineArray,g=this.radiusArray;this.vertexArray=b?.subarray(0,this.vertices*3)||null,this.colorArray=u?.subarray(0,this.vertices*3)||null,L?(this.normalArray=i?.subarray(0,this.vertices*3)||null,this.faceArray=s?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=h?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),g&&(this.radiusArray=g.subarray(0,this.vertices)),w&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class D extends R.EventDispatcher{constructor(L=!1,w=!1,b=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=x++,this.mesh=L,this.radii=w,this.offset=b}updateGeoGroup(L=0){var w,b=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!b||b.vertices+L>(((w=b?.vertexArray)===null||w===void 0?void 0:w.length)||0)/3)&&(b=this.addGeoGroup()),b}vrml(L,w){for(var b="",u=this.geometryGroups.length,i=0;i<u;i++){var s=this.geometryGroups[i];b+=s.vrml(L,w)+`,
`}return b}addGeoGroup(){var L=new v(this.geometryGroups.length);return this.geometryGroups.push(L),this.groups=this.geometryGroups.length,L.vertexArray=new Float32Array(p*3),L.colorArray=new Float32Array(p*3),this.mesh&&(L.normalArray=new Float32Array(p*3),L.faceArray=new Uint16Array(p*6),L.lineArray=new Uint16Array(p*6)),this.radii&&(L.radiusArray=new Float32Array(p)),L.useOffset=this.offset,L}setUpNormals(...L){for(var w=0;w<this.groups;w++){var b=this.geometryGroups[w];b.setNormals(...L)}}setColors(...L){for(var w=this.geometryGroups.length,b=0;b<w;b++){var u=this.geometryGroups[b];u.setColors(...L)}}setColor(...L){let w=this.geometryGroups.length;for(var b=0;b<w;b++){var u=this.geometryGroups[b];u.setColor(...L)}}setUpWireframe(...L){let w=this.geometryGroups.length;for(var b=0;b<w;b++){var u=this.geometryGroups[b];u.setLineIndices(...L)}}initTypedArrays(){for(var L=0;L<this.groups;L++){var w=this.geometryGroups[L];w.__inittedArrays!==!0&&w.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var L=0,w=0;w<this.groups;w++)L+=this.geometryGroups[w].vertices;return L}}let x=0},"./src/WebGL/core/Object3D.ts"(o,a,n){n.r(a),n.d(a,{Light:()=>v,Object3D:()=>j,Object3DIDCount:()=>S,Scene:()=>p});var d=n("./src/WebGL/math/index.ts"),R=n("./src/colors.ts");let S=0;class j{constructor(){this.id=S++,this.name="",this.children=[],this.position=new d.Vector3,this.rotation=new d.Vector3,this.matrix=new d.Matrix4,this.matrixWorld=new d.Matrix4,this.quaternion=new d.Quaternion,this.eulerOrder="XYZ",this.up=new d.Vector3(0,1,0),this.scale=new d.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(x){this.matrix.lookAt(x,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof d.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(x){if(x===this){console.error("Can't add $3Dmol.Object3D to itself");return}x.parent=this,this.children.push(x);for(var A=this;A.parent!==void 0;)A=A.parent;A!==void 0&&A instanceof p&&A.__addObject(x)}remove(x){var A=this.children.indexOf(x);if(A!==-1){x.parent=void 0,this.children.splice(A,1);for(var L=this;L.parent!==void 0;)L=L.parent;L!==void 0&&L instanceof p&&L.__removeObject(x)}}vrml(x){x||(x=" ");var A=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),L=0,w=0,b=0;if(A!=0){let s=Math.sin(A/2);L=this.quaternion.x/s,w=this.quaternion.y/s,b=this.quaternion.z/s}var u=x+`Transform {
`+x+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+x+" rotation "+L+" "+w+" "+b+" "+A+`
`+x+` children [
`;this.geometry&&(u+=this.geometry.vrml(x,this.material));for(var i=0;i<this.children.length;i++)u+=this.children[i].vrml(x+" ")+`,
`;return u+=` ]
`,u+="}",u}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof d.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(x){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||x===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var A=0;A<this.children.length;A++)this.children[A].updateMatrixWorld(!0)}clone(x){x===void 0&&(x=new j),x.name=this.name,x.up.copy(this.up),x.position.copy(this.position),x.rotation instanceof d.Vector3&&this.rotation instanceof d.Vector3?x.rotation.copy(this.rotation):x.rotation=this.rotation,x.eulerOrder=this.eulerOrder,x.scale.copy(this.scale),x.rotationAutoUpdate=this.rotationAutoUpdate,x.matrix.copy(this.matrix),x.matrixWorld.copy(this.matrixWorld),x.quaternion.copy(this.quaternion),x.matrixAutoUpdate=this.matrixAutoUpdate,x.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,x.useQuaternion=this.useQuaternion,x.visible=this.visible;for(var A=0;A<this.children.length;A++){var L=this.children[A];x.add(L.clone())}return x}setVisible(x){this.visible=x;for(var A=0;A<this.children.length;A++){var L=this.children[A];L.setVisible(x)}}}class p extends j{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(x){if(x instanceof v)this.__lights.indexOf(x)===-1&&this.__lights.push(x),x.target&&x.target.parent===void 0&&this.add(x.target);else if(this.__objects.indexOf(x)===-1){this.__objects.push(x),this.__objectsAdded.push(x);var A=this.__objectsRemoved.indexOf(x);A!==-1&&this.__objectsRemoved.splice(A,1)}for(var L=0;L<x.children.length;L++)this.__addObject(x.children[L])}__removeObject(x){var A;if(x instanceof v)A=this.__lights.indexOf(x),A!==-1&&this.__lights.splice(A,1);else if(A=this.__objects.indexOf(x),A!==-1){this.__objects.splice(A,1),this.__objectsRemoved.push(x);var L=this.__objectsAdded.indexOf(x);L!==-1&&this.__objectsAdded.splice(A,1)}for(var w=0;w<x.children.length;w++)this.__removeObject(x.children[w])}}class v extends j{constructor(x,A=1){super(),this.position=new d.Vector3(0,1,0),this.target=new j,this.castShadow=!1,this.onlyShadow=!1,this.color=new R.Color(x),this.intensity=A}}},"./src/WebGL/core/Projector.ts"(o,a,n){n.r(a),n.d(a,{Projector:()=>S});var d=n("./src/WebGL/math/index.ts");const R=new d.Matrix4;class S{static unprojectVector(p,v){return v.projectionMatrixInverse.getInverse(v.projectionMatrix),R.multiplyMatrices(v.matrixWorld,v.projectionMatrixInverse),p.applyProjection(R)}static projectVector(p,v){return v.matrixWorldInverse.getInverse(v.matrixWorld),R.multiplyMatrices(v.projectionMatrix,v.matrixWorldInverse),p.applyProjection(R)}projectVector(p,v){return S.projectVector(p,v)}unprojectVector(p,v){return S.unprojectVector(p,v)}}},"./src/WebGL/core/Raycaster.ts"(o,a,n){n.r(a),n.d(a,{Raycaster:()=>p,intersectObject:()=>s});var d=n("./src/WebGL/math/index.ts"),R=n("./src/WebGL/shapes/index.ts");const S=(h,g)=>h.distance-g.distance,j=new d.Matrix4;class p{constructor(g,y,E,l){this.precision=1e-4,this.linePrecision=.2,this.ray=new d.Ray(g,y),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=l||0,this.far=E||1/0}set(g,y){this.ray.set(g,y)}setFromCamera(g,y){y.ortho?(this.ray.origin.set(g.x,g.y,(y.near+y.far)/(y.near-y.far)).unproject(y),this.ray.direction.set(0,0,-1).transformDirection(y.matrixWorld)):(this.ray.origin.setFromMatrixPosition(y.matrixWorld),this.ray.direction.set(g.x,g.y,g.z),y.projectionMatrixInverse.getInverse(y.projectionMatrix),j.multiplyMatrices(y.matrixWorld,y.projectionMatrixInverse),this.ray.direction.applyProjection(j),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(g,y){for(var E=[],l=0,f=y.length;l<f;l++)s(g,y[l],this,E);return E.sort(S),E}}const v=h=>Math.min(Math.max(h,-1),1);var D=new R.Sphere,x=new R.Cylinder,A=new R.Triangle,L=new d.Vector3,w=new d.Vector3,b=new d.Vector3,u=new d.Vector3,i=new d.Vector3;function s(h,g,y,E){if(i.getPositionFromMatrix(h.matrixWorld),g.intersectionShape===void 0||g.hidden)return E;var l=g.intersectionShape,f=y.linePrecision;f*=h.matrixWorld.getMaxScaleOnAxis();var m=f*f;if(g.boundingSphere!==void 0&&g.boundingSphere instanceof R.Sphere&&(D.copy(g.boundingSphere),D.applyMatrix4(h.matrixWorld),!y.ray.isIntersectionSphere(D)))return E;var C,T,P,F,N,B,U,K,H,G,$,V,k,Y;for(C=0,T=l.triangle.length;C<T;C++)if(l.triangle[C]instanceof R.Triangle){if(A.copy(l.triangle[C]),A.applyMatrix4(h.matrixWorld),P=A.getNormal(),F=y.ray.direction.dot(P),F>=0||(L.subVectors(A.a,y.ray.origin),U=P.dot(L)/F,U<0))continue;w.copy(y.ray.direction).multiplyScalar(U).add(y.ray.origin),w.sub(A.a),b.copy(A.b).sub(A.a),u.copy(A.c).sub(A.a);var ie=b.dot(u),ne=b.lengthSq(),he=u.lengthSq();if(V=(ne*w.dot(u)-ie*w.dot(b))/(ne*he-ie*ie),V<0||V>1||($=(w.dot(b)-V*ie)/ne,$<0||$>1||$+V>1))continue;E.push({clickable:g,distance:U})}for(C=0,T=l.cylinder.length;C<T;C++)if(l.cylinder[C]instanceof R.Cylinder){if(x.copy(l.cylinder[C]),x.applyMatrix4(h.matrixWorld),L.subVectors(x.c1,y.ray.origin),N=L.dot(x.direction),B=L.dot(y.ray.direction),F=v(y.ray.direction.dot(x.direction)),H=1-F*F,H===0)continue;k=(F*B-N)/H,Y=(B-F*N)/H,w.copy(x.direction).multiplyScalar(k).add(x.c1),b.copy(y.ray.direction).multiplyScalar(Y).add(y.ray.origin),K=u.subVectors(w,b).lengthSq();var le=x.radius*x.radius;if(K<=le){if(G=(F*N-B)*(F*N-B)-H*(L.lengthSq()-N*N-le),G<=0?V=U=Math.sqrt(K):V=U=(B-F*N-Math.sqrt(G))/H,$=F*V-N,$<0||$*$>x.lengthSq()||V<0)continue;E.push({clickable:g,distance:U})}}for(C=0,T=l.line.length;C<T;C+=2){w.copy(l.line[C]),w.applyMatrix4(h.matrixWorld),b.copy(l.line[C+1]),b.applyMatrix4(h.matrixWorld),u.subVectors(b,w);var xe=u.lengthSq();u.normalize(),L.subVectors(w,y.ray.origin);var fe=L.dot(u);B=L.dot(y.ray.direction),F=v(y.ray.direction.dot(u)),H=1-F*F,H!==0&&(k=(F*B-fe)/H,Y=(B-F*fe)/H,w.add(u.multiplyScalar(k)),b.copy(y.ray.direction).multiplyScalar(Y).add(y.ray.origin),K=u.subVectors(b,w).lengthSq(),K<m&&k*k<xe&&E.push({clickable:g,distance:Y}))}for(C=0,T=l.sphere.length;C<T;C++)if(l.sphere[C]instanceof R.Sphere&&(D.copy(l.sphere[C]),D.applyMatrix4(h.matrixWorld),y.ray.isIntersectionSphere(D))){w.subVectors(D.center,y.ray.origin);var pe=w.dot(y.ray.direction);if(G=pe*pe-(w.lengthSq()-D.radius*D.radius),pe<0)return E;G<=0?U=pe:U=pe-Math.sqrt(G),E.push({clickable:g,distance:U})}return E}},"./src/WebGL/core/Texture.ts"(o,a,n){n.r(a),n.d(a,{Texture:()=>p,TextureIdCount:()=>v});var d=n("./src/WebGL/constants/TextureConstants.ts"),R=n("./src/WebGL/math/index.ts"),S=n("./src/WebGL/core/EventDispatcher.ts"),j=n("./src/WebGL/core/UVMapping.ts");class p extends S.EventDispatcher{constructor(x,A){super(),this.id=v++,this.name="",this.image=x,this.mapping=new j.UVMapping,this.wrapS=d.ClampToEdgeWrapping,this.wrapT=d.ClampToEdgeWrapping,this.anisotropy=1,A?(this.format=d.RFormat,this.type=d.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=d.NearestFilter,this.minFilter=d.NearestFilter):(this.format=d.RGBAFormat,this.type=d.UnsignedByteType,this.offset=new R.Vector2(0,0),this.repeat=new R.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=d.LinearFilter,this.minFilter=d.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(x=new p){return x.image=this.image,x.mapping=this.mapping,x.wrapS=this.wrapS,x.wrapT=this.wrapT,x.magFilter=this.magFilter,x.minFilter=this.minFilter,x.anisotropy=this.anisotropy,x.format=this.format,x.type=this.type,x.offset.copy(this.offset),x.repeat.copy(this.repeat),x.premultiplyAlpha=this.premultiplyAlpha,x.flipY=this.flipY,x.unpackAlignment=this.unpackAlignment,x}dispose(){this.dispatchEvent({type:"dispose"})}}let v=0},"./src/WebGL/core/UVMapping.ts"(o,a,n){n.r(a),n.d(a,{UVMapping:()=>d});class d{}},"./src/WebGL/core/index.ts"(o,a,n){n.r(a),n.d(a,{EventDispatcher:()=>d.EventDispatcher,Geometry:()=>R.Geometry,GeometryGroup:()=>R.GeometryGroup,GeometryIDCount:()=>R.GeometryIDCount,Light:()=>S.Light,Object3D:()=>S.Object3D,Object3DIDCount:()=>S.Object3DIDCount,Projector:()=>j.Projector,Raycaster:()=>p.Raycaster,Scene:()=>S.Scene,Texture:()=>v.Texture,TextureIdCount:()=>v.TextureIdCount,UVMapping:()=>D.UVMapping,intersectObject:()=>p.intersectObject});var d=n("./src/WebGL/core/EventDispatcher.ts"),R=n("./src/WebGL/core/Geometry.ts"),S=n("./src/WebGL/core/Object3D.ts"),j=n("./src/WebGL/core/Projector.ts"),p=n("./src/WebGL/core/Raycaster.ts"),v=n("./src/WebGL/core/Texture.ts"),D=n("./src/WebGL/core/UVMapping.ts")},"./src/WebGL/index.ts"(o,a,n){n.r(a),n.d(a,{BackSide:()=>d.BackSide,Camera:()=>x.Camera,ClampToEdgeWrapping:()=>d.ClampToEdgeWrapping,Coloring:()=>d.Coloring,Cylinder:()=>D.Cylinder,DoubleSide:()=>d.DoubleSide,EventDispatcher:()=>R.EventDispatcher,FloatType:()=>d.FloatType,Fog:()=>A.Fog,FrontSide:()=>d.FrontSide,Geometry:()=>R.Geometry,GeometryGroup:()=>R.GeometryGroup,GeometryIDCount:()=>R.GeometryIDCount,ImposterMaterial:()=>S.ImposterMaterial,InstancedMaterial:()=>S.InstancedMaterial,Light:()=>R.Light,Line:()=>p.Line,LineBasicMaterial:()=>S.LineBasicMaterial,LineStyle:()=>p.LineStyle,LinearFilter:()=>d.LinearFilter,LinearMipMapLinearFilter:()=>d.LinearMipMapLinearFilter,Material:()=>S.Material,MaterialIdCount:()=>S.MaterialIdCount,Matrix3:()=>j.Matrix3,Matrix4:()=>j.Matrix4,Mesh:()=>p.Mesh,MeshDoubleLambertMaterial:()=>S.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>S.MeshLambertMaterial,MeshOutlineMaterial:()=>S.MeshOutlineMaterial,NearestFilter:()=>d.NearestFilter,Object3D:()=>R.Object3D,Object3DIDCount:()=>R.Object3DIDCount,Projector:()=>R.Projector,Quaternion:()=>j.Quaternion,R32Format:()=>d.R32Format,RFormat:()=>d.RFormat,RGBAFormat:()=>d.RGBAFormat,Ray:()=>j.Ray,Raycaster:()=>R.Raycaster,Renderer:()=>L.Renderer,Scene:()=>R.Scene,ShaderLib:()=>v.ShaderLib,ShaderUtils:()=>v.ShaderUtils,Shading:()=>d.Shading,Sphere:()=>D.Sphere,SphereImposterMaterial:()=>S.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>S.SphereImposterOutlineMaterial,Sprite:()=>p.Sprite,SpriteAlignment:()=>d.SpriteAlignment,SpriteMaterial:()=>S.SpriteMaterial,SpritePlugin:()=>w.SpritePlugin,StickImposterMaterial:()=>S.StickImposterMaterial,StickImposterOutlineMaterial:()=>S.StickImposterOutlineMaterial,Texture:()=>R.Texture,TextureIdCount:()=>R.TextureIdCount,TextureOperations:()=>d.TextureOperations,Triangle:()=>D.Triangle,UVMapping:()=>R.UVMapping,UnsignedByteType:()=>d.UnsignedByteType,Vector2:()=>j.Vector2,Vector3:()=>j.Vector3,VolumetricMaterial:()=>S.VolumetricMaterial,basic:()=>v.basic,clamp:()=>j.clamp,clone:()=>v.clone,conversionMatrix3:()=>j.conversionMatrix3,degToRad:()=>j.degToRad,instanced:()=>v.instanced,intersectObject:()=>R.intersectObject,lambert:()=>v.lambert,lambertdouble:()=>v.lambertdouble,outline:()=>v.outline,screen:()=>v.screen,screenaa:()=>v.screenaa,sphereimposter:()=>v.sphereimposter,sphereimposteroutline:()=>v.sphereimposteroutline,sprite:()=>v.sprite,stickimposter:()=>v.stickimposter,stickimposteroutline:()=>v.stickimposteroutline,volumetric:()=>v.volumetric});var d=n("./src/WebGL/constants/index.ts"),R=n("./src/WebGL/core/index.ts"),S=n("./src/WebGL/materials/index.ts"),j=n("./src/WebGL/math/index.ts"),p=n("./src/WebGL/objects/index.ts"),v=n("./src/WebGL/shaders/index.ts"),D=n("./src/WebGL/shapes/index.ts"),x=n("./src/WebGL/Camera.ts"),A=n("./src/WebGL/Fog.ts"),L=n("./src/WebGL/Renderer.ts"),w=n("./src/WebGL/SpritePlugin.ts")},"./src/WebGL/materials/ImposterMaterial.ts"(o,a,n){n.r(a),n.d(a,{ImposterMaterial:()=>v});var d=n("./src/WebGL/constants/Coloring.ts"),R=n("./src/WebGL/constants/Shading.ts"),S=n("./src/colors.ts"),j=n("./src/WebGL/math/index.ts"),p=n("./src/WebGL/materials/Material.ts");class v extends p.Material{constructor(x){super(),this.color=new S.Color(16777215),this.ambient=new S.Color(1048575),this.emissive=new S.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new j.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=R.Shading.SmoothShading,this.shaderID=null,this.vertexColors=d.Coloring.NoColors,this.skinning=!1,this.setValues(x)}clone(x=new v){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x}}},"./src/WebGL/materials/InstancedMaterial.ts"(o,a,n){n.r(a),n.d(a,{InstancedMaterial:()=>v});var d=n("./src/WebGL/constants/Coloring.ts"),R=n("./src/WebGL/constants/Shading.ts"),S=n("./src/colors.ts"),j=n("./src/WebGL/math/index.ts"),p=n("./src/WebGL/materials/Material.ts");class v extends p.Material{constructor(x){super(),this.color=new S.Color(16777215),this.ambient=new S.Color(1048575),this.emissive=new S.Color(0),this.wrapAround=!1,this.wrapRGB=new j.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=R.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=d.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(x)}clone(x=new v){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x.sphere=this.sphere,x}}},"./src/WebGL/materials/LineBasicMaterial.ts"(o,a,n){n.r(a),n.d(a,{LineBasicMaterial:()=>S});var d=n("./src/colors.ts"),R=n("./src/WebGL/materials/Material.ts");class S extends R.Material{constructor(p){super(),this.color=new d.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(p)}clone(p=new S){return super.clone.call(this,p),p.color.copy(this.color),p}}},"./src/WebGL/materials/Material.ts"(o,a,n){n.r(a),n.d(a,{Material:()=>p,MaterialIdCount:()=>v});var d=n("./src/WebGL/constants/Sides.ts"),R=n("./src/WebGL/core/index.ts"),S=n("./src/WebGL/math/index.ts"),j=n("./src/colors.ts");class p extends R.EventDispatcher{constructor(){super(...arguments),this.id=v++,this.name="",this.side=d.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(x={}){if(x!==void 0)for(var A in x){var L=x[A];if(L===void 0){console.warn("$3Dmol.Material: '"+A+"' parameter is undefined.");continue}if(A in this){var w=this[A];w instanceof j.Color&&L instanceof j.Color?w.copy(L):w instanceof j.Color?w.set(L):w instanceof S.Vector3&&L instanceof S.Vector3?w.copy(L):this[A]=L}}}clone(x=new p){return x.name=this.name,x.side=this.side,x.opacity=this.opacity,x.transparent=this.transparent,x.depthTest=this.depthTest,x.depthWrite=this.depthWrite,x.polygonOffset=this.polygonOffset,x.polygonOffsetFactor=this.polygonOffsetFactor,x.polygonOffsetUnits=this.polygonOffsetUnits,x.alphaTest=this.alphaTest,x.overdraw=this.overdraw,x.visible=this.visible,x}makeShaded(x){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:x},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let v=0},"./src/WebGL/materials/MeshDoubleLambertMaterial.ts"(o,a,n){n.r(a),n.d(a,{MeshDoubleLambertMaterial:()=>S});var d=n("./src/WebGL/constants/Sides.ts"),R=n("./src/WebGL/materials/MeshLambertMaterial.ts");class S extends R.MeshLambertMaterial{constructor(p){super(p),this.shaderID="lambertdouble",this.side=d.DoubleSide,this.outline=!1}clone(p=new S){return super.clone.call(this,p),p}}},"./src/WebGL/materials/MeshLambertMaterial.ts"(o,a,n){n.r(a),n.d(a,{MeshLambertMaterial:()=>v});var d=n("./src/WebGL/constants/Coloring.ts"),R=n("./src/WebGL/constants/Shading.ts"),S=n("./src/WebGL/materials/Material.ts"),j=n("./src/colors.ts"),p=n("./src/WebGL/math/index.ts");class v extends S.Material{constructor(x){super(),this.color=new j.Color(16777215),this.ambient=new j.Color(1048575),this.emissive=new j.Color(0),this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=R.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=d.Coloring.NoColors,this.skinning=!1,this.setValues(x)}clone(x=new v){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x}}},"./src/WebGL/materials/MeshOutlineMaterial.ts"(o,a,n){n.r(a),n.d(a,{MeshOutlineMaterial:()=>S});var d=n("./src/colors.ts"),R=n("./src/WebGL/materials/Material.ts");class S extends R.Material{constructor(p){super(),p=p||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=d.CC.color(p.color||new d.Color(0,0,0)),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1,this.outlineMaxPixels=p.maxpixels||0}clone(p=new S){return super.clone.call(this,p),p.fog=this.fog,p.shaderID=this.shaderID,p.wireframe=this.wireframe,p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p.outlineMaxPixels=this.outlineMaxPixels,p}}},"./src/WebGL/materials/SphereImposterMaterial.ts"(o,a,n){n.r(a),n.d(a,{SphereImposterMaterial:()=>R});var d=n("./src/WebGL/materials/ImposterMaterial.ts");class R extends d.ImposterMaterial{constructor(j){super(j),this.shaderID="sphereimposter",this.setValues(j)}clone(j=new R){return super.clone.call(this,j),j}}},"./src/WebGL/materials/SphereImposterOutlineMaterial.ts"(o,a,n){n.r(a),n.d(a,{SphereImposterOutlineMaterial:()=>S});var d=n("./src/colors.ts"),R=n("./src/WebGL/materials/ImposterMaterial.ts");class S extends R.ImposterMaterial{constructor(p){super(p),p=p||{},this.shaderID="sphereimposteroutline",this.outlineColor=d.CC.color(p.color||new d.Color(0,0,0)),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1,this.outlineMaxPixels=p.maxpixels||0,this.setValues(p)}clone(p=new S){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p.outlineMaxPixels=this.outlineMaxPixels,p}}},"./src/WebGL/materials/SpriteMaterial.ts"(o,a,n){n.r(a),n.d(a,{SpriteMaterial:()=>v});var d=n("./src/WebGL/constants/SpriteAlignment.ts"),R=n("./src/WebGL/core/Texture.ts"),S=n("./src/colors.ts"),j=n("./src/WebGL/math/index.ts"),p=n("./src/WebGL/materials/Material.ts");class v extends p.Material{constructor(x){super(),this.color=new S.Color(16777215),this.map=new R.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new j.Vector2(0,0),this.uvScale=new j.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=d.SpriteAlignment.center.clone(),this.setValues(x),x=x||{},x.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),x.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),x.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(x=new v){return super.clone.call(this,x),x.color.copy(this.color),x.map=this.map,x.useScreenCoordinates=this.useScreenCoordinates,x.screenOffset=this.screenOffset,x.sizeAttenuation=this.sizeAttenuation,x.scaleByViewport=this.scaleByViewPort,x.alignment.copy(this.alignment),x.uvOffset.copy(this.uvOffset),x}}},"./src/WebGL/materials/StickImposterMaterial.ts"(o,a,n){n.r(a),n.d(a,{StickImposterMaterial:()=>R});var d=n("./src/WebGL/materials/ImposterMaterial.ts");class R extends d.ImposterMaterial{constructor(j){super(j),this.shaderID="stickimposter",this.setValues(j)}clone(j=new R){return super.clone.call(this,j),j}}},"./src/WebGL/materials/StickImposterOutlineMaterial.ts"(o,a,n){n.r(a),n.d(a,{StickImposterOutlineMaterial:()=>S});var d=n("./src/colors.ts"),R=n("./src/WebGL/materials/ImposterMaterial.ts");class S extends R.ImposterMaterial{constructor(p={}){super(p),this.shaderID="stickimposteroutline",this.outlineColor=new d.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,p.color&&(this.outlineColor=d.CC.color(p.color)),p.width&&(this.outlineWidth=p.width),p.pushback&&(this.outlinePushback=p.pushback),p.maxpixels&&(this.outlineMaxPixels=p.maxpixels),this.setValues(p)}clone(p=new S){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p.outlineMaxPixels=this.outlineMaxPixels,p}}},"./src/WebGL/materials/VolumetricMaterial.ts"(o,a,n){n.r(a),n.d(a,{VolumetricMaterial:()=>j});var d=n("./src/WebGL/constants/Sides.ts"),R=n("./src/colors.ts"),S=n("./src/WebGL/materials/Material.ts");class j extends S.Material{constructor(v){super(),this.transparent=!1,this.volumetric=!0,this.color=new R.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=d.FrontSide,this.setValues(v)}clone(v=new j){return super.clone.call(this,v),v.transparent=this.transparent,v.volumetric=this.volumetric,v.color=this.color,v.transferfn=this.transferfn,v.map=this.map,v.extent=this.extent,v.maxdepth=this.maxdepth,v.unit=this.unit,v.texmatrix=this.texmatrix,v.transfermin=this.transfermin,v.transfermax=this.transfermax,v.subsamples=this.subsamples,v.shaderID=this.shaderID,v.side=this.side,v}}},"./src/WebGL/materials/index.ts"(o,a,n){n.r(a),n.d(a,{ImposterMaterial:()=>d.ImposterMaterial,InstancedMaterial:()=>R.InstancedMaterial,LineBasicMaterial:()=>S.LineBasicMaterial,Material:()=>j.Material,MaterialIdCount:()=>j.MaterialIdCount,MeshDoubleLambertMaterial:()=>p.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>v.MeshLambertMaterial,MeshOutlineMaterial:()=>D.MeshOutlineMaterial,SphereImposterMaterial:()=>x.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>A.SphereImposterOutlineMaterial,SpriteMaterial:()=>L.SpriteMaterial,StickImposterMaterial:()=>w.StickImposterMaterial,StickImposterOutlineMaterial:()=>b.StickImposterOutlineMaterial,VolumetricMaterial:()=>u.VolumetricMaterial});var d=n("./src/WebGL/materials/ImposterMaterial.ts"),R=n("./src/WebGL/materials/InstancedMaterial.ts"),S=n("./src/WebGL/materials/LineBasicMaterial.ts"),j=n("./src/WebGL/materials/Material.ts"),p=n("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),v=n("./src/WebGL/materials/MeshLambertMaterial.ts"),D=n("./src/WebGL/materials/MeshOutlineMaterial.ts"),x=n("./src/WebGL/materials/SphereImposterMaterial.ts"),A=n("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),L=n("./src/WebGL/materials/SpriteMaterial.ts"),w=n("./src/WebGL/materials/StickImposterMaterial.ts"),b=n("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),u=n("./src/WebGL/materials/VolumetricMaterial.ts")},"./src/WebGL/math/Quaternion.ts"(o,a,n){n.r(a),n.d(a,{Quaternion:()=>d});class d{constructor(S,j,p,v){this.x=S||0,this.y=j||0,this.z=p||0,this.w=v!==void 0?v:1}set(S,j,p,v){return this.x=S,this.y=j,this.z=p,this.w=v,this}copy(S){return this.x=S.x,this.y=S.y,this.z=S.z,this.w=S.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let S=this.length();return S===0?(this.x=0,this.y=0,this.z=0,this.w=1):(S=1/S,this.x*=S,this.y*=S,this.z*=S,this.w*=S),this}multiply(S){return this.multiplyQuaternions(this,S)}multiplyScalar(S){return this.x*=S,this.y*=S,this.z*=S,this.w*=S,this}multiplyQuaternions(S,j){const p=S.x,v=S.y,D=S.z,x=S.w,A=j.x,L=j.y,w=j.z,b=j.w;return this.x=p*b+x*A+v*w-D*L,this.y=v*b+x*L+D*A-p*w,this.z=D*b+x*w+p*L-v*A,this.w=x*b-p*A-v*L-D*w,this}sub(S){return this.x-=S.x,this.y-=S.y,this.z-=S.z,this.w-=S.w,this}clone(){return new d(this.x,this.y,this.z,this.w)}setFromEuler(S){const j=Math.cos(S.x/2),p=Math.cos(S.y/2),v=Math.cos(S.z/2),D=Math.sin(S.x/2),x=Math.sin(S.y/2),A=Math.sin(S.z/2);return this.x=D*p*v+j*x*A,this.y=j*x*v-D*p*A,this.z=j*p*A+D*x*v,this.w=j*p*v-D*x*A,this}}},"./src/WebGL/math/Vector2.ts"(o,a,n){n.r(a),n.d(a,{Vector2:()=>d});class d{constructor(S,j){this.x=S||0,this.y=j||0}set(S,j){return this.x=S,this.y=j,this}subVectors(S,j){return this.x=S.x-j.x,this.y=S.y-j.y,this}copy(S){return this.x=S.x,this.y=S.y,this}clone(){return new d(this.x,this.y)}}},"./src/WebGL/math/index.ts"(o,a,n){n.r(a),n.d(a,{Matrix3:()=>v.Matrix3,Matrix4:()=>v.Matrix4,Quaternion:()=>d.Quaternion,Ray:()=>v.Ray,Vector2:()=>R.Vector2,Vector3:()=>v.Vector3,clamp:()=>S.clamp,conversionMatrix3:()=>j.conversionMatrix3,degToRad:()=>p.degToRad});var d=n("./src/WebGL/math/Quaternion.ts"),R=n("./src/WebGL/math/Vector2.ts"),S=n("./src/WebGL/math/utils/clamp.ts"),j=n("./src/WebGL/math/utils/conversionMatrix3.ts"),p=n("./src/WebGL/math/utils/degToRad.ts"),v=n("./src/WebGL/math/math.ts")},"./src/WebGL/math/math.ts"(o,a,n){n.r(a),n.d(a,{Matrix3:()=>L,Matrix4:()=>x,Ray:()=>w,Vector3:()=>A});var d=n("./src/WebGL/math/utils/degToRad.ts"),R=n("./src/WebGL/math/utils/clamp.ts"),S,j,p,v,D;class x{constructor(u=1,i=0,s=0,h=0,g=0,y=1,E=0,l=0,f=0,m=0,C=1,T=0,P=0,F=0,N=0,B=1){typeof u<"u"&&typeof u!="number"?this.elements=new Float32Array(u):(this.elements=new Float32Array(16),this.elements[0]=u,this.elements[4]=i,this.elements[8]=s,this.elements[12]=h,this.elements[1]=g,this.elements[5]=y,this.elements[9]=E,this.elements[13]=l,this.elements[2]=f,this.elements[6]=m,this.elements[10]=C,this.elements[14]=T,this.elements[3]=P,this.elements[7]=F,this.elements[11]=N,this.elements[15]=B)}makeScale(u,i,s){throw new Error("Method not implemented.")}set(u,i,s,h,g,y,E,l,f,m,C,T,P,F,N,B){const U=this.elements;return U[0]=u,U[4]=i,U[8]=s,U[12]=h,U[1]=g,U[5]=y,U[9]=E,U[13]=l,U[2]=f,U[6]=m,U[10]=C,U[14]=T,U[3]=P,U[7]=F,U[11]=N,U[15]=B,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(u){const i=u.elements;return this.set(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]),this}matrix3FromTopLeft(){const u=this.elements;return new L(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10])}setRotationFromEuler(u,i){const s=this.elements,{x:h,y:g,z:y}=u,E=Math.cos(h),l=Math.sin(h),f=Math.cos(g),m=Math.sin(g),C=Math.cos(y),T=Math.sin(y);if(i===void 0||i==="XYZ"){const P=E*C,F=E*T,N=l*C,B=l*T;s[0]=f*C,s[4]=-f*T,s[8]=m,s[1]=F+N*m,s[5]=P-B*m,s[9]=-l*f,s[2]=B-P*m,s[6]=N+F*m,s[10]=E*f}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${i}`);return this}setRotationFromQuaternion(u){const i=this.elements,{x:s,y:h,z:g,w:y}=u,E=s+s,l=h+h,f=g+g,m=s*E,C=s*l,T=s*f,P=h*l,F=h*f,N=g*f,B=y*E,U=y*l,K=y*f;return i[0]=1-(P+N),i[4]=C-K,i[8]=T+U,i[1]=C+K,i[5]=1-(m+N),i[9]=F-B,i[2]=T-U,i[6]=F+B,i[10]=1-(m+P),this}multiplyMatrices(u,i){const s=u.elements,h=i.elements,g=this.elements,y=s[0],E=s[4],l=s[8],f=s[12],m=s[1],C=s[5],T=s[9],P=s[13],F=s[2],N=s[6],B=s[10],U=s[14],K=s[3],H=s[7],G=s[11],$=s[15],V=h[0],k=h[4],Y=h[8],ie=h[12],ne=h[1],he=h[5],le=h[9],xe=h[13],fe=h[2],pe=h[6],Te=h[10],ke=h[14],$e=h[3],Le=h[7],ue=h[11],Me=h[15];return g[0]=y*V+E*ne+l*fe+f*$e,g[4]=y*k+E*he+l*pe+f*Le,g[8]=y*Y+E*le+l*Te+f*ue,g[12]=y*ie+E*xe+l*ke+f*Me,g[1]=m*V+C*ne+T*fe+P*$e,g[5]=m*k+C*he+T*pe+P*Le,g[9]=m*Y+C*le+T*Te+P*ue,g[13]=m*ie+C*xe+T*ke+P*Me,g[2]=F*V+N*ne+B*fe+U*$e,g[6]=F*k+N*he+B*pe+U*Le,g[10]=F*Y+N*le+B*Te+U*ue,g[14]=F*ie+N*xe+B*ke+U*Me,g[3]=K*V+H*ne+G*fe+$*$e,g[7]=K*k+H*he+G*pe+$*Le,g[11]=K*Y+H*le+G*Te+$*ue,g[15]=K*ie+H*xe+G*ke+$*Me,this}multiplyScalar(u){const i=this.elements;return i[0]*=u,i[4]*=u,i[8]*=u,i[12]*=u,i[1]*=u,i[5]*=u,i[9]*=u,i[13]*=u,i[2]*=u,i[6]*=u,i[10]*=u,i[14]*=u,i[3]*=u,i[7]*=u,i[11]*=u,i[15]*=u,this}makeTranslation(u,i,s){return this.set(1,0,0,u,0,1,0,i,0,0,1,s,0,0,0,1),this}snap(u){const i=Math.pow(10,4),s=this.elements;for(let h=0;h<16;h++){const g=Math.round(s[h]);g===Math.round(s[h]*i)/i&&(s[h]=g)}return this}transpose(){const u=this.elements;let i;return i=u[1],u[1]=u[4],u[4]=i,i=u[2],u[2]=u[8],u[8]=i,i=u[6],u[6]=u[9],u[9]=i,i=u[3],u[3]=u[12],u[12]=i,i=u[7],u[7]=u[13],u[13]=i,i=u[11],u[11]=u[14],u[14]=i,this}setPosition(u){const i=this.elements;return i[12]=u.x,i[13]=u.y,i[14]=u.z,this}translate(u){const i=this.elements;return i[12]+=u.x,i[13]+=u.y,i[14]+=u.z,this}getInverse(u,i){const s=this.elements,h=u.elements,g=h[0],y=h[4],E=h[8],l=h[12],f=h[1],m=h[5],C=h[9],T=h[13],P=h[2],F=h[6],N=h[10],B=h[14],U=h[3],K=h[7],H=h[11],G=h[15];s[0]=C*B*K-T*N*K+T*F*H-m*B*H-C*F*G+m*N*G,s[4]=l*N*K-E*B*K-l*F*H+y*B*H+E*F*G-y*N*G,s[8]=E*T*K-l*C*K+l*m*H-y*T*H-E*m*G+y*C*G,s[12]=l*C*F-E*T*F-l*m*N+y*T*N+E*m*B-y*C*B,s[1]=T*N*U-C*B*U-T*P*H+f*B*H+C*P*G-f*N*G,s[5]=E*B*U-l*N*U+l*P*H-g*B*H-E*P*G+g*N*G,s[9]=l*C*U-E*T*U-l*f*H+g*T*H+E*f*G-g*C*G,s[13]=E*T*P-l*C*P+l*f*N-g*T*N-E*f*B+g*C*B,s[2]=m*B*U-T*F*U+T*P*K-f*B*K-m*P*G+f*F*G,s[6]=l*F*U-y*B*U-l*P*K+g*B*K+y*P*G-g*F*G,s[10]=y*T*U-l*m*U+l*f*K-g*T*K-y*f*G+g*m*G,s[14]=l*m*P-y*T*P-l*f*F+g*T*F+y*f*B-g*m*B,s[3]=C*F*U-m*N*U-C*P*K+f*N*K+m*P*H-f*F*H,s[7]=y*N*U-E*F*U+E*P*K-g*N*K-y*P*H+g*F*H,s[11]=E*m*U-y*C*U-E*f*K+g*C*K+y*f*H-g*m*H,s[15]=y*C*P-E*m*P+E*f*F-g*C*F-y*f*N+g*m*N;const $=g*s[0]+f*s[4]+P*s[8]+U*s[12];if($===0){const V="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(V);return console.warn(V),this.identity(),this}return this.multiplyScalar(1/$),this}isReflected(){const u=this.elements,i=u[0],s=u[4],h=u[8],g=u[1],y=u[5],E=u[9],l=u[2],f=u[6],m=u[10];return i*y*m+g*f*h+l*s*E-l*y*h-g*s*m-i*f*E<0}scale(u){const i=this.elements,{x:s}=u,{y:h}=u,{z:g}=u;return i[0]*=s,i[4]*=h,i[8]*=g,i[1]*=s,i[5]*=h,i[9]*=g,i[2]*=s,i[6]*=h,i[10]*=g,i[3]*=s,i[7]*=h,i[11]*=g,this}getMaxScaleOnAxis(){const u=this.elements,i=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],s=u[4]*u[4]+u[5]*u[5]+u[6]*u[6],h=u[8]*u[8]+u[9]*u[9]+u[10]*u[10];return Math.sqrt(Math.max(i,Math.max(s,h)))}makeFrustum(u,i,s,h,g,y){const E=this.elements,l=2*g/(i-u),f=2*g/(h-s),m=(i+u)/(i-u),C=(h+s)/(h-s),T=-(y+g)/(y-g),P=-2*y*g/(y-g);return E[0]=l,E[4]=0,E[8]=m,E[12]=0,E[1]=0,E[5]=f,E[9]=C,E[13]=0,E[2]=0,E[6]=0,E[10]=T,E[14]=P,E[3]=0,E[7]=0,E[11]=-1,E[15]=0,this}makePerspective(u,i,s,h){const g=s*Math.tan((0,d.degToRad)(u*.5)),y=-g,E=y*i,l=g*i;return this.makeFrustum(E,l,y,g,s,h)}makeOrthographic(u,i,s,h,g,y){const E=this.elements,l=1/(i-u),f=1/(s-h),m=1/(y-g),C=(i+u)*l,T=(s+h)*f,P=(y+g)*m;return E[0]=2*l,E[4]=0,E[8]=0,E[12]=-C,E[1]=0,E[5]=2*f,E[9]=0,E[13]=-T,E[2]=0,E[6]=0,E[10]=-2*m,E[14]=-P,E[3]=0,E[7]=0,E[11]=0,E[15]=1,this}isEqual(u){const i=u.elements,s=this.elements;return s[0]===i[0]&&s[4]===i[4]&&s[8]===i[8]&&s[12]===i[12]&&s[1]===i[1]&&s[5]===i[5]&&s[9]===i[9]&&s[13]===i[13]&&s[2]===i[2]&&s[6]===i[6]&&s[10]===i[10]&&s[14]===i[14]&&s[3]===i[3]&&s[7]===i[7]&&s[11]===i[11]&&s[15]===i[15]}clone(){const u=this.elements;return new x(u[0],u[4],u[8],u[12],u[1],u[5],u[9],u[13],u[2],u[6],u[10],u[14],u[3],u[7],u[11],u[15])}isIdentity(){const u=this.elements;return u[0]===1&&u[4]===0&&u[8]===0&&u[12]===0&&u[1]===0&&u[5]===1&&u[9]===0&&u[13]===0&&u[2]===0&&u[6]===0&&u[10]===1&&u[14]===0&&u[3]===0&&u[7]===0&&u[11]===0&&u[15]===1}isNearlyIdentity(u){return this.clone().snap(u).isIdentity()}getScale(u){const i=this.elements;return u=u||new A,p.set(i[0],i[1],i[2]),v.set(i[4],i[5],i[6]),D.set(i[8],i[9],i[10]),u.x=p.length(),u.y=v.length(),u.z=D.length(),u}lookAt(u,i,s){const h=this.elements;return D.subVectors(u,i).normalize(),D.length()===0&&(D.z=1),p.crossVectors(s,D).normalize(),p.length()===0&&(D.x+=1e-4,p.crossVectors(s,D).normalize()),v.crossVectors(D,p),h[0]=p.x,h[4]=v.x,h[8]=D.x,h[1]=p.y,h[5]=v.y,h[9]=D.y,h[2]=p.z,h[6]=v.z,h[10]=D.z,this}compose(u,i,s){const h=this.elements;return S.identity(),S.setRotationFromQuaternion(i),j.makeScale(s.x,s.y,s.z),this.multiplyMatrices(S,j),h[12]=u.x,h[13]=u.y,h[14]=u.z,this}}S=new x,j=new x;class A{constructor(u,i,s){this.x=u||0,this.y=i||0,this.z=s||0,this.atomid=void 0}set(u,i,s){return this.x=u,this.y=i,this.z=s,this}copy(u){return this.x=u.x,this.y=u.y,this.z=u.z,this}add(u){return this.x+=u.x,this.y+=u.y,this.z+=u.z,this}addVectors(u,i){return this.x=u.x+i.x,this.y=u.y+i.y,this.z=u.z+i.z,this}multiplyVectors(u,i){return this.x=u.x*i.x,this.y=u.y*i.y,this.z=u.z*i.z,this}sub(u){return this.x-=u.x,this.y-=u.y,this.z-=u.z,this}subVectors(u,i){return this.x=u.x-i.x,this.y=u.y-i.y,this.z=u.z-i.z,this}multiplyScalar(u){return this.x*=u,this.y*=u,this.z*=u,this}divideScalar(u){return u!==0?(this.x/=u,this.y/=u,this.z/=u):(this.x=0,this.y=0,this.z=0),this}max(u){return this.x=Math.max(this.x,u.x),this.y=Math.max(this.y,u.y),this.z=Math.max(this.z,u.z),this}min(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this}distanceTo(u){return Math.sqrt(this.distanceToSquared(u))}distanceToSquared(u){const i=this.x-u.x,s=this.y-u.y,h=this.z-u.z;return i*i+s*s+h*h}applyMatrix3(u){const{x:i}=this,{y:s}=this,{z:h}=this,g=u.elements;return this.x=g[0]*i+g[3]*s+g[6]*h,this.y=g[1]*i+g[4]*s+g[7]*h,this.z=g[2]*i+g[5]*s+g[8]*h,this}applyMatrix4(u){const{x:i}=this,{y:s}=this,{z:h}=this,g=u.elements;return this.x=g[0]*i+g[4]*s+g[8]*h+g[12],this.y=g[1]*i+g[5]*s+g[9]*h+g[13],this.z=g[2]*i+g[6]*s+g[10]*h+g[14],this}applyProjection(u){const{x:i}=this,{y:s}=this,{z:h}=this,g=u.elements,y=g[3]*i+g[7]*s+g[11]*h+g[15];return this.x=(g[0]*i+g[4]*s+g[8]*h+g[12])/y,this.y=(g[1]*i+g[5]*s+g[9]*h+g[13])/y,this.z=(g[2]*i+g[6]*s+g[10]*h+g[14])/y,this}applyQuaternion(u){const{x:i}=this,{y:s}=this,{z:h}=this,g=u.x,y=u.y,E=u.z,l=u.w,f={};f.x=2*(s*E-h*y),f.y=2*(h*g-i*E),f.z=2*(i*y-s*g);const m={};return m.x=f.y*E-f.z*y,m.y=f.z*g-f.x*E,m.z=f.x*y-f.y*g,this.x=i+l*f.x+m.x,this.y=s+l*f.y+m.y,this.z=h+l*f.z+m.z,this}negate(){return this.multiplyScalar(-1)}dot(u){return this.x*u.x+this.y*u.y+this.z*u.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(u){const{x:i}=this,{y:s}=this,{z:h}=this;return this.x=s*u.z-h*u.y,this.y=h*u.x-i*u.z,this.z=i*u.y-s*u.x,this}crossVectors(u,i){return this.x=u.y*i.z-u.z*i.y,this.y=u.z*i.x-u.x*i.z,this.z=u.x*i.y-u.y*i.x,this}equals(u){return this.x==u.x&&this.y==u.y&&this.z==u.z}getPositionFromMatrix(u){return this.x=u.elements[12],this.y=u.elements[13],this.z=u.elements[14],this}setEulerFromRotationMatrix(u,i){const s=u.elements,h=s[0],g=s[4],y=s[8],E=s[5],l=s[9],f=s[6],m=s[10];return i===void 0||i==="XYZ"?(this.y=Math.asin((0,R.clamp)(y,-1,1)),Math.abs(y)<.99999?(this.x=Math.atan2(-l,m),this.z=Math.atan2(-g,h)):(this.x=Math.atan2(f,E),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${i}`),this}rotateAboutVector(u,i){u.normalize();const s=Math.cos(i),h=Math.sin(i),g=this.clone().multiplyScalar(s),y=u.clone().cross(this).multiplyScalar(h),E=u.clone().multiplyScalar(u.clone().dot(this)).multiplyScalar(1-s),l=g.add(y).add(E);return this.x=l.x,this.y=l.y,this.z=l.z,this}setFromMatrixPosition(u){const i=u.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}transformDirection(u){const{x:i}=this,{y:s}=this,{z:h}=this,g=u.elements;return this.x=g[0]*i+g[4]*s+g[8]*h,this.y=g[1]*i+g[5]*s+g[9]*h,this.z=g[2]*i+g[6]*s+g[10]*h,this.normalize()}clone(){return new A(this.x,this.y,this.z)}unproject(u){const i=S;return i.multiplyMatrices(u.matrixWorld,i.getInverse(u.projectionMatrix)),this.applyMatrix4(i)}}p=new A,v=new A,D=new A;class L{constructor(u=1,i=0,s=0,h=0,g=1,y=0,E=0,l=0,f=1){this.elements=new Float32Array(9),this.set(u,i,s,h,g,y,E,l,f)}set(u,i,s,h,g,y,E,l,f){const m=this.elements;return m[0]=u,m[3]=i,m[6]=s,m[1]=h,m[4]=g,m[7]=y,m[2]=E,m[5]=l,m[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(u){const i=u.elements;this.set(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8])}multiplyScalar(u){const i=this.elements;return i[0]*=u,i[3]*=u,i[6]*=u,i[1]*=u,i[4]*=u,i[7]*=u,i[2]*=u,i[5]*=u,i[8]*=u,this}getInverse3(u){const i=u.elements,s=this.elements;s[0]=i[4]*i[8]-i[5]*i[7],s[3]=i[6]*i[5]-i[3]*i[8],s[6]=i[3]*i[7]-i[6]*i[4],s[1]=i[7]*i[2]-i[1]*i[8],s[4]=i[0]*i[8]-i[6]*i[2],s[7]=i[1]*i[6]-i[0]*i[7],s[2]=i[1]*i[5]-i[2]*i[4],s[5]=i[2]*i[3]-i[0]*i[5],s[8]=i[0]*i[4]-i[1]*i[3];const h=i[0]*s[0]+i[3]*s[1]+i[6]*s[2];return this.multiplyScalar(1/h),this}getInverse(u,i){const s=u.elements,h=this.elements;h[0]=s[10]*s[5]-s[6]*s[9],h[1]=-s[10]*s[1]+s[2]*s[9],h[2]=s[6]*s[1]-s[2]*s[5],h[3]=-s[10]*s[4]+s[6]*s[8],h[4]=s[10]*s[0]-s[2]*s[8],h[5]=-s[6]*s[0]+s[2]*s[4],h[6]=s[9]*s[4]-s[5]*s[8],h[7]=-s[9]*s[0]+s[1]*s[8],h[8]=s[5]*s[0]-s[1]*s[4];const g=s[0]*h[0]+s[1]*h[3]+s[2]*h[6];if(g===0){const y="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(y);return console.warn(y),this.identity(),this}return this.multiplyScalar(1/g),this}getDeterminant(){const u=this.elements;return u[0]*u[4]*u[8]+u[1]*u[5]*u[6]+u[2]*u[3]*u[7]-u[2]*u[4]*u[6]-u[1]*u[3]*u[8]-u[0]*u[5]*u[7]}transpose(){let u;const i=this.elements;return u=i[1],i[1]=i[3],i[3]=u,u=i[2],i[2]=i[6],i[6]=u,u=i[5],i[5]=i[7],i[7]=u,this}clone(){const u=this.elements;return new L(u[0],u[3],u[6],u[1],u[4],u[7],u[2],u[5],u[8])}getMatrix4(){const u=this.elements;return new x(u[0],u[3],u[6],0,u[1],u[4],u[7],0,u[2],u[5],u[8],0)}}class w{constructor(u,i){this.origin=u!==void 0?u:new A,this.direction=i!==void 0?i:new A}set(u,i){return this.origin.copy(u),this.direction.copy(i),this}copy(u){return this.origin.copy(u.origin),this.direction.copy(u.direction),this}at(u,i){return(i||new A).copy(this.direction).multiplyScalar(u).add(this.origin)}recast(u){const i=p;return this.origin.copy(this.at(u,i)),this}closestPointToPoint(u,i){const s=i||new A;s.subVectors(u,this.origin);const h=s.dot(this.direction);return s.copy(this.direction).multiplyScalar(h).add(this.origin)}distanceToPoint(u){const i=p,s=i.subVectors(u,this.origin).dot(this.direction);return i.copy(this.direction).multiplyScalar(s).add(this.origin),i.distanceTo(u)}isIntersectionCylinder(){}isIntersectionSphere(u){return this.distanceToPoint(u.center)<=u.radius}isIntersectionPlane(u){return u.normal.dot(this.direction)!==0||u.distanceToPoint(this.origin)===0}distanceToPlane(u){const i=u.normal.dot(this.direction);return i===0?u.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(u.normal)+u.constant)/i}intersectPlane(u,i){const s=this.distanceToPlane(u);if(s!==void 0)return this.at(s,i)}applyMatrix4(u){return this.direction.add(this.origin).applyMatrix4(u),this.origin.applyMatrix4(u),this.direction.sub(this.origin),this}clone(){return new w().copy(this)}}},"./src/WebGL/math/utils/clamp.ts"(o,a,n){n.r(a),n.d(a,{clamp:()=>d});function d(R,S,j){return Math.min(Math.max(R,S),j)}},"./src/WebGL/math/utils/conversionMatrix3.ts"(o,a,n){n.r(a),n.d(a,{conversionMatrix3:()=>R});var d=n("./src/WebGL/math/math.ts");function R(S,j,p,v,D,x){v=v*Math.PI/180,D=D*Math.PI/180,x=x*Math.PI/180;const A=s=>s*s,L=Math.cos(v),w=Math.cos(D),b=Math.cos(x),u=Math.sin(x);return new d.Matrix3(S,j*b,p*w,0,j*u,p*(L-w*b)/u,0,0,p*Math.sqrt(1-A(L)-A(w)-A(b)+2*L*w*b)/u)}},"./src/WebGL/math/utils/degToRad.ts"(o,a,n){n.r(a),n.d(a,{degToRad:()=>R});const d=Math.PI/180;function R(S){return S*d}},"./src/WebGL/objects/Line.ts"(o,a,n){n.r(a),n.d(a,{Line:()=>j,LineStyle:()=>S});var d=n("./src/WebGL/materials/index.ts"),R=n("./src/WebGL/core/index.ts"),S;(function(p){p[p.LineStrip=0]="LineStrip",p[p.LinePieces=1]="LinePieces"})(S||(S={}));class j extends R.Object3D{constructor(v,D=new d.LineBasicMaterial({color:Math.random()*16777215}),x=S.LineStrip){super(),this.geometry=v,this.material=D,this.type=x}clone(v=new j(this.geometry,this.material,this.type)){return super.clone.call(this,v),v}}},"./src/WebGL/objects/Mesh.ts"(o,a,n){n.r(a),n.d(a,{Mesh:()=>R});var d=n("./src/WebGL/core/index.ts");class R extends d.Object3D{constructor(j,p){super(),this.geometry=j,this.material=p}clone(j){return j===void 0&&(j=new R(this.geometry,this.material)),super.clone.call(this,j),j}}},"./src/WebGL/objects/Sprite.ts"(o,a,n){n.r(a),n.d(a,{Sprite:()=>S});var d=n("./src/WebGL/materials/index.ts"),R=n("./src/WebGL/core/index.ts");class S extends R.Object3D{constructor(p=new d.SpriteMaterial){super(),this.material=p,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(p=new S(this.material)){return R.Object3D.prototype.clone.call(this,p),p}}},"./src/WebGL/objects/index.ts"(o,a,n){n.r(a),n.d(a,{Line:()=>d.Line,LineStyle:()=>d.LineStyle,Mesh:()=>R.Mesh,Sprite:()=>S.Sprite});var d=n("./src/WebGL/objects/Line.ts"),R=n("./src/WebGL/objects/Mesh.ts"),S=n("./src/WebGL/objects/Sprite.ts")},"./src/WebGL/shaders/ShaderType.ts"(o,a,n){n.r(a)},"./src/WebGL/shaders/index.ts"(o,a,n){n.r(a),n.d(a,{ShaderLib:()=>d.ShaderLib,ShaderUtils:()=>R.ShaderUtils,basic:()=>d.basic,clone:()=>R.clone,instanced:()=>d.instanced,lambert:()=>d.lambert,lambertdouble:()=>d.lambertdouble,outline:()=>d.outline,screen:()=>d.screen,screenaa:()=>d.screenaa,sphereimposter:()=>d.sphereimposter,sphereimposteroutline:()=>d.sphereimposteroutline,sprite:()=>d.sprite,stickimposter:()=>d.stickimposter,stickimposteroutline:()=>d.stickimposteroutline,volumetric:()=>d.volumetric});var d=n("./src/WebGL/shaders/lib/index.ts"),R=n("./src/WebGL/shaders/utils/index.ts");n("./src/WebGL/shaders/ShaderType.ts")},"./src/WebGL/shaders/lib/basic/basic.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/basic/basic.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`},"./src/WebGL/shaders/lib/basic/index.ts"(o,a,n){n.r(a),n.d(a,{basic:()=>j});var d=n("./src/WebGL/shaders/lib/basic/uniforms.ts"),R=n("./src/WebGL/shaders/lib/basic/basic.frag"),S=n("./src/WebGL/shaders/lib/basic/basic.vert");const j={vertexShader:S.default.replace("#define GLSLIFY 1",""),fragmentShader:R.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/basic/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}},"./src/WebGL/shaders/lib/blur/blur.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`},"./src/WebGL/shaders/lib/blur/blur.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/blur/index.ts"(o,a,n){n.r(a),n.d(a,{blur:()=>j});var d=n("./src/WebGL/shaders/lib/blur/uniforms.ts"),R=n("./src/WebGL/shaders/lib/blur/blur.frag"),S=n("./src/WebGL/shaders/lib/blur/blur.vert");const j={fragmentShader:R.default,vertexShader:S.default,uniforms:d.uniforms}},"./src/WebGL/shaders/lib/blur/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>d});const d={}},"./src/WebGL/shaders/lib/index.ts"(o,a,n){n.r(a),n.d(a,{ShaderLib:()=>h,basic:()=>d.basic,instanced:()=>R.instanced,lambert:()=>S.lambert,lambertdouble:()=>j.lambertdouble,outline:()=>p.outline,screen:()=>v.screen,screenaa:()=>D.screenaa,sphereimposter:()=>x.sphereimposter,sphereimposteroutline:()=>A.sphereimposteroutline,sprite:()=>L.sprite,stickimposter:()=>w.stickimposter,stickimposteroutline:()=>b.stickimposteroutline,volumetric:()=>u.volumetric});var d=n("./src/WebGL/shaders/lib/basic/index.ts"),R=n("./src/WebGL/shaders/lib/instanced/index.ts"),S=n("./src/WebGL/shaders/lib/lambert/index.ts"),j=n("./src/WebGL/shaders/lib/lambertdouble/index.ts"),p=n("./src/WebGL/shaders/lib/outline/index.ts"),v=n("./src/WebGL/shaders/lib/screen/index.ts"),D=n("./src/WebGL/shaders/lib/screenaa/index.ts"),x=n("./src/WebGL/shaders/lib/sphereimposter/index.ts"),A=n("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),L=n("./src/WebGL/shaders/lib/sprite/index.ts"),w=n("./src/WebGL/shaders/lib/stickimposter/index.ts"),b=n("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),u=n("./src/WebGL/shaders/lib/volumetric/index.ts"),i=n("./src/WebGL/shaders/lib/ssao/index.ts"),s=n("./src/WebGL/shaders/lib/blur/index.ts");const h={basic:d.basic,blur:s.blur,instanced:R.instanced,lambert:S.lambert,lambertdouble:j.lambertdouble,outline:p.outline,screen:v.screen,screenaa:D.screenaa,ssao:i.ssao,sphereimposter:x.sphereimposter,sphereimposteroutline:A.sphereimposteroutline,sprite:L.sprite,stickimposter:w.stickimposter,stickimposteroutline:b.stickimposteroutline,volumetric:u.volumetric}},"./src/WebGL/shaders/lib/instanced/index.ts"(o,a,n){n.r(a),n.d(a,{instanced:()=>j});var d=n("./src/WebGL/shaders/lib/instanced/uniforms.ts"),R=n("./src/WebGL/shaders/lib/instanced/instanced.frag"),S=n("./src/WebGL/shaders/lib/instanced/instanced.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/instanced/instanced.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`},"./src/WebGL/shaders/lib/instanced/instanced.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/instanced/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambert/index.ts"(o,a,n){n.r(a),n.d(a,{lambert:()=>j});var d=n("./src/WebGL/shaders/lib/lambert/uniforms.ts"),R=n("./src/WebGL/shaders/lib/lambert/lambert.frag"),S=n("./src/WebGL/shaders/lib/lambert/lambert.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/lambert/lambert.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`},"./src/WebGL/shaders/lib/lambert/lambert.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`},"./src/WebGL/shaders/lib/lambert/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambertdouble/index.ts"(o,a,n){n.r(a),n.d(a,{lambertdouble:()=>j});var d=n("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),R=n("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),S=n("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/outline/index.ts"(o,a,n){n.r(a),n.d(a,{outline:()=>j});var d=n("./src/WebGL/shaders/lib/outline/uniforms.ts"),R=n("./src/WebGL/shaders/lib/outline/outline.frag"),S=n("./src/WebGL/shaders/lib/outline/outline.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/outline/outline.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/outline/outline.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`},"./src/WebGL/shaders/lib/outline/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new d.Color(0,0,0)},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/screen/index.ts"(o,a,n){n.r(a),n.d(a,{screen:()=>j});var d=n("./src/WebGL/shaders/lib/screen/uniforms.ts"),R=n("./src/WebGL/shaders/lib/screen/screen.frag"),S=n("./src/WebGL/shaders/lib/screen/screen.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/screen/screen.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `},"./src/WebGL/shaders/lib/screen/screen.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screen/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>d});const d={}},"./src/WebGL/shaders/lib/screenaa/index.ts"(o,a,n){n.r(a),n.d(a,{screenaa:()=>j});var d=n("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),R=n("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),S=n("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/screenaa/screenaa.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`},"./src/WebGL/shaders/lib/screenaa/screenaa.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screenaa/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>d});const d={}},"./src/WebGL/shaders/lib/sphereimposter/index.ts"(o,a,n){n.r(a),n.d(a,{sphereimposter:()=>j});var d=n("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),R=n("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),S=n("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const j={vertexShader:S.default.replace("#define GLSLIFY 1",""),fragmentShader:R.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`},"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"(o,a,n){n.r(a),n.d(a,{sphereimposteroutline:()=>j});var d=n("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),R=n("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),S=n("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`},"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new d.Color(0,0,0)},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/sprite/index.ts"(o,a,n){n.r(a),n.d(a,{sprite:()=>j});var d=n("./src/WebGL/shaders/lib/sprite/uniforms.ts"),R=n("./src/WebGL/shaders/lib/sprite/sprite.frag"),S=n("./src/WebGL/shaders/lib/sprite/sprite.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/sprite/sprite.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`},"./src/WebGL/shaders/lib/sprite/sprite.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`},"./src/WebGL/shaders/lib/sprite/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>d});const d={}},"./src/WebGL/shaders/lib/ssao/index.ts"(o,a,n){n.r(a),n.d(a,{ssao:()=>j});var d=n("./src/WebGL/shaders/lib/ssao/uniforms.ts"),R=n("./src/WebGL/shaders/lib/ssao/ssao.frag"),S=n("./src/WebGL/shaders/lib/ssao/ssao.vert");const j={fragmentShader:R.default,vertexShader:S.default,uniforms:d.uniforms}},"./src/WebGL/shaders/lib/ssao/ssao.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`},"./src/WebGL/shaders/lib/ssao/ssao.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/ssao/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>d});const d={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/stickimposter/index.ts"(o,a,n){n.r(a),n.d(a,{stickimposter:()=>v});var d=n("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),R=n("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),S=n("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),j=n("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const v={fragmentShader:[R.default,S.default].join(`
`),vertexShader:j.default,uniforms:d.uniforms}},"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`},"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`},"./src/WebGL/shaders/lib/stickimposter/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/stickimposteroutline/index.ts"(o,a,n){n.r(a),n.d(a,{stickimposteroutline:()=>v});var d=n("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),R=n("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),S=n("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag"),j=n("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const v={fragmentShader:R.default+S.default,vertexShader:j.default,uniforms:d.uniforms}},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`},"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new d.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/volumetric/index.ts"(o,a,n){n.r(a),n.d(a,{volumetric:()=>j});var d=n("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),R=n("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),S=n("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const j={fragmentShader:R.default.replace("#define GLSLIFY 1",""),vertexShader:S.default.replace("#define GLSLIFY 1",""),uniforms:d.uniforms}},"./src/WebGL/shaders/lib/volumetric/uniforms.ts"(o,a,n){n.r(a),n.d(a,{uniforms:()=>R});var d=n("./src/colors.ts");const R={opacity:{type:"f",value:1},fogColor:{type:"c",value:new d.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}},"./src/WebGL/shaders/lib/volumetric/volumetric.frag"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `},"./src/WebGL/shaders/lib/volumetric/volumetric.vert"(o,a,n){n.r(a),n.d(a,{default:()=>d});const d=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`},"./src/WebGL/shaders/utils/clone.ts"(o,a,n){n.r(a),n.d(a,{clone:()=>R});var d=n("./src/colors.ts");function R(S){let j={};for(const v in S){j[v]={},j[v].type=S[v].type;var p=S[v].value;p instanceof d.Color?j[v].value=p.clone():typeof p=="number"?j[v].value=p:p instanceof Array?j[v].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return j}},"./src/WebGL/shaders/utils/index.ts"(o,a,n){n.r(a),n.d(a,{ShaderUtils:()=>R,clone:()=>d.clone});var d=n("./src/WebGL/shaders/utils/clone.ts");const R={clone:d.clone}},"./src/WebGL/shapes/Cylinder.ts"(o,a,n){n.r(a),n.d(a,{Cylinder:()=>S});var d=n("./src/WebGL/math/index.ts");let R=new d.Vector3;class S{constructor(p=new d.Vector3,v=new d.Vector3,D=0){this.c1=p,this.c2=v,this.radius=D,this.direction=new d.Vector3().subVectors(this.c2,this.c1).normalize()}copy(p){return this.c1.copy(p.c1),this.c2.copy(p.c2),this.direction.copy(p.direction),this.radius=p.radius,this}lengthSq(){return R.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(p){return this.direction.add(this.c1).applyMatrix4(p),this.c1.applyMatrix4(p),this.c2.applyMatrix4(p),this.direction.sub(this.c1).normalize(),this.radius=this.radius*p.getMaxScaleOnAxis(),this}}},"./src/WebGL/shapes/Sphere.ts"(o,a,n){n.r(a),n.d(a,{Sphere:()=>R});var d=n("./src/WebGL/math/index.ts");class R{constructor(j={x:0,y:0,z:0},p=0){this.center=new d.Vector3(j.x,j.y,j.z),this.radius=p}set(j,p){return this.center.copy(j),this.radius=p,this}copy(j){return this.center.copy(j.center),this.radius=j.radius,this}applyMatrix4(j){return this.center.applyMatrix4(j),this.radius=this.radius*j.getMaxScaleOnAxis(),this}translate(j){return this.center.add(j),this}equals(j){return j.center.equals(this.center)&&j.radius===this.radius}clone(){return new R().copy(this)}}},"./src/WebGL/shapes/Triangle.ts"(o,a,n){n.r(a),n.d(a,{Triangle:()=>S});var d=n("./src/WebGL/math/index.ts");const R=new d.Vector3;class S{constructor(p=new d.Vector3,v=new d.Vector3,D=new d.Vector3){this.a=p,this.b=v,this.c=D}copy(p){return this.a.copy(p.a),this.b.copy(p.b),this.c.copy(p.c),this}applyMatrix4(p){return this.a.applyMatrix4(p),this.b.applyMatrix4(p),this.c.applyMatrix4(p),this}getNormal(){var p=this.a.clone();return p.sub(this.b),R.subVectors(this.c,this.b),p.cross(R),p.normalize(),p}}},"./src/WebGL/shapes/index.ts"(o,a,n){n.r(a),n.d(a,{Cylinder:()=>R.Cylinder,Sphere:()=>d.Sphere,Triangle:()=>S.Triangle});var d=n("./src/WebGL/shapes/Sphere.ts"),R=n("./src/WebGL/shapes/Cylinder.ts"),S=n("./src/WebGL/shapes/Triangle.ts")},"./src/autoload.ts"(o,a,n){n.r(a),n.d(a,{autoinit:()=>p,autoload:()=>x,processing_autoinit:()=>v,viewers:()=>D});var d=n("./src/GLViewer.ts"),R=n("./src/ProteinSurface4.ts"),S=n("./src/utilities.ts"),j=n("./src/colors.ts"),p=!1,v=!1,D={};function x(A,L){var w,b,u;if(document.querySelector(".viewer_3Dmoljs")!=null&&(p=!0),p){v=!0,A=A??null;var i=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(s=>{var h=[],g=[],y="";s.style.position=="static"&&(s.style.position="relative");var E=null;if(u=null,s.dataset.pdb)h.push("https://files.rcsb.org/view/"+s.dataset.pdb+".pdb"),g.push("pdb");else if(s.dataset.cid)g.push("sdf"),h.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+s.dataset.cid+"/SDF?record_type=3d");else if(s.dataset.href||s.dataset.url){if(s.dataset.href?y=s.dataset.href:y=s.dataset.url,h.push(y),u=y.substring(y.lastIndexOf(".")+1),u=="gz"){let Le=y.substring(0,y.lastIndexOf(".")).lastIndexOf(".");u=y.substring(Le+1)}g.push(u);var l=y.substring(y.lastIndexOf("/")+1,y.lastIndexOf("."));l=="/"&&(l=y.substring(y.lastIndexOf("/")+1)),s.dataset[g[g.length-1]]=l}let f=s.dataset;for(w in f)w.substring(0,3)==="pdb"&&w!=="pdb"?(h.push("https://files.rcsb.org/view/"+f[w]+".pdb"),g.push("pdb")):w.substring(0,4)==="href"&&w!=="href"?(y=f[w],h.push(y),g.push(y.substring(y.lastIndexOf(".")+1))):w.substring(0,3)==="cid"&&w!=="cid"&&(h.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+f[w]+"/SDF?record_type=3d"),g.push("sdf"));var m={};s.dataset.options&&(m=(0,S.specStringToObject)(s.dataset.options));var C=j.CC.color(s.dataset.backgroundcolor),T=s.dataset.backgroundalpha;T=T==null?1:parseFloat(T);var P={line:{}};s.dataset.style&&(P=(0,S.specStringToObject)(s.dataset.style));var F={};s.dataset.select&&(F=(0,S.specStringToObject)(s.dataset.select));var N=[],B=[],U=[],K={},H=null,G=s.dataset,$=/style(.+)/,V=/surface(.*)/,k=/labelres(.*)/,Y=[];for(b in G)Object.prototype.hasOwnProperty.call(G,b)&&Y.push(b);for(Y.sort(),w=0;w<Y.length;w++){b=Y[w];var ie=$.exec(b),ne,he,le;ie&&(ne="select"+ie[1],he=(0,S.specStringToObject)(G[ne]),le=(0,S.specStringToObject)(G[b]),N.push([he,le])),ie=V.exec(b),ie&&(ne="select"+ie[1],he=(0,S.specStringToObject)(G[ne]),le=(0,S.specStringToObject)(G[b]),B.push([he,le])),ie=k.exec(b),ie&&(ne="select"+ie[1],he=(0,S.specStringToObject)(G[ne]),le=(0,S.specStringToObject)(G[b]),U.push([he,le])),b=="zoomto"&&(K=(0,S.specStringToObject)(G[b])),b=="spin"&&(H=(0,S.specStringToObject)(G[b]))}var xe=function(Le){for(Le.setStyle(F,P),E&&E.createSelectionAndStyle(F,P),w=0;w<N.length;w++){let ue=N[w][0]||{},Me=N[w][1]||{line:{}};Le.setStyle(ue,Me),E&&E.createSelectionAndStyle(F,P)}for(w=0;w<B.length;w++){let ue=B[w][0]||{},Me=B[w][1]||{};E?Le.addSurface(R.SurfaceType.VDW,Me,ue,ue).then(Je=>{E.loadSurface("VDW",ue,Me,Je)}):Le.addSurface(R.SurfaceType.VDW,Me,ue,ue)}for(w=0;w<U.length;w++){let ue=U[w][0]||{},Me=U[w][1]||{};Le.addResLabels(ue,Me)}Le.render(),Le.zoomTo(K),H&&Le.spin(H.axis,H.speed)};let fe=A;try{var pe=(0,S.specStringToObject)(s.dataset.config)||{};pe.backgroundColor===void 0&&(pe.backgroundColor=C),pe.backgroundAlpha===void 0&&(pe.backgroundAlpha=T),fe==null?fe=D[s.id||i++]=(0,d.createViewer)(s,pe):(fe.setBackgroundColor(C,T),fe.setConfig(pe),E&&E.initiateUI()),s.dataset.ui&&$3Dmol.StateManager&&(E=new $3Dmol.StateManager(fe))}catch(Le){console.log(Le),s.textContent="WebGL appears to be disabled."}if(h.length!=0){let Le=0,ue=((Me,Ge)=>function(Je){y=h[Le];var qe=Me.dataset.type||Me.dataset.datatype||g[Le];if(Ge.addModel(Je,qe,m),E){var tt=Me.dataset[g[Le]];E.setModelTitle(tt)}Le+=1,Le<h.length?(0,S.get)(h[Le]).then(ue):(xe(Ge),Me.dataset.callback&&(0,S.makeFunction)(Me.dataset.callback)(Ge),v=!1,L&&L(Ge))})(s,fe);u&&u.endsWith("gz")?(0,S.getbin)(h[0]).then(ue):(0,S.get)(h[0]).then(ue)}else{if(s.dataset.element){var Te="#"+s.dataset.element,ke=document.querySelector(Te),$e=ke?ke.textContent:"";u=s.dataset.type||s.dataset.datatype,fe.addModel($e,u,m)}xe(fe),s.dataset.callback&&(0,S.makeFunction)(s.dataset.callback)(fe),v=!1,L&&L(fe)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&x()}},"./src/colors.ts"(o,a,n){n.r(a),n.d(a,{CC:()=>R,Color:()=>d,builtinColorSchemes:()=>A,chains:()=>x,elementColors:()=>v,htmlColors:()=>S,residues:()=>D,ssColors:()=>j});class d{constructor(w,b,u){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof w=="number"?(this.r=w||0,this.g=b||0,this.b=u||0,this):this.set(w||0)}set(w){return w instanceof d?w.clone():(typeof w=="number"?this.setHex(w):typeof w=="object"&&(this.r=w?.r||0,this.g=w?.g||0,this.b=w?.b||0),this)}setHex(w){return w=Math.floor(w),this.r=(w>>16&255)/255,this.g=(w>>8&255)/255,this.b=(w&255)/255,this}getHex(){var w=Math.round(this.r*255),b=Math.round(this.g*255),u=Math.round(this.b*255);return w<<16|b<<8|u}clone(){return new d(this.r,this.g,this.b)}copy(w){return this.r=w.r,this.g=w.g,this.b=w.b,this}scaled(){var w={};return w.r=Math.round(this.r*255),w.g=Math.round(this.g*255),w.b=Math.round(this.b*255),w.a=1,w}}class R{static color(w){if(!w)return R.cache[0];if(w instanceof d)return w;if(typeof w=="number"&&typeof R.cache[w]<"u")return R.cache[w];if(w&&Array.isArray(w))return w.map(R.color);let b=R.getHex(w),u=new d(b);return R.cache[b]=u,u}static getHex(w){if(Array.isArray(w))return w.map(R.getHex);if(typeof w=="string"){let b=w;if(!isNaN(parseInt(b)))return parseInt(b);if(b=b.trim(),b.length==4&&b[0]=="#"&&(b="#"+b[1]+b[1]+b[2]+b[2]+b[3]+b[3]),b.length==7&&b[0]=="#")return parseInt(b.substring(1),16);let u=R.rgbRegEx.exec(b);if(u){u[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let s=0;for(let h=2;h<5;h++){s*=256;let g=u[h].endsWith("%")?255*parseFloat(u[h])/100:parseFloat(u[h]);s+=Math.round(g)}return s}let i=S[b.toLowerCase()];return i!==void 0?i:(console.error("color not found",w.toLowerCase(),S),0)}return w}}R.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,R.cache={0:new d(0)};const S={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},j={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},p={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},v={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:p,defaultColors:Object.assign({},p),greenCarbon:Object.assign(Object.assign({},p),{C:65280}),cyanCarbon:Object.assign(Object.assign({},p),{C:65535}),magentaCarbon:Object.assign(Object.assign({},p),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},p),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},p),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},p),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},p),{C:8388736}),blueCarbon:Object.assign(Object.assign({},p),{C:255})},D={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},x={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},A={ssPyMol:{prop:"ss",map:j.pyMol},ssJmol:{prop:"ss",map:j.Jmol},Jmol:{prop:"elem",map:v.Jmol},amino:{prop:"resn",map:D.amino},shapely:{prop:"resn",map:D.shapely},nucleic:{prop:"resn",map:D.nucleic},chain:{prop:"chain",map:x.atom},rasmol:{prop:"elem",map:v.rasmol},default:{prop:"elem",map:v.defaultColors},greenCarbon:{prop:"elem",map:v.greenCarbon},chainHetatm:{prop:"chain",map:x.hetatm},cyanCarbon:{prop:"elem",map:v.cyanCarbon},magentaCarbon:{prop:"elem",map:v.magentaCarbon},purpleCarbon:{prop:"elem",map:v.purpleCarbon},whiteCarbon:{prop:"elem",map:v.whiteCarbon},orangeCarbon:{prop:"elem",map:v.orangeCarbon},yellowCarbon:{prop:"elem",map:v.yellowCarbon},blueCarbon:{prop:"elem",map:v.blueCarbon}}},"./src/exporter.js"(o){typeof o.exports=="object"&&(o.exports=window.$3Dmol)},"./src/glcartoon.ts"(o,a,n){n.r(a),n.d(a,{drawCartoon:()=>F,subdivide_spline:()=>x});var d=n("./src/WebGL/math/index.ts"),R=n("./src/WebGL/shapes/index.ts"),S=n("./src/WebGL/index.ts"),j=n("./src/Gradient.ts"),p=n("./src/colors.ts"),v=n("./src/GLDraw.ts"),D=n("./src/utilities.ts");function x(N,B){var U=[],K=N;K=[],K.push(N[0]);var H,G,$,V,k,Y,ie,ne,he;for(H=1,G=N.length-1;H<G;H++)if(k=N[H],Y=N[H+1],k.smoothen){var le=new d.Vector3((k.x+Y.x)/2,(k.y+Y.y)/2,(k.z+Y.z)/2);le.atom=k.atom,K.push(le)}else K.push(k);for(K.push(N[N.length-1]),H=-1,$=K.length;H<=$-3;H++)if(V=K[H===-1?0:H],k=K[H+1],Y=K[H+2],ie=K[H===$-3?$-1:H+3],ne=new d.Vector3().subVectors(Y,V).multiplyScalar(.5),he=new d.Vector3().subVectors(ie,k).multiplyScalar(.5),!Y.skip)for(var xe=0;xe<B;xe++){var fe=1/B*xe,pe=k.x+fe*ne.x+fe*fe*(-3*k.x+3*Y.x-2*ne.x-he.x)+fe*fe*fe*(2*k.x-2*Y.x+ne.x+he.x),Te=k.y+fe*ne.y+fe*fe*(-3*k.y+3*Y.y-2*ne.y-he.y)+fe*fe*fe*(2*k.y-2*Y.y+ne.y+he.y),ke=k.z+fe*ne.z+fe*fe*(-3*k.z+3*Y.z-2*ne.z-he.z)+fe*fe*fe*(2*k.z-2*Y.z+ne.z+he.z),$e=new d.Vector3(pe,Te,ke);xe<B/2?$e.atom=k.atom:$e.atom=Y.atom,U.push($e)}return U.push(K[K.length-1]),U}const A=.5,L=1.3,w=.8,b=.4,u=.4;function i(N,B,U,K){for(var H,G,$,V,k=0,Y=B.length;k<Y;k++){V=Math.round(k*(K.length-1)/Y),$=p.CC.color(K[V]);var ie=N.updateGeoGroup(2),ne=ie.vertexArray,he=ie.colorArray,le=ie.faceArray;H=ie.vertices,G=H*3,ne[G]=B[k].x,ne[G+1]=B[k].y,ne[G+2]=B[k].z,ne[G+3]=U[k].x,ne[G+4]=U[k].y,ne[G+5]=U[k].z;for(var xe=0;xe<6;++xe)he[G+3*xe]=$.r,he[G+1+3*xe]=$.g,he[G+2+3*xe]=$.b;if(k>0){var fe=[H,H+1,H-1,H-2],pe=ie.faceidx;le[pe]=fe[0],le[pe+1]=fe[1],le[pe+2]=fe[3],le[pe+3]=fe[1],le[pe+4]=fe[2],le[pe+5]=fe[3],ie.faceidx+=6}ie.vertices+=2}}function s(N,B,U,K,H,G,$){var V,k,Y,ie;if(Y=B.length,Y<2||B[0].length<2)return;for(V=0;V<Y;V++)B[V]=x(B[V],K);if(ie=B[0].length,!H)return i(N,B[0],B[Y-1],U);var ne,he,le,xe,fe,pe,Te=[],ke=[],$e=[];for(k=0;k<Y;k++)Te.push(.25+1.5*Math.sqrt((Y-1)*k-Math.pow(k,2))/(Y-1)),ke.push(.5),$e.push(2*(Math.pow(k/Y,2)-k/Y)+.6);var Le=[];for(k=0;k<Y*2-1;k++)Le[k]=[k,k+1,k+1-2*Y,k-2*Y];Le[Y*2-1]=[k,k+1-2*Y,k+1-4*Y,k-2*Y];var ue,Me,Ge,Je,qe,tt,Ze,Ve,Ye,Ke;let We=N.updateGeoGroup();for(V=0;V<ie;V++){let re=N.groups,se=!1;We=N.updateGeoGroup(2*Y),re!=N.groups&&V>0&&(V=V-1,se=!0),tt=Math.round(V*(U.length-1)/ie),qe=p.CC.color(U[tt]),fe=le,pe=xe,le=[],xe=[],ne=[],B[0][V].atom!==void 0&&(Je=B[0][V].atom,$==="oval"?he=Te:$==="rectangle"?he=ke:$==="parabola"&&(he=$e)),he||(he=ke);var nt,at;for(k=0;k<Y;k++)V<ie-1?nt=B[k][V+1].clone().sub(B[k][V]):nt=B[k][V-1].clone().sub(B[k][V]).negate(),k<Y-1?at=B[k+1][V].clone().sub(B[k][V]):at=B[k-1][V].clone().sub(B[k][V]).negate(),ne[k]=at.cross(nt).normalize().multiplyScalar(H*he[k]);for(k=0;k<Y;k++)le[k]=B[k][V].clone().add(ne[k].clone().negate());for(k=0;k<Y;k++)xe[k]=B[k][V].clone().add(ne[k]);for(Ze=We.vertexArray,Ve=We.colorArray,Ye=We.faceArray,ue=We.vertices,Me=ue*3,k=0;k<Y;k++)Ze[Me+3*k+0]=le[k].x,Ze[Me+3*k+1]=le[k].y,Ze[Me+3*k+2]=le[k].z;for(k=0;k<Y;k++)Ze[Me+3*k+0+3*Y]=xe[Y-1-k].x,Ze[Me+3*k+1+3*Y]=xe[Y-1-k].y,Ze[Me+3*k+2+3*Y]=xe[Y-1-k].z;for(k=0;k<2*Y;++k)Ve[Me+3*k+0]=qe.r,Ve[Me+3*k+1]=qe.g,Ve[Me+3*k+2]=qe.b;if(V>0&&!se){for(k=0;k<Y*2;k++)Ke=[ue+Le[k][0],ue+Le[k][1],ue+Le[k][2],ue+Le[k][3]],Ge=We.faceidx,Ye[Ge]=Ke[0],Ye[Ge+1]=Ke[1],Ye[Ge+2]=Ke[3],Ye[Ge+3]=Ke[1],Ye[Ge+4]=Ke[2],Ye[Ge+5]=Ke[3],We.faceidx+=6;if(Je.clickable||Je.hoverable){var q=[];q.push(new R.Triangle(fe[0],le[0],le[Y-1])),q.push(new R.Triangle(fe[0],le[Y-1],fe[Y-1])),q.push(new R.Triangle(fe[Y-1],le[Y-1],xe[Y-1])),q.push(new R.Triangle(fe[Y-1],xe[Y-1],pe[Y-1])),q.push(new R.Triangle(xe[0],pe[0],pe[Y-1])),q.push(new R.Triangle(xe[Y-1],xe[0],pe[Y-1])),q.push(new R.Triangle(le[0],fe[0],pe[0])),q.push(new R.Triangle(xe[0],le[0],pe[0]));for(k in q)Je.intersectionShape.triangle.push(q[k])}}We.vertices+=2*Y}for(Ze=We.vertexArray,Ve=We.colorArray,Ye=We.faceArray,ue=We.vertices,Me=ue*3,Ge=We.faceidx,V=0;V<Y-1;V++)Ke=[V,V+1,2*Y-2-V,2*Y-1-V],Ge=We.faceidx,Ye[Ge]=Ke[0],Ye[Ge+1]=Ke[1],Ye[Ge+2]=Ke[3],Ye[Ge+3]=Ke[1],Ye[Ge+4]=Ke[2],Ye[Ge+5]=Ke[3],We.faceidx+=6;for(V=0;V<Y-1;V++)Ke=[ue-1-V,ue-2-V,ue-2*Y+V+1,ue-2*Y+V],Ge=We.faceidx,Ye[Ge]=Ke[0],Ye[Ge+1]=Ke[1],Ye[Ge+2]=Ke[3],Ye[Ge+3]=Ke[1],Ye[Ge+4]=Ke[2],Ye[Ge+5]=Ke[3],We.faceidx+=6}function h(N,B,U,K,H,G){if(!(B.length<2)){var $,V;if($=B[0],V=B[B.length-1],$=x($,K),V=x(V,K),!H)return i(N,$,V,U);var k=[],Y,ie,ne,he,le,xe=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],fe,pe,Te,ke,$e,Le,ue,Me,Ge,Je,qe,tt,Ze,Ve,Ye,Ke,We;for(Me=0,Ge=$.length;Me<Ge;Me++){if($e=Math.round(Me*(U.length-1)/Ge),ke=p.CC.color(U[$e]),k.push(ie=$[Me]),k.push(ie),k.push(ne=V[Me]),k.push(ne),Me<Ge-1){var nt=$[Me+1].clone().sub($[Me]),at=V[Me].clone().sub($[Me]);Y=at.cross(nt).normalize().multiplyScalar(H)}for(k.push(he=$[Me].clone().add(Y)),k.push(he),k.push(le=V[Me].clone().add(Y)),k.push(le),ie.atom!==void 0&&(Le=ie.atom),Ve=N.updateGeoGroup(8),Ye=Ve.vertexArray,Ke=Ve.colorArray,We=Ve.faceArray,fe=Ve.vertices,pe=fe*3,Ye[pe]=ie.x,Ye[pe+1]=ie.y,Ye[pe+2]=ie.z,Ye[pe+3]=ie.x,Ye[pe+4]=ie.y,Ye[pe+5]=ie.z,Ye[pe+6]=ne.x,Ye[pe+7]=ne.y,Ye[pe+8]=ne.z,Ye[pe+9]=ne.x,Ye[pe+10]=ne.y,Ye[pe+11]=ne.z,Ye[pe+12]=he.x,Ye[pe+13]=he.y,Ye[pe+14]=he.z,Ye[pe+15]=he.x,Ye[pe+16]=he.y,Ye[pe+17]=he.z,Ye[pe+18]=le.x,Ye[pe+19]=le.y,Ye[pe+20]=le.z,Ye[pe+21]=le.x,Ye[pe+22]=le.y,Ye[pe+23]=le.z,Je=0;Je<8;++Je)Ke[pe+3*Je]=ke.r,Ke[pe+1+3*Je]=ke.g,Ke[pe+2+3*Je]=ke.b;if(Me>0){var q=ue!==void 0&&Le!==void 0&&ue.serial!==Le.serial;for(Je=0;Je<4;Je++){var re=[fe+xe[Je][0],fe+xe[Je][1],fe+xe[Je][2],fe+xe[Je][3]];if(Te=Ve.faceidx,We[Te]=re[0],We[Te+1]=re[1],We[Te+2]=re[3],We[Te+3]=re[1],We[Te+4]=re[2],We[Te+5]=re[3],Ve.faceidx+=6,Le.clickable||ue.clickable||Le.hoverable||ue.hoverable){var se=k[re[3]].clone(),Se=k[re[0]].clone(),we=k[re[2]].clone(),ze=k[re[1]].clone();if(se.atom=k[re[3]].atom||null,we.atom=k[re[2]].atom||null,Se.atom=k[re[0]].atom||null,ze.atom=k[re[1]].atom||null,q){var Be=se.clone().add(Se).multiplyScalar(.5),Z=we.clone().add(ze).multiplyScalar(.5),ge=se.clone().add(ze).multiplyScalar(.5);Je%2===0?((ue.clickable||ue.hoverable)&&(qe=new R.Triangle(Be,ge,se),tt=new R.Triangle(Z,we,ge),Ze=new R.Triangle(ge,we,se),ue.intersectionShape.triangle.push(qe),ue.intersectionShape.triangle.push(tt),ue.intersectionShape.triangle.push(Ze)),(Le.clickable||Le.hoverable)&&(qe=new R.Triangle(Se,ze,ge),tt=new R.Triangle(ze,Z,ge),Ze=new R.Triangle(Se,ge,Be),Le.intersectionShape.triangle.push(qe),Le.intersectionShape.triangle.push(tt),Le.intersectionShape.triangle.push(Ze))):((Le.clickable||Le.hoverable)&&(qe=new R.Triangle(Be,ge,se),tt=new R.Triangle(Z,we,ge),Ze=new R.Triangle(ge,we,se),Le.intersectionShape.triangle.push(qe),Le.intersectionShape.triangle.push(tt),Le.intersectionShape.triangle.push(Ze)),(ue.clickable||ue.hoverable)&&(qe=new R.Triangle(Se,ze,ge),tt=new R.Triangle(ze,Z,ge),Ze=new R.Triangle(Se,ge,Be),ue.intersectionShape.triangle.push(qe),ue.intersectionShape.triangle.push(tt),ue.intersectionShape.triangle.push(Ze)))}else(Le.clickable||Le.hoverable)&&(qe=new R.Triangle(Se,ze,se),tt=new R.Triangle(ze,we,se),Le.intersectionShape.triangle.push(qe),Le.intersectionShape.triangle.push(tt))}}}Ve.vertices+=8,ue=Le}var Ce=k.length-8;for(Ve=N.updateGeoGroup(8),Ye=Ve.vertexArray,Ke=Ve.colorArray,We=Ve.faceArray,fe=Ve.vertices,pe=fe*3,Te=Ve.faceidx,Me=0;Me<4;Me++){k.push(k[Me*2]),k.push(k[Ce+Me*2]);var Ue=k[Me*2],ce=k[Ce+Me*2];Ye[pe+6*Me]=Ue.x,Ye[pe+1+6*Me]=Ue.y,Ye[pe+2+6*Me]=Ue.z,Ye[pe+3+6*Me]=ce.x,Ye[pe+4+6*Me]=ce.y,Ye[pe+5+6*Me]=ce.z,Ke[pe+6*Me]=ke.r,Ke[pe+1+6*Me]=ke.g,Ke[pe+2+6*Me]=ke.b,Ke[pe+3+6*Me]=ke.r,Ke[pe+4+6*Me]=ke.g,Ke[pe+5+6*Me]=ke.b}Ce+=8,qe=[fe,fe+2,fe+6,fe+4],tt=[fe+1,fe+5,fe+7,fe+3],We[Te]=qe[0],We[Te+1]=qe[1],We[Te+2]=qe[3],We[Te+3]=qe[1],We[Te+4]=qe[2],We[Te+5]=qe[3],We[Te+6]=tt[0],We[Te+7]=tt[1],We[Te+8]=tt[3],We[Te+9]=tt[1],We[Te+10]=tt[2],We[Te+11]=tt[3],Ve.faceidx+=12,Ve.vertices+=8}}function g(N,B,U,K,H,G,$){(!$||$==="default")&&($="rectangle"),$==="edged"?h(N,B,U,K,H):($==="rectangle"||$==="oval"||$==="parabola")&&s(N,B,U,K,H,G,$)}function y(N){return N&&N.elem==="C"&&N.atom==="CA"}function E(N,B){if(N&&B&&N.chain===B.chain){if(!N.hetflag&&!B.hetflag&&N.reschain===B.reschain&&(N.resi===B.resi||N.resi===B.resi-1))return!0;if(N.resi<B.resi){var U=N.x-B.x,K=N.y-B.y,H=N.z-B.z,G=U*U+K*K+H*H;if(N.atom=="CA"&&B.atom=="CA"&&G<16)return!0;if((N.atom=="P"||B.atom=="P")&&G<64)return!0}}return!1}function l(N,B,U,K,H){if(!(B==null||B.vertices==0)){H&&(B.initTypedArrays(),B.setUpNormals());var G=new S.MeshDoubleLambertMaterial;G.vertexColors=S.Coloring.FaceColors,typeof U=="number"&&U>=0&&U<1&&(G.transparent=!0,G.opacity=U),G.outline=K;var $=new S.Mesh(B,G);N.add($)}}function f(N,B,U,K,H,G,$,V,k){var Y,ie,ne,he,le,xe;if(!(!K||!H||!$)){var fe=H.sub(K);fe.normalize();var pe=V[k];for(ie=k+1;ie<V.length&&(pe=V[ie],pe.atom!=$.atom);ie++);if(pe=pe?new d.Vector3(pe.x,pe.y,pe.z):new d.Vector3(0,0,0),pe.sub(K),$.ss==="arrow start"){var Te=pe.clone().multiplyScalar(.3).cross(H);K.add(Te);var ke=pe.clone().cross(fe).normalize();fe.rotateAboutVector(ke,.43)}for($.style.cartoon.ribbon?Y=$.style.cartoon.thickness||b:$.style.cartoon.width?Y=$.style.cartoon.width:$.ss==="c"?$.atom==="P"?Y=w:Y=A:$.ss==="arrow start"?(Y=L,le=!0):$.ss==="arrow end"||$.ss==="h"&&$.style.cartoon.tubes||$.ss==="tube start"?Y=A:Y=L,G!=null&&fe.dot(G)<0&&fe.negate(),fe.multiplyScalar(Y),ie=0;ie<B;ie++)ne=-1+ie*2/(B-1),he=new d.Vector3(K.x+ne*fe.x,K.y+ne*fe.y,K.z+ne*fe.z),he.atom=$,$.ss==="s"&&(he.smoothen=!0),N[ie].push(he);if(le)for(fe.multiplyScalar(2),ie=0;ie<B;ie++)ne=-1+ie*2/(B-1),he=new d.Vector3(K.x+ne*fe.x,K.y+ne*fe.y,K.z+ne*fe.z),he.atom=$,he.smoothen=!1,he.skip=!0,N[ie].push(he);return xe=$.style.cartoon.style||"default",N.style?N.style!=xe&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),N.style="default"):N.style=xe,($.ss==="arrow start"||$.ss==="arrow end")&&($.ss="s"),le}}const m={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},C={DA:!0,DG:!0,A:!0,G:!0},T={DT:!0,DC:!0,U:!0,C:!0,T:!0},P={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function F(N,B,U,K=10){let H=K,G=K;var $,V,k,Y,ie,ne,he,le,xe,fe,pe,Te,ke,$e,Le,ue,Me,Ge,Je=new S.Geometry(!0),qe=new S.Geometry(!0),tt=[],Ze=[],Ve=1,Ye=!1,Ke={};for(var We in j.Gradient.builtinGradients)j.Gradient.builtinGradients.hasOwnProperty(We)&&(Ke[We]=new j.Gradient.builtinGradients[We](U[1],U[0]));var nt=function(He,z){return U&&z.color==="spectrum"?z.colorscheme in Ke?Ke[z.colorscheme].valueToHex(He.resi):Ke.sinebow.valueToHex(He.resi):(0,D.getColorFromStyle)(He,z).getHex()};for(le=0;le<H;le++)Ze[le]=[];var at=!1,q=!1,re=[];for(le in B){if(Y=B[le],Y.elem==="C"&&Y.atom==="CA"){var se=E(k,Y);se&&Y.ss==="s"?at=!0:at&&(k&&V&&k.style.cartoon.arrows&&V.style.cartoon.arrows&&(k.ss="arrow end",V.ss="arrow start"),at=!1),se&&(k.ss==="h"||k.ss=="tube start")&&k.style.cartoon.tubes?!q&&k.ss!="tube start"&&Y.style.cartoon.tubes&&(Y.ss="tube start",q=!0):q&&(k.ss==="tube start"?k.ss="tube end":V&&V.style.cartoon.tubes&&(V.ss="tube end"),q=!1),V=k,k=Y}Y&&Y.atom in m&&re.push(Y)}q&&k.style.cartoon.tubes&&(k.ss="tube end",q=!1);var Se=function(He){Ze[0].length>0&&g(qe,Ze,tt,G,he,Ve,Ze.style);var z=[],be=null;if(He){for(le=0;le<H;le++)z[le]=Ze[le][Ze[le].length-1];be=tt[tt.length-1]}for(Ze=[],le=0;le<H;le++)Ze[le]=[];if(tt=[],He){for(le=0;le<H;le++)Ze[le].push(z[le]);tt.push(be)}l(N,qe,Ve,Ye,!0),l(N,Je,Ve,Ye,!1),qe=new S.Geometry(!0),Je=new S.Geometry(!0)};k=void 0;let we=[];for(var ze=0;ze<re.length;ze++){Y=re[ze];var Be=Y.resn.trim(),Z=Be in P;if(Ve=1,$=Y.style.cartoon,k&&k.style.cartoon&&(Ve=k.style.cartoon.opacity),k&&k.style.cartoon&&k.style.cartoon.outline&&(Ye=k.style.cartoon.outline),k&&k.style.cartoon&&(!Y.style.cartoon||k.style.cartoon.opacity!=Y.style.cartoon.opacity)&&Se(k.chain==Y.chain),k&&Y&&!E(k,Y)&&k.chain&&k.chain==Y.chain&&!k.hetflag&&!Y.hetflag&&k.reschain+1==Y.reschain&&we.push([k,Y]),$.style==="trace"){if(!Y.hetflag){if(Y.elem==="C"&&Y.atom==="CA"||Z&&Y.atom==="P"||Y.atom==="BB"){if(ne=nt(Y,$),(0,D.isNumeric)($.thickness)?he=$.thickness:he=b,E(k,Y))if(ne==ie){var ge=p.CC.color(ne);v.GLDraw.drawCylinder(Je,k,Y,he,ge,2,2)}else{var Ce=new d.Vector3().addVectors(k,Y).multiplyScalar(.5),Ue=p.CC.color(ie),ce=p.CC.color(ne);v.GLDraw.drawCylinder(Je,k,Ce,he,Ue,2,0),v.GLDraw.drawCylinder(Je,Ce,Y,he,ce,0,2)}if((Y.clickable===!0||Y.hoverable)&&Y.intersectionShape!==void 0){var Pe=new d.Vector3(Y.x,Y.y,Y.z);Y.intersectionShape.sphere.push(new R.Sphere(Pe,he))}k=Y,ie=ne}}}else{if(y(Y)||Z&&(Y.atom==="P"||Y.atom.indexOf("O5")==0)){if(Ge)if(Y.ss==="tube end")Ge=!1,Me=new d.Vector3(Y.x,Y.y,Y.z),v.GLDraw.drawCylinder(Je,ue,Me,2,p.CC.color(ie),1,1),Y.ss="h";else if(k.chain!=Y.chain||k.ss==="tube end")Ge=!1,k.ss="h",Me=new d.Vector3(k.x,k.y,k.z),v.GLDraw.drawCylinder(Je,ue,Me,2,p.CC.color(ie),1,1);else continue;if(k&&(!E(k,Y)||k.ss==="tube start")){for(k.ss==="tube start"&&(Ge=!0,ue=new d.Vector3(k.x,k.y,k.z),k.ss="h"),Le&&(Te?$e=new d.Vector3().addVectors(k,Te).multiplyScalar(.5):$e=new d.Vector3(k.x,k.y,k.z),v.GLDraw.drawCylinder(Je,$e,Le,u,p.CC.color(Le.color),0,2),f(Ze,H,!0,Te,ke,pe,k,re,ze),tt.push(ne),$e=null,Le=null),Ze[0].length>0&&g(qe,Ze,tt,G,he,Ve,Ze.style),Ze=[],le=0;le<H;le++)Ze[le]=[];tt=[]}if(k===void 0||k.rescode!=Y.rescode||k.resi!=Y.resi){if(Le&&k!=null){$e=new d.Vector3().addVectors(k,Y).multiplyScalar(.5);var Q=$e.clone().sub(Le).multiplyScalar(.02);$e.add(Q),v.GLDraw.drawCylinder(Je,$e,Le,u,p.CC.color(Le.color),0,2),$e=null,Le=null}ne=nt(Y,$),tt.push(ne),(0,D.isNumeric)($.thickness)?he=$.thickness:he=b,k=Y,xe=new d.Vector3(k.x,k.y,k.z),xe.resi=k.resi,ie=ne}(Y.clickable===!0||Y.hoverable===!0)&&(Y.intersectionShape===void 0||Y.intersectionShape.triangle===void 0)&&(Y.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else k!=null&&(y(k)&&Y.atom==="O"||Z&&k.atom==="P"&&(Y.atom==="OP2"||Y.atom==="O2P")||Z&&k.atom.indexOf("O5")==0&&Y.atom.indexOf("C5")==0)?(fe=new d.Vector3(Y.x,Y.y,Y.z),fe.resi=Y.resi,(Y.atom==="OP2"||Y.atom==="O2P")&&(ke=new d.Vector3(Y.x,Y.y,Y.z))):Z&&Y.atom.indexOf("O3")==0?Te=new d.Vector3(Y.x,Y.y,Y.z):(Y.atom==="N1"&&Be in C||Y.atom==="N3"&&Be in T)&&(Le=new d.Vector3(Y.x,Y.y,Y.z),Le.color=(0,D.getColorFromStyle)(Y,$).getHex());fe&&xe&&fe.resi===xe.resi&&(f(Ze,H,!0,xe,fe,pe,k,re,ze),pe=fe,xe=null,fe=null,tt.push(ne))}}Le&&(Te?$e=new d.Vector3().addVectors(k,Te).multiplyScalar(.5):$e=new d.Vector3(k.x,k.y,k.z),v.GLDraw.drawCylinder(Je,$e,Le,u,p.CC.color(Le.color),0,2),f(Ze,H,!0,Te,ke,pe,k,re,ze),tt.push(ne)),Se(!1);var Ne=function(He,z){if(He.style.cartoon.gapcutoff&&He.style.cartoon.gapcutoff==z.style.cartoon.gapcutoff){let _e=He.style.cartoon.gapcutoff,ee=z.resi-He.resi;if(ee>0&&ee<_e){let me=.25,Ae=z.x-He.x,ut=z.y-He.y,ot=z.z-He.z,rt=Math.sqrt(Ae*Ae+ut*ut+ot*ot),yt=rt/(2*ee),Xt=new d.Vector3(He.x,He.y,He.z),bt=rt/yt,xt=new d.Vector3((z.x-He.x)/bt,(z.y-He.y)/bt,(z.z-He.z)/bt);Xt.add({x:xt.x/2,y:xt.y/2,z:xt.z/2});let vt=Xt.clone().add(xt);xt.multiplyScalar(2);let Pt=(0,D.extend)({},He);for(var be=0;be<ee;be++){Pt.resi+=1;let Dt=nt(Pt,Pt.style.cartoon);v.GLDraw.drawCylinder(Je,Xt,vt,me,p.CC.color(Dt),v.CAP.FLAT,v.CAP.FLAT),Xt.add(xt),vt.add(xt)}Se(!1)}}};for(let He of we)Ne(He[0],He[1])}},"./src/index.ts"(o,a,n){n.r(a),n.d(a,{CAP:()=>d.CAP,CC:()=>d.CC,CONTEXTS_PER_VIEWPORT:()=>d.CONTEXTS_PER_VIEWPORT,Color:()=>d.Color,CustomLinear:()=>d.CustomLinear,Cylinder:()=>d.Cylinder,GLDraw:()=>d.GLDraw,GLModel:()=>d.GLModel,GLShape:()=>d.GLShape,GLViewer:()=>d.GLViewer,GLVolumetricRender:()=>d.GLVolumetricRender,Gradient:()=>d.Gradient,GradientType:()=>d.GradientType,Label:()=>d.Label,LabelCount:()=>d.LabelCount,MarchingCube:()=>d.MarchingCube,MarchingCubeInitializer:()=>d.MarchingCubeInitializer,Matrix3:()=>d.Matrix3,Matrix4:()=>d.Matrix4,Parsers:()=>d.Parsers,PausableTimer:()=>d.PausableTimer,PointGrid:()=>d.PointGrid,ProteinSurface:()=>d.ProteinSurface,Quaternion:()=>d.Quaternion,ROYGB:()=>d.ROYGB,RWB:()=>d.RWB,Ray:()=>d.Ray,Sinebow:()=>d.Sinebow,Sphere:()=>d.Sphere,SurfaceType:()=>d.SurfaceType,Triangle:()=>d.Triangle,Vector2:()=>d.Vector2,Vector3:()=>d.Vector3,VolumeData:()=>d.VolumeData,adjustVolumeStyle:()=>d.adjustVolumeStyle,applyPartialCharges:()=>d.applyPartialCharges,autoinit:()=>d.autoinit,autoload:()=>d.autoload,base64ToArray:()=>d.base64ToArray,bondLength:()=>d.bondLength,builtinColorSchemes:()=>d.builtinColorSchemes,builtinGradients:()=>d.builtinGradients,chains:()=>d.chains,clamp:()=>d.clamp,conversionMatrix3:()=>d.conversionMatrix3,createStereoViewer:()=>d.createStereoViewer,createViewer:()=>d.createViewer,createViewerGrid:()=>d.createViewerGrid,deepCopy:()=>d.deepCopy,degToRad:()=>d.degToRad,download:()=>d.download,drawCartoon:()=>d.drawCartoon,elementColors:()=>d.elementColors,extend:()=>d.extend,get:()=>d.get,getAtomProperty:()=>d.getAtomProperty,getColorFromStyle:()=>d.getColorFromStyle,getElement:()=>d.getElement,getExtent:()=>d.getExtent,getGradient:()=>d.getGradient,getPropertyRange:()=>d.getPropertyRange,getbin:()=>d.getbin,htmlColors:()=>d.htmlColors,inflateString:()=>d.inflateString,isEmptyObject:()=>d.isEmptyObject,isNumeric:()=>d.isNumeric,makeFunction:()=>d.makeFunction,mergeGeos:()=>d.mergeGeos,normalizeValue:()=>d.normalizeValue,partialCharges:()=>d.partialCharges,processing_autoinit:()=>d.processing_autoinit,residues:()=>d.residues,setBondLength:()=>d.setBondLength,setSyncSurface:()=>d.setSyncSurface,specStringToObject:()=>d.specStringToObject,splitMesh:()=>d.splitMesh,ssColors:()=>d.ssColors,subdivide_spline:()=>d.subdivide_spline,syncSurface:()=>d.syncSurface,viewers:()=>d.viewers});var d=n("./src/3Dmol.ts");window&&(window.$3Dmol=a)},"./src/parsers/BCIF.ts"(o,a,n){n.r(a),n.d(a,{BCIF:()=>b});var d=n("./src/utilities.ts"),R=n("./src/parsers/utils/computeSecondaryStructure.ts"),S=n("./src/parsers/utils/processSymmetries.ts"),j=n("./src/parsers/cifutils/category.ts"),p=n("./src/parsers/utils/assignPDBBonds.ts"),v=n("./src/WebGL/index.ts"),D=n("./src/parsers/utils/isEmpty.ts"),x=n("./src/vendor/mmtf.js");class A{constructor(i){if(this.C={},i){let s=i.getField("comp_id"),h=i.getField("atom_id_1"),g=i.getField("atom_id_2"),y=i.getField("value_order");for(let E=0;E<s.length;E++){let l=s[E],f=h[E],m=g[E],C=y[E],T=1;C=="doub"?T=2:C=="trip"&&(T=3),this.C[l]==null&&(this.C[l]={}),this.C[l][f]==null&&(this.C[l][f]={}),this.C[l][m]==null&&(this.C[l][m]={}),this.C[l][f][m]=T,this.C[l][m][f]=T}}}order(i,s,h){return this.C[i]!==void 0&&this.C[i][s]!==void 0&&this.C[i][s][h]!==void 0?this.C[i][s][h]:0}}class L{constructor(i){if(this.C=[],i){let s=i.getField("conn_type_id"),h=i.getField("ptnr1_label_asym_id"),g=i.getField("ptnr1_label_seq_id"),y=i.getField("ptnr1_label_comp_id"),E=i.getField("ptnr1_label_atom_id"),l=i.getField("ptnr2_label_asym_id"),f=i.getField("ptnr2_label_seq_id"),m=i.getField("ptnr2_label_comp_id"),C=i.getField("ptnr2_label_atom_id"),T=i.getField("pdbx_value_order");for(let P=0;P<s.length;P++)if(s[P]=="disulf"||s[P]=="covale"){let F=T?T[P]==""?1:parseInt(T[P]):1;this.C.push([[h[P],g[P],y[P],E[P]],[l[P],f[P],m[P],C[P]],F])}}}}class w{constructor(){this.R={}}add(i){this.R[i.lchain]==null&&(this.R[i.lchain]={}),this.R[i.lchain][i.lresi]==null&&(this.R[i.lchain][i.lresi]={}),this.R[i.lchain][i.lresi][i.lresn]==null&&(this.R[i.lchain][i.lresi][i.lresn]=[]),this.R[i.lchain][i.lresi][i.lresn].push(i),this.R[i.lchain][i.lresi][i.lresn][i.atom]=i}geta([i,s,h,g]){if(this.R[i]!==void 0&&this.R[i][s]!==void 0&&this.R[i][s][h]!==void 0)return this.R[i][s][h][g]}setBonds(i,s){for(let h in this.R)for(let g in this.R[h])for(let y in this.R[h][g]){let E=this.R[h][g][y];for(let l=0;l<E.length;l++)for(let f=l+1;f<E.length;f++){let m=E[l],C=E[f],T=i.order(y,m.atom,C.atom);m.altLoc!=C.altLoc&&m.altLoc!=""&&C.altLoc!=""&&(T=0),T>0&&(m.bonds.push(C.index),C.bonds.push(m.index),m.bondOrder.push(T),C.bondOrder.push(T))}}for(let h of s.C){let g=h[0],y=h[1],E=h[2],l=this.geta(g),f=this.geta(y);l!=null&&f!=null&&(l.bonds.push(f.index),f.bonds.push(l.index),l.bondOrder.push(E),f.bondOrder.push(E))}}}function b(u,i){var s=!i.keepH,h=i.altLoc?i.altLoc:"A",g=!i.noComputeSecondaryStructure;const y=!i.doAssembly,E=i.assignBonds===void 0?!0:i.assignBonds;if(typeof u=="string")try{u=(0,d.base64ToArray)(u)}catch{u=new TextEncoder().encode(u)}else u=new Uint8Array(u);var l=x.decodeMsgpack(u);l==31&&(u=(0,d.inflateString)(u,!1),l=x.decodeMsgpack(u));var f=[],m=f.modelData=[],C=l.dataBlocks.length;if(C==0)return f;i.multimodel||(C=1);for(let T=0;T<C;T++){let P=f.length;const F=[];m.push({symmetries:[]}),f.push([]);const N=l.dataBlocks[T],B=Object.create(null);for(const Ke of N.categories)B[Ke.name.substr(1)]=(0,j.Category)(Ke);let U={},K=B.struct_conf;if(K){let Ke=K.getField("conf_type_id"),We=K.getField("beg_label_asym_id"),nt=K.getField("beg_label_seq_id"),at=K.getField("end_label_seq_id");for(let q=0;q<Ke.length;q++)if(Ke[q].startsWith("H")){let re=We[q],se=nt[q],Se=at[q];re in U||(U[re]={}),U[re][se]="h1";for(let we=se+1;we<Se;we++)U[re][we]="h";U[re][Se]="h2"}}let H=B.struct_sheet_range;if(H){let Ke=H.getField("id"),We=H.getField("beg_label_asym_id"),nt=H.getField("beg_label_seq_id"),at=H.getField("end_label_seq_id");for(let q=0;q<Ke.length;q++){let re=We[q],se=nt[q],Se=at[q];re in U||(U[re]={}),U[re][se]="s1";for(let we=se+1;we<Se;we++)U[re][we]="s";U[re][Se]="s2"}}let G=B.pdbx_struct_oper_list,$=G.getField("id");if($&&!y){let Ke=G.getField("matrix[1][1]"),We=G.getField("matrix[1][2]"),nt=G.getField("matrix[1][3]"),at=G.getField("matrix[2][1]"),q=G.getField("matrix[2][2]"),re=G.getField("matrix[2][3]"),se=G.getField("matrix[3][1]"),Se=G.getField("matrix[3][2]"),we=G.getField("matrix[3][3]"),ze=G.getField("vector[1]"),Be=G.getField("vector[2]"),Z=G.getField("vector[3]");for(let ge=0;ge<$.length;ge++){const Ce=new v.Matrix4(Ke[ge],We[ge],nt[ge],ze[ge],at[ge],q[ge],re[ge],Be[ge],se[ge],Se[ge],we[ge],Z[ge]);m[m.length-1].symmetries.push(Ce)}}let V=new A(B.chem_comp_bond),k=new w,Y=new L(B.struct_conn),ie=B.atom_site,ne=ie.rowCount,he=ie.getField("group_PDB"),le=ie.getField("Cartn_x"),xe=ie.getField("Cartn_y"),fe=ie.getField("Cartn_z"),pe=ie.getField("auth_asym_id"),Te=ie.getField("label_asym_id"),ke=ie.getField("auth_seq_id"),$e=ie.getField("label_seq_id"),Le=ie.getField("auth_comp_id"),ue=ie.getField("label_comp_id"),Me=ie.getField("auth_atom_id"),Ge=ie.getField("label_atom_id"),Je=ie.getField("type_symbol"),qe=ie.getField("B_iso_or_equiv"),tt=ie.getField("id"),Ze=ie.getField("label_alt_id"),Ve=ie.getField("pdbx_PDB_model_num"),Ye=Ve?Ve[0]:0;for(let Ke=0;Ke<ne;Ke++){if(he!==void 0&&he[Ke]==="TER")continue;if(Ve&&Ve[Ke]!=Ye)if(Ye=Ve[Ke],i.multimodel)i.onemol||(f.push([]),m.push(m[m.length-1]),Ye=Ve[Ke],k.setBonds(V,Y),k=new w);else break;const We={};We.x=le[Ke],We.y=xe[Ke],We.z=fe[Ke],We.chain=pe?pe[Ke]:Te?Te[Ke]:void 0,We.lchain=Te?Te[Ke]:void 0,We.resi=ke?ke[Ke]:$e?$e[Ke]:void 0,We.lresi=$e?$e[Ke]:void 0,We.resn=Le?Le[Ke].trim():ue?ue[Ke].trim():void 0,We.lresn=ue?ue[Ke].trim():void 0,We.atom=Me?Me[Ke].replace(/"/gm,""):Ge?Ge[Ke].replace(/"/gm,""):void 0,We.icode=Ze?Ze[Ke]:void 0,We.altLoc=We.icode,We.hetflag=!he||he[Ke]==="HETA"||he[Ke]==="HETATM";let nt="X";Je&&(nt=Je[Ke].replace(/\(?\+?\d+.*/,"")),We.elem=nt[0].toUpperCase()+nt.substring(1,2).toLowerCase(),qe&&(We.b=qe[Ke]),!(s&&We.elem=="H")&&(We.altLoc!=""&&We.altLoc!=h&&h!="*"||(We.bonds=[],We.ss="c",We.serial=tt[Ke],We.model=Ye,We.bondOrder=[],We.properties={},We.index=f[f.length-1].length,F[We.serial]=[f.length,We.index],f[f.length-1].push(We),k.add(We)))}if(k.setBonds(V,Y),!(0,D.isEmpty)(U))for(let Ke=P;Ke<f.length;Ke++){let We=f[Ke];for(let nt=0;nt<We.length;nt++){const at=We[nt];if(at!==void 0&&at.lchain in U&&at.lresi in U[at.lchain]){const q=U[at.lchain][at.lresi];at.ss=q[0],q.length>1&&(q[1]=="1"?at.ssbegin=!0:q[1]=="2"&&(at.ssend=!0))}}}i.multimodel&&T<C-1&&(i.onemol||(f.push([]),m.push({symmetries:[]})))}for(let T=0;T<f.length;T++)E&&!(i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms)&&(0,p.assignPDBBonds)(f[T],i),g&&(0,R.computeSecondaryStructure)(f[T],i.hbondCutoff),(0,S.processSymmetries)(m[T].symmetries,f[T],i,m[T].cryst),i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms&&E&&(0,p.assignPDBBonds)(f[T],i);return f}},"./src/parsers/CDJSON.ts"(o,a,n){n.r(a),n.d(a,{CDJSON:()=>d});function d(R,S){var j=[[]];typeof R=="string"&&(R=JSON.parse(R));for(var p=R.m,v=p[0].a,D=p[0].b,x=p[0].s,A=S!==void 0&&S.parseStyle!==void 0?S.parseStyle:x!==void 0,L=j[j.length-1].length,w=0;w<v.length;w++){var b=v[w],u={};u.id=b.i,u.x=b.x,u.y=b.y,u.z=b.z||0,u.bonds=[],u.bondOrder=[];var i=b.l||"C";u.elem=i[0].toUpperCase()+i.substring(1).toLowerCase(),u.serial=j[j.length-1].length,A&&(u.style=x[b.s||0]),j[j.length-1].push(u)}for(let s=0;s<D.length;s++){let h=D[s],g=h.b+L,y=h.e+L,E=h.o||1,l=j[j.length-1][g],f=j[j.length-1][y];l.bonds.push(y),l.bondOrder.push(E),f.bonds.push(g),f.bondOrder.push(E)}return j}},"./src/parsers/CIF.ts"(o,a,n){n.r(a),n.d(a,{CIF:()=>v});var d=n("./src/parsers/utils/computeSecondaryStructure.ts"),R=n("./src/parsers/utils/processSymmetries.ts"),S=n("./src/WebGL/index.ts"),j=n("./src/parsers/utils/assignPDBBonds.ts");const p=function(D,x,A,L){return new S.Vector3(x,A,L).applyMatrix3(D)};function v(D,x={}){const A=[],L=!x.doAssembly,w=A.modelData=[],b=x.assignBonds===void 0?!0:x.assignBonds;function u(E,l){const f=[];let m=0,C=0;for(;C<E.length;){for(;E.substring(C,C+l.length)!==l&&C<E.length;)if(E[C]==="'"){for(C++;C<E.length&&E[C]!=="'";)C++;for(;E.substring(C,C+l.length)!==l&&C<E.length;)C++}else if(E[C]==='"'){for(C++;C<E.length&&E[C]!=='"';)C++;C++}else C++;f.push(E.substring(m,C)),m=C=C+l.length}return f}const i=D.split(/\r?\n|\r/),s=[];let h=!1;for(let E=0;E<i.length;E++){var g=i[E].split("#")[0];if(h?g[0]===";"&&(h=!1):g[0]===";"&&(h=!0),h||g!==""){if(!h&&(g=g.trim(),g[0]==="_")){const l=g.split(/\s/)[0].indexOf(".");if(l>-1){let f=g.split("");f[l]="_",g=f.join(""),g=g.substring(0,l)+"_"+g.substring(l+1)}}s.push(g)}}let y=0;for(;y<s.length;){for(;!s[y].startsWith("data_")||s[y]==="data_global";)y++;y++;const E={};for(;y<s.length&&!s[y].startsWith("data_");)if(s[y][0]===void 0)y++;else if(s[y][0]==="_"){const C=s[y].split(/\s/)[0].toLowerCase(),T=E[C]=E[C]||[],P=s[y].substring(s[y].indexOf(C)+C.length);if(P==="")if(y++,s[y][0]===";"){let F=s[y].substring(1);for(y++;s[y]!==";";)F=F+`
`+s[y],y++;T.push(F)}else T.push(s[y]);else T.push(P.trim());y++}else if(s[y].substring(0,5)==="loop_"){y++;const C=[];for(;s[y]===""||s[y][0]==="_";){if(s[y]!==""){let P=s[y].split(/\s/)[0].toLowerCase(),F=E[P]=E[P]||[];C.push(F)}y++}let T=0;for(;y<s.length&&s[y][0]!=="_"&&!s[y].startsWith("loop_")&&!s[y].startsWith("data_");){let P=u(s[y]," ");for(let F=0;F<P.length;F++)P[F]!==""&&(C[T].push(P[F]),T=(T+1)%C.length);y++}}else y++;w.push({symmetries:[]}),A.push([]);const l=E._atom_site_id!==void 0?E._atom_site_id.length:E._atom_site_label.length;let f;if(E._cell_length_a!==void 0){const C=parseFloat(E._cell_length_a),T=parseFloat(E._cell_length_b),P=parseFloat(E._cell_length_c),F=parseFloat(E._cell_angle_alpha)||90,N=parseFloat(E._cell_angle_beta)||90,B=parseFloat(E._cell_angle_gamma)||90;f=(0,S.conversionMatrix3)(C,T,P,F,N,B),w[w.length-1].cryst={a:C,b:T,c:P,alpha:F,beta:N,gamma:B}}for(let C=0;C<l;C++){if(E._atom_site_group_pdb!==void 0&&E._atom_site_group_pdb[C]==="TER")continue;const T={};if(E._atom_site_cartn_x!==void 0)T.x=parseFloat(E._atom_site_cartn_x[C]),T.y=parseFloat(E._atom_site_cartn_y[C]),T.z=parseFloat(E._atom_site_cartn_z[C]);else{const F=p(f,parseFloat(E._atom_site_fract_x[C]),parseFloat(E._atom_site_fract_y[C]),parseFloat(E._atom_site_fract_z[C]));T.x=F.x,T.y=F.y,T.z=F.z}T.chain=E._atom_site_auth_asym_id?E._atom_site_auth_asym_id[C]:E._atom_site_label_asym_id?E._atom_site_label_asym_id[C]:void 0,T.lchain=E._atom_site_label_asym_id?E._atom_site_label_asym_id[C]:void 0,T.resi=E._atom_site_auth_seq_id?parseInt(E._atom_site_auth_seq_id[C]):E._atom_site_label_seq_id?E._atom_site_label_seq_id[C]:void 0,T.resn=E._atom_site_auth_comp_id?E._atom_site_auth_comp_id[C].trim():E._atom_site_label_comp_id?E._atom_site_label_comp_id[C].trim():void 0,T.atom=E._atom_site_auth_atom_id?E._atom_site_auth_atom_id[C].replace(/"/gm,""):E._atom_site_label_atom_id?E._atom_site_label_atom_id[C].replace(/"/gm,""):void 0,T.hetflag=!E._atom_site_group_pdb||E._atom_site_group_pdb[C]==="HETA"||E._atom_site_group_pdb[C]==="HETATM",E._atom_site_b_iso_or_equiv&&(T.b=parseFloat(E._atom_site_b_iso_or_equiv[C]));let P="X";E._atom_site_type_symbol?P=E._atom_site_type_symbol[C].replace(/\(?\+?\d+.*/,""):E._atom_site_label&&(P=E._atom_site_label[C].split("_")[0].replace(/\(?\d+.*/,"")),T.elem=P[0].toUpperCase()+P.substring(1,2).toLowerCase(),T.bonds=[],T.ss="c",T.serial=C,T.bondOrder=[],T.properties={},A[A.length-1].push(T)}if(E._pdbx_struct_oper_list_id!==void 0&&!L)for(let C=0;C<E._pdbx_struct_oper_list_id.length;C++){const T=parseFloat(E["_pdbx_struct_oper_list_matrix[1][1]"][C]),P=parseFloat(E["_pdbx_struct_oper_list_matrix[1][2]"][C]),F=parseFloat(E["_pdbx_struct_oper_list_matrix[1][3]"][C]),N=parseFloat(E["_pdbx_struct_oper_list_vector[1]"][C]),B=parseFloat(E["_pdbx_struct_oper_list_matrix[2][1]"][C]),U=parseFloat(E["_pdbx_struct_oper_list_matrix[2][2]"][C]),K=parseFloat(E["_pdbx_struct_oper_list_matrix[2][3]"][C]),H=parseFloat(E["_pdbx_struct_oper_list_vector[2]"][C]),G=parseFloat(E["_pdbx_struct_oper_list_matrix[3][1]"][C]),$=parseFloat(E["_pdbx_struct_oper_list_matrix[3][2]"][C]),V=parseFloat(E["_pdbx_struct_oper_list_matrix[3][3]"][C]),k=parseFloat(E["_pdbx_struct_oper_list_vector[3]"][C]),Y=new S.Matrix4(T,P,F,N,B,U,K,H,G,$,V,k);w[w.length-1].symmetries.push(Y)}const m=function(C){const T=C.match("-");C=C.replace(/[-xyz]/g,"");const P=C.split("/");let F,N;return P[1]===void 0?N=1:N=parseInt(P[1]),P[0]===""?F=1:F=parseInt(P[0]),F/N*(T?-1:1)};if(E._symmetry_equiv_pos_as_xyz!==void 0&&!L)for(let C=0;C<E._symmetry_equiv_pos_as_xyz.length;C++){const P=E._symmetry_equiv_pos_as_xyz[C].replace(/["' ]/g,"").split(",").map(function(U){return U.replace(/-/g,"+-")});let F=new S.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let U=0;U<3;U++){const K=P[U].split("+");for(let H=0;H<K.length;H++){const G=K[H];if(G==="")continue;const $=m(G);G.match("x")?F.elements[U+0]=$:G.match("y")?F.elements[U+4]=$:G.match("z")?F.elements[U+8]=$:F.elements[U+12]=$}}const N=f.getMatrix4(),B=new S.Matrix4().getInverse(N,!0);F=new S.Matrix4().multiplyMatrices(F,B),F=new S.Matrix4().multiplyMatrices(N,F),w[w.length-1].symmetries.push(F)}}for(let E=0;E<A.length;E++)b&&!(x.duplicateAssemblyAtoms&&!x.dontConnectDuplicatedAtoms)&&(0,j.assignPDBBonds)(A[E],x),(0,d.computeSecondaryStructure)(A[E],x.hbondCutoff),(0,R.processSymmetries)(w[E].symmetries,A[E],x,w[E].cryst),x.duplicateAssemblyAtoms&&!x.dontConnectDuplicatedAtoms&&b&&(0,j.assignPDBBonds)(A[E],x);return A}},"./src/parsers/CUBE.ts"(o,a,n){n.r(a),n.d(a,{CUBE:()=>j});var d=n("./src/WebGL/index.ts"),R=n("./src/parsers/utils/assignBonds.ts"),S=n("./src/parsers/utils/anumToSymbol.ts");function j(p,v){v=v||{};const D=[[]];let x=p.split(/\r?\n/);const A=v.assignBonds===void 0?!0:v.assignBonds;if(x.length<6)return D;let L=x[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const w=Math.abs(parseFloat(L[0]));let b={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const u=b.origin=new d.Vector3(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));L=x[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),L=x[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const i=L[0]>0?.529177:1;u.multiplyScalar(i);const s=Math.abs(L[0]),h=new d.Vector3(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])).multiplyScalar(i);L=x[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const g=Math.abs(L[0]),y=new d.Vector3(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])).multiplyScalar(i);L=x[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const E=Math.abs(L[0]),l=new d.Vector3(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])).multiplyScalar(i);if(b.size={x:s,y:g,z:E},b.unit=new d.Vector3(h.x,y.y,l.z),h.y!=0||h.z!=0||y.x!=0||y.z!=0||l.x!=0||l.y!=0){b.matrix4=new d.Matrix4(h.x,y.x,l.x,0,h.y,y.y,l.y,0,h.z,y.z,l.z,0,0,0,0,1);let N=new d.Matrix4().makeTranslation(u.x,u.y,u.z);b.matrix4=b.matrix4.multiplyMatrices(N,b.matrix4),b.matrix=b.matrix4.matrix3FromTopLeft(),b.origin=new d.Vector3(0,0,0),b.unit=new d.Vector3(1,1,1)}D.modelData=[{cryst:b}],x=x.splice(6,w);for(var f=D[D.length-1].length,m=f+x.length,C=f;C<m;++C){var T={};T.serial=C;var P=x[C-f],F=P.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");T.elem=S.anumToSymbol[F[0]],T.x=parseFloat(F[2])*i,T.y=parseFloat(F[3])*i,T.z=parseFloat(F[4])*i,T.hetflag=!0,T.bonds=[],T.bondOrder=[],T.properties={},D[D.length-1].push(T)}if(A)for(let N=0;N<D.length;N++)(0,R.assignBonds)(D[N],v);return D}},"./src/parsers/GRO.ts"(o,a,n){n.r(a),n.d(a,{GRO:()=>S});var d=n("./src/parsers/utils/assignPDBBonds.ts"),R=n("./src/parsers/utils/atomNameToElem.ts");function S(j,p){const v=[],D=j.split(/\r?\n|\r/);for(;D.length>0;){const x=parseInt(D[1]);if(D.length<3||isNaN(x)||x<=0||D.length<x+3)break;const L=[];v.push(L);let w=2;const b=L.length,u=b+x;for(let i=b;i<u;i++){const s=D[w++],h={};h.serial=i,h.atom=s.slice(10,15).trim(),h.elem=(0,R.atomNameToElem)(h.atom,!0),h.x=10*parseFloat(s.slice(20,28)),h.y=10*parseFloat(s.slice(28,36)),h.z=10*parseFloat(s.slice(36,44)),h.resi=parseInt(s.slice(0,5)),h.resn=s.slice(5,10).trim(),h.bonds=[],h.bondOrder=[],h.properties={},s.length>44&&(h.dx=10*parseFloat(s.slice(44,52)),h.dy=10*parseFloat(s.slice(52,60)),h.dz=10*parseFloat(s.slice(60,68))),L[i]=h}if(D.length<=w+3){const s=D[w++].trim().split(/\s+/);if(s.length===3){for(let h=0;h<3;h++)s[h]=(parseFloat(s[h])*10).toString();v.box=s}}D.splice(0,++w)}for(let x=0;x<v.length;x++)(0,d.assignPDBBonds)(v[x],p);return v}},"./src/parsers/LAMMPSTRJ.ts"(o,a,n){n.r(a),n.d(a,{LAMMPSTRJ:()=>S});var d=n("./src/parsers/utils/assignBonds.ts");const R={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function S(j,p){const v=[],D=j.split(/\r?\n|\r/);let x=0,A=0,L=0;for(;L<D.length-9;){for(var w=L;w<D.length;w++)if(D[w].match(/ITEM: NUMBER OF ATOMS/)&&(A=parseInt(D[w+1])),D[w].match(/ITEM: ATOMS/)){x=w+1;break}const b=D[x-1].replace("ITEM: ATOMS ","").split(" ");v.push([]);for(let u=x;u<x+A;u++){const i={},s={},h=D[u].split(" ");for(let g=0;g<h.length;g++){const y=R[b[g]];y!==void 0&&(y==="serial"?i[y]=parseInt(h[g]):y==="x"||y==="y"||y==="z"?i[y]=parseFloat(h[g]):y==="charge"||y==="radius"?s[y]=parseFloat(h[g]):i[y]=h[g]),i.properties=s,i.bonds=[],i.bondOrder=[]}v[v.length-1][u-x]=i}L=x+A-1}if(p.assignBonds)for(let b=0;b<v.length;b++)(0,d.assignBonds)(v[b],p);return v}},"./src/parsers/MMTF.ts"(o,a,n){n.r(a),n.d(a,{MMTFparser:()=>A});var d=n("./src/utilities.ts"),R=n("./src/WebGL/index.ts"),S=n("./src/parsers/utils/computeSecondaryStructure.ts"),j=n("./src/parsers/utils/processSymmetries.ts"),p=n("./src/vendor/mmtf.js"),v=function(L){return String.fromCharCode.apply(null,L).replace(/\0/g,"")},D=function(L){return L==0||L==2||L==4?"h":L==3?"s":"c"};let x=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function A(L,w){var b=!w.keepH,u=w.altLoc?w.altLoc:"A",i=!!w.noSecondaryStructure,s=!w.noComputeSecondaryStructure,h=!w.doAssembly,g=w.assemblyIndex?w.assemblyIndex:0;typeof L=="string"?L=(0,d.base64ToArray)(L):L=new Uint8Array(L);var y=p.decode(L),E=[[]],l=E.modelData=[],f=0,m=0,C=0,T=y.secStructList,P=y.bFactorList,F=y.altLocList,N=y.occupancyList,B=y.bondAtomList,U=y.bondOrderList,K=y.numModels;if(K==0)return E;w.multimodel||(K=1);var H,G,$,V,k,Y,ie=[];if(!h&&y.bioAssemblyList&&y.bioAssemblyList.length>0){var ne=y.bioAssemblyList[g].transformList;for(H=0,Y=ne.length;H<Y;H++){var he=new R.Matrix4(ne[H].matrix);he.transpose(),ie.push(he)}}var le=null;if(y.unitCell){var xe=y.unitCell;le={a:xe[0],b:xe[1],c:xe[2],alpha:xe[3],beta:xe[4],gamma:xe[5]}}let fe=[];y.entityList.forEach(_e=>{_e.chainIndexList.forEach(ee=>{fe[ee]=_e.type=="polymer"})});var pe=0;for(k=0;k<K;k++){var Te=y.chainsPerModel[k],ke=E[E.length-1],$e=[];for(l.push({symmetries:ie,cryst:le}),H=0;H<Te;++H){var Le=y.groupsPerChain[f],ue=v(y.chainIdList.subarray(f*4,f*4+4));y.chainNameList&&(ue=v(y.chainNameList.subarray(f*4,f*4+4)));var Me=m,Ge="";for(G=0;G<Le;++G){var Je=y.groupList[y.groupTypeList[m]],qe=Je.atomNameList.length,tt=0,Ze=!1,Ve=!1;if(T){tt=T[m];var Ye=D(tt);(m==0||Ye!=Ge)&&(Ze=!0),Ge=Ye;var Ke=m+1;(Ke>=T.length||D(T[Ke]!=Ye))&&(Ve=!0)}var We=y.groupIdList[m],nt=Je.groupName;let _e=Je.chemCompType;var at=C;let ee=x.has(_e)||!fe[f];for($=0;$<qe;++$){var q=Je.elementList[$];if(b&&q=="H"){C+=1;continue}var re="";P&&(re=P[C]);var se="";F&&F[C]&&(se=String.fromCharCode(F[C]));var Se="";if(N&&(Se=N[C]),se!=""&&se!=u&&u!="*"){C+=1;continue}var we=y.atomIdList[C],ze=Je.atomNameList[$],Be=0;Je.atomChargeList&&(Be=Je.atomChargeList[$]);var Z=y.xCoordList[C],ge=y.yCoordList[C],Ce=y.zCoordList[C];$e[C]=ke.length,ke.push({resn:nt,x:Z,y:ge,z:Ce,elem:q,hetflag:ee,chain:ue,resi:We,icode:se,rescode:We+(se!=" "?"^"+se:""),serial:we,altLoc:se,index:C,atom:ze,bonds:[],ss:D(tt),ssbegin:Ze,ssend:Ve,bondOrder:[],properties:{charge:Be,occupancy:Se},b:re}),C+=1}var Ue=Je.bondAtomList;for($=0,V=Je.bondOrderList.length;$<V;++$){var ce=at+Ue[$*2],Pe=at+Ue[$*2+1],Q=Je.bondOrderList[$],Ne=$e[ce],He=$e[Pe],z=ke[Ne],be=ke[He];z&&be&&(z.bonds.push(He),z.bondOrder.push(Q),be.bonds.push(Ne),be.bondOrder.push(Q))}m+=1}for(m=Me,G=0;G<Le;++G)m+=1;f+=1}if(B)for(let _e=pe,ee=B.length;_e<ee;_e+=2){let me=B[_e],Ae=B[_e+1],ut=U?U[_e/2]:1;if(me>=C){pe=_e;break}let ot=$e[me],rt=$e[Ae],yt=ke[ot],Xt=ke[rt];yt&&Xt&&(yt.bonds.push(rt),yt.bondOrder.push(ut),Xt.bonds.push(ot),Xt.bondOrder.push(ut))}w.multimodel&&(w.onemol||E.push([]))}if(!h)for(let _e=0;_e<E.length;_e++)(0,j.processSymmetries)(l[_e].symmetries,E[_e],w,l[_e].cryst);return s&&!i&&(0,S.computeSecondaryStructure)(E,w.hbondCutoff),E}},"./src/parsers/MOL2.ts"(o,a,n){n.r(a),n.d(a,{MOL2:()=>R});let d={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function R(S,j){var p=[[]],v=!1;typeof j.keepH<"u"&&(v=!j.keepH);var D=S.search(/@<TRIPOS>MOLECULE/),x=S.search(/@<TRIPOS>ATOM/);if(D==-1||x==-1)return p;for(var A=S.substring(D).split(/\r?\n|\r/);A.length>0;){var L=[],w=A[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),b=parseInt(w[0]),u=0;w.length>1&&(u=parseInt(w[1]));var i=4,s;for(s=3;s<A.length;s++)if(A[s]=="@<TRIPOS>ATOM"){i=s+1;break}var h=p[p.length-1].length,g=h+b,y;for(s=h;s<g;s++){y=A[i++],w=y.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var E={},l=w[5];if(d[l]!==void 0?l=d[l]:(l=l.split(".")[0],l=l[0].toUpperCase()+l.substring(1).toLowerCase()),E.atom=w[1],E.elem=l,!(E.elem=="H"&&v)){var f=p[p.length-1].length,m=parseInt(w[0]);E.serial=m,E.x=parseFloat(w[2]),E.y=parseFloat(w[3]),E.z=parseFloat(w[4]),E.atom=w[5];var C=parseFloat(w[8]);E.index=f,E.bonds=[],E.bondOrder=[],E.properties={charge:C,partialCharge:C},L[m]=f,p[p.length-1].push(E)}}for(var T=!1;i<A.length;)if(A[i++]=="@<TRIPOS>BOND"){T=!0;break}if(T&&u)for(s=0;s<u;s++){y=A[i++],w=y.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var P=parseInt(w[1]),F=p[p.length-1][L[P]],N=parseInt(w[2]),B=p[p.length-1][L[N]],U=parseInt(w[3]);isNaN(U)&&(U=1),F!==void 0&&B!==void 0&&(F.bonds.push(L[N]),F.bondOrder.push(U),B.bonds.push(L[P]),B.bondOrder.push(U))}if(j.multimodel){j.onemol||p.push([]),A.splice(0,i),S=A.join(`
`);continue}else break}return p}},"./src/parsers/PDB.ts"(o,a,n){n.r(a),n.d(a,{PDB:()=>R});var d=n("./src/parsers/utils/getSinglePDB.ts");function R(S,j){j=j||{};var p=[],v={};p.modelData=[];for(var D=S.split(/\r?\n|\r/);D.length>0;){var x=(0,d.getSinglePDB)(D,j,v),A=x[0],L=x[1];if(D=x[2],A.length!=0){if(j.multimodel&&j.onemol&&p.length>0)for(var w=p[0].length,b=0;b<A.length;b++){var u=A[b];u.index=b;for(var i=0;i<u.bonds.length;i++)u.bonds[i]+=w;p[0].push(u)}else p.modelData.push(L),p.push(A);if(!j.multimodel)break}}return p}},"./src/parsers/PQR.ts"(o,a,n){n.r(a),n.d(a,{PQR:()=>S});var d=n("./src/parsers/utils/assignPDBBonds.ts"),R=n("./src/parsers/utils/computeSecondaryStructure.ts");function S(j,p){var v=[[]],D=!p.noSecondaryStructure;v.modelData=[{symmetries:[]}];var x=[],A=j.split(/\r?\n|\r/),L;for(let T=0;T<A.length;T++){L=A[T].replace(/^\s*/,"");var w=L.substring(0,6);if(w.indexOf("END")==0)if(p.multimodel){p.onemol||v.push([]);continue}else break;else if(w=="ATOM  "||w=="HETATM"){var b;let P=parseInt(L.substring(6,11)),F=L.substring(12,16).replace(/ /g,""),N=L.substring(17,20).trim(),B=L.substring(21,22),U=parseInt(L.substring(22,26));var u=L.substring(30).trim().split(/\s+/),i=parseFloat(u[0]),s=parseFloat(u[1]),h=parseFloat(u[2]),g=parseFloat(u[3]),y=parseFloat(u[4]),E=F[0];F.length>1&&F[1].toUpperCase()!=F[1]&&(E=F.substring(0,2)),L[0]=="H"?b=!0:b=!1,x[P]=v[v.length-1].length,v[v.length-1].push({resn:N,x:i,y:s,z:h,elem:E,hetflag:b,chain:B,resi:U,serial:P,atom:F,bonds:[],ss:"c",bondOrder:[],properties:{charge:g,partialCharge:g,radius:y},pdbline:L})}else if(w=="CONECT"){var l=parseInt(L.substring(6,11)),f=v[v.length-1][x[l]];for(let P=0;P<4;P++){var m=parseInt(L.substring([11,16,21,26][P],[11,16,21,26][P]+5)),C=v[v.length-1][x[m]];f!==void 0&&C!==void 0&&(f.bonds.push(x[m]),f.bondOrder.push(1))}}}for(let T=0;T<v.length;T++)(0,d.assignPDBBonds)(v[T],p),D&&(0,R.computeSecondaryStructure)(v[T],p.hbondCutoff);return v}},"./src/parsers/PRMTOP.ts"(o,a,n){n.r(a),n.d(a,{PRMTOP:()=>d});function d(R){var S=[],j,p=0,v=R.split(/\r?\n|\r/);if(v.length>0&&v[0].includes("VERSION")){var D=v.filter(function(h){return h.includes("POINTERS")||h.includes("ATOM_NAME")||h.includes("CHARGE")||h.includes("RADII")||h.includes("BONDS_INC_HYDROGEN")||h.includes("BONDS_WITHOUT_HYDROGEN")||h.includes("RESIDUE_LABEL")||h.includes("RESIDUE_POINTER")}),x=u("POINTERS");if(x==-1)return[];var A=i(x),L=parseInt(v[x+1].slice(0,A[1]));let s=parseInt(v[x+2].slice(A[1],A[0]+A[1]));if(isNaN(L)||L<=0)return[];if(x=u("ATOM_NAME"),x==-1)return[];A=i(x);var w=A[0];for(let h=0;h<L/A[0];h++){h==parseInt(L/A[0])&&(w=L%A[0]);for(let g=0;g<w;g++){let y={},E={charge:"",radii:""};y.serial=p,y.x=0,y.y=0,y.z=0,y.atom=v[x+1].slice(A[1]*g,A[1]*(g+1)).trim(),y.elem=v[x+1].slice(A[1]*g,A[1]*g+1).trim(),y.properties=E,y.bonds=[],y.bondOrder=[],y.index=S.length,S.push(y),p++}x++}if(x=u("CHARGE"),x!=-1){A=i(x),p=0,w=A[0];for(let h=0;h<L/A[0];h++){h==parseInt(L/A[0])&&(w=L%A[0]);for(let g=0;g<w;g++)S[p].properties.charge=parseFloat(v[x+1].slice(A[1]*g,A[1]*(g+1))),p++;x++}}x=u("RESIDUE_POINTER");var b=[];if(x!=-1){A=i(x),w=A[0],x+=1;for(let h=0;h<s/A[0];h++){h==parseInt(s/A[0])&&(w=s%A[0]);for(let g=0;g<w;g++)b.push(parseInt(v[x].slice(A[1]*g,A[1]*(g+1))));x++}if(x=u("RESIDUE_LABEL"),x!=-1){let h=[];A=i(x),w=A[0],x+=1;for(let l=0;l<s/A[0];l++){l==parseInt(s/A[0])&&(w=s%A[0]);for(let f=0;f<w;f++)h.push(v[x].slice(A[1]*f,A[1]*(f+1)).trim());x++}let g=0,y=0,E="";b.push(S.length+1);for(let l=0;l<S.length;l++)l+1>=b[g]&&(E=h[g],g+=1,y+=1),S[l].resi=y,S[l].resn=E}}if(x=u("RADII"),x!=-1){A=i(x),p=0,w=A[0];for(let h=0;h<L/A[0];h++){h==parseInt(L/A[0])&&(w=L%A[0]);for(let g=0;g<w;g++)S[p].properties.radii=parseFloat(v[x+1].slice(A[1]*g,A[1]*(g+1))),p++;x++}}if(x=u("BONDS_WITHOUT_HYDROGEN"),x!=-1)for(A=i(x),p=0,w=A[0],x=x+1;!v[x].match(/^%FLAG/);){v[x+1].match(/^%FLAG/)&&(w=L%A[0]);for(let h=0;h<w;h++)p%3==0?j=parseInt(v[x].slice(A[1]*h,A[1]*(h+1))/3):p%3==1&&(S[j].bonds.push(parseInt(v[x].slice(A[1]*h,A[1]*(h+1))/3)),S[j].bondOrder.push(1)),p++;x++}if(x=u("BONDS_INC_HYDROGEN"),x!=-1)for(A=i(x),p=0,w=A[0],x=x+1;!v[x].match(/^%FLAG/);){v[x+1].match(/^%FLAG/)&&(w=L%A[0]);for(let h=0;h<w;h++)p%3==0?j=parseInt(v[x].slice(A[1]*h,A[1]*(h+1))/3):p%3==1&&(S[j].bonds.push(parseInt(v[x].slice(A[1]*h,A[1]*(h+1))/3)),S[j].bonds.push(1)),p++;x++}}else return[];function u(s){var h=v.indexOf(D.filter(function(g){return g.includes(s)})[0]);if(Number.isInteger(h)&&h>0){for(;!v[h].includes("FORMAT");)h++;return h}else return-1}function i(s){var h=v[s].match(/\((\d*)\S*/),g=v[s].match(/[a-zA-Z](\d*)\)\s*/);return g==null&&(g=v[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(h[1]),parseInt(g[1])]}return[S]}},"./src/parsers/SDF.ts"(o,a,n){n.r(a),n.d(a,{SDF:()=>S});var d=function(j,p){var v=[[]],D=!1;for(typeof p.keepH<"u"&&(D=!p.keepH);j.length>0&&!(j.length<4);){var x=parseInt(j[3].substring(0,3));if(isNaN(x)||x<=0)break;var A=parseInt(j[3].substring(3,6)),L=4;if(j.length<4+x+A)break;var w=[],b=v[v.length-1].length,u=b+x,i,s;for(i=b;i<u;i++,L++){s=j[L];var h={},g=s.substring(31,34).replace(/ /g,"");h.atom=h.elem=g[0].toUpperCase()+g.substring(1).toLowerCase(),(h.elem!=="H"||!D)&&(h.serial=i,w[i]=v[v.length-1].length,h.x=parseFloat(s.substring(0,10)),h.y=parseFloat(s.substring(10,20)),h.z=parseFloat(s.substring(20,30)),h.hetflag=!0,h.bonds=[],h.bondOrder=[],h.properties={},h.index=v[v.length-1].length,v[v.length-1].push(h))}for(i=0;i<A;i++,L++){s=j[L];var y=w[parseInt(s.substring(0,3))-1+b],E=w[parseInt(s.substring(3,6))-1+b],l=parseFloat(s.substring(6));typeof y<"u"&&typeof E<"u"&&(v[v.length-1][y].bonds.push(E),v[v.length-1][y].bondOrder.push(l),v[v.length-1][E].bonds.push(y),v[v.length-1][E].bondOrder.push(l))}if(p.multimodel){for(p.onemol||v.push([]);j[L]!=="$$$$"&&L<j.length;)L++;j.splice(0,++L)}else break}return v},R=function(j,p){var v=[[]],D=!1;for(typeof p.keepH<"u"&&(D=!p.keepH);j.length>0&&!(j.length<8||!j[4].startsWith("M  V30 BEGIN CTAB")||!j[5].startsWith("M  V30 COUNTS")||j[5].length<14);){var x=j[5].substring(13).match(/\S+/g);if(x.length<2)break;var A=parseInt(x[0]);if(isNaN(A)||A<=0)break;var L=parseInt(x[1]),w=7;if(j.length<8+A+L)break;var b=[],u=v[v.length-1].length,i=u+A,s,h;for(s=u;s<i;s++,w++){h=j[w];var g=h.substring(6).match(/\S+/g);if(g.length>4){var y={},E=g[1].replace(/ /g,"");y.atom=y.elem=E[0].toUpperCase()+E.substring(1).toLowerCase(),(y.elem!=="H"||!D)&&(y.serial=s,b[s]=v[v.length-1].length,y.x=parseFloat(g[2]),y.y=parseFloat(g[3]),y.z=parseFloat(g[4]),y.hetflag=!0,y.bonds=[],y.bondOrder=[],y.properties={},y.index=v[v.length-1].length,v[v.length-1].push(y))}}if(j[w]==="M  V30 END ATOM")w++;else break;if(L!==0&&j[w]==="M  V30 BEGIN BOND")w++;else break;for(s=0;s<L;s++,w++){h=j[w];var l=h.substring(6).match(/\S+/g);if(l.length>3){var f=b[parseInt(l[2])-1+u],m=b[parseInt(l[3])-1+u],C=parseFloat(l[1]);typeof f<"u"&&typeof m<"u"&&(v[v.length-1][f].bonds.push(m),v[v.length-1][f].bondOrder.push(C),v[v.length-1][m].bonds.push(f),v[v.length-1][m].bondOrder.push(C))}}if(p.multimodel){for(p.onemol||v.push([]);j[w]!=="$$$$"&&w<j.length;)w++;j.splice(0,++w)}else break}return v};function S(j,p){var v="V2000",D=j.split(/\r?\n|\r/);return D.length>3&&D[3].length>38&&(v=D[3].substring(34,39)),v==="V2000"?d(D,p):v==="V3000"?R(D,p):[[""]]}},"./src/parsers/VASP.ts"(o,a,n){n.r(a),n.d(a,{VASP:()=>S});var d=n("./src/WebGL/index.ts"),R=n("./src/parsers/utils/assignBonds.ts");function S(j,p={}){var v=[[]],D={};const x=p.assignBonds===void 0?!0:p.assignBonds;var A=j.replace(/^\s+/,"").split(/\r?\n/);if(A.length<3)return v;if(A[1].match(/\d+/))D.length=parseFloat(A[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),v;if(D.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),v;D.xVec=new Float32Array(A[2].replace(/^\s+/,"").split(/\s+/)),D.yVec=new Float32Array(A[3].replace(/^\s+/,"").split(/\s+/)),D.zVec=new Float32Array(A[4].replace(/^\s+/,"").split(/\s+/));var L=new d.Matrix3(D.xVec[0],D.xVec[1],D.xVec[2],D.yVec[0],D.yVec[1],D.yVec[2],D.zVec[0],D.zVec[1],D.zVec[2]);L.multiplyScalar(D.length),v.modelData=[{symmetries:[],cryst:{matrix:L}}];var w=A[5].trim().split(/\s+/),b=new Int16Array(A[6].trim().split(/\s+/)),u=A[7].trim(),i=!1;if(u.match(/S/)&&(i=!0,u=A[8].trim()),u.toLowerCase()[0]=="c")u="cartesian";else if(u.toLowerCase()[0]=="d")u="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),v;if(w.length!=b.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(w),console.log(b),v;i?A.splice(0,9):A.splice(0,8);for(var s=0,h=0,g=w.length;h<g;h++){for(var y=w[h],E=0,l=b[h];E<l;E++){var f=new Float32Array(A[s+E].trim().split(/\s+/)),m={};m.elem=y,u=="cartesian"?(m.x=D.length*f[0],m.y=D.length*f[1],m.z=D.length*f[2]):(m.x=D.length*(f[0]*D.xVec[0]+f[1]*D.yVec[0]+f[2]*D.zVec[0]),m.y=D.length*(f[0]*D.xVec[1]+f[1]*D.yVec[1]+f[2]*D.zVec[1]),m.z=D.length*(f[0]*D.xVec[2]+f[1]*D.yVec[2]+f[2]*D.zVec[2])),m.bonds=[],m.bondOrder=[],v[0].push(m)}s+=b[h]}if(x)for(let C=0;C<v.length;C++)(0,R.assignBonds)(v[C],p);return v}},"./src/parsers/XYZ.ts"(o,a,n){n.r(a),n.d(a,{XYZ:()=>S});var d=n("./src/WebGL/index.ts"),R=n("./src/parsers/utils/assignBonds.ts");function S(j,p){p=p||{};for(var v=[[]],D=p.assignBonds===void 0?!0:p.assignBonds,x=j.trimStart().split(/\r?\n|\r/);x.length>0&&!(x.length<3);){var A=parseInt(x[0]);if(isNaN(A)||A<=0||x.length<A+2)break;var L=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,w=L.exec(x[1]);if(w!=null&&w.length>1){var b=new Float32Array(w[1].split(/\s+/)),u=new d.Matrix3(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);v.modelData=[{cryst:{matrix:u}}]}for(var i=2,s=v[v.length-1].length,h=s+A,g=s;g<h;g++){var y=x[i++],E=y.trim().split(/\s+/),l={};l.serial=g;var f=E[0];l.atom=l.elem=f[0].toUpperCase()+f.substring(1,2).toLowerCase(),l.x=parseFloat(E[1]),l.y=parseFloat(E[2]),l.z=parseFloat(E[3]),l.hetflag=!0,l.bonds=[],l.bondOrder=[],l.properties={},v[v.length-1][g]=l,E.length>=7&&(l.dx=parseFloat(E[4]),l.dy=parseFloat(E[5]),l.dz=parseFloat(E[6]))}if(p.multimodel)v.push([]),x.splice(0,i);else break}if(D)for(let C=0;C<v.length;C++)(0,R.assignBonds)(v[C],p);if(p.onemol){var m=v;v=[],v.push(m[0]);for(let C=1;C<m.length;C++){let T=v[0].length;for(let P=0;P<m[C].length;P++){let F=m[C][P];for(let N=0;N<F.bonds.length;N++)F.bonds[N]=F.bonds[N]+T;F.index=v[0].length,F.serial=v[0].length,v[0].push(F)}}}return v}},"./src/parsers/cifutils/category.ts"(o,a,n){n.r(a),n.d(a,{Category:()=>R});var d=n("./src/parsers/cifutils/decoder.ts");function R(S){const j=Object.create(null),p=Object.create(null);for(const v of S.columns)j[v.name]=v;return{rowCount:S.rowCount,name:S.name.substring(1),fieldNames:S.columns.map(v=>v.name),getField(v){const D=j[v];if(D)return p[v]||(p[v]=(0,d.decode)(D.data)),p[v]}}}},"./src/parsers/cifutils/decoder.ts"(o,a,n){n.r(a),n.d(a,{decode:()=>j});var d=n("./src/parsers/cifutils/encoding.ts");const R=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function S(T,P){const F=new ArrayBuffer(T.length),N=new Uint8Array(F);for(let B=0,U=T.length;B<U;B+=P)for(let K=0;K<P;K++)N[B+P-K-1]=T[B+K];return F}function j(T){let P=T.data;for(let F=T.encoding.length-1;F>=0;F--)P=p(P,T.encoding[F]);return P}function p(T,P){switch(P.kind){case"ByteArray":switch(P.type){case d.Encoding.IntDataType.Uint8:return T;case d.Encoding.IntDataType.Int8:return x(T);case d.Encoding.IntDataType.Int16:return L(T);case d.Encoding.IntDataType.Uint16:return w(T);case d.Encoding.IntDataType.Int32:return b(T);case d.Encoding.IntDataType.Uint32:return u(T);case d.Encoding.FloatDataType.Float32:return i(T);case d.Encoding.FloatDataType.Float64:return s(T);default:throw new Error("unreachable")}case"FixedPoint":return h(T,P);case"IntervalQuantization":return g(T,P);case"RunLength":return y(T,P);case"Delta":return E(T,P);case"IntegerPacking":return m(T,P);case"StringArray":return C(T,P)}}function v(T,P){switch(T){case d.Encoding.IntDataType.Int8:return new Int8Array(P);case d.Encoding.IntDataType.Int16:return new Int16Array(P);case d.Encoding.IntDataType.Int32:return new Int32Array(P);case d.Encoding.IntDataType.Uint8:return new Uint8Array(P);case d.Encoding.IntDataType.Uint16:return new Uint16Array(P);case d.Encoding.IntDataType.Uint32:return new Uint32Array(P);default:return new Int32Array(P)}}function D(T,P){switch(T){case d.Encoding.FloatDataType.Float32:return new Float32Array(P);case d.Encoding.FloatDataType.Float64:return new Float64Array(P);default:return new Float64Array(P)}}function x(T){return new Int8Array(T.buffer,T.byteOffset)}function A(T,P,F){return(T.byteOffset!=0||T.byteLength!=T.buffer.byteLength)&&(T=new Uint8Array(T)),R?new F(T.buffer):new F(S(T,P))}function L(T){return A(T,2,Int16Array)}function w(T){return A(T,2,Uint16Array)}function b(T){return A(T,4,Int32Array)}function u(T){return A(T,4,Uint32Array)}function i(T){return A(T,4,Float32Array)}function s(T){return A(T,8,Float64Array)}function h(T,P){const F=T.length,N=D(P.srcType,F),B=1/P.factor;for(let U=0;U<F;U++)N[U]=B*T[U];return N}function g(T,P){const F=T.length,N=D(P.srcType,F),B=(P.max-P.min)/(P.numSteps-1),U=P.min;for(let K=0;K<F;K++)N[K]=U+B*T[K];return N}function y(T,P){const F=v(P.srcType,P.srcSize);let N=0;for(let B=0,U=T.length;B<U;B+=2){const K=T[B],H=T[B+1];for(let G=0;G<H;++G)F[N++]=K}return F}function E(T,P){const F=T.length,N=v(P.srcType,F);if(!F)return T;N[0]=T[0]+(P.origin|0);for(let B=1;B<F;++B)N[B]=T[B]+N[B-1];return N}function l(T,P){const F=P.byteCount===1?127:32767,N=-F-1,B=T.length,U=new Int32Array(P.srcSize);let K=0,H=0;for(;K<B;){let G=0,$=T[K];for(;$===F||$===N;)G+=$,K++,$=T[K];G+=$,U[H]=G,K++,H++}return U}function f(T,P){const F=P.byteCount===1?255:65535,N=T.length,B=new Int32Array(P.srcSize);let U=0,K=0;for(;U<N;){let H=0,G=T[U];for(;G===F;)H+=G,U++,G=T[U];H+=G,B[K]=H,U++,K++}return B}function m(T,P){return T.length===P.srcSize?T:P.isUnsigned?f(T,P):l(T,P)}function C(T,P){const F=j({encoding:P.offsetEncoding,data:P.offsets}),N=j({encoding:P.dataEncoding,data:T}),B=P.stringData,U=new Array(F.length);U[0]="";for(let G=1,$=F.length;G<$;G++)U[G]=B.substring(F[G-1],F[G]);let K=0;const H=new Array(N.length);for(let G=0,$=N.length;G<$;G++)H[K++]=U[N[G]+1];return H}},"./src/parsers/cifutils/encoding.ts"(o,a,n){n.r(a),n.d(a,{Encoding:()=>R,VERSION:()=>d});const d="0.3.0";var R;(function(S){(function(v){v[v.Int8=1]="Int8",v[v.Int16=2]="Int16",v[v.Int32=3]="Int32",v[v.Uint8=4]="Uint8",v[v.Uint16=5]="Uint16",v[v.Uint32=6]="Uint32"})(S.IntDataType||(S.IntDataType={})),(function(v){v[v.Float32=32]="Float32",v[v.Float64=33]="Float64"})(S.FloatDataType||(S.FloatDataType={}));function j(v){let D;return v instanceof Int8Array?D=S.IntDataType.Int8:v instanceof Int16Array?D=S.IntDataType.Int16:v instanceof Int32Array?D=S.IntDataType.Int32:v instanceof Uint8Array?D=S.IntDataType.Uint8:v instanceof Uint16Array?D=S.IntDataType.Uint16:v instanceof Uint32Array?D=S.IntDataType.Uint32:v instanceof Float32Array?D=S.FloatDataType.Float32:v instanceof Float64Array?D=S.FloatDataType.Float64:D=S.IntDataType.Int32,D}S.getDataType=j;function p(v){if(v instanceof Int8Array||v instanceof Int16Array||v instanceof Int32Array)return!0;for(let D=0,x=v.length;D<x;D++)if(D<0)return!1;return!0}S.isSignedIntegerDataType=p})(R||(R={}))},"./src/parsers/index.ts"(o,a,n){n.r(a),n.d(a,{Parsers:()=>h,bondLength:()=>s.bondLength,setBondLength:()=>s.setBondLength});var d=n("./src/parsers/VASP.ts"),R=n("./src/parsers/CUBE.ts"),S=n("./src/parsers/XYZ.ts"),j=n("./src/parsers/SDF.ts"),p=n("./src/parsers/CDJSON.ts"),v=n("./src/parsers/CIF.ts"),D=n("./src/parsers/MOL2.ts"),x=n("./src/parsers/PDB.ts"),A=n("./src/parsers/PQR.ts"),L=n("./src/parsers/MMTF.ts"),w=n("./src/parsers/PRMTOP.ts"),b=n("./src/parsers/GRO.ts"),u=n("./src/parsers/LAMMPSTRJ.ts"),i=n("./src/parsers/BCIF.ts"),s=n("./src/parsers/utils/bondLength.ts");const h={vasp:d.VASP,VASP:d.VASP,cube:R.CUBE,CUBE:R.CUBE,xyz:S.XYZ,XYZ:S.XYZ,sdf:j.SDF,SDF:j.SDF,json:p.CDJSON,cdjson:p.CDJSON,CDJSON:p.CDJSON,mcif:v.CIF,cif:v.CIF,CIF:v.CIF,mol2:D.MOL2,MOL2:D.MOL2,pdb:x.PDB,PDB:x.PDB,pdbqt:x.PDB,PDBQT:x.PDB,pqr:A.PQR,PQR:A.PQR,mmtf:L.MMTFparser,MMTF:L.MMTFparser,prmtop:w.PRMTOP,PRMTOP:w.PRMTOP,gro:b.GRO,GRO:b.GRO,lammpstrj:u.LAMMPSTRJ,LAMMPSTRJ:u.LAMMPSTRJ,bcif:i.BCIF,BCIF:i.BCIF}},"./src/parsers/utils/anumToSymbol.ts"(o,a,n){n.r(a),n.d(a,{anumToSymbol:()=>d});const d={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}},"./src/parsers/utils/areConnected.ts"(o,a,n){n.r(a),n.d(a,{areConnected:()=>S});var d=n("./src/parsers/utils/bondLength.ts");const R=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function S(j,p,v){if(v&&v.unboundCations&&(R.has(j.elem)||R.has(p.elem)))return!1;let D=(0,d.bondLength)(j.elem)+(0,d.bondLength)(p.elem);D+=.25,D*=D;let x=j.x-p.x;if(x*=x,x>D)return!1;let A=j.y-p.y;if(A*=A,A>D)return!1;let L=j.z-p.z;if(L*=L,L>D)return!1;const w=x+A+L;return!(isNaN(w)||w<.5||w>D||j.altLoc!==p.altLoc&&j.altLoc.trim()!==""&&p.altLoc.trim()!=="")}},"./src/parsers/utils/assignBackboneHBonds.ts"(o,a,n){n.r(a),n.d(a,{assignBackboneHBonds:()=>d});function d(R,S){const j=S||3.2,p=j*j,v=[];for(let D=0,x=R.length;D<x;D++){R[D].index=D;const A=R[D];!A.hetflag&&(A.atom==="N"||A.atom==="O")&&(v.push(A),A.hbondOther=null,A.hbondDistanceSq=Number.POSITIVE_INFINITY)}v.sort(function(D,x){return D.z-x.z});for(let D=0,x=v.length;D<x;D++){const A=v[D];for(let L=D+1;L<x;L++){const w=v[L],b=w.z-A.z;if(b>j)break;if(w.atom==A.atom)continue;const u=Math.abs(w.y-A.y);if(u>j)continue;const i=Math.abs(w.x-A.x);if(i>j)continue;const s=i*i+u*u+b*b;s>p||w.chain==A.chain&&Math.abs(w.resi-A.resi)<4||(s<A.hbondDistanceSq&&(A.hbondOther=w,A.hbondDistanceSq=s),s<w.hbondDistanceSq&&(w.hbondOther=A,w.hbondDistanceSq=s))}}}},"./src/parsers/utils/assignBonds.ts"(o,a,n){n.r(a),n.d(a,{assignBonds:()=>j});var d=n("./src/parsers/utils/areConnected.ts");const R=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],S=4.95;function j(p,v){for(let A=0,L=p.length;A<L;A++)p[A].index||(p[A].index=A);const D={x:{y:{z:[]}}};for(let A=0;A<p.length;A++){const L=p[A],w=Math.floor(L.x/S),b=Math.floor(L.y/S),u=Math.floor(L.z/S);D[w]||(D[w]={}),D[w][b]||(D[w][b]={}),D[w][b][u]||(D[w][b][u]=[]),D[w][b][u].push(L)}function x(A,L){for(let w=0;w<A.length;w++){const b=A[w];for(let u=0;u<L.length;u++){const i=L[u];if((0,d.areConnected)(b,i,v)){const s=b.bonds.indexOf(i.index),h=i.bonds.indexOf(b.index);s===-1&&h===-1?(b.bonds.push(i.index),b.bondOrder.push(1),i.bonds.push(b.index),i.bondOrder.push(1)):s===-1?(b.bonds.push(i.index),b.bondOrder.push(i.bondOrder[h])):h===-1&&(i.bonds.push(b.index),i.bondOrder.push(b.bondOrder[s]))}}}}for(let A in D){const L=parseInt(A);for(let w in D[L]){const b=parseInt(w);for(let u in D[L][b]){const i=parseInt(u),s=D[L][b][i];for(let h=0;h<s.length;h++){const g=s[h];for(let y=h+1;y<s.length;y++){const E=s[y];(0,d.areConnected)(g,E,v)&&g.bonds.indexOf(E.index)==-1&&(g.bonds.push(E.index),g.bondOrder.push(1),E.bonds.push(g.index),E.bondOrder.push(1))}}for(let h=0;h<R.length;h++){const g=R[h];if(!D[L+g.x]||!D[L+g.x][b+g.y]||!D[L+g.x][b+g.y][i+g.z])continue;const y=D[L+g.x][b+g.y][i+g.z];x(s,y)}}}}}},"./src/parsers/utils/assignPDBBonds.ts"(o,a,n){n.r(a),n.d(a,{assignPDBBonds:()=>j});var d=n("./src/parsers/utils/areConnected.ts"),R=n("./src/parsers/utils/assignBonds.ts"),S=n("./src/parsers/utils/standardResidues.ts");function j(p,v){const D=[],x=[];for(let b=0,u=p.length;b<u;b++){const i=p[b];i.index=b,i.hetflag||!S.standardResidues.has(i.resn)?x.push(i):D.push(i)}(0,R.assignBonds)(x,v),D.sort(function(b,u){return b.chain!==u.chain?b.chain<u.chain?-1:1:b.resi-u.resi});let A=-1,L=-1,w;for(let b=0,u=D.length;b<u;b++){const i=D[b];i.resi!==A&&(A=i.resi,w||L++,w=!1),i.reschain=L;for(let s=b+1;s<D.length;s++){const h=D[s];if(h.chain!==i.chain||h.resi-i.resi>1)break;(0,d.areConnected)(i,h,v)&&(i.bonds.indexOf(h.index)===-1&&(i.bonds.push(h.index),i.bondOrder.push(1),h.bonds.push(i.index),h.bondOrder.push(1)),i.resi!==h.resi&&(w=!0))}}}},"./src/parsers/utils/atomNameToElem.ts"(o,a,n){n.r(a),n.d(a,{atomNameToElem:()=>R});var d=n("./src/parsers/utils/bondLength.ts");function R(S,j){let p=S.replace(/ /g,"");return p.length>0&&p[0]==="H"&&p!=="Hg"&&p!=="He"&&p!=="Hf"&&p!=="Hs"&&p!=="Ho"&&(p="H"),p.length>1&&(p=p[0].toUpperCase()+p.substring(1).toLowerCase(),d.bondTable[p]===void 0?p=p[0]:j&&(p==="Ca"||p==="Cd")&&(p="C")),p}},"./src/parsers/utils/bondLength.ts"(o,a,n){n.r(a),n.d(a,{bondLength:()=>R,bondTable:()=>d,setBondLength:()=>S});let d={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function R(j){return d[j]||1.6}function S(j,p){p<0&&(p=0),d[j]=p}},"./src/parsers/utils/computeSecondaryStructure.ts"(o,a,n){n.r(a),n.d(a,{computeSecondaryStructure:()=>R});var d=n("./src/parsers/utils/assignBackboneHBonds.ts");function R(S,j){(0,d.assignBackboneHBonds)(S,j);const p={};let v,D,x,A,L,w;for(v=0,D=S.length;v<D;v++)if(L=S[v],p[L.chain]===void 0&&(p[L.chain]=[]),isFinite(L.hbondDistanceSq)){const b=L.hbondOther;p[b.chain]===void 0&&(p[b.chain]=[]),Math.abs(b.resi-L.resi)===4&&(p[L.chain][L.resi]="h")}for(x in p)for(A=1;A<p[x].length-1;A++){const b=p[x][A-1],u=p[x][A+1];w=p[x][A],b=="h"&&b==u&&w!=b&&(p[x][A]=b)}for(v=0,D=S.length;v<D;v++)L=S[v],isFinite(L.hbondDistanceSq)&&p[L.chain][L.resi]!="h"&&L.ss!=="h"&&(p[L.chain][L.resi]="maybesheet");for(let b=0,u=S.length;b<u;b++)if(L=S[b],isFinite(L.hbondDistanceSq)&&p[L.chain][L.resi]=="maybesheet"){let i=L.hbondOther,s=p[i.chain][i.resi];(s=="maybesheet"||s=="s")&&(p[L.chain][L.resi]="s",p[i.chain][i.resi]="s")}for(let b in p){for(let u=1;u<p[b].length-1;u++){const i=p[b][u-1],s=p[b][u+1];w=p[b][u],i=="s"&&i==s&&w!=i&&(p[b][u]=i)}for(let u=0;u<p[b].length;u++){const i=p[b][u];(i=="h"||i=="s")&&p[b][u-1]!=i&&p[b][u+1]!=i&&delete p[b][u]}}for(v=0,D=S.length;v<D;v++)L=S[v],w=p[L.chain][L.resi],delete L.hbondOther,delete L.hbondDistanceSq,!(w===void 0||w==="maybesheet")&&(L.ss=w,p[L.chain][L.resi-1]!=w&&(L.ssbegin=!0),p[L.chain][L.resi+1]!=w&&(L.ssend=!0))}},"./src/parsers/utils/getSinglePDB.ts"(o,a,n){n.r(a),n.d(a,{getSinglePDB:()=>A});var d=n("./src/WebGL/index.ts"),R=n("./src/parsers/utils/atomNameToElem.ts"),S=n("./src/parsers/utils/bondLength.ts"),j=n("./src/parsers/utils/computeSecondaryStructure.ts"),p=n("./src/parsers/utils/isEmpty.ts"),v=n("./src/parsers/utils/processSymmetries.ts"),D=n("./src/parsers/utils/assignPDBBonds.ts"),x=n("./src/parsers/utils/validateBonds.ts");function A(L,w,b){const u=[],i=w.assignBonds===void 0?!0:w.assignBonds,s=!w.keepH,h=!!w.noSecondaryStructure,g=!w.noComputeSecondaryStructure,y=!w.doAssembly,E=w.altLoc?w.altLoc:"A",l={symmetries:[],cryst:void 0};let f,m=[];const C=[];let T;const P={};for(let F=0;F<L.length;F++){T=L[F].replace(/^\s*/,"");const N=T.substring(0,6);let B,U,K;if(N.indexOf("END")===0){if(m=L.slice(F+1),N==="END")for(const H in b)b.hasOwnProperty(H)&&delete b[H];break}else if(N==="ATOM  "||N==="HETATM"){let H,G,$,V,k,Y,ie,ne,he,le,xe,fe;if(xe=T.substring(16,17),xe!==" "&&xe!==E&&E!=="*"||(le=parseInt(T.substring(6,11)),f=T.substring(12,16).replace(/ /g,""),H=T.substring(17,20).replace(/ /g,""),G=T.substring(21,22),$=parseInt(T.substring(22,26)),V=T.substring(26,27),k=parseFloat(T.substring(30,38)),Y=parseFloat(T.substring(38,46)),ie=parseFloat(T.substring(46,54)),fe=parseFloat(T.substring(60,68)),he=T.substring(76,78).replace(/ /g,""),he===""||S.bondTable[he]===void 0?he=(0,R.atomNameToElem)(T.substring(12,14),T[0]=="A"):he=he[0].toUpperCase()+he.substring(1).toLowerCase(),he==="H"&&s))continue;N[0]=="H"?ne=!0:ne=!1,C[le]=u.length,u.push({resn:H,x:k,y:Y,z:ie,elem:he,hetflag:ne,altLoc:xe,chain:G,resi:$,icode:V,rescode:$+(V!==" "?"^"+V:""),serial:le,atom:f,bonds:[],ss:"c",bondOrder:[],properties:{},b:fe,pdbline:T})}else if(N==="SHEET "){B=T.substring(21,22),U=parseInt(T.substring(22,26)),K=parseInt(T.substring(33,37)),B in b||(b[B]={}),b[B][U]="s1";for(let H=U+1;H<K;H++)b[B][H]="s";b[B][K]="s2"}else if(N==="CONECT"){const H=parseInt(T.substring(6,11)),G=C[H],$=u[G],V=[11,16,21,26];for(let k=0;k<4;k++){const Y=parseInt(T.substring(V[k],V[k]+5)),ie=C[Y];let ne=G+":"+ie;const he=u[ie];if($!==void 0&&he!==void 0)if(!P[ne])P[ne]=1,($.bonds.length==0||$.bonds[$.bonds.length-1]!==ie)&&($.bonds.push(ie),$.bondOrder.push(1));else{P[ne]+=1;for(let le=0;le<$.bonds.length;le++)if($.bonds[le]==ie){const xe=P[ne];xe>=4?$.bondOrder[le]=1:$.bondOrder[le]=xe}}}}else if(N==="HELIX "){B=T.substring(19,20),U=parseInt(T.substring(21,25)),K=parseInt(T.substring(33,37)),B in b||(b[B]={}),b[B][U]="h1";for(let H=U+1;H<K;H++)b[B][H]="h";b[B][K]="h2"}else if(!y&&N==="REMARK"&&T.substring(13,18)==="BIOMT"){let H,G=new d.Matrix4;for(H=1;H<=3;H++)if(T=L[F].replace(/^\s*/,""),parseInt(T.substring(18,19))==H)G.elements[H-1]=parseFloat(T.substring(23,33)),G.elements[H-1+4]=parseFloat(T.substring(33,43)),G.elements[H-1+8]=parseFloat(T.substring(43,53)),G.elements[H-1+12]=parseFloat(T.substring(53)),F++;else for(;T.substring(13,18)==="BIOMT";)F++,T=L[F].replace(/^\s*/,"");G.elements[3]=0,G.elements[7]=0,G.elements[11]=0,G.elements[15]=1,l.symmetries.push(G),F--}else if(N==="CRYST1"){let H,G,$,V,k,Y;H=parseFloat(T.substring(7,15)),G=parseFloat(T.substring(16,24)),$=parseFloat(T.substring(25,33)),V=parseFloat(T.substring(34,40)),k=parseFloat(T.substring(41,47)),Y=parseFloat(T.substring(48,54)),l.cryst={a:H,b:G,c:$,alpha:V,beta:k,gamma:Y}}else if(N==="ANISOU"){const H=parseInt(T.substring(6,11)),G=C[H],$=u[G];if($){const V=T.substring(30).trim().split(/\s+/),k={u11:parseInt(V[0]),u22:parseInt(V[1]),u33:parseInt(V[2]),u12:parseInt(V[3]),u13:parseInt(V[4]),u23:parseInt(V[5])};$.uMat=k}}}if((0,x.validateBonds)(u,C),i&&(0,D.assignPDBBonds)(u,w),y||(0,v.processSymmetries)(l.symmetries,u,w,l.cryst),g&&!h&&(0,j.computeSecondaryStructure)(u,w.hbondCutoff),!(0,p.isEmpty)(b))for(let F=0;F<u.length;F++){const N=u[F];if(N!==void 0&&N.chain in b&&N.resi in b[N.chain]){const B=b[N.chain][N.resi];N.ss=B[0],B.length>1&&(B[1]=="1"?N.ssbegin=!0:B[1]=="2"&&(N.ssend=!0))}}return[u,l,m]}},"./src/parsers/utils/isEmpty.ts"(o,a,n){n.r(a),n.d(a,{isEmpty:()=>d});function d(R){for(const S in R)return!1;return!0}},"./src/parsers/utils/processSymmetries.ts"(o,a,n){n.r(a),n.d(a,{processSymmetries:()=>R});var d=n("./src/WebGL/index.ts");function R(S,j,p,v){const D=!p.duplicateAssemblyAtoms,x=j.length;let A=x,L=-1,w=null,b=null;(p.normalizeAssembly||p.wrapAtoms)&&v&&(w=(0,d.conversionMatrix3)(v.a,v.b,v.c,v.alpha,v.beta,v.gamma),b=new d.Matrix3,b.getInverse3(w));let u=function(h){let g=h.clone().applyMatrix3(b);const y=[g.x,g.y,g.z],E=[0,0,0];for(let f=0;f<3;f++){for(;y[f]<-.001;)y[f]+=1,E[f]+=1;for(;y[f]>1.001;)y[f]-=1,E[f]-=1}const l=new d.Vector3(E[0],E[1],E[2]);return l.applyMatrix3(w),l};if(p.normalizeAssembly&&v)for(let h=0;h<S.length;h++){const g=new d.Vector3(0,0,0);for(let E=0;E<x;E++){const l=new d.Vector3(j[E].x,j[E].y,j[E].z);l.applyMatrix4(S[h]),g.add(l)}g.divideScalar(x);const y=u(g);S[h].isNearlyIdentity()&&y.lengthSq()>.001&&(L=h),S[h].translate(y)}if(D){if(S.length>1)for(let h=0;h<j.length;h++){var i=[];for(let g=0;g<S.length;g++)if(!S[g].isNearlyIdentity()){var s=new d.Vector3;s.set(j[h].x,j[h].y,j[h].z),s.applyMatrix4(S[g]),i.push(s)}j[h].symmetries=i}}else{for(let h=0;h<x;h++)j[h].sym=-1;for(let h=0;h<S.length;h++)if(!S[h].isNearlyIdentity()&&L!=h){let g=new d.Vector3;for(let y=0;y<x;y++){const E=[];for(let f=0;f<j[y].bonds.length;f++)E.push(j[y].bonds[f]+A);if(g.set(j[y].x,j[y].y,j[y].z),g.applyMatrix4(S[h]),p.wrapAtoms&&v){let f=u(g);g.add(f)}const l={};for(const f in j[y])l[f]=j[y][f];l.x=g.x,l.y=g.y,l.z=g.z,l.bonds=E,l.sym=h,l.index=j.length,j.push(l)}A=j.length}else for(let g=0;g<x;g++)j[g].sym=h;if(p.wrapAtoms&&v){let h=new d.Vector3;for(let g=0;g<x;g++){h.set(j[g].x,j[g].y,j[g].z);let y=u(h);h.add(y),j[g].x=h.x,j[g].y=h.y,j[g].z=h.z}}if(L>=0){const h=new d.Vector3;for(let g=0;g<x;g++)h.set(j[g].x,j[g].y,j[g].z),h.applyMatrix4(S[L]),j[g].x=h.x,j[g].y=h.y,j[g].z=h.z}S.length=0}}},"./src/parsers/utils/standardResidues.ts"(o,a,n){n.r(a),n.d(a,{standardResidues:()=>d});const d=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])},"./src/parsers/utils/validateBonds.ts"(o,a,n){n.r(a),n.d(a,{validateBonds:()=>d});function d(R,S){for(let j=0,p=R.length;j<p;j++){const v=R[j];for(let D=0;D<v.bonds.length;D++){const x=v.bonds[D],A=R[x],L=S[v.serial];A&&L&&A.bonds.indexOf(L)<0&&(A.bonds.push(L),A.bondOrder.push(v.bondOrder[D]))}}}},"./src/partialCharges.ts"(o,a,n){n.r(a),n.d(a,{applyPartialCharges:()=>R,partialCharges:()=>d});const d={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function R(S,j){if((!j||typeof S.partialCharge>"u")&&S.resn&&S.atom){var p=S.resn+":"+S.atom;S.properties.partialCharge=d[p]}}},"./src/specs.ts"(o,a,n){n.r(a)},"./src/utilities.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(o,a){for(var n in a)a.hasOwnProperty(n)&&a[n]!==void 0&&(o[n]=a[n]);return o}function deepCopy(o){let a,n,d;if(o==null)return{};if(typeof o!="object"||o===null)return o;a=Array.isArray(o)?[]:{};for(d in o)n=o[d],a[d]=deepCopy(n);return a}function isNumeric(o){var a=typeof o;return(a==="number"||a==="string")&&!isNaN(o-parseFloat(o))}function isEmptyObject(o){return Object.keys(o).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(o){o&&(o.volformat&&!(o.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(o.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(o.voldata,o.volformat)),o.volscheme&&(o.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(o.volscheme)))}function getExtent(o,a){var n,d,R,S,j,p,v,D,x,A,L=!a;if(n=d=R=9999,S=j=p=-9999,v=D=x=A=0,o.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var w=0;w<o.length;w++){var b=o[w];if(!(typeof b>"u"||!isFinite(b.x)||!isFinite(b.y)||!isFinite(b.z))&&(A++,v+=b.x,D+=b.y,x+=b.z,n=n<b.x?n:b.x,d=d<b.y?d:b.y,R=R<b.z?R:b.z,S=S>b.x?S:b.x,j=j>b.y?j:b.y,p=p>b.z?p:b.z,b.symmetries&&L))for(var u=0;u<b.symmetries.length;u++)A++,v+=b.symmetries[u].x,D+=b.symmetries[u].y,x+=b.symmetries[u].z,n=n<b.symmetries[u].x?n:b.symmetries[u].x,d=d<b.symmetries[u].y?d:b.symmetries[u].y,R=R<b.symmetries[u].z?R:b.symmetries[u].z,S=S>b.symmetries[u].x?S:b.symmetries[u].x,j=j>b.symmetries[u].y?j:b.symmetries[u].y,p=p>b.symmetries[u].z?p:b.symmetries[u].z}return[[n,d,R],[S,j,p],[v/A,D/A,x/A]]}function getPropertyRange(o,a){for(var n=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,R=0,S=o.length;R<S;R++){var j=o[R],p=getAtomProperty(j,a);p!=null&&(p<n&&(n=p),p>d&&(d=p))}return!isFinite(n)&&!isFinite(d)?n=d=0:isFinite(n)?isFinite(d)||(d=n):n=d,[n,d]}class PausableTimer{constructor(a,n,d){this.total_time_run=0,this.fn=a,this.arg=d,this.countdown=n,this.start_time=new Date().getTime(),this.ident=setTimeout(a,n,d)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(o){for(var a=window.atob(o),n=a.length,d=new Uint8Array(n),R=0;R<n;R++)d[R]=a.charCodeAt(R);return d}function getAtomProperty(o,a){var n=null;return o.properties&&typeof o.properties[a]<"u"?n=o.properties[a]:typeof o[a]<"u"&&(n=o[a]),n}function mergeGeos(o,a){var n=a.geometry;n!==void 0&&o.geometryGroups.push(n.geometryGroups[0])}function specStringToObject(o){if(typeof o=="object")return o;if(typeof o>"u"||o==null)return o;try{return JSON.parse(o)}catch{}o=o.replace(/%7E/g,"~");var a=function(L){return isNumeric(L)?Math.floor(parseFloat(L))==parseInt(L)||L.indexOf(".")>=0?parseFloat(L):parseInt(L):L==="true"?!0:L==="false"?!1:L},n={};if(o==="all")return n;for(var d=o.split(";"),R=0;R<d.length;R++){var S=d[R].split(":"),j=S[0],p={},v=S[1];if(v)if(v=v.replace(/~/g,"="),v.indexOf("=")!==-1)for(var D=v.split(","),x=0;x<D.length;x++){var A=D[x].split("=",2);p[A[0]]=a(A[1])}else v.indexOf(",")!==-1?p=v.split(","):p=a(v);n[j]=p}return n}function checkStatus(o){if(!o.ok)throw new Error(`HTTP ${o.status} - ${o.statusText}`);return o}function get(o,a){var n=fetch(o).then(checkStatus).then(d=>d.text());return a?n.then(a):n}function getbin(o,a,n,d){var R;return n=="POST"?R=fetch(o,{method:"POST",body:d}).then(S=>checkStatus(S)).then(S=>S.arrayBuffer()):R=fetch(o).then(S=>checkStatus(S)).then(S=>S.arrayBuffer()),a?R.then(a):R}function download(o,a,n,d){var R="",S="",j="",p=null,v=a.addModel();if(o.indexOf(":")<0&&(o.length==4?o="pdb:"+o:isNaN(o)?o="url:"+o:o="cid:"+o),o.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),o="bcif:"+o.slice(5)),o.substring(0,5)==="bcif:")o=o.substring(5).toUpperCase(),j="https://models.rcsb.org/"+o+".bcif.gz",n&&typeof n.noComputeSecondaryStructure>"u"&&(n.noComputeSecondaryStructure=!0),p=new Promise(function(x){getbin(j).then(function(A){v.addMolData(A,"bcif.gz",n),a.zoomTo(),a.render(),x(v)},function(){console.error("fetch of "+j+" failed.")})});else{if(o.substring(0,4)==="pdb:"){if(R="bcif",n&&n.format&&(R=n.format),n&&typeof n.noComputeSecondaryStructure>"u"&&(n.noComputeSecondaryStructure=!0),o=o.substring(4).toUpperCase(),!o.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}R=="bcif"?j="https://models.rcsb.org/"+o.toUpperCase()+".bcif.gz":(S=n&&n.pdbUri?n.pdbUri:"https://files.rcsb.org/view/",j=S+o+"."+R)}else if(o.substring(0,4)=="cid:"){if(R="sdf",o=o.substring(4),!o.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}j="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+o+"/SDF?record_type=3d"}else o.substring(0,4)=="url:"&&(j=o.substring(4),R=j);var D=function(x){v.addMolData(x,R,n),a.zoomTo(),a.render()};p=new Promise(function(x){R=="bcif"?getbin(j).then(function(A){D(A),x(v)}).catch(function(){S=n&&n.pdbUri?n.pdbUri:"https://files.rcsb.org/view/",j=S+o+".pdb",R="pdb",console.warn("falling back to pdb format"),get(j).then(function(A){D(A),x(v)}).catch(function(A){D(""),x(v),console.error("fetch of "+j+" failed: "+A.statusText)})}):get(j).then(function(A){D(A),x(v)}).catch(function(A){D(""),x(v),console.error("fetch of "+j+" failed: "+A.statusText)})})}return d?(p.then(function(x){d(x)}),v):p}function getColorFromStyle(o,a){let n=a.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[n]<"u")n=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[n];else if(typeof n=="string"&&n.endsWith("Carbon")){let j=n.substring(0,n.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[j]<"u"){let p=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);p.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[j],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[n]={prop:"elem",map:p},n=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[n]}}let d=o.color;if(typeof a.color<"u"&&a.color!="spectrum"&&(d=a.color),typeof n<"u"){let j,p;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[n]<"u")n=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[n],typeof n[o[n.prop]]<"u"&&(d=n.map[o[n.prop]]);else if(typeof n[o[n.prop]]<"u")d=n.map[o[n.prop]];else if(typeof n.prop<"u"&&typeof n.gradient<"u"){j=n.prop;var R=n.gradient;R instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(R=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(n));let v=R.range()||[-1,1];p=getAtomProperty(o,j),p!=null&&(d=R.valueToHex(p,v))}else typeof n.prop<"u"&&typeof n.map<"u"?(j=n.prop,p=getAtomProperty(o,j),typeof n.map[p]<"u"&&(d=n.map[p])):typeof a.colorscheme[o.elem]<"u"?d=a.colorscheme[o.elem]:console.warn("Could not interpret colorscheme "+n)}else typeof a.colorfunc<"u"&&(d=a.colorfunc(o));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(d)}function getElement(o){let a=o;return typeof o=="string"?a=document.querySelector("#"+o):typeof o=="object"&&o.get&&(a=o.get(0)),a}function inflateString(o,a=!0){let n;return typeof o=="string"?n=new TextEncoder().encode(o):n=new Uint8Array(o),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(n,{to:a?"string":null})}},"./src/vendor/mmtf.js"(o,a){(function(n,d){d(a)})(this,function(n){function d(q,re,se){for(var Se=(q.byteLength,0),we=se.length;we>Se;Se++){var ze=se.charCodeAt(Se);if(128>ze)q.setUint8(re++,ze>>>0&127|0);else if(2048>ze)q.setUint8(re++,ze>>>6&31|192),q.setUint8(re++,ze>>>0&63|128);else if(65536>ze)q.setUint8(re++,ze>>>12&15|224),q.setUint8(re++,ze>>>6&63|128),q.setUint8(re++,ze>>>0&63|128);else{if(!(1114112>ze))throw new Error("bad codepoint "+ze);q.setUint8(re++,ze>>>18&7|240),q.setUint8(re++,ze>>>12&63|128),q.setUint8(re++,ze>>>6&63|128),q.setUint8(re++,ze>>>0&63|128)}}}function R(q){for(var re=0,se=0,Se=q.length;Se>se;se++){var we=q.charCodeAt(se);if(128>we)re+=1;else if(2048>we)re+=2;else if(65536>we)re+=3;else{if(!(1114112>we))throw new Error("bad codepoint "+we);re+=4}}return re}function S(q,re,se){var Se=typeof q;if(Se==="string"){var we=R(q);if(32>we)return re.setUint8(se,160|we),d(re,se+1,q),1+we;if(256>we)return re.setUint8(se,217),re.setUint8(se+1,we),d(re,se+2,q),2+we;if(65536>we)return re.setUint8(se,218),re.setUint16(se+1,we),d(re,se+3,q),3+we;if(4294967296>we)return re.setUint8(se,219),re.setUint32(se+1,we),d(re,se+5,q),5+we}if(q instanceof Uint8Array){var we=q.byteLength,ze=new Uint8Array(re.buffer);if(256>we)return re.setUint8(se,196),re.setUint8(se+1,we),ze.set(q,se+2),2+we;if(65536>we)return re.setUint8(se,197),re.setUint16(se+1,we),ze.set(q,se+3),3+we;if(4294967296>we)return re.setUint8(se,198),re.setUint32(se+1,we),ze.set(q,se+5),5+we}if(Se==="number"){if(!isFinite(q))throw new Error("Number not finite: "+q);if(Math.floor(q)!==q)return re.setUint8(se,203),re.setFloat64(se+1,q),9;if(q>=0){if(128>q)return re.setUint8(se,q),1;if(256>q)return re.setUint8(se,204),re.setUint8(se+1,q),2;if(65536>q)return re.setUint8(se,205),re.setUint16(se+1,q),3;if(4294967296>q)return re.setUint8(se,206),re.setUint32(se+1,q),5;throw new Error("Number too big 0x"+q.toString(16))}if(q>=-32)return re.setInt8(se,q),1;if(q>=-128)return re.setUint8(se,208),re.setInt8(se+1,q),2;if(q>=-32768)return re.setUint8(se,209),re.setInt16(se+1,q),3;if(q>=-2147483648)return re.setUint8(se,210),re.setInt32(se+1,q),5;throw new Error("Number too small -0x"+(-q).toString(16).substr(1))}if(q===null)return re.setUint8(se,192),1;if(Se==="boolean")return re.setUint8(se,q?195:194),1;if(Se==="object"){var we,ge=0,Be=Array.isArray(q);if(Be)we=q.length;else{var Z=Object.keys(q);we=Z.length}var ge;if(16>we?(re.setUint8(se,we|(Be?144:128)),ge=1):65536>we?(re.setUint8(se,Be?220:222),re.setUint16(se+1,we),ge=3):4294967296>we&&(re.setUint8(se,Be?221:223),re.setUint32(se+1,we),ge=5),Be)for(var Ce=0;we>Ce;Ce++)ge+=S(q[Ce],re,se+ge);else for(var Ce=0;we>Ce;Ce++){var Ue=Z[Ce];ge+=S(Ue,re,se+ge),ge+=S(q[Ue],re,se+ge)}return ge}throw new Error("Unknown type "+Se)}function j(q){var re=typeof q;if(re==="string"){var se=R(q);if(32>se)return 1+se;if(256>se)return 2+se;if(65536>se)return 3+se;if(4294967296>se)return 5+se}if(q instanceof Uint8Array){var se=q.byteLength;if(256>se)return 2+se;if(65536>se)return 3+se;if(4294967296>se)return 5+se}if(re==="number"){if(Math.floor(q)!==q)return 9;if(q>=0){if(128>q)return 1;if(256>q)return 2;if(65536>q)return 3;if(4294967296>q)return 5;throw new Error("Number too big 0x"+q.toString(16))}if(q>=-32)return 1;if(q>=-128)return 2;if(q>=-32768)return 3;if(q>=-2147483648)return 5;throw new Error("Number too small -0x"+q.toString(16).substr(1))}if(re==="boolean"||q===null)return 1;if(re==="object"){var se,Se=0;if(Array.isArray(q)){se=q.length;for(var we=0;se>we;we++)Se+=j(q[we])}else{var ze=Object.keys(q);se=ze.length;for(var we=0;se>we;we++){var Be=ze[we];Se+=j(Be)+j(q[Be])}}if(16>se)return 1+Se;if(65536>se)return 3+Se;if(4294967296>se)return 5+Se;throw new Error("Array or object too long 0x"+se.toString(16))}throw new Error("Unknown type "+re)}function p(q){var re=new ArrayBuffer(j(q)),se=new DataView(re);return S(q,se,0),new Uint8Array(re)}function v(q,re,se){return re?new q(re.buffer,re.byteOffset,re.byteLength/(se||1)):void 0}function D(q){return v(DataView,q)}function x(q){return v(Uint8Array,q)}function A(q){return v(Int8Array,q)}function L(q){return v(Int32Array,q,4)}function w(q){return v(Float32Array,q,4)}function b(q,re){var se=q.length/2;re||(re=new Int16Array(se));for(var Se=0,we=0;se>Se;++Se,we+=2)re[Se]=q[we]<<8^q[we+1]<<0;return re}function u(q,re){var se=q.length;re||(re=new Uint8Array(2*se));for(var Se=D(re),we=0;se>we;++we)Se.setInt16(2*we,q[we]);return x(re)}function i(q,re){var se=q.length/4;re||(re=new Int32Array(se));for(var Se=0,we=0;se>Se;++Se,we+=4)re[Se]=q[we]<<24^q[we+1]<<16^q[we+2]<<8^q[we+3]<<0;return re}function s(q,re){var se=q.length;re||(re=new Uint8Array(4*se));for(var Se=D(re),we=0;se>we;++we)Se.setInt32(4*we,q[we]);return x(re)}function h(q,re){var se=q.length;re||(re=new Float32Array(se/4));for(var Se=D(re),we=D(q),ze=0,Be=0,Z=se/4;Z>ze;++ze,Be+=4)Se.setFloat32(Be,we.getFloat32(Be),!0);return re}function g(q,re,se){var Se=q.length,we=1/re;se||(se=new Float32Array(Se));for(var ze=0;Se>ze;++ze)se[ze]=q[ze]*we;return se}function y(q,re,se){var Se=q.length;se||(se=new Int32Array(Se));for(var we=0;Se>we;++we)se[we]=Math.round(q[we]*re);return se}function E(q,re){var se,Se;if(!re){var we=0;for(se=0,Se=q.length;Se>se;se+=2)we+=q[se+1];re=new q.constructor(we)}var ze=0;for(se=0,Se=q.length;Se>se;se+=2)for(var Be=q[se],Z=q[se+1],ge=0;Z>ge;++ge)re[ze]=Be,++ze;return re}function l(q){if(q.length===0)return new Int32Array;var re,se,Se=2;for(re=1,se=q.length;se>re;++re)q[re-1]!==q[re]&&(Se+=2);var we=new Int32Array(Se),ze=0,Be=1;for(re=1,se=q.length;se>re;++re)q[re-1]!==q[re]?(we[ze]=q[re-1],we[ze+1]=Be,Be=1,ze+=2):++Be;return we[ze]=q[q.length-1],we[ze+1]=Be,we}function f(q,re){var se=q.length;re||(re=new q.constructor(se)),se&&(re[0]=q[0]);for(var Se=1;se>Se;++Se)re[Se]=q[Se]+re[Se-1];return re}function m(q,re){var se=q.length;re||(re=new q.constructor(se)),re[0]=q[0];for(var Se=1;se>Se;++Se)re[Se]=q[Se]-q[Se-1];return re}function C(q,re){var se,Se,we=q instanceof Int8Array?127:32767,ze=-we-1,Be=q.length;if(!re){var Z=0;for(se=0;Be>se;++se)q[se]<we&&q[se]>ze&&++Z;re=new Int32Array(Z)}for(se=0,Se=0;Be>se;){for(var ge=0;q[se]===we||q[se]===ze;)ge+=q[se],++se;ge+=q[se],++se,re[Se]=ge,++Se}return re}function T(q,re){var se,Se=32767,we=-Se-1,ze=q.length,Be=0;for(se=0;ze>se;++se){var Z=q[se];Z===0?++Be:Z>0?(Be+=Math.ceil(Z/Se),Z%Se===0&&(Be+=1)):(Be+=Math.ceil(Z/we),Z%we===0&&(Be+=1))}var ge=new Int16Array(Be),Ce=0;for(se=0;ze>se;++se){var Z=q[se];if(Z>=0)for(;Z>=Se;)ge[Ce]=Se,++Ce,Z-=Se;else for(;we>=Z;)ge[Ce]=we,++Ce,Z-=we;ge[Ce]=Z,++Ce}return ge}function P(q,re){return f(E(q),re)}function F(q){return l(m(q))}function N(q,re,se){return g(E(q,L(se)),re,se)}function B(q,re){return l(y(q,re))}function U(q,re,se){return g(f(q,L(se)),re,se)}function K(q,re,se){return m(y(q,re),se)}function H(q,re,se){return g(C(q,L(se)),re,se)}function G(q,re,se){var Se=C(q,L(se));return U(Se,re,w(Se))}function $(q,re,se){return T(K(q,re))}function V(ze){var re=D(ze),se=re.getInt32(0),Se=re.getInt32(4),we=ze.subarray(8,12),ze=ze.subarray(12);return[se,ze,Se,we]}function k(q,re,se,Se){var we=new ArrayBuffer(12+Se.byteLength),ze=new Uint8Array(we),Be=new DataView(we);return Be.setInt32(0,q),Be.setInt32(4,re),se&&ze.set(se,8),ze.set(Se,12),ze}function Y(q){var re=q.length,se=x(q);return k(2,re,void 0,se)}function ie(q){var re=q.length,se=s(q);return k(4,re,void 0,se)}function ne(q,re){var se=q.length/re,Se=s([re]),we=x(q);return k(5,se,Se,we)}function he(q){var re=q.length,se=s(l(q));return k(6,re,void 0,se)}function le(q){var re=q.length,se=s(F(q));return k(8,re,void 0,se)}function xe(q,re){var se=q.length,Se=s([re]),we=s(B(q,re));return k(9,se,Se,we)}function fe(q,re){var se=q.length,Se=s([re]),we=u($(q,re));return k(10,se,Se,we)}function pe(q){var re={};return Ze.forEach(function(se){q[se]!==void 0&&(re[se]=q[se])}),q.bondAtomList&&(re.bondAtomList=ie(q.bondAtomList)),q.bondOrderList&&(re.bondOrderList=Y(q.bondOrderList)),re.xCoordList=fe(q.xCoordList,1e3),re.yCoordList=fe(q.yCoordList,1e3),re.zCoordList=fe(q.zCoordList,1e3),q.bFactorList&&(re.bFactorList=fe(q.bFactorList,100)),q.atomIdList&&(re.atomIdList=le(q.atomIdList)),q.altLocList&&(re.altLocList=he(q.altLocList)),q.occupancyList&&(re.occupancyList=xe(q.occupancyList,100)),re.groupIdList=le(q.groupIdList),re.groupTypeList=ie(q.groupTypeList),q.secStructList&&(re.secStructList=Y(q.secStructList)),q.insCodeList&&(re.insCodeList=he(q.insCodeList)),q.sequenceIndexList&&(re.sequenceIndexList=le(q.sequenceIndexList)),re.chainIdList=ne(q.chainIdList,4),q.chainNameList&&(re.chainNameList=ne(q.chainNameList,4)),re}function Te(q){function re(ge){for(var Ce={},Ue=0;ge>Ue;Ue++){var ce=ze();Ce[ce]=ze()}return Ce}function se(ge){var Ce=q.subarray(Be,Be+ge);return Be+=ge,Ce}function Se(ge){var Ce=q.subarray(Be,Be+ge);Be+=ge;var Ue=65535;if(ge>Ue){for(var ce=[],Pe=0;Pe<Ce.length;Pe+=Ue)ce.push(String.fromCharCode.apply(null,Ce.subarray(Pe,Pe+Ue)));return ce.join("")}return String.fromCharCode.apply(null,Ce)}function we(ge){for(var Ce=new Array(ge),Ue=0;ge>Ue;Ue++)Ce[Ue]=ze();return Ce}function ze(){var ge,Ce,Ue=q[Be];if((128&Ue)===0)return Be++,Ue;if((240&Ue)===128)return Ce=15&Ue,Be++,re(Ce);if((240&Ue)===144)return Ce=15&Ue,Be++,we(Ce);if((224&Ue)===160)return Ce=31&Ue,Be++,Se(Ce);if((224&Ue)===224)return ge=Z.getInt8(Be),Be++,ge;switch(Ue){case 192:return Be++,null;case 194:return Be++,!1;case 195:return Be++,!0;case 196:return Ce=Z.getUint8(Be+1),Be+=2,se(Ce);case 197:return Ce=Z.getUint16(Be+1),Be+=3,se(Ce);case 198:return Ce=Z.getUint32(Be+1),Be+=5,se(Ce);case 202:return ge=Z.getFloat32(Be+1),Be+=5,ge;case 203:return ge=Z.getFloat64(Be+1),Be+=9,ge;case 204:return ge=q[Be+1],Be+=2,ge;case 205:return ge=Z.getUint16(Be+1),Be+=3,ge;case 206:return ge=Z.getUint32(Be+1),Be+=5,ge;case 208:return ge=Z.getInt8(Be+1),Be+=2,ge;case 209:return ge=Z.getInt16(Be+1),Be+=3,ge;case 210:return ge=Z.getInt32(Be+1),Be+=5,ge;case 217:return Ce=Z.getUint8(Be+1),Be+=2,Se(Ce);case 218:return Ce=Z.getUint16(Be+1),Be+=3,Se(Ce);case 219:return Ce=Z.getUint32(Be+1),Be+=5,Se(Ce);case 220:return Ce=Z.getUint16(Be+1),Be+=3,we(Ce);case 221:return Ce=Z.getUint32(Be+1),Be+=5,we(Ce);case 222:return Ce=Z.getUint16(Be+1),Be+=3,re(Ce);case 223:return Ce=Z.getUint32(Be+1),Be+=5,re(Ce)}throw new Error("Unknown type 0x"+Ue.toString(16))}var Be=0,Z=new DataView(q.buffer);return ze()}function ke(q,re,se,Se){switch(q){case 1:return h(re);case 2:return A(re);case 3:return b(re);case 4:return i(re);case 5:return x(re);case 6:return E(i(re),new Uint8Array(se));case 7:return E(i(re));case 8:return P(i(re));case 9:return N(i(re),i(Se)[0]);case 10:return G(b(re),i(Se)[0]);case 11:return g(b(re),i(Se)[0]);case 12:return H(b(re),i(Se)[0]);case 13:return H(A(re),i(Se)[0]);case 14:return C(b(re));case 15:return C(A(re))}}function $e(q,re){re=re||{};var se=re.ignoreFields,Se={};return Ye.forEach(function(we){var ze=se?se.indexOf(we)!==-1:!1,Be=q[we];ze||Be===void 0||(Be instanceof Uint8Array?Se[we]=ke.apply(null,V(Be)):Se[we]=Be)}),Se}function Le(q){return String.fromCharCode.apply(null,q).replace(/\0/g,"")}function ue(q,re,se){se=se||{};var Se,we,ze,Be,Z,ge,Ce=se.firstModelOnly,Ue=re.onModel,ce=re.onChain,Pe=re.onGroup,Q=re.onAtom,Ne=re.onBond,He=0,z=0,be=0,_e=0,ee=0,me=-1,Ae=q.chainNameList,ut=q.secStructList,ot=q.insCodeList,rt=q.sequenceIndexList,yt=q.atomIdList,Xt=q.bFactorList,bt=q.altLocList,xt=q.occupancyList,vt=q.bondAtomList,Pt=q.bondOrderList;for(Se=0,we=q.chainsPerModel.length;we>Se&&!(Ce&&He>0);++Se){var Dt=q.chainsPerModel[He];for(Ue&&Ue({chainCount:Dt,modelIndex:He}),ze=0;Dt>ze;++ze){var ir=q.groupsPerChain[z];if(ce){var Vt=Le(q.chainIdList.subarray(4*z,4*z+4)),Rt=null;Ae&&(Rt=Le(Ae.subarray(4*z,4*z+4))),ce({groupCount:ir,chainIndex:z,modelIndex:He,chainId:Vt,chainName:Rt})}for(Be=0;ir>Be;++Be){var At=q.groupList[q.groupTypeList[be]],St=At.atomNameList.length;if(Pe){var Ht=null;ut&&(Ht=ut[be]);var Yt=null;q.insCodeList&&(Yt=String.fromCharCode(ot[be]));var rr=null;rt&&(rr=rt[be]),Pe({atomCount:St,groupIndex:be,chainIndex:z,modelIndex:He,groupId:q.groupIdList[be],groupType:q.groupTypeList[be],groupName:At.groupName,singleLetterCode:At.singleLetterCode,chemCompType:At.chemCompType,secStruct:Ht,insCode:Yt,sequenceIndex:rr})}for(Z=0;St>Z;++Z){if(Q){var cr=null;yt&&(cr=yt[_e]);var dr=null;Xt&&(dr=Xt[_e]);var Hr=null;bt&&(Hr=String.fromCharCode(bt[_e]));var Vi=null;xt&&(Vi=xt[_e]),Q({atomIndex:_e,groupIndex:be,chainIndex:z,modelIndex:He,atomId:cr,element:At.elementList[Z],atomName:At.atomNameList[Z],formalCharge:At.formalChargeList[Z],xCoord:q.xCoordList[_e],yCoord:q.yCoordList[_e],zCoord:q.zCoordList[_e],bFactor:dr,altLoc:Hr,occupancy:Vi})}_e+=1}if(Ne){var er=At.bondAtomList;for(Z=0,ge=At.bondOrderList.length;ge>Z;++Z)Ne({atomIndex1:_e-St+er[2*Z],atomIndex2:_e-St+er[2*Z+1],bondOrder:At.bondOrderList[Z]})}be+=1}z+=1}if(ee=me+1,me=_e-1,Ne&&vt)for(Z=0,ge=vt.length;ge>Z;Z+=2){var Xn=vt[Z],Hi=vt[Z+1];(Xn>=ee&&me>=Xn||Hi>=ee&&me>=Hi)&&Ne({atomIndex1:Xn,atomIndex2:Hi,bondOrder:Pt?Pt[Z/2]:null})}He+=1}}function Me(q){return p(pe(q))}function Ge(q,re){q instanceof ArrayBuffer&&(q=new Uint8Array(q));var se;return se=q instanceof Uint8Array?Te(q):q,$e(se,re)}function Je(q,re,se,Se){function we(){try{var Be=Ge(ze.response);se(Be)}catch(Z){Se(Z)}}var ze=new XMLHttpRequest;ze.addEventListener("load",we,!0),ze.addEventListener("error",Se,!0),ze.responseType="arraybuffer",ze.open("GET",re+q.toUpperCase()),ze.send()}function qe(q,re,se){Je(q,nt,re,se)}function tt(q,re,se){Je(q,at,re,se)}var Ze=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],Ve=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Ye=Ze.concat(Ve),Ke="v1.0.1",We="//mmtf.rcsb.org/v1.0/",nt=We+"full/",at=We+"reduced/";n.encode=Me,n.decode=Ge,n.traverse=ue,n.fetch=qe,n.fetchReduced=tt,n.version=Ke,n.fetchUrl=nt,n.fetchReducedUrl=at,n.encodeMsgpack=p,n.encodeMmtf=pe,n.decodeMsgpack=Te,n.decodeMmtf=$e})}},__webpack_module_cache__={};function __webpack_require__(o){var a=__webpack_module_cache__[o];if(a!==void 0)return a.exports;if(__webpack_modules__[o]===void 0){var n=new Error("Cannot find module '"+o+"'");throw n.code="MODULE_NOT_FOUND",n}var d=__webpack_module_cache__[o]={exports:{}};return __webpack_modules__[o].call(d.exports,d,d.exports,__webpack_require__),d.exports}__webpack_require__.n=o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return __webpack_require__.d(a,{a}),a},__webpack_require__.d=(o,a)=>{for(var n in a)__webpack_require__.o(a,n)&&!__webpack_require__.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:a[n]})},__webpack_require__.o=(o,a)=>Object.prototype.hasOwnProperty.call(o,a),__webpack_require__.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol$1)),_3Dmol$1.exports}var _3DmolExports=require_3Dmol();const MoleculeViewer=({compound:o})=>{const a=reactExports.useRef(null),[n,d]=reactExports.useState(!0),[R,S]=reactExports.useState(null),[j,p]=reactExports.useState(null);reactExports.useEffect(()=>{if(!a.current)return;j&&j.clear(),d(!0),S(null);const w=_3DmolExports.createViewer(a.current,{backgroundColor:"white"});return p(w),(async()=>{try{if(o.pubchem_cid){const u=await fetch(`https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/${o.pubchem_cid}/SDF?record_type=3d`);if(u.ok){const i=await u.text();w.addModel(i,"sdf")}else{const i=await fetch(`https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/${o.pubchem_cid}/SDF`);if(!i.ok)throw new Error("Could not fetch molecular structure");const s=await i.text();w.addModel(s,"sdf")}}else if(o.canonical_smiles){const u=await fetch(`https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/${encodeURIComponent(o.canonical_smiles)}/SDF?record_type=3d`);if(!u.ok)throw new Error("Could not fetch molecular structure from SMILES");const i=await u.text();w.addModel(i,"sdf")}else throw new Error("No PubChem CID or SMILES available for 3D visualization");w.setStyle({},{stick:{radius:.15},sphere:{scale:.25}}),w.zoomTo(),w.render(),d(!1)}catch(u){console.error("Error loading molecule:",u),S(u instanceof Error?u.message:"Failed to load 3D structure"),d(!1)}})(),()=>{w&&w.clear()}},[o.pubchem_cid,o.canonical_smiles]);const v=()=>{j&&(j.setStyle({},{stick:{radius:.15}}),j.render())},D=()=>{j&&(j.setStyle({},{stick:{radius:.15},sphere:{scale:.25}}),j.render())},x=()=>{j&&(j.setStyle({},{sphere:{scale:.5}}),j.render())},A=()=>{j&&(j.setStyle({},{stick:{colorscheme:"Jmol",radius:.15},sphere:{colorscheme:"Jmol",scale:.25}}),j.render())},L=()=>{j&&(j.zoomTo(),j.render())};return jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between mb-4",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"3D Molecular Structure"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[o.ingredient_name,o.pubchem_cid&&` (CID: ${o.pubchem_cid})`]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[jsxRuntimeExports.jsx("button",{onClick:D,className:"px-3 py-1.5 text-sm bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors",children:"Ball & Stick"}),jsxRuntimeExports.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Stick"}),jsxRuntimeExports.jsx("button",{onClick:x,className:"px-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Sphere"}),jsxRuntimeExports.jsx("button",{onClick:A,className:"px-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Color by Element"}),jsxRuntimeExports.jsx("button",{onClick:L,className:"px-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors ml-auto",children:"Reset View"})]}),jsxRuntimeExports.jsxs("div",{className:"relative w-full h-96 bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[n&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 dark:bg-gray-900/80 z-10",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(LoadingSpinner$1,{size:"lg"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Loading 3D structure..."})]})}),R&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:jsxRuntimeExports.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[jsxRuntimeExports.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:R})]})}),jsxRuntimeExports.jsx("div",{ref:a,className:"w-full h-full",style:{position:"relative"}})]}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Controls:"})," Drag to rotate - Scroll to zoom - Shift+drag to pan"]})}),o.inchikey&&jsxRuntimeExports.jsxs("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"InChIKey"}),jsxRuntimeExports.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 break-all",children:o.inchikey})]})]})};function getSideEffectsFromTargets(o,a){const n=[],d=new Set,R=p=>{d.has(p.name)||(n.push(p),d.add(p.name))};for(const p of o){const v=p.target_name.toLowerCase();(v.includes("cyclooxygenase")||v.includes("prostaglandin")||p.target_id==="P23219"||p.target_id==="P35354")&&(R({name:"Gastrointestinal Irritation",description:"Stomach discomfort, heartburn, or nausea due to reduced protective prostaglandins in the stomach lining.",severity:"moderate",frequency:"common",bodySystem:"Digestive",mechanismBasis:"COX-1 inhibition reduces gastric mucosal protection",managementTips:["Take with food or milk","Use lowest effective dose","Consider enteric-coated formulations","Avoid alcohol consumption"],whenToSeekHelp:"Black or bloody stools, severe stomach pain, vomiting blood"}),R({name:"Increased Bleeding Risk",description:"Reduced ability for blood to clot due to effects on platelet function.",severity:"moderate",frequency:"uncommon",bodySystem:"Cardiovascular",mechanismBasis:"COX-1 inhibition reduces thromboxane A2 production in platelets",managementTips:["Inform healthcare providers before surgery","Avoid combining with other blood thinners","Watch for unusual bruising"],whenToSeekHelp:"Unusual bleeding, prolonged bleeding from cuts, severe bruising"}),R({name:"Kidney Function Changes",description:"May affect kidney blood flow, especially in those with existing kidney conditions.",severity:"moderate",frequency:"uncommon",bodySystem:"Urinary",mechanismBasis:"Prostaglandins help maintain renal blood flow",managementTips:["Stay well hydrated","Avoid prolonged use","Regular monitoring if using long-term"],whenToSeekHelp:"Decreased urination, swelling in legs/feet, unusual fatigue"}),R({name:"Cardiovascular Risk",description:"Long-term use may slightly increase risk of heart problems in susceptible individuals.",severity:"serious",frequency:"rare",bodySystem:"Cardiovascular",mechanismBasis:"COX-2 selective inhibition may affect vascular prostacyclin balance",managementTips:["Use lowest dose for shortest time","Discuss cardiovascular history with doctor","Consider alternatives if high risk"],whenToSeekHelp:"Chest pain, shortness of breath, sudden weakness on one side"})),(v.includes("lipoxygenase")||p.target_id==="P09917")&&R({name:"Altered Immune Response",description:"Changes in leukotriene production may affect inflammatory and immune responses.",severity:"mild",frequency:"uncommon",bodySystem:"Immune",mechanismBasis:"Leukotrienes are important immune signaling molecules",managementTips:["Monitor for signs of infection","Report unusual symptoms"]}),(v.includes("cytochrome")||v.includes("cyp"))&&R({name:"Drug Metabolism Changes",description:"May alter how the liver processes other medications, affecting their effectiveness or safety.",severity:"moderate",frequency:"common",bodySystem:"Hepatic",mechanismBasis:"CYP450 enzymes metabolize many medications",managementTips:["Inform all healthcare providers about all medications","Watch for increased or decreased effects of other drugs","Consider drug interaction checking"],whenToSeekHelp:"Unexpected medication side effects, signs of medication toxicity"}),v.includes("kinase")&&R({name:"Cell Signaling Alterations",description:"May affect cellular growth and signaling pathways.",severity:"mild",frequency:"uncommon",bodySystem:"Cellular",mechanismBasis:"Kinases regulate many cellular processes",managementTips:["Monitor for unusual symptoms","Follow recommended dosing"]}),(v.includes("channel")||v.includes("receptor"))&&R({name:"Nervous System Effects",description:"May cause mild drowsiness, dizziness, or changes in mood in some individuals.",severity:"mild",frequency:"uncommon",bodySystem:"Nervous",mechanismBasis:"Ion channels and receptors mediate neural signaling",managementTips:["Avoid driving if drowsy","Avoid alcohol","Start with lower doses"]})}for(const p of a){const v=p.pathway_name.toLowerCase();(v.includes("platelet")||v.includes("coagulation"))&&R({name:"Bleeding Tendency",description:"Affects blood clotting mechanisms, may increase bleeding risk.",severity:"moderate",frequency:"uncommon",bodySystem:"Hematologic",mechanismBasis:"Pathway involvement in coagulation cascade",managementTips:["Avoid with anticoagulants unless advised","Inform surgeons and dentists","Watch for unusual bleeding"],whenToSeekHelp:"Prolonged bleeding, blood in urine or stool"}),(v.includes("histamine")||v.includes("allergic"))&&R({name:"Allergic Reactions",description:"Some individuals may experience allergic responses.",severity:"moderate",frequency:"rare",bodySystem:"Immune",mechanismBasis:"Individual sensitivity and immune pathway involvement",managementTips:["Start with small dose to test tolerance","Have antihistamines available","Know signs of allergic reaction"],whenToSeekHelp:"Difficulty breathing, swelling of face/throat, severe rash"})}const S={serious:0,moderate:1,mild:2},j={common:0,uncommon:1,rare:2};return n.sort((p,v)=>{const D=S[p.severity]-S[v.severity];return D!==0?D:j[p.frequency]-j[v.frequency]})}const SeverityBadge=({severity:o})=>{const n={mild:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-300",label:"Mild"},moderate:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",label:"Moderate"},serious:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-300",label:"Serious"}}[o];return jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-0.5 rounded-full text-xs font-medium",n.bg,n.text),children:n.label})},FrequencyBadge=({frequency:o})=>{const n={common:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",label:"Common"},uncommon:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",label:"Uncommon"},rare:{bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-600 dark:text-gray-300",label:"Rare"}}[o];return jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-0.5 rounded-full text-xs font-medium",n.bg,n.text),children:n.label})},SideEffectsTab=({targets:o,pathways:a,compoundName:n})=>{const[d,R]=reactExports.useState(null),[S,j]=reactExports.useState("all"),p=getSideEffectsFromTargets(o,a),v=S==="all"?p:p.filter(x=>x.severity===S),D={serious:p.filter(x=>x.severity==="serious").length,moderate:p.filter(x=>x.severity==="moderate").length,mild:p.filter(x=>x.severity==="mild").length};return jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Potential Side Effects"]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Based on ",n,"'s mechanism of action"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[D.serious>0&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:D.serious}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Serious"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:D.moderate}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Moderate"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:D.mild}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Mild"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 mb-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>j("all"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="all"?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:["All (",p.length,")"]}),jsxRuntimeExports.jsx("button",{onClick:()=>j("serious"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="serious"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Serious"}),jsxRuntimeExports.jsx("button",{onClick:()=>j("moderate"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="moderate"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Moderate"}),jsxRuntimeExports.jsx("button",{onClick:()=>j("mild"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="mild"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Mild"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[v.map((x,A)=>{const L=d===A;return jsxRuntimeExports.jsxs("div",{className:clsx("border rounded-xl overflow-hidden transition-all duration-200",x.severity==="serious"&&"border-red-200 dark:border-red-800",x.severity==="moderate"&&"border-amber-200 dark:border-amber-800",x.severity==="mild"&&"border-gray-200 dark:border-gray-700",L&&"shadow-lg"),children:[jsxRuntimeExports.jsx("div",{onClick:()=>R(L?null:A),className:clsx("p-4 cursor-pointer transition-colors",x.severity==="serious"&&"hover:bg-red-50 dark:hover:bg-red-900/10",x.severity==="moderate"&&"hover:bg-amber-50 dark:hover:bg-amber-900/10",x.severity==="mild"&&"hover:bg-gray-50 dark:hover:bg-gray-800/50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:x.name}),jsxRuntimeExports.jsx(SeverityBadge,{severity:x.severity}),jsxRuntimeExports.jsx(FrequencyBadge,{frequency:x.frequency})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:x.description})]}),jsxRuntimeExports.jsx("button",{className:clsx("p-1 transition-transform duration-200",L&&"rotate-180"),children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),L&&jsxRuntimeExports.jsxs("div",{className:"px-4 pb-4 border-t border-gray-100 dark:border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3",children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2",children:"BODY SYSTEM"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:x.bodySystem}),jsxRuntimeExports.jsx("h5",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mt-3 mb-2",children:"MECHANISM BASIS"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:x.mechanismBasis})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-medium text-blue-700 dark:text-blue-300 mb-2",children:"MANAGEMENT TIPS"}),jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:x.managementTips.map((w,b)=>jsxRuntimeExports.jsxs("li",{className:"text-sm text-blue-800 dark:text-blue-200 flex items-start gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-500 mt-1",children:""}),w]},b))})]})]}),x.whenToSeekHelp&&jsxRuntimeExports.jsxs("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:[jsxRuntimeExports.jsxs("h5",{className:"text-xs font-semibold text-red-700 dark:text-red-300 mb-1 flex items-center gap-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"WHEN TO SEEK MEDICAL HELP"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:x.whenToSeekHelp})]})]})]},A)}),v.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No side effects found for the selected filter."})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("strong",{children:"Disclaimer:"})," This information is derived from the compound's mechanism of action and is for educational purposes only. Individual responses may vary. Always consult a healthcare professional for medical advice. Not all possible side effects are listed."]})})]})};function getDrugInteractions(o,a){const n=[],d=new Set,R=j=>{d.has(j.drugClass)||(n.push(j),d.add(j.drugClass))};for(const j of o){const p=j.target_name.toLowerCase();(p.includes("cyclooxygenase")||p.includes("prostaglandin")||j.target_id==="P23219"||j.target_id==="P35354")&&(R({drugClass:"Anticoagulants (Blood Thinners)",examples:["Warfarin (Coumadin)","Heparin","Enoxaparin (Lovenox)"],interactionType:"Pharmacodynamic",severity:"major",mechanism:"Both COX inhibitors and anticoagulants affect hemostasis through different mechanisms. COX inhibition reduces platelet aggregation while anticoagulants prevent clot formation.",clinicalEffect:"Significantly increased risk of bleeding, including gastrointestinal bleeding and hemorrhagic stroke.",recommendation:"Avoid combination if possible. If necessary, use lowest effective doses and monitor closely for signs of bleeding. Consider gastroprotective agents.",evidenceLevel:"established",references:["Lanas A, et al. Am J Gastroenterol. 2006;101(4):701-10","Garca Rodrguez LA, et al. Circulation. 2011;123(21):2226-35","FDA Drug Safety Communication: NSAIDs and Anticoagulants"]}),R({drugClass:"Other NSAIDs",examples:["Aspirin","Naproxen (Aleve)","Diclofenac","Celecoxib"],interactionType:"Pharmacodynamic",severity:"major",mechanism:"Additive inhibition of cyclooxygenase enzymes throughout the body.",clinicalEffect:"Increased risk of gastrointestinal ulceration, bleeding, and cardiovascular events without additional therapeutic benefit.",recommendation:"Avoid concurrent use of multiple NSAIDs. Choose one NSAID at the lowest effective dose.",evidenceLevel:"established",references:["Antman EM, et al. Circulation. 2007;115(12):1634-42","FDA Label: NSAIDs Class Warning"]}),R({drugClass:"ACE Inhibitors & ARBs",examples:["Lisinopril","Enalapril","Losartan","Valsartan"],interactionType:"Pharmacodynamic",severity:"moderate",mechanism:"NSAIDs reduce prostaglandin-mediated vasodilation and sodium excretion, counteracting the antihypertensive effects of ACE inhibitors and ARBs.",clinicalEffect:"Reduced blood pressure control, potential worsening of heart failure, and increased risk of acute kidney injury (especially with dehydration).",recommendation:"Monitor blood pressure and renal function. Ensure adequate hydration. Consider alternative pain relief if blood pressure becomes difficult to control.",evidenceLevel:"established",references:["Fournier JP, et al. BMJ. 2012;344:e458","White WB. Clin Pharmacol Ther. 2007;82(6):676-90"]}),R({drugClass:"Diuretics",examples:["Furosemide (Lasix)","Hydrochlorothiazide","Spironolactone"],interactionType:"Pharmacodynamic",severity:"moderate",mechanism:"NSAIDs promote sodium and water retention by inhibiting renal prostaglandins, opposing the natriuretic effect of diuretics.",clinicalEffect:"Reduced diuretic efficacy, fluid retention, potential edema, and worsening of hypertension or heart failure.",recommendation:"Monitor weight, blood pressure, and signs of fluid retention. May need to adjust diuretic dosing.",evidenceLevel:"established",references:["Brater DC. Clin Pharmacol Ther. 1999;66(6):557-62"]}),R({drugClass:"SSRIs & SNRIs (Antidepressants)",examples:["Sertraline (Zoloft)","Fluoxetine (Prozac)","Venlafaxine (Effexor)"],interactionType:"Pharmacodynamic",severity:"moderate",mechanism:"SSRIs deplete platelet serotonin, impairing platelet aggregation. Combined with NSAID-induced COX inhibition, bleeding risk increases.",clinicalEffect:"Approximately 2-3 fold increased risk of upper gastrointestinal bleeding.",recommendation:"Consider gastroprotective therapy (PPI) if combination is necessary. Monitor for signs of bleeding.",evidenceLevel:"established",references:["Loke YK, et al. Aliment Pharmacol Ther. 2008;27(1):31-40","de Abajo FJ, et al. BMJ. 1999;319(7217):1106-9"]}),R({drugClass:"Lithium",examples:["Lithium carbonate (Lithobid)","Lithium citrate"],interactionType:"Pharmacokinetic",severity:"major",mechanism:"NSAIDs reduce renal lithium clearance by inhibiting prostaglandin-mediated renal blood flow and sodium excretion.",clinicalEffect:"Increased lithium serum levels by 15-30%, potentially causing lithium toxicity (tremor, confusion, cardiac effects).",recommendation:"Avoid if possible. If necessary, reduce lithium dose by 25-50% and monitor lithium levels closely. Watch for signs of toxicity.",evidenceLevel:"established",references:["Phelan KM, et al. Ann Pharmacother. 2003;37(3):346-51","Ragheb M. J Clin Psychiatry. 1990;51(5):197-200"]}),R({drugClass:"Methotrexate",examples:["Methotrexate (Trexall, Rheumatrex)"],interactionType:"Pharmacokinetic",severity:"major",mechanism:"NSAIDs reduce renal clearance of methotrexate and may displace it from protein binding sites.",clinicalEffect:"Elevated methotrexate levels leading to bone marrow suppression, hepatotoxicity, and mucositis.",recommendation:"Avoid with high-dose methotrexate. With low-dose methotrexate (rheumatoid arthritis), use caution and monitor blood counts.",evidenceLevel:"established",references:["Skeith KJ, et al. Clin Pharmacol Ther. 1997;62(5):516-26","Frenia ML, Long KS. Pharmacotherapy. 1992;12(4):305-9"]}),R({drugClass:"Corticosteroids",examples:["Prednisone","Dexamethasone","Hydrocortisone"],interactionType:"Pharmacodynamic",severity:"moderate",mechanism:"Both drug classes can damage the gastrointestinal mucosa, and corticosteroids may mask symptoms of GI complications.",clinicalEffect:"Increased risk of GI ulceration and bleeding. Corticosteroids may delay wound healing.",recommendation:"Use gastroprotective therapy (PPI or misoprostol) if combination is needed. Limit duration of concurrent use.",evidenceLevel:"established",references:["Piper JM, et al. Ann Intern Med. 1991;114(9):735-40"]})),(p.includes("cytochrome")||p.includes("cyp"))&&R({drugClass:"CYP450-Metabolized Drugs",examples:["Phenytoin","Warfarin","Theophylline","Certain statins"],interactionType:"Pharmacokinetic",severity:"moderate",mechanism:"Inhibition or induction of cytochrome P450 enzymes alters the metabolism of drugs processed by the same pathway.",clinicalEffect:"May increase or decrease blood levels of affected medications, altering their efficacy or causing toxicity.",recommendation:"Review all medications for potential CYP450 interactions. Monitor drug levels where applicable.",evidenceLevel:"established",references:["Flockhart DA. Drug Interactions: Cytochrome P450 Drug Interaction Table. Indiana University School of Medicine","Zanger UM, Schwab M. Pharmacol Rev. 2013;65(4):1199-1214"]}),p.includes("kinase")&&R({drugClass:"Tyrosine Kinase Inhibitors",examples:["Imatinib (Gleevec)","Gefitinib","Erlotinib"],interactionType:"Pharmacodynamic",severity:"moderate",mechanism:"Potential additive effects on kinase inhibition pathways.",clinicalEffect:"May enhance or interfere with kinase inhibitor therapy effects.",recommendation:"Consult oncologist. Monitor for enhanced side effects.",evidenceLevel:"theoretical",references:["Drug interaction databases (Lexicomp, Micromedex)"]})}for(const j of a){const p=j.pathway_name.toLowerCase();(p.includes("platelet")||p.includes("coagulation"))&&R({drugClass:"Antiplatelet Agents",examples:["Clopidogrel (Plavix)","Prasugrel","Ticagrelor"],interactionType:"Pharmacodynamic",severity:"major",mechanism:"Additive inhibition of platelet function through different mechanisms.",clinicalEffect:"Significantly increased bleeding risk, particularly gastrointestinal bleeding.",recommendation:"Use combination only when clearly indicated (e.g., post-cardiac stent). Add gastroprotection.",evidenceLevel:"established",references:["Bhatt DL, et al. JAMA. 2008;300(22):2620-2","Abraham NS, et al. Circulation. 2010;122(12):1183-9"]}),(p.includes("serotonin")||p.includes("dopamine"))&&R({drugClass:"Serotonergic Drugs",examples:["Tramadol","Triptans","MAOIs","St. John's Wort"],interactionType:"Pharmacodynamic",severity:"moderate",mechanism:"Additive effects on serotonin pathways.",clinicalEffect:"Potential for serotonin syndrome (agitation, hyperthermia, tremor, hyperreflexia).",recommendation:"Avoid combining multiple serotonergic agents. Monitor for signs of serotonin syndrome.",evidenceLevel:"case-reports",references:["Boyer EW, Shannon M. N Engl J Med. 2005;352(11):1112-20"]})}const S={major:0,moderate:1,minor:2};return n.sort((j,p)=>S[j.severity]-S[p.severity])}const SeverityIcon=({severity:o})=>{const n={major:{color:"text-red-500",bg:"bg-red-100 dark:bg-red-900/30"},moderate:{color:"text-amber-500",bg:"bg-amber-100 dark:bg-amber-900/30"},minor:{color:"text-blue-500",bg:"bg-blue-100 dark:bg-blue-900/30"}}[o];return jsxRuntimeExports.jsx("div",{className:clsx("p-2 rounded-full",n.bg),children:jsxRuntimeExports.jsxs("svg",{className:clsx("w-5 h-5",n.color),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o==="major"&&jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}),o==="moderate"&&jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),o==="minor"&&jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})})},EvidenceBadge=({level:o})=>{const n={established:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-300",label:"Established"},"case-reports":{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",label:"Case Reports"},theoretical:{bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-600 dark:text-gray-300",label:"Theoretical"}}[o];return jsxRuntimeExports.jsxs("span",{className:clsx("px-2 py-0.5 rounded text-xs font-medium",n.bg,n.text),children:[n.label," Evidence"]})},DrugInteractionsTab=({targets:o,pathways:a,compoundName:n})=>{const[d,R]=reactExports.useState(new Set),[S,j]=reactExports.useState("all"),p=getDrugInteractions(o,a),v=S==="all"?p:p.filter(w=>w.severity===S),D=w=>{const b=new Set(d);b.has(w)?b.delete(w):b.add(w),R(b)},x=()=>{R(new Set(v.map((w,b)=>b)))},A=()=>{R(new Set)},L={major:p.filter(w=>w.severity==="major").length,moderate:p.filter(w=>w.severity==="moderate").length,minor:p.filter(w=>w.severity==="minor").length};return jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Drug Interactions"]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Potential interactions with ",n]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:L.major}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Major"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:L.moderate}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Moderate"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:L.minor}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 block",children:"Minor"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>j("all"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="all"?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:["All (",p.length,")"]}),jsxRuntimeExports.jsx("button",{onClick:()=>j("major"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="major"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Major"}),jsxRuntimeExports.jsx("button",{onClick:()=>j("moderate"),className:clsx("px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",S==="moderate"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Moderate"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:x,className:"px-3 py-1.5 text-sm text-primary-600 dark:text-primary-400 hover:underline",children:"Expand All"}),jsxRuntimeExports.jsx("button",{onClick:A,className:"px-3 py-1.5 text-sm text-gray-500 dark:text-gray-400 hover:underline",children:"Collapse All"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[v.map((w,b)=>{const u=d.has(b);return jsxRuntimeExports.jsxs("div",{className:clsx("border rounded-xl overflow-hidden transition-all duration-200",w.severity==="major"&&"border-red-200 dark:border-red-800",w.severity==="moderate"&&"border-amber-200 dark:border-amber-800",w.severity==="minor"&&"border-blue-200 dark:border-blue-800",u&&"shadow-lg"),children:[jsxRuntimeExports.jsx("div",{onClick:()=>D(b),className:clsx("p-4 cursor-pointer transition-colors","hover:bg-gray-50 dark:hover:bg-gray-800/50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx(SeverityIcon,{severity:w.severity}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:w.drugClass}),jsxRuntimeExports.jsx(EvidenceBadge,{level:w.evidenceLevel})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:["Examples: ",w.examples.join(", ")]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-1 rounded text-xs font-semibold uppercase",w.severity==="major"&&"bg-red-500 text-white",w.severity==="moderate"&&"bg-amber-500 text-white",w.severity==="minor"&&"bg-blue-500 text-white"),children:w.severity}),jsxRuntimeExports.jsx("button",{className:clsx("p-1 transition-transform duration-200",u&&"rotate-180"),children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),u&&jsxRuntimeExports.jsx("div",{className:"px-4 pb-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/30",children:jsxRuntimeExports.jsxs("div",{className:"pt-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2",children:"AFFECTED DRUGS"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:w.examples.map((i,s)=>jsxRuntimeExports.jsx("span",{className:"px-2.5 py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-full text-sm text-gray-700 dark:text-gray-300",children:i},s))})]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-100 dark:border-gray-700",children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2",children:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"MECHANISM"]})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:w.mechanism}),jsxRuntimeExports.jsx("span",{className:"inline-block mt-2 px-2 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs text-gray-500 dark:text-gray-400",children:w.interactionType})]}),jsxRuntimeExports.jsxs("div",{className:clsx("rounded-lg p-3 border",w.severity==="major"&&"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",w.severity==="moderate"&&"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800",w.severity==="minor"&&"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"),children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2",children:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"CLINICAL EFFECT"]})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:w.clinicalEffect})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 border border-green-200 dark:border-green-800",children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-green-700 dark:text-green-300 mb-2",children:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"RECOMMENDATION"]})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:w.recommendation})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2",children:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"REFERENCES"]})}),jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:w.references.map((i,s)=>jsxRuntimeExports.jsx("li",{className:"text-xs text-gray-500 dark:text-gray-400 pl-3 border-l-2 border-gray-200 dark:border-gray-600",children:i},s))})]})]})})]},b)}),v.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No drug interactions found for the selected filter."})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("strong",{children:"Important:"})," This list is not exhaustive. Drug interactions depend on individual patient factors, dosages, and duration of use. Always consult a pharmacist or healthcare provider for personalized drug interaction checking. Clinical references are provided for educational purposes."]})})]})},getSeverityColor=o=>{switch(o){case"major":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"moderate":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"minor":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800";default:return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}},getSeverityBadgeColor=o=>{switch(o){case"major":return"bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300";case"moderate":return"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300";case"minor":return"bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300";default:return"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300"}},getSeverityIcon=o=>{switch(o){case"major":return"";case"moderate":return"";case"minor":return"";default:return""}},getEvidenceBadge=o=>{switch(o){case"established":return{text:"Established",color:"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300"};case"theoretical":return{text:"Theoretical",color:"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-300"};case"predicted":return{text:"Predicted",color:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"};default:return{text:"Unknown",color:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"}}},PersonalizedInteractionsTab=({compoundName:o,personalized_interactions:a=[]})=>{const[n,d]=reactExports.useState(null),R=a.filter(v=>v.severity==="major").length,S=a.filter(v=>v.severity==="moderate").length,j=a.filter(v=>v.severity==="minor").length,p=a.filter(v=>v.severity==="none").length;return jsxRuntimeExports.jsxs(Card,{className:"animate-slide-up space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"Interactions with Your Medications"]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["How ",o," may interact with your current medications"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[R>0&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:R}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Major"})]}),S>0&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:S}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Moderate"})]}),j>0&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:j}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Minor"})]}),p>0&&jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Safe (",p,")"]})})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:a.length===0?jsxRuntimeExports.jsxs("div",{className:"p-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-medium text-green-900 dark:text-green-300",children:"No Known Interactions"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-green-800 dark:text-green-400 mt-2",children:["Based on available data, ",o," does not have known interactions with your medications."]})]}):a.map((v,D)=>jsxRuntimeExports.jsxs("div",{className:clsx("border rounded-lg p-4 cursor-pointer transition-all hover:shadow-md",getSeverityColor(v.severity)),onClick:()=>d(n===v.medication_name?null:v.medication_name),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xl mt-1",children:getSeverityIcon(v.severity)}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:v.medication_name}),jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-1 text-xs font-medium rounded-full",getSeverityBadgeColor(v.severity)),children:v.severity.charAt(0).toUpperCase()+v.severity.slice(1)}),jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-1 text-xs font-medium rounded-full",getEvidenceBadge(v.evidence_level).color),children:getEvidenceBadge(v.evidence_level).text})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium",children:v.mechanism})]})]}),jsxRuntimeExports.jsx("svg",{className:clsx("w-5 h-5 transition-transform flex-shrink-0",n===v.medication_name&&"rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),n===v.medication_name&&jsxRuntimeExports.jsxs("div",{className:"mt-4 pt-4 border-t border-current border-opacity-20 space-y-3",children:[v.clinical_effect&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"Clinical Effect:"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:v.clinical_effect})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"Recommendation:"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:v.recommendation})]}),(v.shared_targets?.length??0)>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"Shared Targets:"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:v.shared_targets?.map((x,A)=>jsxRuntimeExports.jsx("span",{className:"text-xs bg-white dark:bg-gray-700 px-2 py-1 rounded border border-gray-300 dark:border-gray-600",children:x},A))})]}),(v.shared_pathways?.length??0)>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"Affected Pathways:"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:v.shared_pathways?.map((x,A)=>jsxRuntimeExports.jsx("span",{className:"text-xs bg-white dark:bg-gray-700 px-2 py-1 rounded border border-gray-300 dark:border-gray-600",children:x},A))})]})]})]},D))}),R>0&&jsxRuntimeExports.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-red-900 dark:text-red-300 mb-1",children:" Important Safety Notice"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-red-800 dark:text-red-400",children:["Major interactions detected. ",jsxRuntimeExports.jsx("strong",{children:"Consult your healthcare provider immediately"})," before using this substance in combination with your medications."]})]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[jsxRuntimeExports.jsx("strong",{children:"Disclaimer:"})," This information is for educational purposes only and should not be considered medical advice. Always consult with your healthcare provider or pharmacist before combining any substances with your medications. Interactions depend on dose, timing, individual metabolism, and other factors not captured here."]})})]})},STORAGE_KEY="biopath-medications",MedicationListManager=({medications:o,onMedicationsChange:a})=>{const[n,d]=reactExports.useState("");reactExports.useEffect(()=>{try{const v=localStorage.getItem(STORAGE_KEY);if(v){const D=JSON.parse(v);a(D)}}catch(v){console.error("Failed to load medications from localStorage:",v)}},[]),reactExports.useEffect(()=>{try{localStorage.setItem(STORAGE_KEY,JSON.stringify(o))}catch(v){console.error("Failed to save medications to localStorage:",v)}},[o]);const R=()=>{const v=n.trim();if(!v)return;if(o.some(x=>x.name.toLowerCase()===v.toLowerCase())){alert("This medication is already in your list");return}const D={id:`med_${Date.now()}`,name:v,addedAt:new Date().toISOString()};a([...o,D]),d("")},S=v=>{a(o.filter(D=>D.id!==v))},j=()=>{window.confirm("Are you sure you want to remove all medications?")&&a([])},p=v=>{d(v)};return jsxRuntimeExports.jsx(Card,{className:"max-w-2xl mx-auto",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:" My Medications"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Add your current medications to check for interactions when analyzing compounds or plants."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:["Your Medications (",o.length,")"]}),o.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-2 mb-4",children:o.map(v=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:""}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:v.name}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Added ",new Date(v.addedAt).toLocaleDateString()]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>S(v.id),className:"px-3 py-1 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:"Remove"})]},v.id))}):jsxRuntimeExports.jsx("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg text-center mb-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:"No medications added yet. Add your medications to get personalized drug interaction warnings."})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"medication",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Add Medication"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx(AutocompleteInput,{value:n,onChange:d,onSelect:p,placeholder:"Enter medication name (e.g., Lisinopril, Metformin)..."}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Press Enter or click Add to add medication to your list."})]}),jsxRuntimeExports.jsx("div",{className:"flex items-end",children:jsxRuntimeExports.jsx(Button,{type:"button",onClick:R,variant:"primary",size:"md",children:"+ Add"})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-3 w-full",children:[jsxRuntimeExports.jsx(Button,{type:"button",onClick:j,variant:"outline",size:"md",disabled:o.length===0,children:"Clear All"}),o.length>0&&jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center flex-1",children:[o.length," medication",o.length!==1?"s":""," saved"]})]})}),o.length>0&&jsxRuntimeExports.jsx("div",{className:"pt-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Now you can analyze any compound or plant, and see how it interacts with your medications."})}),jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:[jsxRuntimeExports.jsx("strong",{children:" Important:"})," This tool provides information about potential drug interactions for educational purposes only. Always consult with your healthcare provider before combining medications or botanical supplements."]})})]})})},LoadingOverlay=({compoundName:o})=>jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in",children:jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center max-w-md mx-4",children:[jsxRuntimeExports.jsx(LoadingSpinner$1,{size:"lg",className:"mx-auto mb-4"}),jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Analyzing ",o||"compound","..."]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take around 1 minute"}),jsxRuntimeExports.jsxs("div",{className:"mt-6 space-y-2 text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full mr-2 animate-pulse"}),"Resolving compound structure..."]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full mr-2 animate-pulse",style:{animationDelay:"0.2s"}}),"Finding targets in ChEMBL..."]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full mr-2 animate-pulse",style:{animationDelay:"0.4s"}}),"Mapping biological pathways..."]})]})]})}),LicensesModal=({isOpen:o,onClose:a})=>{if(!o)return null;const n=[{name:"PubChem",description:"Chemical compound data and structures",license:"Public Domain",url:"https://pubchem.ncbi.nlm.nih.gov/"},{name:"ChEMBL",description:"Bioactivity database of drug-like molecules",license:"CC BY-SA 3.0",url:"https://www.ebi.ac.uk/chembl/"},{name:"Reactome",description:"Pathway and reaction database",license:"CC BY 4.0",url:"https://reactome.org/"},{name:"Open Targets",description:"Drug target validation and pathway data",license:"Apache 2.0",url:"https://platform.opentargets.org/"},{name:"UniProt",description:"Protein sequence and functional information",license:"CC BY 4.0",url:"https://www.uniprot.org/"},{name:"RDKit",description:"Open-source cheminformatics toolkit",license:"BSD 3-Clause",url:"https://www.rdkit.org/"},{name:"3Dmol.js",description:"3D molecular visualization",license:"BSD 3-Clause",url:"https://3dmol.org/"}];return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:a,children:jsxRuntimeExports.jsx("div",{onClick:d=>d.stopPropagation(),children:jsxRuntimeExports.jsxs(Card,{className:"max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Licenses & Attributions"}),jsxRuntimeExports.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"BioPath integrates data from multiple scientific databases and uses open-source tools. We gratefully acknowledge the following resources:"}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:n.map(d=>jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:d.name}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.description})]}),jsxRuntimeExports.jsx("span",{className:"text-xs px-2 py-1 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded",children:d.license})]}),jsxRuntimeExports.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 mt-2 inline-block",children:d.url})]},d.name))}),jsxRuntimeExports.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"BioPath Application"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created by Dharsan Kesavan. This application is provided for educational and research purposes only. The information displayed is derived from public scientific databases and should not be used for medical diagnosis or treatment decisions."})]})]})]})})})},useAnalysisSync=()=>useMutation({mutationFn:analysisAPI.analyzeSync,onSuccess:o=>{const a=JSON.parse(localStorage.getItem("biopath_history")||"[]");a.unshift({ingredient_name:o.ingredient_name,timestamp:o.analysis_timestamp,pathways_count:o.pathways.length,targets_count:o.known_targets.length}),localStorage.setItem("biopath_history",JSON.stringify(a.slice(0,10)))}});function App(){const[o,a]=reactExports.useState("compound"),[n,d]=reactExports.useState(null),[R,S]=reactExports.useState(null),[j,p]=reactExports.useState(""),[v,D]=reactExports.useState("overview"),[x,A]=reactExports.useState(!1),[L,w]=reactExports.useState(!1),[b,u]=reactExports.useState([]);useTheme();const{mutate:i,isPending:s}=useAnalysisSync(),h=m=>{const C={...m,user_medications:b.length>0?b.map(T=>T.name):void 0};p(C.ingredient_name),d(null),D("overview"),i(C,{onSuccess:T=>{d(T)},onError:T=>{console.error("Analysis error:",T),alert(`Error: ${T.message}`)}})},g=()=>{d(null),S(null),p(""),D("overview")},y=m=>{S(m)},E=m=>{alert(`Error: ${m}`)},l=m=>{a(m),d(null),S(null),p("")},f=[{id:"overview",label:"Overview",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"body-impact",label:"Body Impact",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m7.538-4a3.998 3.998 0 00-5.441 0L12 7.939M3 12a9 9 0 1118 0m0 0a9 9 0 01-18 0m18 0a9 9 0 01-18 0m9-9a3 3 0 11-6 0 3 3 0 016 0z"})})},{id:"3d-structure",label:"3D Structure",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5M12 21l-2-1m2 1l2-1m-2 1v-2.5M6 18l-2-1v-2.5M18 18l2-1v-2.5"})})},{id:"targets",label:"Targets",icon:jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"})]})},{id:"pathways",label:"Pathways",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})},{id:"side-effects",label:"Side Effects",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})},{id:"drug-interactions",label:"Drug Interactions",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})},{id:"my-medications",label:"My Medications",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-primary text-primary transition-colors duration-200",children:[(s||L)&&jsxRuntimeExports.jsx(LoadingOverlay,{compoundName:j||"plant"}),jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[jsxRuntimeExports.jsxs("header",{className:"mb-16 text-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-700 tracking-tight mb-3",children:"BioPath"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-text-secondary",children:"Discover how compounds interact with your medications"})]}),!n&&!R&&jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-16",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-3 bg-secondary rounded-full p-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>l("compound"),className:clsx("px-8 py-3 rounded-full text-sm font-500 transition-all duration-300 relative overflow-hidden",o==="compound"?"bg-gradient-to-r from-accent-warm to-accent-warm-dark text-white shadow-lg animate-liquid-glass":"text-text-secondary hover:text-text-primary hover:bg-bg-secondary"),children:"Compound"}),jsxRuntimeExports.jsx("button",{onClick:()=>l("plant"),className:clsx("px-8 py-3 rounded-full text-sm font-500 transition-all duration-300 relative overflow-hidden",o==="plant"?"bg-gradient-to-r from-accent-warm to-accent-warm-dark text-white shadow-lg animate-liquid-glass":"text-text-secondary hover:text-text-primary hover:bg-bg-secondary"),children:"Plant"}),jsxRuntimeExports.jsx("button",{onClick:()=>l("medication-tracker"),className:clsx("px-8 py-3 rounded-full text-sm font-500 transition-all duration-300 relative overflow-hidden",o==="medication-tracker"?"bg-gradient-to-r from-accent-warm to-accent-warm-dark text-white shadow-lg animate-liquid-glass":"text-text-secondary hover:text-text-primary hover:bg-bg-secondary"),children:"Medications"})]})}),jsxRuntimeExports.jsx("main",{children:R?jsxRuntimeExports.jsx(PlantAnalysisResults,{result:R,onNewAnalysis:g}):n?jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx(SummaryCard,{report:n}),jsxRuntimeExports.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:jsxRuntimeExports.jsx("nav",{className:"flex space-x-4 overflow-x-auto","aria-label":"Tabs",children:f.map(m=>jsxRuntimeExports.jsxs("button",{onClick:()=>D(m.id),className:clsx("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 whitespace-nowrap transition-colors",v===m.id?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:[m.icon,m.label,m.id==="targets"&&n.known_targets.length>0&&jsxRuntimeExports.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full",children:n.known_targets.length}),m.id==="pathways"&&n.pathways.length>0&&jsxRuntimeExports.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full",children:n.pathways.length})]},m.id))})}),jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[v==="overview"&&jsxRuntimeExports.jsx(CompoundInfo,{compound:n.compound_identity}),v==="body-impact"&&jsxRuntimeExports.jsx(BodyDiagram,{targets:n.known_targets,pathways:n.pathways,compoundName:n.ingredient_name}),v==="3d-structure"&&jsxRuntimeExports.jsx(MoleculeViewer,{compound:n.compound_identity}),v==="targets"&&(n.known_targets.length>0?jsxRuntimeExports.jsx(TargetsList,{targets:n.known_targets}):jsxRuntimeExports.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("p",{children:"No known targets found for this compound."})]})),v==="pathways"&&(n.pathways.length>0?jsxRuntimeExports.jsx(PathwaysList,{pathways:n.pathways}):jsxRuntimeExports.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("p",{children:"No pathways found for this compound."})]})),v==="side-effects"&&jsxRuntimeExports.jsx(SideEffectsTab,{targets:n.known_targets,pathways:n.pathways,compoundName:n.ingredient_name}),v==="drug-interactions"&&jsxRuntimeExports.jsx(DrugInteractionsTab,{targets:n.known_targets,pathways:n.pathways,compoundName:n.ingredient_name}),v==="my-medications"&&jsxRuntimeExports.jsx(PersonalizedInteractionsTab,{compoundName:n.ingredient_name,personalized_interactions:n.personalized_interactions||[]})]}),jsxRuntimeExports.jsx("div",{className:"text-center pt-4",children:jsxRuntimeExports.jsx("button",{onClick:g,className:"px-6 py-3 bg-primary-500 text-white font-medium rounded-lg hover:bg-primary-600 transition-colors duration-200",children:"New Analysis"})}),n.final_summary.disclaimer&&jsxRuntimeExports.jsxs("div",{className:"bg-secondary border border-divider rounded-lg p-6 text-sm",children:[jsxRuntimeExports.jsx("p",{className:"font-600 text-text-primary mb-2",children:"Disclaimer"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary",children:n.final_summary.disclaimer})]})]}):jsxRuntimeExports.jsx("div",{className:"animate-content-fade",children:o==="compound"?jsxRuntimeExports.jsx(AnalysisForm,{onSubmit:h,isLoading:s}):o==="plant"?jsxRuntimeExports.jsx(PlantIdentification,{onAnalysisComplete:y,onError:E,isLoading:L,setIsLoading:w}):jsxRuntimeExports.jsx(MedicationListManager,{medications:b,onMedicationsChange:u})},o)}),jsxRuntimeExports.jsxs("footer",{className:"mt-24 pt-12 border-t border-divider text-center text-sm text-text-secondary",children:[jsxRuntimeExports.jsxs("p",{className:"mb-3",children:["Created by ",jsxRuntimeExports.jsx("span",{className:"font-500 text-text-primary",children:"Dharsan Kesavan"})]}),jsxRuntimeExports.jsx("p",{className:"text-text-tertiary text-xs mb-4",children:"Powered by PubChem, ChEMBL, Reactome, Open Targets, and PlantNet"}),jsxRuntimeExports.jsx("p",{className:"text-text-tertiary text-xs mb-4",children:"For research purposes only - Not medical advice"}),jsxRuntimeExports.jsx("button",{onClick:()=>A(!0),className:"text-info hover:opacity-70 transition-opacity text-xs",children:"Licenses & Attributions"})]})]}),jsxRuntimeExports.jsx(LicensesModal,{isOpen:x,onClose:()=>A(!1)})]})}const queryClient=new QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:300*1e3}}});ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsx(ThemeProvider,{children:jsxRuntimeExports.jsx(App,{})})})}));export{apiClient as a};
